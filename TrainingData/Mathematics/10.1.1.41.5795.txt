On the geometry and cohomology of some
simple Shimura varieties
Michael Harris 1
Department of Mathematics,
University of Paris 7,
Paris,
France.

Richard Taylor 2
Department of Mathematics,
Harvard University,
Cambridge,
MA 02138,
U.S.A.

August 30, 1999

1 Institut

de Math´ematiques de Jussieu, U.M.R. 7586 du CNRS
supported by NSF Grant DMS-9702885 and by the Miller Institute at
the University of California at Berkeley
2 Partially

Introduction
This paper has twin aims. On the one hand we prove the local Langlands
conjecture for GLn over a p-adic field. On the other hand in many cases we
are able to identify the action of the decomposition group at a prime of bad
reduction on the l-adic cohomology of the “simple” Shimura varieties studied
by Kottwitz in [Ko4]. These two problems go hand in hand.
The local Langlands conjecture is one of those hydra like conjectures which
seems to grow as it gets proved. However the generally accepted formulation
seems to be the following (see [He2]). Let K be a finite extension of Qp . Fix a
non-trivial additive character ψ : K → C× . We will denote the absolute value
on K which takes uniformisers to the reciprocal of the number of elements in
the residue field by | |K . We will let WK denote its Weil group. Recall that
local class field theory gives us a canonical isomorphism
Art K : K × → WKab .
(Normalised so that geometric Frobenius elements correspond to uniformisers.)
The local Langlands conjecture provides some sort of description of the whole
of WK in the same spirit.
We will let Irr(GLn (K)) denote the set of isomorphism classes or irreducible
admissible representations of GLn (K) over C (or what comes to the same
thing: irreducible smooth representations). If [π1 ] ∈ Irr(GLn1 (K)) and [π2 ] ∈
Irr(GLn2 (K)) then there is an L-factor L(π1 × π2 , s) and an epsilon factor
(π1 × π2 , s, ψ) associated to the pair π1 , π2 (see for instance [JPSS]).
On the other hand let WDRepn (WK ) denote the set of isomorphism classes
of n-dimensional Frobenius semi-simple Weil-Deligne representations of the
Weil group, WK , of K over C. By a Frobenius semi-simple Weil-Deligne
representation of WK over C we mean a pair (r, N ) where r is a semi-simple
representation of WK on a finite dimensional complex vector space , V , which
is trivial on an open subgroup and an element N ∈ End C (V ) such that
−1
r(σ)N r(σ)−1 = |Art K
(σ)|K N

for all σ ∈ WK . Again if [(r, N )] ∈ WDRepn1 (WK ) then there is an L-factor
L((r, N ), s) and an epsilon factor ((r, N ), s, ψ) associated to (r, N ) (see for
instance [Tat2] and section 12 of this paper for the precise normalisations we
are using).
By a local Langlands correspondence for K we shall mean a collection of
bijections
recK : Irr(GLn (K)) −→ WDRepn (WK )
for every n ≥ 1 satisfying the following properties.
1

−1
1. If π ∈ Irr(GL1 (K)) then recK (π) = π ◦ Art K
.

2. If [π1 ] ∈ Irr(GLn1 (K)) and [π2 ] ∈ Irr(GLn2 (K)) then
L(π1 × π2 , s) = L(recK (π1 ) ⊗ recK (π2 ), s)
and
(π1 × π2 , s, ψ) = (recK (π1 ) ⊗ recK (π2 ), s, ψ).
3. If [π] ∈ Irr(GLn (K)) and χ ∈ Irr(GL1 (K)) then recK (π ⊗ (χ ◦ det)) =
recK (π) ⊗ recK (χ).
4. If [π] ∈ Irr(GLn (K)) and π has central character χ then det recK (π) =
recK (χ).
5. If [π] ∈ Irr(GLn (K)) then recK (π ∨ ) = recK (π)∨ (where ∨ denotes contragredient).
Henniart showed (see [He5]) that there is at most one set of bijections recK
with these properties. The commonest formulation of the local Langlands
conjecture for GLn is the following theorem.
Theorem A A local Langlands correspondence recK exists for any finite extension K/Qp .
However it seems to us that one would really like more than this simple
existence theorem. On the one hand it would be very useful if one had some
sort of explicit description of this map recK . Our methods shed no light on
this. One might well hope that the methods of Bushnell, Henniart and Kutzko
will lead to an explicit version of this theorem. On the other hand one would
also like to know that the local reciprocity map recK is compatible with global
reciprocity maps whenever the global map is known to exist. Our methods
do not resolve this latter question but they do shed considerable light on it.
For instance in the cases considered by Clozel in [Cl1] we settle this question
affirmatively up to semisimplification (in particular we do not identify the two
N ’s).
Maybe a remark on the history of this problem is in order. The existence of recK |Irr(GL1 (K)) with the desired properties follows from local class
field theory (due originally to Hasse [Has]), but this preceded the general conjecture. The key generalisation to n > 1 is due to Langlands (see [Lan]), who
formulated some much more wide ranging, if less precise, conjectures. The
formulation in the form described here, with its emphasis on epsilon factors
2

of pairs, seems to be due to Henniart (see [He2]). Henniart’s formulation has
the advantage that there is a most one such correspondence, but as remarked
above it limits somewhat the scope of Langlands’ original desirata. The existence of recK |Irr(GL2 (K)) with the desired properties was established by Kutzko
([Ku]), following earlier partial work by a number of people. The existence of
recK |Irr(GL3 (K)) with almost all the desired properties was established by Henniart ([He1]). In particular, his correspondence had enough of these properties
to characterise it uniquely. Both the work of Kutzko and Henniart relied on
a detailed classification of all elements of Irr(GLn (K)). These methods have
since been pushed much further, but to date have not provided a construction
of recK which demonstrably has the desired properties on Irr(GLn (K)) for any
n > 3. In the case of completions of functions fields of transcendence degree 1
over finite fields, the corresponding theorem was proved by Laumon, Rapoport
and Stuhler ([LRS]).
We will let Cusp (GLn (K)) denote the subset of Irr(GLn (K)) consisting
of equivalence classes of supercuspidal representations. Let Repn (WK ) denote
the subset of WDRepn (WK ) consisting of equivalence classes of pairs (r, N )
with N = 0. Also let Irrn (WK ) denote the subset of Repn (WK ) consisting of
equivalence classes of pairs (r, 0) with r irreducible. It follows from important
work of Zelevinsky [Z] that it suffices to construct bijections
recK : Cusp (GLn (K)) −→ Irrn (WK )
with the properties listed above (see [He2].) In a key breakthrough, Henniart
[He4] showed that there did exist bijections
recK : Cusp (GLn (K)) −→ Irrn (WK ),
which preserved conductors and were compatible with twists by unramified
characters. He was however unable to show that these bijections had enough
of the other desired properties to characterise them uniquely. The usefulness
of this result is that it allows one to use counting arguments, for instance
any injection Cusp (GLn (K)) → Irrn (WK ) satisfying the desired properties
must be a bijection. (This result is usually referred to as the numerical local
Langlands theorem.)
We will give a natural construction of a map
recK : Cusp (GLn (K)) −→ Irrn (WK ),
which we will show is compatible with the association of l-adic representations to many automorphic forms on certain unitary groups. Using this global
3

compatibility and some instances of non-Galois automorphic induction discovered by one of us (M.H., see [Har2]) we will see that there is a subset
Cusp (GLn (K)) ⊂ Cusp (GLn (K)) such that
∼

recK : Cusp (GLn (K)) −→ Irrn (WK )
and such that recK |Cusp (GLn (K)) has all the desired properties. The subset
Cusp (GLn (K)) may be described as those elements of Cusp (GLn (K)) which
become unramified after some series of cyclic base changes. Appealing to
Henniart’s numerical local Langlands theorem ([He4]) we can conclude that
Cusp (GLn (K)) = Cusp (GLn (K)) and so deduce theorem A.
One of us (M.H. see [Har1]) had previously given a different construction
of a map
recK : Cusp (GLn (K)) −→ Irrn (WK ).
In some cases he was able to show its compatibility with the association of ladic representations to certain classes of automorphic forms on unitary groups.
As a result he could deduce the local Langlands conjecture only for p > n (see
[BHK] and [Har2]). A posteriori we can show that recK = recK . Since the
distribution of a preliminary version of this paper, but before the distribution
of the final version, Henniart [He6] has given a much simpler proof of theorem
A by making much cleverer use of the non-Galois automorphic induction of
[Har2] and of his own numerical local Langlands theorem [He4]. He does not
need the a priori construction of a map recK compatible with some instances of
the global correspondence, and thus he is able to by-pass all the main results in
this paper. For the reader interested only in theorem A his is clearly the better
proof. None the less we believe the results of this paper are still important as
they establish many instances of compatibility between the global and local
correspondences.
Let us now explain our construction of maps
recK : Cusp (GLn (K)) −→ Repn (WK ).
To this end choose a prime l = p and fix an isomorphism C ∼
= Qac
l . Let k
denote the residue field of K. For any g ≥ 1 there is, up to isomorphism,
a unique one-dimensional formal OK -module ΣK,g /k ac of OK -height g. Then
End OK (ΣK,g ) ⊗Z Q ∼
= DK,g , the division algebra with centre K and Hasse
invariant 1/g. Drinfeld showed that the functor which associates to any Artinian local OK -algebra A with residue field k ac the set of isomorphism classes
of deformations of ΣK,g to A is prorepresented by a complete noetherian local OK algebra RK,g with residue field k ac . (In fact he showed that RK,g is
4

a formal power series ring in g − 1 variables over the ring of integers of the
completion of the maximal unramified extension of K.) We will let ΣK,g denote the universal deformation of ΣK,g over RK,g . (In the case g = 1 one just
obtains the base change to the ring of integers of the completion of the maximal unramified extension of K of any Lubin-Tate formal OK module over K.)
Drinfeld further showed that for any integer m ≥ 0 there is a finite flat RK,g algebra RK,g,m over which ΣK,g has a universal Drinfeld level pm -structure. We
will consider the direct limit over m of the formal vanishing cycle sheaves of
i
Spf RK,g,m with coefficients in Qac
l . This gives a collection {ΨK,l,g } of infiniteac
dimensional Ql vector spaces with natural admissible actions of the subgroup
×
× WK consisting of elements (γ, δ, σ) such that
of GLg (K) × DK,g
| det δ|| det γ|−1 |Art −1
K σ| = 1.
×
For any irreducible representation ρ of DK,g
we set
i
ΨK,l,g
(ρ) = Hom O×

DK,g

i
(ρ, ΨK,l,g
).

This becomes an admissible GLg (K) × WK -module. In the case g = 1 we
have ΨiK,l,1 = (0) for i > 0, while it follows from the theory of Lubin-Tate
formal groups (see [LT]) that Ψ0K,l,1 (ρ) = Qlac with an action of K × × WK via
−1
ρ−1 × (ρ ◦ Art K
) (see section 3.4 of [Car3]).
i
To describe ΨK,l,g
(ρ) in greater generality we must recall that Deligne,
Kazhdan and Vigneras (see [DKV]) and Rogawski ([Rog2]) have given a bijec×
tion between irreducible representations of DK,g
and (quasi-)square integrable
irreducible admissible representations of GLg (K) characterised by a natural
character identity (see appendix IV). This generalises work of Jacquet and
Langlands in the case g = 2 so we will denote the correspondence ρ → JL (ρ).
Carayol essentially conjectured ([Car3]) that if JL (ρ) is supercuspidal then
∨
(1−g)/2
∼
Ψg−1
).
K,l,g (ρ) = JL (ρ) × recK (JL (ρ) ⊗ | det |

We do not quite prove this (though it may be possible by our methods to
do so). However motivated by Carayol’s conjecture our first main theorem
is the following. To state it let [ΨK,g (ρ)] denote the virtual representation
i
i
(−1)g−1 g−1
i=0 (−1) [ΨK,l,g (ρ)].
Theorem B If π is an irreducible supercuspidal representation of GLg (K)
then there is a (true) representation
rl (π) : WK → GLg (Qac
l ),
5

such that in the Grothendieck group
[ΨK,l,g (JL (π)∨ ] = [π ⊗ rl (π)].
In the case n = 1 Lubin-Tate theory allows one to identify
rl (π) = π −1 ◦ Art −1
K .
We use this theorem to define
recK : Cusp (GLg (K)) −→ Repg (WK )
by the formula
recK (π) = rl (π ∨ ⊗ (| | ◦ det)(1−g)/2 ).
It will also be convenient for us to extend rl to all irreducible admissible
representations of GLg (K) as follows. If π is an irreducible admissible representation of GLg (K), then we can find positive integers g1 , ..., gt which sum to
g and irreducible supercuspidal representations πi of GLgi (K) such that π is
a subquotient of n-Ind (π1 × ... × πt ), where we are using the usual normalised
induction (see appendix I). Then we set
t

rl (π) =
i=1

(gi −g)/2
rl (πi ) ⊗ |Art −1
.
K |

This is well defined and
recK (π) = (rl (π ∨ ⊗ (| | ◦ det)(1−g)/2 ), N ),
for some N .
Our second key result is that rl is compatible with many instances of the
global Langlands correspondence. The following theorem strengthens a theorem of Clozel [Cl1] (in which he only identifies [R(Π)|WFy ] for all but finitely
many places y, and specifically for none of the bad places).
Theorem C Suppose that L is a CM field and that Π is a cuspidal automorphic representation of GLg (AL ) satisfying the following conditions:
• Π∨ ∼
= Πc ,
• Π∞ has the same infinitesimal character as some algebraic representation
over C of the restriction of scalars from L to Q of GLg ,
6

• and for some finite place x of L the representation Πx is square integrable.
Then there is a non-zero integer a(Π) and a continuous representation R(Π)
of Gal (Lac /L) over Qac
l such that for any finite place y of L not dividing l we
have
[R(Π)|WLy ] = a(Π)[rl (Πy )].
In the case n = 2 and K = Qp and F + = Q both theorems B and C were
essentially proved by Deligne in his beautiful letter [De2]. (The argument was
completed by Brylinski [Bry].) Carayol [Car2] generalised Deligne’s method
to essentially prove both theorems B and C in the general n = 2 case. We will
simply generalise Deligne’s approach to n > 2. The combination of theorems B
and C, Henniart’s numerical local Langlands theorem [He4] and the non-Galois
automorphic induction of [Har2] suffice to prove theorem A.
Both theorems B and C follow without great difficulty from an analysis
of the bad reduction of certain Shimura varieties. We will next explain this
analysis. Unfortunately we must first establish some notation. Let E denote
an imaginary quadratic field in which p splits: p = uuc . Let F + denote a
totally real field of degree d and set F = EF + . Fix a place w of F above u.
Let B be a division algebra with centre F such that
• the opposite algebra B op is isomorphic to B ⊗E,c E;
• B is split at w;
• at any place x of F which is not split over F + , Bx is split;
• at any place x of F which is split over F + either Bx is split or Bx is a
division algebra,
• if n is even then 1 + dn/2 is congruent modulo 2 to the number of places
of F + above which B is ramified.
Let n denote [B : F ]1/2 . We can pick a positive involution of the second kind
∗ on B (i.e. ∗|F = c and tr B/Q (xx∗ ) > 0 for all nonzero x ∈ B). If β ∈ B ∗=−1
then we will let
• G denote the algebraic group with G(Q) the subgroup of elements x ∈
(B op )× so that x∗ βx = ν(x)β for some ν(x) ∈ Q× ,
• ν : G → Gm the corresponding character,
• G1 the kernel of ν,
7

• and ( , ) the pairing on B defined by
(x, y) = (tr F/Q ◦ tr B/F )(xβy ∗ ).
We can and will choose β such that
• G is quasi-split at all rational primes x which do not split in E
+
• and G1 (R) ∼
= U (n − 1, 1) × U (n)[F :Q]−1 .

If U ⊂ G(A∞ ) is an open compact subgroup we will consider the following
moduli problem. If S is a connected F -scheme and s is a closed geometric
point of S then we consider equivalence classes of quadruples (A, λ, i, η) where
• A is an abelian scheme of dimension [F + : Q]n2 ;
• λ : A → A∨ is a polarisation;
• i : B → End (A) ⊗Z Q such that λ ◦ i(b) = i(b∗ )∨ ◦ λ for all b ∈ B and
such that
tr (b|Lie(A) ) = (c ◦ tr F/E ◦ tr B/F )(nb) + tr B/F (b) − (c ◦ tr B/F )(b)
for all b ∈ B;
• η is a π1 (S, s)-invariant U -orbit of isomorphisms of B ⊗Q A∞ -modules
η : V ⊗Q A∞ → V As which take the standard pairing ( , ) on V to a
scalar multiple of the λ-Weil pairing on V As .
We consider two such quadruples equivalent if the abelian varieties are isogenous in a way that preserves the rest of the structure (but only need preserve
the polarisation up to Q× multiples). The set of equivalence classes is canonically independent of the choice of s. If U is sufficiently small this moduli
problem is represented by a smooth proper scheme of finite type XU /F .
If ξ is a representation of the algebraic group G over Qac
l then we can define
ac
ac
a lisse Ql sheaf Lξ on XU . Then we will consider the Ql -vector spaces
i
(XU × F ac , Lξ ).
H i (X, Lξ ) = lim Het
→U

This is naturally an admissible G(A∞ ) × Gal (F ac /F )-module. In fact we can
write
π ⊗ Rξi (π),
H i (X, Lξ ) =
π

8

where π runs over irreducible admissible representations of G(A∞ ) and Rξi (π)
is a finite dimensional continuous representation of Gal (Qac /Q). We will focus
on the virtual representation
[Rξ (π)] = (−1)n−1

(−1)i [Rξi (π)].
i

Kottwitz (see [Ko4]) determined tr [Rξ (π)](Frobx ) in terms of ρ for all but
finitely many places x of F . He thus completely determined the virtual representation [Rξ (π)]. We will extend Kottwitz’s description to all places x |l of
F (see corollary 11.12).
We have an isomorphism
G(Qp ) ∼
= Eu×c ×

(Bxop )×
x|u

and hence a decomposition
G(A∞ ) ∼
= G(A∞,p ) × Eu×c ×

(Bxop )× .
x|u

Thus we may decompose an irreducible admissible representation π of G(A∞ )
as
π∼
πx .
= π p ⊗ πp,0 ⊗
x|u

Phop

For h = 1, ..., n we will let
denote the parabolic subgroup of GLn (Fw )
consisting of block lower triangular matrices with an (n − h) × (n − h)-block
in the top left and an h × h block in the bottom right. It has Levi component GLn−h (Fw ) × GLh (Fw ). Let Nhop denote its unipotent radical. Suppose that ρ is an irreducible representation of DF×w ,n−h . We will let ϕJL (ρ)∨ ∈
C ∞ (GLn−h (Fw )) denote a pseudo-coefficient for JL (ρ)∨ (so that ϕJL (ρ)∨ is
compactly supported mod centre, and for any irreducible tempered admissible representation α of GLn−h (Fw ) with the same central character as JL (ρ)∨
we have tr α(ϕJL (ρ)∨ ) = vol (DF×w ,n−h /Fw× ) if α ∼
= JL (ρ)∨ and = 0 otherwise).
Then we define a homomorphism
n-red(h)
ρ : Groth (GLn (Fw )) −→ Groth (GLh (Fw ))
as a composite
Groth (GLn (Fw )) → Groth (GLn−h (Fw ) × GLh (Fw )) → Groth (GLh (Fw )),
where
9

• the first map takes the class, [π], of an irreducible admissible representation, π, to the class, [JNhop (π)], of its normalised Jacquet module (see
appendix I),
• and the second map takes the class, [α ⊗ β], to
– vol (DF×w ,n−h /Fw× )−1 tr α(ϕJL (ρ)∨ ) times [β] if the central characters
of α and JL (ρ)∨ are equal,
– and to 0 otherwise.
Our key technical result is the following theorem relating Rξ (π) and [ΨFw ,l,g ]
for 1 ≤ g ≤ n. From it both theorem B and theorem C follow without undue
difficulty. (As does corollary 11.12.)
Theorem D Suppose that π is an irreducible admissible representation of
G(A∞ ) such that πp,0 |Z×p = 1. Then
n[πw ][Rξ (π)|WFw ] = (dim[Rξ (π)])
[ΨFw ,l,n−h (ρ) ⊗

GLn (Fw )
n−1
(h)
ρ n-Ind Phop (Fw ) ((n-redρ [πw ])
h=0
−h/2
−1
((πp,0
⊗ | |p ) ◦ Art −1
Qp )|WFw ])

where ρ runs over irreducible admissible representations of DF×w ,n−h .
Almost all of this paper is devoted to proving this theorem. In the rest of
this introduction we will give a very brief sketch of the strategy. We caution
the reader that in the rest of this introduction we will not make precise mathematical statements, but rather comments that we hope will convey an idea of
our methods. We refer the reader to the body of our article for the accurate
formulation of these ideas.
i
We compute the cohomology groups Het
(XU × Fwac , Lξ ) via vanishing cycle
sheaves on the special fibre X U of XU . Thus we are led to try to compute the
cohomology groups
i
(X U × k(w)ac , Rj Ψη (Qac
Het
l ) ⊗ Lξ ),

where k(w) denotes the residue field of w. The first key idea is to introduce a
certain stratification on X U and compute stratum by stratum. Consider the
w∞ torsion points on the universal abelian variety over XU . It has an action
of Bw ∼
= Mn (Fw ). Applying the idempotent (eij ) ∈ Mn (Fw ) with e11 = 1 and
eij = 0 otherwise, we obtain a divisible OFw -module G/XU of OFw -height n and
(h)
of dimension 1. For h = 0, ..., n − 1 we will let X U denote the (h-dimensional)
locally closed reduced subscheme of X U where the maximal etale quotient of
10

(h)

(h )

G has OFw -height h. (Then the closure of X U is the union of the X U
h ≤ h.) It will suffice to compute

for

(h)

Hci (X U × k(w)ac , Rj Ψη (Qac
l ) ⊗ Lξ ).
×
w
Next we restrict to U of the form U w × Uw where OE,u
⊂ G(A∞,p ) ×
c ⊂ U
Eu×c × x|u,x=w (Bxop )× and Uw ⊂ GLn (Fw ). If Uw is the group of matrices in
GLn (OF,w ) congruent to 1 modulo wm we will write U = U w (m). To analyse
(h)
X U (m) we introduce an analogue of Igusa curves in this setting: we call them
(h)

Igusa varieties of the first kind. More precisely IU w ,m will denote the etale
(h)

cover of X U (0) which parametrises isomorphisms
∼

(OFw /wm )h → G et [wm ].
One can define this Igusa variety of the first kind not only as a variety in char(h)
acteristic p but as a formal scheme. Thus we obtain formal schemes (IU w ,m )∧ (t)
(h)
with special fibre IU w ,m over which there is a universal deformation of the formal OFw -module G 0 together with its Drinfeld level wt -structure.
(h)
(h)
One can show that X U (m) is a disjoint union of copies of IU w ,m except that
(h)

the structure map down to X U (0) is twisted by a power of Frobenius. If Ph
denotes the opposite parabolic to Phop then one can obtain an isomorphism
(h)
lim→m Hci (X U (m) × k(w)ac , Rj Ψη (Qlac ) ⊗ Lξ ) ∼
=
GLn (Fw )
ac
i (h)
j
Ind Ph
lim→m,t Hc (IU w ,m × k(w) , R Ψη (Qac
l )(I (h)
w
U

,m

)∧ (t)η

⊗ Lξ ).

Thus it will suffice to compute
(h)

Hci (IU w ,m × k(w)ac , Rj Ψη (Qlac )(I (h)w
U

∧
,m ) (t)η

⊗ Lξ ).

The next step is to understand the vanishing cycle sheaves
Rj Ψη (Qac
l )(I (h)
w
U

,m )

∧ (t)

η

.

To do so we introduce a second generalisation of Igusa varieties, which we will
(h)
(h)
call Igusa varieties of the second kind. More specifically we let JU w ,m,s /IU w ,m ×
k(w)ac denote the moduli space for isomorphisms
∼

α : ΣFw ,n−h [ws ] → G 0 [ws ],
11

which for every s > s lift etale locally to isomorphisms of the ws -division
schemes. As s varies we get a system of finite etale Galois covers and the
×
system has Galois group OD
. It is perhaps worth noting three things.
Fw ,n−h
One is that we need now the technical condition that the isomorphism must
lift locally - this is because Aut (ΣFw ,n−h ) → Aut (ΣFw ,n−h [ws ]) is not usually
surjective. Secondly we remark that if one looked at a similar construction in
the case of the ordinary locus of a modular curve one would just obtain the
familiar Igusa curves. This is because in that case there is a duality between
the connected and etale part of the analogue of G (i.e. the p-divisible group of
the universal elliptic curve). To the best of our knowledge, for n − h > 1 the
(h)
varieties JU w ,m,s do not occur in the reduction of any Shimura variety. They
seem to naturally exist only in characteristic p.
(h)
The idea is now that over the “pro-object” lim←s JU w ,m,s we have an isobecomes the constant
morphism G 0 ∼
= ΣFw ,n−h and Rj Ψη (Qac
l )(I (h)
)∧ (e
t)η
w
j

U

Ψη (Qac
l )(Spf RFw ,n−h,t )η .

Fw /Qp

,m

sheaf R
If one descends this isomorphism back down to
(h)
IU w ,s one obtains an isomorphism
lim Rj Ψη (Qlac )(I (h)w
→t

U

∧
,m ) (t)η

∼
=

ρ

F(ΨjFw ,l,n−h [ρ]),

where ρ runs over irreducible representations of DF×w ,n−h (up to unramified
(h)

twist). If Fρ is the lisse Qac
l -sheaf on IU w ,m associated to the representation ρ
(h)
(h)
of Gal (JU w ,m,∞ /IU w ,m ) then the sheaf F(ΨjFw ,l,n−h [ρ]) is closely related to
Fρ ⊗ ΨjFw ,l,n−h (ρ),
where now the rather mysterious action of
GLn−h (OF,w ) × IFw
is concentrated on the constant sheaf ΨjFw ,l,n−h (π). At least in our unskilled
hands it took some effort to make sense of the non-mathematical ideas of this
paragraph. We are very grateful to Berkovich for providing a key step in the
argument.
In this way we obtain an isomorphism
(h)
⊕(n−h) ∼
lim→m Hci (X U (m) × k(w)ac , Rj Ψ(Qac
=
l ) ⊗ Lξ )
GLn (Fw )
i (h)
ac
(lim→m Hc (IU w ,m × k(w) , Lξ ⊗ Fρ )) ⊗ ΨFj w ,l,n−h (ρ)⊕(n−h)/e[ρ]
ρ Ind Ph

for some explicit integers e[ρ]|(n − h) (see section 3). (Here we are using
unnormalised induction.) To complete the proof of theorem D it remains to
12

compute

(h)

lim Hci (IU w ,m × k(w)ac , Lξ ⊗ Fπ )
→

as a G(A∞,p ) × Eu×c × Z × GLh (Fw ) × x|u,x=w (Bxop )× -module.
At this point we return to Langlands’ idea of using the Lefschetz trace
formula to calculate the trace of the action of correspondences on Shimura
varieties in characteristic p. In our case we use Fujiwara’s “Deligne conjecture”
to compute the trace of a Hecke operator acting on
(h)

lim Hci (IU w ,m × k(w)ac , Lξ ⊗ Fπ )
→

in terms of data at fixed points. For this to be applicable there is a condition
on the Hecke operator which corresponds to it being sufficiently twisted by
Frobenius. Following Kottwitz we combine the results of Honda and Tate
with some group theory (which we need in order to understand polarisations)
(h)
to describe the points of IU w ,m × k(w)ac . We find an expression for the sum of
the terms at fixed points in terms of orbital integrals in the group
G(A∞,p ) × Eu×c × DF×w ,n−h × GLh (Fw ) ×

(Bxop )× .
x|u,x=w

Unlike Kottwitz’s work there is no distinguished Frobenius element and we
use a classification of points over k(w)ac rather than over finite extensions of
k(w). We are able to manipulate this expression so that it becomes a sum
of orbital integrals in G(A). In doing so we use again the condition that the
Hecke operator “was sufficiently twisted by Frobenius” (cf [Cas]). Next we
apply the trace formula on XU × Fuac to relate traces of Hecke operators on
(h)

i

(−1)i [lim Hci (IU w ,m × k(w)ac , Lξ ⊗ Fπ )]
→

with traces of related Hecke operators on

i

i
(−1)i [lim Het
(XU × Fwac , Lξ )].
→

From this comparison it is not hard to deduce theorem D.
We remark that we recover in this way some of Kottwitz’s results from
[Ko4]. Although we have borrowed many of Kottwitz’s ideas our argument in
the case of overlap does seem to be somewhat different. For instance we make
no appeal to the fundamental lemma for stable base change (at this point in
the argument).
13

Acknowledgements
One of us (R.T.) is very grateful to the Miller Institute at the University of
California at Berkeley for its hospitality and support during the very lengthy
revision of this paper.
We are very grateful for the help (conscious and unconscious) of many
mathematicians. We would like to thank Bultel, Clozel, Coleman,B.Conrad,
Gabber, Henniart, R.Huber, de Jong, Katz, Kazhdan, Kottwitz, Labesse, Laumon, Mazur, Rapoport and Strauch for helpful conversations. We came at this
work from different starting points. One of us (M.H.) was inspired by Boyer’s
Paris XI thesis [Bo]; he would like to thank Laumon for explaining Boyer’s
work. The other (R.T.) was inspired by teaching a class on Deligne’s letter
[De2] at Harvard; he would like to thank the students of math 253x for their
help with understanding this letter.
Our debt to the work of Kottwitz (see eg [Ko3] and [Ko4]) on the l-adic
cohomology of these same Shimura varieties will be clear to the reader. We
have borrowed many of his ideas.
Our work would have been impossible without Berkovich’s vanishing cycles
for formal schemes. We are extremely grateful to him for a number of things.
Firstly for the help he has given us in understanding his results and in writing
appendix II. Secondly because he found a proof of a key result we needed,
which he kindly wrote it up in an appendix to this paper [Berk4].
Finally we would like to acknowledge our debt to the work of Carayol,
Deligne and Drinfeld; on whose ideas the present paper is based. In particular
we owe a very great debt to Deligne: our paper is simply the natural generalisation of the arguments of his beautiful letter [De2] from modular curves to
the unitary group Shimura varieties we consider.

1

Notation

In this section we will introduce some notation which we will use throughout
this paper. The reader should also consult appendix I for some basic group
theory notation.
We will let p and l denote distinct rational primes, Z(p) ring of elements of Q
with denominator coprime to p, val p the p-adic valuation (so that val p (p) = 1
and | |p the p-adic absolute value (so that |p|p = 1/p).
If X is a scheme and x is a point of X we will let k(x) denote the residue
field at x. We will let OX,x denote the local ring of X at x and we will
∧
let OX,x
denote its completion at its maximal ideal. If Y ⊂ X is a locally
14

closed subscheme we will let XY∧ denote the completion of X along Y . For
∧
instance Xx∧ = Spf OX,x
. If X is a locally noetherian formal scheme then X
has a unique largest ideal of definition I. The formal scheme with the same
underlying topological space as X and with structure sheaf OX /I is in fact a
scheme which we will refer to as the reduced subscheme of X , and will denote
X red . (See section 10.5 of [EGAI].)
If k is a field and A/k is an abelian variety we will let T A denote the Tate
module of A, i.e.
T A = lim A[N ](k ac ),
←N

where the limit is over all positive integers N . We will also introduce the
characteristic zero version of the Tate module
V A = T A ⊗Z Q.
If S is a finite set of rational primes we will let T S A and V S A denote the
“away from S” Tate modules, i.e.
T S A = lim A[N ](k ac )
←N

where the limit is over all positive integers coprime to S, and V S A = T S A⊗Z Q.
We similarly define the “at S” Tate modules TS A and VS A.
If A and A /S are abelian schemes then by an isogeny α : A → A we shall
mean an invertible element of Hom (A, A )⊗Z Q. We will denote Hom (A, A)⊗Z
Q by End 0 (A). By a polarisation λ of A we shall mean a homomorphism
λ : A → A∨ such that for each geometric point s of S the homomorphism λs
is a polarisation in the usual sense. If p is a rational prime then by a primeto-p-isogeny we shall mean an invertible element of Hom (A, A ) ⊗Z Z(p) . By a
prime-to-p-polarisation of A we shall mean a polarisation λ : A → A∨ which
is also a prime-to-p-isogeny.
If L /L is a finite field extension we will let NL /L denote the norm from L
to L.
If R is an Fp -algebra we will let Fr : R → R denote the Frobenius morphism
which takes x ∈ R to xp ∈ R. If X/Fp is a scheme we will let Fr∗ : X → X
denote the Frobenius morphism induced by Fr on structure sheaves. If Y → X
(p)
is a morphism of schemes over Fp then we will let Y/X (or simply Y (p) , if no
confusion seems likely to arise) denote the pull back of Y by Fr∗ : X → X.
(p)
We will also let FY /X : Y → Y/X (or simply F : Y → Y (p) when no confusion
seems likely to arise) denote the relative Frobenius, i.e. the morphism that
(p)
arises from Fr : Y → Y and the universal property of the pull back Y/X . If
15

Y /X is a finite flat group scheme then we will let V : Y (p) → Y denote the dual
of F : Y ∨ → Y ∨,(p) = Y (p),∨ , where Y ∨ is the Cartier dual of Y . This definition
then extends to p-divisible groups Y /X. The morphism V : Y (p) → Y induces
a morphism of quasi-coherent sheaves of OX -modules
V∗ : (Fr∗ )∗ Lie Y ∼
= Lie Y (p) → Lie Y.
Combining this with the natural map Fr : Lie Y → (Fr∗ )∗ Lie Y we get a map,
which we will also denote V∗ , from Lie Y to itself over X, which satisfies
V∗ (xy) = xp V∗ (y)
for x a section of OX and for y a section of Lie Y .
If k/Fp is a finite extension we will let Frobk ∈ Gal (k ac /k) denote Fr−[k:Fp ] ,
i.e. it will denote a geometric Frobenius element.
We will let K denote a p-adic field, i.e. a finite extension of Qp . We will
→ Z denote its unique valuation which is normalised to send
let vK : K × →
uniformisers to 1. We will let OK denote its ring of integers, ℘K the unique
maximal ideal of OK and k(vK ) = k(℘K ) = OK /℘K its residue field. We will
often use K to denote a uniformiser in OK . We will define an absolute value
| |K = | |vK on K by
|x|K = (#k(vK ))−vK (x) ,

for x ∈ K × . We will let CvK = C℘K denote the completion of the algebraic
closure of K. We will let K nr denote the maximal unramified extension of K
and we will let K nr denote the completion of K nr .
We will let IK ⊂ Gal (K ac /K) denote the inertia subgroup, so that
∼

∼

Gal (K ac /K)/IK → Gal (K nr /K) → Gal (k(vK )ac /k(vK )).
We will let WK ⊂ Gal (K ac /K) denote the Weil group, i.e. the inverse image
in Gal (K ac /K) of FrobZk(vK ) ⊂ Gal (k(vK )ac /k(vK )). We will write FrobvK for
Frobk(vK ) , and will without comment think of it as an element of WK /IK . If
(σ)
σ ∈ WK then we define vK (σ) by σIK = FrobvvK
. We will let fK = fvK =
K
[k(vK ) : Fp ] and eK = evK = [K : Qp ]/fK . If g is a positive integer we will let
DK,g denote the division algebra with centre K and Hasse invariant 1/g. The
algebra DK,g has a unique maximal order, which we will denote ODK,g . We will
also let det denote the reduced norm from DK,g to K and ΠK,g a uniformiser
in ODK,g .
Local class field theory gives us a canonical isomorphism
∼

Art K : K × −→ WKab .
16

There is a choice of sign in the definition of Art K . We will choose a normalisation which makes uniformisers and geometric Frobenius elements correspond.
If σ ∈ WK we will define
−fK vK (σ)
|σ|K = |Art −1
.
K σ|K = p

We will let c denote the non-trivial element of Gal (C/R). We take Art C :
C → Gal (C/C) to be the trivial homomorphism and we take
×

∼

×
Art R : R× /R>0
−→ Gal (C/R)

to be the unique isomorphism. We take | |R to be the usual absolute value
and | |C to be the square of the usual absolute value, i.e. |z|C = |zz c |R .
If L is a number field we will let AL denote the adeles of L. If S is a finite
set of places of L we decompose AL = ASL × LS where ALS denotes the adeles
S
away from S and where LS = x∈S Lx . Also let AL denote
S(L )

lim →AL

,

where L runs over finite extensions of L and where S(L ) is the set of places
of L above S. The product of the normalised absolute values gives a homomorphism
| |Lx : L× \AL× −→ R×
| |=
>0 .
x

Global class field theory tells us that the product of the local Artin maps
gives an isomorphism
∼

× 0
Art L : L× \AL× /(L∞
) −→ Gal (Lac /L)ab ,
× 0
where (L∞
) denotes the connected component of the identity in L×
∞.
∼
If
→
C.
Suppose that ı : Qac
l
×
×
ψ : A×
L /L −→ C

is a continuous character, we will call ψ algebraic if we can find integers nσ for
each embedding σ : L → C such that
ψ|L⊗Q R =
σ

(σ ⊗ 1)nσ .

In this case there is a unique continuous character
×
recl,ı (ψ) = rec(ψ) : Gal (Lac /L) −→ (Qac
l )

17

such that for any finite place x |l of L we have
ı ◦ recl,ı (ψ) ◦ Art Lx = ψ|L×x .
More explicitly recl,ı (ψ) = ψ ◦ Art −1
L where
0
ac ×
ψ : L× \AL× /(L×
∞ ) −→ (Ql )

is defined by
ψ (x) = ı(ψ(x)
σ

(σ ⊗ 1)(x∞ )−nσ )

σ

((ı ◦ σ) ⊗ 1)(xl )nσ .

If M is any Gal (Lac /L)-module we will let
ker1 (L, M )
denote the subset of H 1 (L, M ) of elements that become trivial in H 1 (Lx , M )
for every place x of L.
If L is a CM field we will let c denote complex conjugation on L, i.e. the
unique automorphism of L which coincides with complex conjugation on C for
any embedding L → C.
Let ε ∈ Mn (Z) denote the idempotent


1 0 0
0
 0 0 0 ... 0 



0 
.
 0 0 0

.. 
.
.
.
.

. . 
.
0 0 0 ... 0
Thus for any ring R we have isomorphisms

• Mn (R)ε ∼
= Rn via the map sending x to its first column;
• εMn (R) ∼
= (Rn )∨ via the map sending x to its first row;
• the map Mn (R)ε ⊗R εMn (R) → Mn (R) sending xε ⊗ εy to xεy is an
isomorphism.
Suppose that L is a field of characteristic 0 and that C is a finite dimensional semi-simple L-algebra. Suppose that ∗ is an involution on C (i.e.
∗ : C → C satisfies (x + y)∗ = x∗ + y ∗ , (xy)∗ = y ∗ x∗ and ∗2 = 1) such that
18

∗|L = 1. Set L+ = L∗=1 . Suppose that W is a C-module which is finite
dimensional over L. We will call a non-degenerate L+ -alternating pairing
,
∗-Hermitian if

: W × W −→ L+
γx, y = x, γ ∗ y

for all x, y ∈ W and all γ ∈ C. We will call two such pairings , and
equivalent if we can find δ ∈ End C (W )× and µ ∈ (L+ )× such that
x, y

1

,

1

= µ δx, δy

for all x, y ∈ W . We may classify equivalence classes of non-degenerate L+ alternating ∗-Hermitian pairings W × W → L+ as follows.
Fix one such pairing , 0 (if one exists). We will denote by ∗0 the involution on End L+ (W ) such that
δx, y = x, δ ∗ y
for all x, y ∈ W and all δ ∈ End L+ (W ). Note that ∗0 |C = ∗ and that ∗0
preserves End C (W ). Define a reductive algebraic group H/L+ by setting, for
any L+ -algebra R, H(R) equal to the set of δ ∈ (End C (W ) ⊗L+ R)× such that
δδ ∗0 ∈ R× .
Note that if R is an L-algebra then
End C (W ) ⊗L+ R ∼
=
= (End C (W ) ⊗L+ L) ⊗L R ∼
End C (W ) ⊗L R ⊕ End C (W ) ⊗L,∗|L R
and ∗0 interchanges the two factors. Then H(R) consists of the set of pairs
(x, λx∗0 ), where x ∈ (End C (W ) ⊗L R)× and λ ∈ R× , i.e.
H(R) ∼
= (End C (W ) ⊗L R)× × R× .
By Hilbert 90 we see that H 1 (L, H) = (0) and so
∼

H 1 (Gal (L/L+ ), H(L)) −→ H 1 (L+ , H).
We can describe H 1 (Gal (L/L+ ), H(L)) as the set of equivalence classes of
pairs (λ, γ) ∈ L× × End C (W )× such that λ has norm 1 down to L+ and such
that
γ ∗0 = λ∗ γ.
19

We consider (λ, γ) and (λ , γ ) equivalent if there exists µ ∈ L× and δ ∈
End C (W )× such that
(λ , γ ) = (λµ/µ∗ , µ−∗ δγδ ∗0 ).
Applying Hilbert 90 to L/L+ we see that H 1 (Gal (L/L+ ), H(L)) is also in
bijection with equivalence classes of
γ ∈ End C (W )× ∩ End C (W )∗0 =1 ,
where we consider γ and γ equivalent if there exists µ ∈ (L+ )× and δ ∈
End C (W )× such that
γ = µδgammaδ ∗0 .
Any non-degenerate, L+ -alternating, ∗-Hermitian form W × W → L+ is of
the form
x, y δ = δx, δy 0
for some δ ∈ End L+ (W )× with
δ ∗0 δ ∈ End C (W )∗0 =1 .
Moreover , δ and , δ are equivalent if and only if there exists γ ∈
End C (W )× and λ ∈ (L+ )× such that
(δ )∗0 δ = λγ ∗0 (δ ∗0 δ)γ.
Note that any element γ ∈ End C (W )∗0 =1 can be written δ ∗0 δ for some
δ ∈ End L+ (W ). (If we choose an L+ -basis of W we get an isomorphism of
End L+ (W ) with M2N (L+ ) for some integer N . Moreover , is represented
by an anti-symmetric matrix J ∈ GL2N (L+ ) and if δ ∈ M2N (L+ ) then δ ∗0 =
J −1 δ t J (where t denotes the transpose). Thus if δ ∗0 = δ we see that Jδ is
antisymmetric and hence that
Jδ = (δ )t Jδ
for some δ ∈ GL2N (L+ ). Thus δ = (δ )∗0 δ .) We deduce that the correspondence which associates , δ with δδ ∗ sets up a bijection between
• equivalence classes of non-degenerate L+ -alternating ∗-Hermitian forms
on W
• and H 1 (L+ , H).
20

Suppose now that L is a number field. Suppose that two classes ψ1 , ψ2 ∈
H (L+ , H) correspond to non-degenerate L+ -alternating ∗-Hermitian forms
, 1 and , 2 . Then the same arguments show that , 1 and , 2
become equivalent over ALS + (with the same definition of equivalence as over
S
a field) if and only if ψ1 and ψ2 have the same image in H 1 (L+ , AL+ ).
We will call an L+ -bilinear pairing
1

( , ) : W × W −→ L
∗-symmetric if ( , ) is L-linear in the first variable and satisfies
(y, x) = (x, y)∗
for all x, y ∈ W . We will call this pairing non-degenerate if (x, y) = 0 for all
y ∈ W implies that x = 0. We will call it 8-Hermitian if
(γx, y) = (x, γ ∗ y)
for all x, y ∈ W and all γ ∈ C. We call two ∗-Hermitian ∗-symmetric pairings
( , )1 and ( , )2 equivalent if there exists δ ∈ End C (W ) and λ ∈ (L+ )× such
that
(x, y)2 = λ(γx, γy)
for all x, y ∈ W .
√ 2
√
Suppose that L = L+ ( a) where a = a ∈ L+ . Then there is a bijection between equivalence classes of non-degenerate, ∗-Hermitian, ∗-symmetric
pairings W × W → L and equivalence classes of non-degenerate, ∗-Hermitian,
L+ -alternating pairings W × W → L+ given as follows. If , is a nondegenerate, ∗-Hermitian, L+ -alternating pairing W × W → L+ then associate
to the equivalence class of , the equivalence class of the non-degenerate,
∗-Hermitian, ∗-symmetric pairing given by
√
√
ax, y + a x, y .
(x, y) =
conversely if ( , ) is a non-degenerate, ∗-Hermitian, ∗-symmetric pairing W ×
W → L+ then associate to the equivalence class of ( , ) the equivalence class
of the non-degenerate, ∗-Hermitian, L+ -alternating pairing given by
√
x, y = tr L/L+ a(x, y).
√
This bijection is independent of the choice of a ∈ L.
21

Suppose that L = C, L+ = R, C = CI , ∗ = cI and W = (Cn )I . Then any
non-degenerate ∗-Hermitian, ∗-symmetric pairing W × W → C is of the form
(xi )i∈I × (yi )i∈I −→

xti Ji yi ,
i∈I

where Ji is the diagonal n×n-matrix with 1 on the diagonal ai times and −1 on
the diagonal bi = n−ai times. This establishes a bijection between equivalence
classes of non-degenerate, ∗-Hermitian, ∗-symmetric pairings W timesW → C
and equivalence classes of I-tuples ((ai , bi ))i∈I of pairs of non-negative integers
(ai , bi ) with ai + bi = n for all i ∈ I. We call the I-tuples ((ai , bi ))i∈I and
((bi , ai ))i∈I equivalent, but consider no other pairs of I-tuples equivalent. We
deduce that equivalence classes of non-degenerate, ∗-Hermitian, R-alternating
pairings W × W → R are also parametrised by such equivalence classes of
I-tuples.
Now suppose that L = C, L+ = R, C = Mn (C)I , (γi )∗ = (γic,t ) and W =
C. Then equivalence classes of non-degenerate, ∗-Hermitian, R-alternating
pairings W × W → R are still parametrised by equivalence classes of I-tuples
((ai , bi ))i∈I of pairs of non-negative integers (ai , bi ) with ai + bi = n for all
i ∈ I. again we call the I-tuples ((ai , bi ))i∈I and ((bi , ai ))i∈I equivalent, but
consider no other pairs of I-tuples equivalent. To see this one can note that
to give a non-degenerate, ∗-Hermitian, R-alternating form W × W → R is
the same as giving a non-degenerate, ∗-Hermitian for CI , R-alternating form
εW × εW → R. The equivalence sends , to the I-tuple parametrising
,

|εW ×εW .

Now suppose that L is an imaginary quadratic field, that M is a totally
real field, that C is a central simple LM -algebra with dimLM C = n2 , that ∗
is an involution of the second kind on C (i.e. ∗|LM = c), that ∗ is positive (i.e.
tr LM/Q tr C/LM (γγ ∗ ) > 0 for all non-zero γ ∈ C) and that W = C. Then the
5-tuple (L∞ , L+
∞ , C∞ , ∗, W∞ ) is isomorphic to the 5-tuple
(C, R, Mn (C)Hom (M,R) , (γτ ) → (γτc,t ), Mn (C)Hom (M,R) ).
In particular we see that equivalence classes of non-degenerate, ∗-Hermitian,
R-alternating pairings W∞ × W∞ → R are parametrised by equivalence classes
of Hom (M, R)-tuples as above.
We will let E denote an imaginary quadratic field in which p splits. We
will let c denote complex conjugation in Gal (E/Q). We will choose a prime u
of E above p. We will also let F + /Q denote a totally real field of degree d. We
22

will set F = E.F + so that F is a CM-field with maximal totally real subfield
F + . Let w = w1 , w2 , ..., wr denote the places of F above u and let v = v1 , ..., vr
denote their restrictions to F + . We will denote [k(wi ) : Fp ] by fi . We will let
B/F denote a division algebra of dimension n2 such that
• F is the centre of B;
• the opposite algebra B op is isomorphic to B ⊗E,c E;
• B is split at w;
• at any place x of F which is not split over F + , Bx is split;
• at any place x of F which is split over F + either Bx is split or Bx is a
division algebra,
• if n is even then 1 + dn/2 is congruent modulo 2 to the number of places
of F + above which B is ramified.
We will let tr B/F denote the reduced trace and detB/F the reduced norm
for B/F . When no confusion seems likely to arise we may drop the subscripts.
Define n ∈ Z>0 by [B : F ] = n2 .
We may pick an involution of the second kind ∗ on B. (That we may
chose such an involution follows from the second and fourth of the above
assumptions on B. More precisely lemma 8.1 of [Sc] defines homomorphism
Br (F )op=c → (F + )× /N (F × ) and shows that B has an involution of the second
kind if and only if [B] is in the kernel of this homomorphism. But [B] is in
the kernel if and only if [Bx ] is in the kernel for all places x of F which are
non split over F + .) We may and will further assume that ∗ is positive, i.e.
for all nonzero x ∈ B we have (tr F/Q ◦ tr B/F )(xx∗ ) > 0. (To see that we may
suppose that ∗ is positive one may argue as follows. The involutions of the
second kind on B are exactly the maps of the form
x −→ bx∗ b−1 ,

where b ∈ B × and b∗ b−1 ∈ F . By Hilbert’s theorem 90 we may alter any such
b by an element of F × so that b∗ = b. Thus we may suppose that b∗ = b. By
lemma 2.8 of [Ko3] the set of invertible b ∈ (B ∗=1 ⊗Q R) such that x → bx∗ b−1
is positive is a non-empty open set. Thus we can find an invertible b ∈ B ∗=1
such that x → bx∗ b−1 is positive.)
We will let V denote the B ⊗F B op module B. We will be interested in
alternating pairings V × V → Q which are ∗-Hermitian for the action of B on
V . Any such pairing is of the form
(x1 , x2 )β = (tr F/Q ◦ tr B/F )(x1 βx∗2 ),
23

for some β ∈ B ∗=−1 . Define an involution of the second kind #β on B by
x#β = βx∗ β −1 . Then we have that
#

((b1 ⊗ b2 )x1 , x2 ) = (x1 , (b∗1 ⊗ b2 β )x2 )
for all x1 , x2 ∈ V , b1 ∈ B and b2 ∈ B op . Also let Gβ /Q be the algebraic group
whose R-points (for any Q-algebra R) are the set of pairs
(λ, g) ∈ R× × (B op ⊗Q R)×
such that
gg #β = λ.
This comes with a homomorphism ν : Gβ → Gm which sends (λ, g) to λ. We
will let Gβ,1 denote the kernel of ν. Note that the structure map Gβ,1 → Spec Q
factors through Spec F + so we may also consider Gβ,1 as an algebraic group
over F + .
Choose a distinguished embedding τ0 : F → C.
Lemma 1.1 We can choose an element 0 = β ∈ B ∗=−1 such that

1. if x is a rational prime which is not split in E then Gβ is quasisplit at
x,
2. and if τ : F + → R then Gβ,1 ×F + ,τ R is isomorphic to U (1, n − 1) if
τ = τ0 and U (n) otherwise.
Proof: Choose 0 = β0 ∈ B ∗=−1 and suppose that if x is an infinite place of F +
then Gβ0 ,1 (Fx+ ) ∼
= U (p0,x , q0,x ). We will look for an element α ∈ B, such that
the element β = αβ0 satisfies the conditions of the lemma. Firstly we require
that
α#β0 = α.
Thus α defines a class in H 1 (F/F + , P Gβ0 ,1 ), where P Gβ0 ,1 is the adjoint group
of Gβ0 ,1 . Every class in H 1 (F/F + , P Gβ0 ,1 ) arises in this way. (By definition
such a class is represented by α ∈ (B op )× such that αα−#β0 = λ ∈ F × . Then
λ has norm 1 in F + and so by Hilbert’s theorem 90 can be written as µc /µ.
Then µα represents the same class as α and µα = (µα)#β0 .) Moreover Gαβ0 ,1
is the inner form of Gβ0 ,1 classified by
[α] ∈ H 1 (F + , P Gβ0 ,1 ).
If x is a place of F + which splits in F and if y is a place of F above x then
we have natural maps
H 1 (Fx+ , P Gβ0 ,1 ) ∼
= H 1 (Fy , P Gβ0 ,1 ) ∼
= Z/nZ.
= H 2 (Fy , µn ) ∼
24

If x is a finite place of F + which does not split in F then according to section
2 of [Cl1] we have
H 1 (Fx+ , P Gβ0 ,1 ) ∼
= Z/2Z.
Moreover if x is an infinite place then H 1 (Fx+ , P Gβ0 ,1 ) is in bijection with the
set of unordered pairs of non-negative integers {px , qx } with px + qx = n. In
both these cases the map
H 1 (Fx+ , P Gβ0 ,1 ) −→ H 1 (Fx , P Gβ0 ,1 )
is trivial. Clozel also shows (lemma 2.1 of [Cl1]) that if n is odd then the map
H 1 (F + , P Gβ0 ,1 ) −→

H 1 (Fx+ , P Gβ0 ,1 )
x

is surjective. If on the other hand n is even he shows there is a map
x

H 1 (Fx+ , P Gβ0 ,1 ) −→ Z/2Z

whose kernel coincides with the image of H 1 (F + , P Gβ0 ,1 ). Clozel describes
this map as the sum of the natural maps
→ Z/2Z
H 1 (Fx+ , P Gβ0 ,1 ) →
if x is finite; and the map
H 1 (Fx+ , P Gβ0 ,1 ) →
→ Z/2Z
which sends {px , qx } to px,0 − px mod 2, if x is infinite. (See section 2 of [Cl1],
particularly lemma 2.2.)
Suppose that B is ramified above s places of F + which split in F . If x is
a place of F + which does not split in F let ux ∈ H 1 (Fx+ , P Gβ0 ,1 ) denote the
class of the quasi-split inner form of P Gβ0 ,1 over Fx+ . If n is even then we see
that
s + nd/2 +
px,0 +
ux ≡ 0 mod 2.
x|∞
x |∞

Let A = Z/Z if n is odd and A = Z/2Z if n is even. Also suppose that B
is ramified above s places of F + which split in F . Then we see that we get
maps
H 1 (Fx+ , P Gβ0 ,1 ) −→ A,
H 1 (F/F + , P Gβ0 ,1 ) −→
x

+

where x runs over places of F which do not split in F , where the second
map is as described above and where the sequence is exact in the middle. The
lemma requires us to find a class in H 1 (F/F + , P Gβ0 ,1 ) which maps to
25

• ux if x is a finite place of F + which does not split in F ,
• {1, n − 1} if x is an infinite place corresponding to τ0 : F + → R,
• and {0, n} if x is any other infinite place of F + .
If n is odd this will be possible. If n is even this is possible if
1+

ux +
x |∞

x|∞

px,0 ≡ 0 mod 2,

i.e. if
1 ≡ s + nd/2 mod 2.
The lemma follows. ✷
Now fix β as in the lemma. We will drop the subscript β from #, G and
G1 . Note that the corresponding alternating form on V ,
(x1 , x2 ) = (tr F/Q ◦ tr B/F )(x1 βx∗2 ),
has parameters (n, 0) at any embedding τ = τ0 and (n − 1, 1) at τ0 .
If R is an E-algebra then G(R) can be identified with the set of pairs
(g1 , g2 ) ∈ (B op ⊗E R) × (B op ⊗E,c R)
such that
Thus we have
where

(g1 g2# , g2 g1# ) ∈ R× .
G(R) ∼
= (B op ⊗E R)× × R×
(g1 , g2 ) −→ (g1 , g1 g2# )

and inversely
(g, ν) −→ (g, νg −# ).
In particular we get an isomorphism
E
∼
RSE
Q (G ×Q E) = RSQ (Gm ) × HB op ,

where RS denotes Weil’s restriction of scalars and where HB op /Q is the algebraic group defined by
HB op (R) = (B op ⊗Q R)× .
26

Suppose that x is a place of Q which splits as x = yy c in E. Then the
∼
choice of a place y|x allows us to consider Qx → Ey as an E-algebra and hence
to identify
G(Qx ) ∼
= (Byop )× × Qx× .
In particular, we get an isomorphism
r
∼

G(Qp ) →

Q×
p

×

(Bwopi )× ,
i=1

which sends g to (ν(g), g1 , ..., gr ). We will often let
r

(g0 , g1 , ..., gr ) ∈ Q×
p ×

(Bwopi )×
i=1

denote a typical element of G(Qp ). Similarly we will decompose a typical
element g ∈ G(A) as (gx )x=p × (gp,0 , gw1 , ..., gwr ) with gx ∈ G(Qx ), gp,0 ∈ Q×
p
and gwi ∈ Bw×i ; or as g p × gp,0 × gw × gpw , where g p = (gx )x=p , gw = gw1 and
gpw = (gw2 , ..., gwr ). We will let G(Aw ) denote the subgroup of G(A) consisting
of elements with gp,0 = 1 and gw = 1. Similarly if π is an irreducible admissible
representation of G(A) over an algebraically closed field of characteristic 0 we
may decompose it π ∼
= π p ⊗πp ∼
= π p ⊗πp,0 ⊗πp,1 ⊗...⊗πp,r ∼
= π p ⊗πp,0 ⊗πw ⊗πpw ∼
=
w
π ⊗ πp,0 ⊗ πw . Note that πp,0 = ψπ |E ×c .
u
Fix a maximal order Λi = OBwi in Bwi for each i = 1, ..., r. Our pairing
( , ) gives a perfect duality between Vwi and Vwic . Let Λ∨i ⊂ Vwic denote the
dual of Λi ⊂ Vwi . Then if
r

Λ=
i=1

r

Λi ⊕

i=1

Λ∨i ⊂ V ⊗Q Qp ,

we see that Λ is a Zp -lattice in V ⊗Q Qp and that the pairing ( , ) on V
restricts to give a perfect pairing Λ × Λ → Zp .
∗
= OB and
There is a unique maximal Z(p) -order OB ⊂ B such that OB
OB,wi = OBwi for i = 1, ..., r. Then OB,p equals the set of elements of Bp
which carry Λ into itself. On the other hand the stabiliser of Λ in G(Qp ) is
r
×
Z×
p ×
i=1 OBwi .
Fix an isomorphism OBw ∼
= Mn (OF,w ). Composing this with the transpose
op ∼
map t we also get an isomorphism OB
= Mn (OF,w ). Moreover we get an
w
isomorphism
n
)∨ .
εΛ1 ∼
= (OF,w
27

op
The action of g ∈ Mn (OF,w ) ∼
= (OBw ) on this module is via right multiplication
by g t . We will write Λ11 as an abbreviation for εΛ1 . We get an identification
r
n
n
⊗ Λ11 )∨ ) ⊕
Λ∼
⊗ Λ11 ) ⊕ (OF,w
= ((OF,w

i=2

(Λi ⊕ Λ∨i ).

Under this identification (g0 , g1 , ..., gr ) ∈ G(Qp ) acts as
r

((1 ⊗ g1 ) ⊕ g0 (1 ⊗
Fix a square root

g1−1 )∨ )

⊕

i=2

(gi ⊕ g0 (gi−1 )∨ ).

1/2

×
| |K : (K × −→ Qac
l )

fK
of | |K : K × → Q×
in Qlac . If fK is even we
l , i.e. fix a square root of p
fK /2
∼
assume that this square root is chosen to be p
. Also choose ı : Qac
l = C,
×
such that ı ◦ | |1/2 is valued in R>0
. We apologise for making such an ugly
choice. The reader will see that all our main results are independent of the
choice of ı, but it would require a lot of extra notation to make the proofs free
of such a choice. Some of our main results do involve the choice of | |1/2 , but
in each case this choice is involved in more than one place and all that matters
is that the same choice is made at each place.
We will let ξ denote an irreducible representation of the algebraic group G
on a finite dimensional Qac
l vector space Wξ .

2

Barsotti-Tate groups

For the definition of a Barsotti-Tate group over a scheme S we refer the reader
to section 2 of chapter I of [Me]. Suppose that S is a OK scheme, then by
a Barsotti-Tate OK -module H/S we shall mean a Barsotti-Tate group H/S
together with an embedding OK → End (H) (ring morphisms are assumed
to send the multiplicative identity to itself) such that the induced action of
OK on Lie H coincides with the action coming from the structural morphism
H → S → Spec OK . We call a Barsotti-Tate OK -module H ind-etale if
the underlying Barsotti-Tate group is ind-etale (see example 3.7 of chapter
I of [Me]). There is an equivalence of categories between ind-etale BarsottiTate OK -modules and finite, torsion free lisse etale OK -sheaves on S (see
example 3.7 of chapter I of [Me]). If S is connected we define the height of a
Barsotti-Tate OK -module H to be the unique integer h(H) such that H[℘nK ]
h(H)
has rank qK for all n ≥ 1. The usual height of H as a Barsotti-Tate group is
28

h(H)[K : Qp ]. In general we will let H ∨ denote the unique Barsotti-Tate OK module such that H ∨ [pr ] is the Cartier dual of H[pr ] for all p and such that the
ps−r

inclusions H ∨ [pr ] → H ∨ [ps ] for s ≥ r are the Cartier duals of H[ps ] −→ H[pr ].
We will refer to H ∨ as the Cartier dual of H.
Now suppose that p is locally nilpotent on S. We will call a BarsottiTate OK -module H formal if the p-torsion H[p] in H is radicial. There is an
equivalence of categories between the category of formal Barsotti-Tate OK module and the category of formal Lie groups Θ/S together with a morphism
OK → End (Θ) such that
• Θ[p] is finite and locally free;
• p : Θ → Θ is an epimorphism;
• the induced action of OK on Lie Θ coincides with the action coming from
the structural morphism Θ → S → Spec OK .
(This follows from corollary 4.5 of chapter II of [Me].)
Let X be a locally noetherian formal scheme with ideal of definition I.
We will let Xn denote the scheme with underlying topological space X and
structure sheaf OX /I n . By a Barsotti-Tate OK -module H over the locally
noetherian formal scheme X we shall mean a system of Barsotti-Tate OK modules Hn over the schemes Xn together with compatible isomorphisms
Hn ×Xn Xm ∼
= Xm
whenever m ≤ n. This definition is easily checked to be canonically independent of the choice of ideal of definition I. We will call H ind-etale (resp.
formal) if each Hn is ind-etale (resp. formal). Note that in fact H is indetale (resp. formal) if and only if H1 is ind-etale (resp. formal, see paragraph
3.2 of chapter II of [Me]). If A is a noetherian ring complete with respect
to the I-adic topology for some ideal I, then there is a natural functor from
Barsotti-Tate OK -modules H/Spec A to Barsotti-Tate OK -modules H/Spf A.
It follows from lemma 4.16 of chapter II of [Me] that if I contains some power
of p then this is in fact an equivalence of categories which preserves exact
sequences. We remark that H/Spf A may be formal while the corresponding
Barsotti-Tate OK -module H/Spec A is not.
Lemma 2.1 Suppose that p is locally nilpotent on a locally noetherian scheme
S and that H/S is a Barsotti-Tate OK -module. Then for h ∈ Z≥0 we can find
reduced closed subschemes S [h] ⊂ S such that
29

1. S [h] ⊃ S [h−1] ;
2. the codimension of any component of S [h−1] in any component of S [h]
which contains it is at most 1;
3. for any geometric point s of S we have that s lies in S [h] if and only if
#H[p](k(s)) ≤ p[K:Qp ]h ;
4. on S (h) = S [h] − S [h−1] there is a short exact sequence of Barsotti-Tate
OK -module
(0) −→ H 0 −→ H −→ H et −→ (0)
where H 0 is a formal Barsotti-Tate OK -module and where H et is an
ind-etale Barsotti-Tate OK -module of height h.

Proof: By proposition 4.9 of [Me] it suffices to show that for g ∈ Z≥0 we
can find closed subschemes Sg ⊂ S such that
1. Sg ⊃ Sg−1 ;
2. if s is a geometric point of S then s lies in Sg if and only if #H[p](k(s)) ≤
pg ;
3. the codimension of any component of Sg−1 in any component of Sg which
contains it is at most 1.
The question is local on S so we may assume that S = Spec R for a
noetherian ring R. We may further assume that S is reduced. By a simple
inductive argument it suffices in fact to show that if for any geometric point s
of S we have #H[p](k(s)) ≤ pg then we can find a reduced closed subscheme
S ⊂ S such that
1. a geometric point s of S lies in S if and only if #h[p](k(s)) < pg ;
2. any irreducible component of S has codimension at most one in any
irreducible component of S containing it.
Finally we may assume that S is in fact integral.
We now follow the arguments of page 97 of [O]. Let H/S denote the locally
free sheaf Lie (H[p]∨ ) = Lie H ∨ (the equality here follows from remark 3.3.20
of chapter II of [Me] because p = 0 on S). For any geometric point s of S there
is a canonical perfect pairing between HsV∗ =1 and Hs [p](k(s)). (This seems to
be well known, but we know of no reference for the statement in exactly this
form, so we will sketch the proof. On page 138 of [Mu1] we see that we can
30

identify Hs with Hom (Hs [p], Ga ) and that V∗ then becomes identified with the
map φ → φ ◦ Fr∗ . We get a pairing
Hs [p](k(s)) × Hs −→ k(s)
× φ −→ φ ◦ x,
x

where φ ∈ Hom (Hs [p], Ga ) and φ ◦ x ∈ Ga (k(s)) = k(s). We see that it
restricts to a pairing
Hs [p](k(s)) × HsV∗ =1 −→ Fp .

If φ ◦ x = 0 for all x ∈ Hs [p](k(s)) then φ factors through the local ring of Ga
at 0. If moreover φ ◦ Fr∗ = φ then we see that φ = 0. Thus our pairing gives
an injection
HsV∗ =1 → Hom (Hs [p](k(s)), Fp ).

To show this is in fact an isomorphism one can count orders. Suppose that
#Hs [p](k(s)) = ph . Then we have an embedding µhp → Hs [p]∨ and so an
embedding Lie µhp → Hs . But (Lie µp )V∗ =1 has order p (as follows easily from
the results on page 143 of [Mu1]), and so
#HsV∗ =1 ≥ ph = #Hs [p](k(s)).
The perfection of our pairing follows at once.)
Again shrinking S we may assume that in fact H is free. Choose a basis
e1 , ..., em and suppose that V∗ ei = j vi,j ej . Then
V∗

xpi vi,j ej .

xi ei =
i,j

i

Let HV∗ =1 denote the subscheme of Aff m
R defined by the equations
vi xpi

xj =
i,j

for j = 1, ..., m. Then HV∗ =1 /S is quasi-finite and etale (as the Jacobian is
the identity matrix). Generically HV∗ =1 /S has degree ≤ pg . We may suppose
that in fact generically the degree equals pg . The locus where the degree
drops is closed (as the degree is locally constant). We must show that it
has codimension 1. Let T denote the normalisation of S in a finite separable
extension of the fraction field of R over which HV∗ =1 has pg points. As T /S is
finite, it suffices to prove the result for T . Let x1 , ..., xpg denote the sections of
HV∗ =1 over the generic point of T . Then T is simply the locus where some xi
is not regular. But the locus where any given xi is not regular has codimension
1 because T is normal. ✷
31

Corollary 2.2 Suppose that H/X is a Barsotti-Tate OK -module over a locally noetherian formal scheme. Suppose also that p = 0 on X red and that the
function from geometric points of X red to integers
s → #H[p](k(s))
is constant. Then there is an exact sequence of Barsotti-Tate OK -modules
(0) −→ H0 −→ H −→ Het −→ (0)
over X with H0 formal and Het ind-etale.
For any g ≥ 1 there is a unique 1-dimensional formal Barsotti-Tate OK module ΣK,g over k(vK )ac of height g. In fact if k is any separably closed field
containing k(vK ) then any one-dimensional Barsotti-Tate OK -module over k
is of the form ΣK,g × (K/OK )h for some g and h. (If H/k(vK )ac is a onedimensional Barsotti-Tate OK -module over k we have an exact sequence
(0) −→ H 0 −→ H −→ H et −→ (0),
where H 0 is formal and H et is ind-etale. By proposition 1.7 of [Dr] we see
that H 0 ∼
= ΣK,g . It only remains to find a splitting H et → H, but this is
the same as finding a splitting H et (k) → H(k). Finally note that H(k) →
H et (k) is an isomorphism.) Moreover End (ΣK,g /k) = End (ΣK,g /k(vK )ac ) ∼
=
×
ODK,g (proposition 1.7 of [Dr]). We can extend the (left)-action of OD
on
K,g
×
×
on ΣK,g /k(vK ), such that for δ ∈ DK,g
ΣK,g /k(vK )ac to an action of DK,g
δ

−→

ΣK,g
↓
Spec k(vK )ac

(Frob∗v )vK (det δ)
K
−→

ΣK,g
↓
Spec k(vK )ac

commutes. To see this one need only consider the case vK (det δ) ≥ 0: for
vK (det δ) < 0 we define the action of δ to be the inverse of the action of δ −1 .
If vK (det δ) ≥ 0 then the kernel of δ ∈ End (ΣK,g ) is the same as the kernel of
(fK vK (det δ))
(fK vK (det δ))
→ ΣK,g .
F fK vK (det δ) : ΣK,g → ΣK,g
. Thus δ induces a map ΣK,g
We define our semi-linear action of δ as the top row of the following diagram
ΣK,g
↓
Spec k(vK )ac

−→
(Frob∗v )vK (det δ)
K
−→

(pfK vK (det δ) )

ΣK,g

↓
Spec k(vK )ac
32

−→

δ

ΣK,g
↓

=

Spec k(vK )ac

where the left hand square is a pullback.
Consider the functor from Artinian local OK -algebras with residue field
k(vK )ac to sets which sends A to the set of isomorphism classes of pairs (H, j)
∼
where H/Spec A is a Barsotti-Tate OK -module and j : ΣK,g → H ×A k(℘K )ac .
This functor is pro-represented by a complete noetherian local ring RK,g with
residue field k(℘K )ac and in fact RK,g ∼
= OK nr [[T2 , ..., Tg ]] (proposition 4.2 of
[Dr]). The universal deformation exists over Spec RK,g (not just over Spf RK,g ,
see lemma 4.16 of chapter II of [Me]). We will denote this universal deformation
×
.
by (ΣK,g , j)/Spec RK,g . Note that RK,g has a continuous left action of OD
g

(If δ ∈ ODK,g then the push forward of (ΣK,g , j) along δ : RK,g → RK,g is
(ΣK,g , j ◦ δ).) We will let RK,g denote RK,g ×W (k(℘K )) k(℘K )ac .
Set H0 = Σk,g × (K/OK )h a Barsotti-Tate OK -module over k(vK )ac . Let
h
T H0 denote its Tate module, i.e. T H0 = Hom OK (K/OK , H0 (k(vK )ac )) ∼
.
= OK
Now consider the functor from Artinian local OK -algebras with residue field
k(vK )ac to sets which sends A to the set of isomorphism classes of pairs (H, j)
∼
where H/Spec A is a Barsotti-Tate OK -module and j : H0 → H ×A k(℘K )ac .
This functor is again pro-represented, this time by Hom (T H0 , ΣK,g ). By
Hom (T H0 , ΣK,g ) we mean the RK,g -formal scheme such that for any Artinian
local RK,g algebra S we have
Hom (T H0 , ΣK,g )(S) = Hom OK (T H0 , ΣK,g (S)).
Noncanonically we have Hom (T H0 , ΣK,g ) ∼
= ΣhK,g , where the fibre product is
taken over Spf RK,g . We also have, again noncanonically, Hom (T H0 , ΣK,g ) ∼
=
Spf OK nr [[T2 , ..., Tg+h ]]. The universal deformation of H0 over Hom (T H0 , ΣK,g )
is then the extension of ΣK,g by (K/OK )h classified by the tautological class
in
Hom (T H0 , ΣK,g )(S) = Hom (T H0 , ΣK,g (S)) ∼
=
∼
Ext (T H0 ⊗OK (K/OK ), ΣK,g (S)) = Ext S (T H0 ⊗OK (K/OK ), ΣK,g ),
where S = Hom (T H0 , ΣK,g ). (See proposition 4.5 of [Dr] and its proof.)
Lemma 2.3 Suppose that S/k(vK )ac is reduced of finite type. Suppose also
that H/S is a one-dimensional Barsotti-Tate OK -module. Suppose moreover
that over S there is an exact sequence of Barsotti-Tate OK -modules
(0) −→ H 0 −→ H −→ H et −→ (0),
where H et has constant height h and H 0 has constant height g. Let s be a
∼
closed point of S and choose an isomorphism j : ΣK,g → Hs0 .
33

1. Then we get a morphism Ss∧ → Spf RK,g which in fact factors through
k(vK )ac .
2. We also get a morphism Ss∧ → Hom (T Hs , ΣK,g ) which in fact factors
through Hom (T Hs , ΣK,g ) ⊂ Hom (T Hs , ΣK,g ).
Proof: The statements are easily seen to be equivalent. We will prove the
∧
first one. Write RK,g = OK nr [[T2 , ..., Tg ]], let P be a minimal prime of OS,s
∧
and let k denote the field of fractions of the image RK,g → OS,s /P . As S is
reduced, it suffices to show that T2 , ..., Tg map to 0 in k. Suppose not.
For the rest of this proof we will use without comment the notation of [Dr].
We can arrange that ΣK,g corresponds to a morphism ΛOK = OK [g1 , g2 , ...] →
RK,g which
• sends gpfK i −1 to Ti+1 for 1 ≤ i ≤ g − 1;
• and sends gj to zero for 1 ≤ j < pfK g − 1 and j = pfK i − 1 for some i in
the above range.
(See the proof of proposition 4.2 of [Dr].) Choose i minimal such that Ti does
not map to zero in k. Then H 0 ×S k corresponds to a morphism ΛOK → k which
sends gj to 0 for j = 1, 2, ..., pfK (i−1) − 2 and sends gpfK (i−1) −1 to something
nonzero. Thus H 0 ×S k has height i − 1 < g (see the proof of proposition 1.6
of [Dr]). This contradicts the fact that H ×S Spec k is a formal Barsotti-Tate
OK -module of height g (because H/S is a formal Barsotti-Tate OK -module
of height g). ✷
Corollary 2.4 Suppose that S/k(vK )ac is a smooth scheme of finite type. Suppose that H/S is a one-dimensional Barsotti-Tate OK -module of constant
height g. Suppose moreover that for each closed point s of S the formal
completion Ss∧ is isomorphic to the equidimensional universal formal deformation space of Hs . Then for h = 0, ..., g − 1 the locally closed subscheme
S (h) = S [h] − S [h−1] of S is either empty or smooth of dimension h. If s is
∼
a closed point of S (h) and if j : ΣK,g−h → Hs0 then we get an identification
Ss∧ ∼
= Hom (T Hs , ΣK,g−h )×OK k(vK ) and under this identification (S (h) )∧s ⊂ Ss∧
corresponds to Hom (T Hs , ΣK,g−h ) ⊂ Hom (T Hs , ΣK,g−h ) ×OK k(vK ).
Proof: Because the formal completion of S at any closed point is isomorphic to k(vK )ac [[T2 , ..., Tg ]], every component of S has dimension g − 1. We
must have S = S [g−1] . Hence by lemma 2.1 every irreducible component of S [h]
has dimension at least h. Thus the same is true for S (h) . On the other hand
34

by the previous lemma if s is any closed point of S (h) then the formal completion (S (h) )∧s corresponds to a sub-formal scheme of Hom (T Hs , ΣK,g−h ) ⊂
Hom (T Hs , ΣK,g−h ). Thus we must have (S (h) )∧s ∼
= Hom (T Hs , ΣK,g−h ) and,
assuming such a closed point exists, we have that S (h) is smooth at s of dimension h. ✷
The functor on schemes S/k(vK )ac which sends S to Aut (ΣK,g [℘m
K ]/S) is
m
ac
represented by a scheme Aut (ΣK,g [℘K ]) of finite type over k(vK ) . (To see this
simply think of these automorphisms as maps on sheaves of Hopf algebras.) If
m1 > m2 there is a natural morphism
m2
1
Aut (ΣK,g [℘m
K ]) −→ Aut (ΣK,g [℘K ]).

We will let Aut 1 (ΣK,g [℘m
K ]) denote the intersection of the scheme theoretic
m
images of Aut (ΣK,g [℘K ]) in Aut (ΣK,g [℘m
K ]) as m varies over integers greater
than or equal to m.
Lemma 2.5 Aut 1 (ΣK,g [℘m
K ]) is zero dimensional and
×
red ∼
Aut 1 (ΣK,g [℘m
= (ODK,g /℘m
K ])
K ODK,g ) .

Proof: From the definitions we see that the scheme theoretic image of the
morphism
1
m
Aut 1 (ΣK,g [℘m+1
K ]) −→ Aut (ΣK,g [℘K ])

1
m
is just Aut 1 (ΣK,g [℘m
K ]). Suppose first that Aut (ΣK,g [℘K ]) has an irreducible
component Vm of dimension > 0. Then we can find irreducible components
Vm of Aut 1 (ΣK,g [℘m
K ]) for m > m such that whenever m ≥ m ≥ m then
Vm maps to Vm and is dominating. Let k(Vm ) denote the function field of
Vmred , so that whenever m ≥ m ≥ m we have k(Vm ) → k(Vm ). Let k be
algebraically closed extension field of k(vK )ac of uncountable transcendence
degree. Then there are uncountably many maps k(Vm ) → k and each can
be extended into a compatible series of injections k(Vm ) → k for m > m.
Thus Aut 1 (ΣK,g [℘m
K ])(k) has uncountably many points which can be lifted
compatibly to each Aut 1 (ΣK,g [℘m
K ])(k) with m > m. This implies that the
image of
Aut (ΣK,g /k) −→ Aut (ΣK,g [℘m
K ]/k)

is uncountably infinite. On the other hand it follows from proposition 1.7 of
×
[Dr] that this image is just (ODK,g /℘m
K ODK,g ) , which is finite. This contra1
m
diction shows that Aut (ΣK,g [℘K ]) is zero dimensional.

35

m
As each Aut 1 (ΣK,g [℘K
]) is zero dimensional and as for m > m the morphism
m
Aut 1 (ΣK,g [℘K
]) −→ Aut 1 (ΣK,g [℘m
K ])

is dominating we see that for m ≥ m
ac
ac
Aut 1 (ΣK,g [℘m
→ Aut 1 (ΣK,g [℘m
K ])(k(vK ) ) →
K ])(k(vK ) ).
m
])(k(vK )ac ) equals the image of
It follows that Aut 1 (ΣK,g [℘K
ac
Aut (ΣK,g /k(vK )ac ) −→ Aut (ΣK,g [℘m
K ]/k(vK ) ).
×
Again by proposition 1.7 of [Dr] this is just (ODK,g /℘m
and so the
K ODK,g )
lemma follows. ✷

We remark that for m > 1 the scheme Aut (ΣK,g [℘m
K ]) has dimension > 0.
By an explicit calculation with Dieudonne modules we checked in an earlier
red
version of this paper that Aut 1 (ΣK,g [℘m
coincides with the reduced subK ])
m+1
scheme of the image of Aut (ΣK,g [℘K ]) → Aut (ΣK,g [℘m
K ]). However we will
not actually need that stronger result here, so we do not reproduce the argument.
Now suppose that S is a reduced k(vK )ac -scheme and that H/S is a onedimensional formal Barsotti-Tate OK -module of constant height g. We want
to investigate how far H differs from ΣK,g ×Spec k(vK )ac S. Consider the functor
on S-schemes which sends T /S to the set of isomorphisms (over T)
m
j : Σk,g [℘m
K ] ×Spec k(vK )ac T −→ H[℘K ] ×S T.

It is easy to see that this functor is represented by a scheme Xm (H/S) of finite
type over S. (Think about j as a map of sheaves of Hopf algebras on T .) Then
we define Ym (H/S) to be the intersection of the scheme theoretic images of
the
Xm (H/S) −→ Xm (H/S)
for m ≥ m. Finally we set J (m) (H/S) = Ym (H/S)red . We will also let j univ
denote the universal isomorphism
∼

m
j univ : ΣK,g [℘m
K ] −→ H[℘K ]

over J (m) (H/S).
For instance
red ∼
m
ODK,g )× .
J (m) (ΣK,g /k(vK )ac ) = Aut 1 (ΣK,g [℘m
= (ODK,g /℘K
K ])

36

In fact if S/k(vK )ac is any reduced scheme then
× red
J (m) (ΣK,g /S) = (J (m) (ΣK,g /k(vK )ac ) × S)red = ((ODK,g /℘m
K ODK,g )S )
×
m
= (ODK,g /℘K ODK,g )S .

Each of the schemes Xm (H/S), Ym (H/S) and J (m) (H/S) has a natural
×
×
right action of (ODK,g /℘m
K ODK,g ) . (δ ∈ OD,g takes j to j ◦ δ.) If S =
T ×Spec k(vK ) Spec k(vK )ac for a reduced scheme T /k(vK ) and if H = H0 ×T S
for a formal Barsotti-Tate OK -module H0 /T , then this action extends to one
×
(m)
of DK,g
/(1+℘m
(H/S) thought
K ODK,g ) on each of Xm (H/S), Ym (H/S) and J
×
of as T -schemes. More precisely if δ ∈ DK,g we get a commutative diagram
δ

J (m) (H/S)
↓

J (m) (H/S)
↓

−→

T × Spec k(vK )ac

(1×Frob∗v )−vK (det δ)
K
−→

T × Spec k(vK )ac .

commutes. (Let X/S denote the pull back of Xm (H/S) by
T × Spec k(vK )ac

(1×Frob∗v )vK (det δ)
K
−→

T × Spec k(vK )ac .

(p−fK vK (det δ) )

Then over X we get an isomorphism j : ΣK,g
other hand δ gives an isomorphism
∼

(p−fK vK (det δ) )

δ : ΣK,g −→ ΣK,g
Thus over X we get

∼

m
[℘m
K ] → H[℘K ]. On the

.

∼

m
j ◦ δ : ΣK,g [℘m
K ] → H[℘K ].

This induces a map over S from X to Xm (H/S). Composing this with the
inverse of the pull back of (1×Frob∗vK )vK (det δ) we get the desired automorphism
of Xm (H/S). The following diagram
Xm (H/S)
←−
X
→
Xm (H/S)
↓
↓
↓
T × Spec k(vK )ac ←− T × Spec k(vK )ac = T × Spec k(vK )ac
(where the leftwards arrow on the bottom row is (1×Frobv∗K )vK (det δ) ) illustrates
this construction.)
Before going on to the main result of this section let us take the opportunity
to record a simple result in commutative algebra for which we do not know a
reference.
37

Lemma 2.6 Let k be a perfect field, A/k a k-algebra of finite type, m a maximal ideal of A and B/A a finite A-algebra.
1. Suppose also that B is reduced. Then the completion Bm∧ of B with respect
to the ideal mB is also reduced.
2. More generally if N is the nilradical of B then Nm∧ is the nilradical of
Bm∧ .
Proof: Consider the first part of the lemma. B has finitely many maximal
ideals n1 , ..., nr above m and we have that
Bm∧ = Bn∧1 ⊕ ... ⊕ Bn∧r
(see corollary 2 of section 7 of chapter VIII of [ZS]). Thus we can reduce to
the case B = A.
Note that as A is reduced the same is true of the localisation Am . Let
Q1 , ..., Qs denote the minimal primes of Am . As Am is reduced we have a finite
embedding
Am → (Am /Q1 ) ⊕ ... ⊕ (Am /Qs ).
Hence we also have an embedding

A∧m → (Am /Q1 )∧ ⊕ ... ⊕ (Am /Qs )∧
(use theorem 16 of section 6 of chapter VIII of [ZS] and the flatness of A∧m /Am ).
Thus we may suppose that Am is an integral domain. In this case the result
follows from lemmas 1 and 4 of section 13 of chapter VIII of [ZS].
For the second part consider the exact sequence
(0) −→ N −→ B −→ B −→ (0).
Again using theorem 16 of section 6 of chapter VIII of [ZS] and the flatness of
A∧m /Am we see that
∧
(0) −→ Nm∧ −→ Bm∧ −→ (B )m
−→ (0)

is also exact. By the first part of this lemma we know that (B )∧m is reduced
and the second part follows. ✷
The following proposition is of key importance for us.
Proposition 2.7 Suppose that S/k(vK )ac is a reduced scheme of finite type
and let H/S be a one-dimensional formal Barsotti-Tate OK -module of constant height g. Then for each m ≥ 1, J (m) (H/S)/S is finite etale and Ga×
lois with Galois group (ODK,g /℘m
K ODK,g ) . (N.B. We are not asserting that
J (m) (H/S) is connected.)
38

Proof: It suffices to show that for any closed point s of S
×
• the group (ODK,g /℘m
K ODK,g ) has a faithful and transitive action on the
points of J (m) (H/S)s ;
∼

• and if t is any point of J (m) (H/S)s then J (m) (H/S)∧t → Ss∧ .
(See for instance theorem 3 of section 5 of chapter 3 of [Mu2].) Equivalently
it suffices to check that for all closed points s of S we have
×
∧ ∼
J (m) (H/S) ×S Spec OS,s
= (ODK,g /℘m
K ODK,g )Spec O∧ .
S,s

We note that by lemma 2.3
∧
∧ ∼
H ×S Spec OS,s
.
= ΣK,g ×Spec k(vK )ac Spec OS,s
∧
Because Spec OS,s
is flat we see that for any closed point s of S we have
∧ ∼
∧
Ym (H/S) ×S Spec OS,s
).
= Ym (H/Spec OS,s

(The formation of scheme theoretic images commutes with flat base change.)
Thus by lemma 2.3 we see that
∧ ∼
∧
m
∧
Ym (H/S) ×S Spec OS,s
)∼
]) × Spec OS,s
= Ym (ΣK,g /Spec OS,s
= Aut 1 (ΣK,g [℘K
∧
is finite and flat over Spec OS,s
. We conclude that Ym (H/S) is finite and flat
∧
over S. (Use the fact that OS,s is faithfully flat over OS,s . More precisely it
suffices to show that for any closed point s of S the ring OYm (H/S) ⊗OS OS,s is
finite and free over OS,s . We have seen that this is true after tensoring with
a
∧
. Thus we can find a morphism of OS,s -modules OS,s
→ OYm (H/S) ⊗OS OS,s
OS,s
∧
which becomes an isomorphism after tensoring with OS,s
. Faithful flatness
∼
a
implies that OS,s → OYm (H/S) ⊗OS OS,s .)
Thus J (m) (H/S) is finite over S. The previous lemma then shows that for
any closed point s of S
∼

∧
∧
J (m) (H/S) ×S Spec OS,s
−→ J (m) (H/Spec OS,s
).

Thus by lemma 2.3 we have that
×
∧ ∼ (m)
∧
)∼
J (m) (H/S) ×S Spec OS,s
= (ODK,g /℘m
= J (ΣK,g /Spec OS,s
K ODK,g )Spec O∧ .
S,s

This proves the proposition. ✷
Although we will not need it in this paper, it may be of interest to point
out the following corollary of the proceeding proposition.
39

Corollary 2.8 Suppose that S/k(vK )ac is a reduced, connected scheme of finite type, and suppose that s is a geometric point of S. If H/S is a onedimensional formal Barsotti-Tate OK -module of height g then it gives rise to
a continuous homomorphism
×
.
ρH : π1alg (S, s) −→ OD
K,g

This gives rise to a bijection between isomorphism classes of one-dimensional
formal Barsotti-Tate OK -module of height g on S and conjugacy classes of
continuous homomorphisms
×
.
ρ : π1alg (S, s) −→ OD
K,g

Proof: As we will not use this result elsewhere in this paper we will simply
sketch the proof.
First we explain the construction of ρH from H. Choose a compatible
system of geometric points sm of J (m) (H/S) above s (i.e. if m > m then
sm maps to sm under J (m ) (H/S) → J (m) (H/S)). If σ ∈ π1alg (S, s) then
×
σsm = ρH,m (σ)sm for some (unique) element ρH,m (σ) ∈ (ODK,g /℘m
K ODK,g ) .
m
Moreover for m > m we have ρH,m (σ) ≡ ρH,m (σ) mod ℘K
. We set
×
ρH = lim ρH,m : π1alg (S, s) → OD
.
K,g
←

It is a continuous homomorphism. The construction appears to depend on
the choice of the system {sm }, but a different choice simply changes ρH by
×
conjugation in OD
.
K,g
Next we explain how one goes from a continuous homomorphism
×
ρ : π1alg (S, s) → OD
K,g

to a one-dimensional formal Barsotti-Tate OK -module Hρ /S. The reduction
ρ mod ℘m
K gives rise to a Galois finite etale cover (not necessarily connected)
×
Sm → S with Galois group (ODK,g /℘m
K ODK,g ) . Consider
ΣK,g [℘m
K ] × Sm −→ Sm
×
with the diagonal action of (ODK,g /℘m
K ODK,g ) . We may quotient out by the
action of this finite group and we obtain a finite flat group scheme Hm /S. We
set Hρ = lim→ Hm .
We leave the reader both to check that Hρ /S is a one-dimensional formal
Barsotti-Tate OK -module, and that these two constructions are inverse to each
other. ✷

40

We end this section with some results about lifting extensions of BarsottiTate OK -modules. We are very grateful to Johan de Jong for explaining to us
how to prove corollary 2.10 below.
Lemma 2.9 Let A be a noetherian ring and J an ideal of A which contains
some power of p and which satisfies J 2 = (0). Suppose that over Spec A/J we
have an exact sequence of Barsotti-Tate OK -modules
(0) −→ H 0 −→ H −→ H et −→ (0)
with H 0 formal and H et ind-etale. Suppose moreover that H 0 is a lift of H 0
to a Barsotti-Tate OK -module over Spec A. Then there is an exact sequence
(0) −→ H 0 −→ H −→ H et −→ (0)
of Barsotti-Tate OK -modules over Spec A, which reduces modulo J to the above
exact sequence.
Proof: For the proof we use Grothendieck-Messing Dieudonne theory (see
[Me] as completed by [I]). This associates to
(0) −→ H 0 −→ H −→ H et −→ (0)
an exact sequence of crystals in finite locally free modules
(0) −→ D(H 0 ) −→ D(H) −→ D(H et ) −→ (0)
on Spec A/J. (For exactness use [BBM] combined with the compatibility of
the theories in [Me] and [BBM], which is proved in [BM].) Moreover we have
locally free submodules V (H 0 ) ⊂ D(H 0 )A/J (resp. V (H) ⊂ D(H)A/J , resp.
V (H et ) = D(H et )A/J ) with locally free quotients. To H 0 we may associate
a locally free submodule V (H 0 ) ⊂ D(H 0 )A with a locally free quotient and
with V (H 0 )/JV (H 0 ) = V (H 0 ). We will look for a locally free submodule
V ⊂ D(H)A with locally free quotient such that
• V (H 0 ) → V ,
• V →
→ D(H et )A ,
• and V /JV = V (H).

41

Assuming we can find such a V we would get a complex of Barsotti-Tate
OK -modules
(0) −→ H 0 −→ H −→ H et −→ (0)
lifting

(0) −→ H 0 −→ H −→ H et −→ (0).
It follows from lemma 4.10 chapter II of [Me] that the lifted sequence is in fact
exact.
It remains to construct such a V . This is equivalent to constructing a
splitting for the exact sequence
(0) −→ D(H 0 )A /V (H 0 ) −→ D(H)A /V (H 0 ) −→ D(H et )A −→ (0)
above the splitting of
(0) −→ D(H 0 )A/J /V (H 0 ) −→ D(H)A/J /V (H 0 ) −→ D(H et )A/J −→ (0)
provided by V (H)/V (H 0 ). As D(H et )A is locally free we can find such a
splitting Zariski locally on Spec A. It is not unique but determined up to an
element of
Hom (D(H et )A/J , J(D(H 0 )/V (H 0 ))).
Thus the obstruction to the existence of a global splitting lies in
H 2 (Spec A/J, Hom (D(H et )A/J , J(D(H 0 )/V (H 0 )))).
Because Spec A/J is affine this group vanishes and so we can find such a
splitting globally. ✷
As an immediate consequence we obtain the following corollary.
Corollary 2.10 Let A be a noetherian ring complete with respect to the topology defined by an ideal I. Suppose that I contains a power of p. Suppose also
that over Spec A/I we have an exact sequence of Barsotti-Tate OK -modules
(0) −→ H 0 −→ H −→ H et −→ (0)
with H 0 formal and H et ind-etale. Suppose moreover that H 0 is a lift of H 0
to a Barsotti-Tate OK -module over Spf A. Then there is an exact sequence
(0) −→ H 0 −→ H −→ H et −→ (0)
of Barsotti-Tate OK -modules over Spf A, which reduces modulo I to the previous exact sequence.
42

3

Drinfeld level structures

Suppose that H/S is a Barsotti-Tate OK -module of constant height h over a
scheme S. By a Drinfeld ℘m
K -structure on H/S we shall mean a morphism of
abelian groups
h
m
α : (℘−m
K /OK ) −→ H[℘K ](S)

−m
such that the set of α(x) for x ∈ (℘K
/OK )h forms a full set of sections of
m
H[℘K ] in the sense of [KM] section 1.8. We will collect together here some of
the basic properties of Drinfeld level structures.

Lemma 3.1 In this lemma S will denote an OK -scheme and H/S will be a
Barsotti-Tate OK -module of constant height h.
h
m
m
1. Suppose that α : (℘−m
K /OK ) −→ H[℘K ](S) is a Drinfeld ℘K -structure
and that T /S is any scheme. Then the composite
α

h
m
m
αT : (℘−m
K /OK ) −→ H[℘K ](S) −→ H[℘K ](T )

is a Drinfeld ℘m
K -structure for H ×S T .
2. Suppose that S/Fp is reduced. If H/S is one-dimensional and formal
then H contains a unique finite flat subgroup scheme of any order ps ,
namely the kernel of F s .
3. Suppose that S/Fp is reduced. If H/S is one-dimensional and formal
then there is a unique Drinfeld ℘m
K -structure on H/S, namely the trivial
homomorphism
−m
/OK )h −→ H(S)
αtriv : (℘K
x −→ 0
h
for all x ∈ (℘−m
K /OK ) . (We will refer to this as the trivial Drinfeld
m
℘K -structure.)

4. Suppose that there is an exact sequence of Barsotti-Tate OK -modules
(0) −→ H 0 −→ H −→ H et −→ (0),
over S with H 0 formal, H et ind-etale and both of constant height. Then
m
h
α : (℘−m
K /OK ) → H[℘K ](S)
m
-structure if and only if there is a direct summand OK is a Drinfeld ℘K
−m
/OK )h such that
submodule M ⊂ (℘K

43

m
• α|M : M → H 0 [℘K
](S) is a Drinfeld ℘m
K -structure,

• α induces an isomorphism

∼

h
et m
α : ((℘−m
K /OK ) /M )S → H [℘K ].

5. Suppose that S is reduced and that p = 0 on S. Suppose also that there
is an exact sequence of Barsotti-Tate OK -modules
(0) −→ H 0 −→ H −→ H et −→ (0),
over S with H 0 formal, H et ind-etale and both of constant height. If
H/S admits a Drinfeld ℘m
K -level structure (with m ≥ 1) then there is a
unique splitting
et m
∼ 0 m
H[℘m
K ] = H [℘K ] × H [℘K ]
∼ 0 m
over S. On the other hand if there is a splitting H[℘m
K ] = H [℘K ] ×
−m
m
et m
H [℘K ]/S then to give a Drinfeld ℘K -structure α : (℘K /OK )h →
−m
h
H[℘m
K ](S) is the same as giving a direct summand M ⊂ (℘K /OK )
and an isomorphism
∼

h
et m
((℘−m
K /OK ) /M )S → H [℘K ].

6. For any m ≥ 0 there is a scheme S(m) which is finite over S and a
Drinfeld ℘m
K -structure
h
m
αuniv : (℘−m
K /OK ) −→ H[℘K ](S(m))

on H ×S(m), which is universal in the sense that if T /S is any S-scheme
and if
h
m
α : (℘−m
K /OK ) −→ H[℘K ](T )

is any Drinfeld ℘m
K -structure on H × T then T → S factors uniquely
through S(m) in such a way that αuniv pulls back to α. Moreover S(m)/S
has a right action of GLh (OK /℘m
K ), which can be characterised as follows.
)
If g ∈ GLh (OK /℘m
then
under
the morphism g : S(m) → S(m), αuniv
K
pulls back to αuniv ◦ g.

7. Suppose that S = Spec R with R a noetherian local ring and that H/S
is one-dimensional and formal. Then H ∼
= Spf R[[T ]]. Choose a uniformiser K ∈ OK and let f Km (T ) ∈ R[[T ]] be the power series reprem ∗
m
senting multiplication by K
) (T )). Suppose that
(i.e. f Km (T ) = ( K
−m
h
m
α : (℘K /OK ) → H[℘K ](R). Then the following are equivalent
44

• α is a Drinfeld ℘m
K -level structure,

•

• f

x (T
m
K

− T (α(x)))|f

(T ) = g(T )

m
K

x (T

(T ),

− T (α(x))) for some unit g(T ) ∈ R[[T ]]× .

Proof: 1. This follows from proposition 1.9.1 of [KM].
2. We may suppose that S is connected. From the discussion on page 26 of
s
[Me] we see that ker F s locally isomorphic to Spec OS [T ]/(T p ). Thus ker F s
is indeed a finite flat group scheme of rank ps . If A ⊂ H is any finite flat
subgroup scheme then we will show that A = ker F s for some s. Choose s
maximal such that ker F s ⊂ A. We must show we actually have equality.
Modding out by ker F s we may suppose that s = 0. We must show that
A = (0). If for any point s of S, ker F |As = (0) then as As is connected we
must have As = (0). As S is connected the rank of A is constant and we would
then have that A = (0) as desired. Thus suppose that for all points s of S
we have that (ker FA )s = (0). As ker F is finite flat of rank p we see that we
must have (ker FA )s = (ker F )s for all points s of S. Over S we have ker F |A
is a closed subscheme of ker F which becomes equal to ker F when pulled back
to any point of S. As S is reduced we must have ker F = ker F |A ⊂ A, a
contradiction.
m
-structure it suffices to
3. To see that there is no more than one Drinfeld ℘K
m
m
check that H[℘K ](S) = {0}. This follows because S is reduced and H[℘K
]/S
is radicial (see proposition 4.4 of chapter II of [Me]). (If f : T → S is finite
and radicial and if S is reduced then there is at most one section to f . To see
this one reduces to the case that S = Spec A and T = Spec B. We are looking
for sections to f ∗ : A → B. Suppose g1∗ and g2∗ are two such sections. As S is
reduced we can embed A into a product of fields. Thus if g1∗ = g2∗ we can find
a field k and a homomorphism φ∗ : A → k such that φ∗ ◦ g1∗ = φ∗ ◦ g2∗ . On the
other hand we must have g1∗ ◦ f ∗ = g2∗ ◦ f ∗ and so φ∗ ◦ g1∗ ◦ f ∗ = φ∗ ◦ g2∗ ◦ f ∗ . This
contradicts the fact that f is radicial. (The finiteness hypothesis is presumably
unnecessary, but this additional hypothesis does us no harm.))
It remains to show that αtriv is indeed a Drinfeld ℘m
K -structure. We must
m
have that H[℘K
]
is
locally isomorphic to
] = ker F fK hm and hence H[℘m
K
pfK hm
pfK hm
OS [T ]/(T
). If f ∈ OS [T ]/(T
) and we write f = f0 + f1 T + ... +
fK hm
f hm
pfK hm −1
fpfK hm −1 T
, then the norm down to OS of f is f0p
= f (0)p K . This
verifies condition (2) on page 33 of [KM].
4. This follows from proposition 1.11.2 and lemma 1.8.3 of [KM].
h
m
m
5. Suppose that α : (℘−m
K /OK ) → H[℘K ](S) is a Drinfeld ℘K -structure. Let
M = ker α. By parts 2 and 3 we see that the composite
m
et m
α : ((℘−m
K /OK )/M )S −→ H[℘K ] −→ H [℘K ]

45

m
m
] is provided by the
] into H[℘K
is an isomorphism. A splitting of H et [℘K
−m
m
image of ((℘K /OK )/M )S in H[℘K ]. To see the splitting is unique we argue as follows. To give a splitting is the same as giving a morphism γ :
−m
/OK )/M )S → H[℘m
((℘K
K ] such that the composite
m
et m
γ : ((℘−m
K /OK )/M )S −→ H[℘K ] −→ H [℘K ]

coincides with the map induced by α. To give γ is the same as giving
∼

−m
et m
γ : ((℘K
/OK )/M ) −→ H[℘m
K ](S) −→ H [℘K ](S).

Thus there is only one possible choice for γ. The second assertion of this part
now follows from parts 3 and 4.
h
(℘−m
K /OK )
where the
6. Let S(m) be the closed subscheme of T = H[℘m
K]
tautological map
h
m
(℘−m
K /OK ) −→ H[℘K ](T )
is a Drinfeld ℘m
K -structure (use lemma 1.9.1 of [KM]).
∼
7. That H = Spf R[[T ]] follows from page 26 of [Me]. Let T s be the first power
of T whose coefficient in f Km (T ) is not in the maximal ideal of R. Consider
the map
s−1

i=0

RT i −→ R[[T ]]/(f

m
K

(T )) ∼
= RfK mh .

After tensoring with the residue field of R we get an isomorphism. Thus this
f mh
map is already an isomorphism and s = fK mh. We conclude that T p K
f mh
is a linear combination of 1, T, ..., T p K −1 in R[[T ]]/f Km (T ), and again by
f mh
reducing modulo the maximal ideal of R we see that T p K is a linear comf mh
bination of 1, T, ..., T p K −1 with coefficients in the maximal ideal of R. Put
another way we can find a monic polynomial h(T ) of degree pfK mh over R
all whose nonleading coefficients are in the maximal ideal of R, and a power
series g(T ) ∈ R[[T ]] such that h(T ) = g(T )f Km (T ). We see at once that the
constant term of g(T ) is a unit in R and hence that g(T ) ∈ R[[T ]]× . We see at
once that the second and third conditions are equivalent. The first and third
conditions are equivalent by lemma 1.10.2 of [KM]. ✷
Suppose that X is a locally noetherian formal scheme with ideal of definition I. We will let Xn denote the scheme with underlying topological space
X and structure sheaf OX /I n . By a Drinfeld ℘m
K -structure on a Barsottim
Tate OK -module H/X we shall mean a compatible system of Drinfeld ℘K
structures
m
h
αn : (℘−m
K /OK ) −→ H[℘K ](Xn )
46

for H×X Xn . This is easily checked to be canonically independent of the choice
of ideal of definition I.
If A is a noetherian ring complete with respect to the I-adic topology for
some ideal I and if H/Spec A is a Barsotti-Tate OK -module with Drinfeld
m
℘m
K -structure α, then we obtain a a natural Drinfeld ℘K -structure α on the
corresponding Barsotti-Tate OK -module H/Spf A (take the push forward of α
on Xn for each n). This establishes a bijection from Drinfeld ℘m
K -structures on
m
H/Spec A to Drinfeld ℘K -structures on H/Spf A. (Given a compatible system
−m
n
αn : (℘K
/OK )h −→ H[℘m
K ](A/I )

using the completeness of A we get in the limit a homomorphism
h
m
α : (℘−m
K /OK ) −→ H[℘K ](A).

Using lemma 1.9.1 of [KM] we see that α is in fact a Drinfeld ℘m
K -structure.)
We will next recall some results of Drinfeld about formal deformations
of one-dimensional Barsotti-Tate OK -modules with Drinfeld level structures.
Consider first the case of a formal Barsotti-Tate OK -module. More precisely
consider the functor which associates to any local Artinian OK -algebra A with
residue field k(v)ac the set of isomorphism classes of triples (H, j, α) where
∼
H/A is a Barsotti-Tate OK -module, where j : ΣK,g → H ×Spec A Spec k(vK )ac
g
m
m
and where α : (℘−m
K /OK ) −→ H[℘K ](Spec A) is a Drinfeld ℘K -structure.
Proposition 4.3 of [Dr] tells us that this functor is pro-represented by a regular finite flat local RK,g -algebra, which we will denote RK,g,m . We will denote by (ΣK,g , j, α) the universal triple. Again by lemma 4.16 of chapter II
of [Me] we see that (ΣK,g , j) is actually defined over Spec RK,g,m . In fact
−m
m
α : (℘K
/OK )g → ΣK,g [℘m
K ](Spec RK,g,m ) (as ΣK,g [℘K ]/Spec RK,g,m is finite)
m
and by proposition 1.9.1 of [KM] α is a Drinfeld ℘K -structure over Spec RK,g,m .
Thus we get a map Spec RK,g,m → (Spec RK,g )(m), which is an isomorphism
after tensoring with any Artinian quotient of RK,g and hence is an isomorm
phism. We also have that RK,g,m is degree #GLg (OK /℘K
) over RK,g . (To see
this it suffices to look at the generic fibre RK,g ⊗Zp Qp , where the degree is
easy to calculate because ΣK,g becomes ind-etale and a Drinfeld ℘m
K -structure
is nothing but an isomorphism
∼

h
m
α : (℘−m
K /OK )S → H[℘K ].)

We next turn to deformations of H0 = ΣK,g × (K/OK )h /k(vK )ac . Fix a
surjection
g+h
δ : (℘−m
→
→ ℘−m
K /OK )
K T H0 /T H0 ;
47

m
and let GLg+h (OK /℘m
K )δ denote the group of x ∈ GLg+h (OK /℘K ) such that
δ ◦ x = δ. Then there is a short exact sequence
m
(0) → Hom (℘−m
K T H0 /T H0 , ker δ) → GLg+h (OK /℘K )δ → Aut (ker δ) → (0).

Consider the functor which associates to any local Artinian OK -algebra A with
residue field k(v)ac the set of isomorphism classes of triples (H, j, α) where H/A
∼
is a Barsotti-Tate OK -module, where j : ΣK,g → H ×Spec A Spec k(vK )ac and
g+h
m
where α : (℘−m
−→ H[℘m
K ](Spec A) is a Drinfeld ℘K -structure such
K /OK )
that the composite
j −1

α

g+h
m
ac
(℘−m
−→ H[℘K
](Spec A) −→ H[℘m
K ](Spec k(vK ) ) −→
K /OK )
−m
m
ac
−→ H0 [℘K ](Spec k(vK ) ) = ℘K T H0 /T H0

equals δ. This functor is pro-representable by (H, j, αH )/Spf Rδuniv (by proposition 4.5 of [Dr]).
To describe how it is pro-represented it is convenient to also fix a homog
g+h
morphism γ : (℘−m
−→ (℘−m
K /OK )
K /OK ) such that
∼

−m
−m
g
δ ⊕ γ : (℘K
/OK )g+h −→ (℘−m
K T H0 /T H0 ) ⊕ (℘K /OK ) .

This first of all gives rise to a splitting Aut (ker δ) → GLg+h (OK /℘m
K )δ . Secuniv
ondly it gives rise to an isomorphism of Spf Rδ with
Hom (℘−m
K T H0 , ΣK,g ) ×Spec RK,g Spec RK,g,m .
Over this ring we have the pull back from Hom (T H0 , ΣK,g ) of the tautological
extension
(0) −→ ΣK,g −→ H −→ T H0 ⊗ (K/OK ) −→ (0),
as well as a second extension
(0) −→ ΣK,g −→ H −→ T H0 ⊗ (K/℘−m
K ) −→ (0).
There is a natural isogeny H −→ H whose kernel projects isomorphically to
−m
T H0 /T H0 , and so we get a splitting
℘K
−m
i : ℘K
T H0 /T H0 → H.

Then
αH = α ◦ γ + i ◦ δ.
(See the (rather sketchy) proof of proposition 4.5 in [Dr].)
48

The deformation space Spf Rδuniv has a right action of GLg+h (OK /℘m
K )δ
which may be described as follows. The splitting γ allows one to write the
−m
group GLg+h (OK /℘m
K )δ as a semidirect product of Hom (℘K T H0 /T H0 , ker δ)
and Aut (ker δ). It thus suffices to describe the action of both these groups on
Spf Rδuniv . Now Aut (ker δ) is isomorphic via γ to GLh (OK /℘m
K ) and simply
acts on the factor Spf RK,g,m . On the other hand composition with α gives a
map
−m
Hom (℘−m
K T H0 /T H0 , ker δ) −→ Hom (℘K T H0 , ΣK,g (RK,g,m ))
= Hom (℘−m
K T H0 , ΣK,g )(RK,g.m ).

The action of an element φ ∈ Hom (℘−m
K T H0 /T H0 , ker δ) on
Hom (℘−m
K T H0 , ΣK,g ) ×Spec RK,g Spec RK,g,m
−m
is simply by translation by the image of φ in Hom (℘K
T H0 , ΣK,g )(RK,g.m ).
If we write Hom (T H0 , ΣK,g ) = Spf R then H is defined over Spec R. Moreover as before we can identify (Spec R)(m) with

Spec Rδuniv ,
δ

where the disjoint union is over surjections
−m
g+h
δ : (℘−m
→
→ ℘K
T H0 /T H0 .
K /OK )
univ
univ
If x ∈ GLg+h (OK /℘m
isomorphically to Rδ◦x
. If x ∈
K ) then x takes Rδ
m
univ
GLg+h (OK /℘K )δ then the two actions of x on Spec Rδ coincide. In particular
we see that (Spec R)(m) is regular and is finite and flat over Spec R of degree
#GLg+h (OK /℘m
K ).
We now record a few more basic facts about Drinfeld level structures which
can be proved by reduction to the universal case.

Lemma 3.2 In this lemma S will denote an OK -scheme which we will assume
is locally noetherian with a dense set of points with residue field algebraic
over k(v). Also H/S will be a one-dimensional Barsotti-Tate OK -module of
constant height h.
1. S(m)/S is finite, flat of degree #GLh (OK /℘m
K ).
2. Suppose that
h
m
α : (℘−m
K /OK ) −→ H[℘K ](S)

49

h
m
-structure. Suppose also that M ⊂ (℘−m
is a Drinfeld ℘K
K /OK ) is a
OK -submodule. Then there is a unique OK -invariant finite flat subgroup
scheme N ⊂ H[℘m
K ] such that the set of α(x) for x ∈ M form a full set
of sections for N/S. If moreover
h
−m
−m
/OK
δ : (℘K
) → (℘K
/OK )h /M

is a map of OK -modules, then α ◦ δ is a Drinfeld ℘m
K structure for H/N .

The construction of N is compatible with base change in the following
sense. If T /S is a locally noetherian S-scheme with a dense set of points
with residue field algebraic over k(v) and if
α

m
h
m
αT : (℘−m
K /OK ) −→ H[℘K ](S) −→ (H ×S T )[℘K ](T ),

then the set of αT (x) for x ∈ M is a full set of sections for N ×S T .
Proof: The first part is proved by a straightforward reduction to the universal formal case. We will prove the second part only, as the argument in
this case is slightly more difficult. The last paragraph of the second part follows from lemma 1.9.1 of [KM]. Thus we concentrate on the proof of the first
paragraph of part 2.
By corollary 1.30.3 of [KM] there is a unique closed subscheme N ⊂ H[℘m
K]
which is locally free over S and for which the set of x ∈ M form a full set of
sections. From the uniqueness it follows that N is invariant by the action of
×
OK
. Thus it suffices to check that
1. N is a subgroup scheme;
2. if
−m
h
h
δ : (℘−m
K /OK ) → (℘K /OK ) /M

is a map of OK -modules, then α ◦ δ is a Drinfeld ℘m
K structure for H/N .
There is a closed subscheme S ⊂ S such that for any scheme T /S, N ×S
T ⊂ H ×S T has the two properties above if and only if T → S factors through
S . (H[℘m
K ] is the spectrum of a sheaf of locally free Hopf algebras H/S. Let I
denote the subsheaf of ideals defining N . The first property above is equivalent
to the composite map
I → H −→ H ⊗ H −→ H/I ⊗ H/I,
where the middle map is the comultiplication, being zero. It follows that
there exists a closed S ⊂ S universal for the truth of the first property. The
50

existence of S ⊂ S follows from proposition 1.9.1 of [KM].) What we must
show is that S = S.
We may at once reduce to the case that S = Spec A for an Artinian local
ring A. (Look at OS,s /mas as s runs over a dense set of points and a runs over
positive integers.) Then by tensoring with W (k(vK )ac ) we may assume that
the residue field of A is k(vK )ac . Next we may replace H/A by the universal
deformation of H × Spec k(vK )ac together with its Drinfeld ℘m
K -structure, and
so we may suppose that S = Spec R for a complete noetherian local ring which
is flat over OK nr . Then we may replace S by S × Spec Qp , which is dense in
S. But H/S × Spec Qp is ind-etale and the result is easy. ✷
The following corollary follows readily.

Corollary 3.3 In this lemma X will denote a locally noetherian OK -formal
scheme. We will assume that X red has a dense set of points with residue field
algebraic over k(v). Also H/X will denote a one-dimensional Barsotti-Tate
OK -module of constant height h.
1. There is a formal scheme X (m)/X and a Drinfeld ℘m
K -level structure
αuniv on H ×X X (m) which is universal in the following sense. If Y →
X is any morphism of formal schemes and if δ is a Drinfeld ℘m
K -level
structure on H ×X Y then there is a unique morphism Y → X (m) over
X under which αuniv pulls back to δ. Moreover X (m)/X finite, flat of
degree #GLh (OK /℘m
K ).

2. Suppose that α is a Drinfeld ℘m
K -structure on H/X . Suppose also that
h
M ⊂ (℘−m
/O
)
is
a
-submodule.
Then we can find a Barsotti-Tate
O
K
K
K
OK -module H/α(M ) over X and a morphism H → H/α(M ) over X
such that when restricted to any closed subscheme X ⊂ X the morphism
H|X −→ (H/α(M ))|X
is surjective and the set of α|X (x) for x ∈ M form a complete set of
sections for the kernel.
The construction of H/α(M ) is compatible with base change in the following sense. If Y/X is a locally noetherian X -formal scheme such
that Y red has a dense set of points with residue field algebraic over k(v)
and if HY (resp. αY ) denotes the pull back of H (resp. α) to Y, then
HY /αY (M ) is canonically the pull back of H/α(M ) to Y.

×
. The
We have seen that RK,g has a natural continuous left action of OD
K,g
same is true of RK,g,m and so in fact RK,g,m has a continuous left action of
×
×
→
→ GLg (OK /℘m
GLg (OK ) × OD
K ) × ODK,g .
K,g

51

×
In fact we can extend this action to a continuous left action of GLg (K) × DK,g
on the direct system of the RK,g,m such that
(γ,δ)

RK,g,m1
↑

RK,g,m2
↑

−→
v

W (k(vK )ac )

K
FrobvK

(det γ)−vK (det δ))

−→

W (k(vK )ac )

commutes if m2 >> m1 .
×
To describe this first suppose that (γ, δ) ∈ GLg (K) × DK,g
, that γ −1 ∈
g
m1 −m2 g
Mg (OK ), that vK (det(δ)) ≤ 0 and that γOK
⊂ ℘K
OK . It suffices to
ac
define a W (k(vK ) )-linear map
(γ, δ) : RK,g,m1 −→ RK,g,m2 ⊗W (k(v)ac ),FrobvK (det δ)−vK (det γ) W (k(v)ac ).
vK

Next, by the universal property of RK,g,m1 it suffices to give a deformation of
(ΣK,g , j, αtriv ) to RK,g,m2 ⊗W (k(v)ac ),FrobvK (det δ)−vK (det γ) W (k(v)ac ). By lemma 3.2
vK

there is a unique finite flat subgroup scheme A ⊂ ΣK,g over RK,g,m1 such that
g
g
are a complete set of sections for A. For
)/OK
the set of αuniv (x) for x ∈ (γOK
our deformation of ΣK,g we will take
(ΣK,g /A) ×Spf W (k(vK )ac ),(Frobv∗

K

)vK (det δ)−vK (det γ)

Spf W (k(vK )ac ).

1
It has a Drinfeld ℘m
K -structure coming from

γ

αuniv

g
−m2 g
g
1
(℘−m
K /OK ) → ℘K OK /(γOK ) −→ (ΣK,g /A)(RK,g,m2 ).

(Use lemma 3.2.) Reducing modulo the maximal ideal of
RK,g,m2 ⊗W (k(v)ac ),FrobvK (det δ)−vK (det γ) W (k(v)ac )
vK

and using j we obtain
(p−fK vK (det γ) )

ΣK,g

(p−fK vK (det δ) )
.
×Spec k(vK )ac ,(Fr∗ )fK (vK (det γ)−vK (det δ)) Spec k(vK )ac ∼
= ΣK,g

Finally we identify this with ΣK,g via
(p−vK (det δ) ) ∼

δ −1 : ΣK,g

→ ΣK,g .

We note that if x ∈ OK and x = 0 then the element (x−1 , x−1 ) acts trivially.
Thus we obtain an action of
×
×
GLg (K) × DK,g
→
→ (GLg (K) × DK,g
)/K × ,

where K × is embedded diagonally.
52

Lemma 3.4 Let us fix K, g and m. For each positive integer s we can find
an integer N (s) such that
• N (s) increases monotonically to infinity as s → ∞;
• any element of

s−m
K ODK,g

lifts to an endomorphism of
N (s)

ΣK,g × (RK,g,m /mRK,g,m )
• and (1 +

s
K ODK,g )

N (s)

acts trivially on RK,g,m /mRK,g,m .

Proof: Note that if we can choose N (s) satisfying the first two conditions,
×
then the third will also be satisfied. (If δ ∈ OD
with δ ≡ 1 mod ps then
g
N (s)

m
m
(δ−1)/ K
and (δ −1 −1)/ K
lift to endomorphisms of ΣK,g ×(RK,g,m /mRK,g,m ).
By the uniqueness of such lifts (see part 2 of lemma 1.1.3 of [Kat]) we see that
N (s)
δ lifts to an automorphism of ΣK,g × (RK,g,m /mRK,g,m ) which is the identity on
m
K -torsion.)
Now take N (s) to be the integer part of (s/eK/Qp − m) (or 0 if this is not
N (s)
defined). As pN (s) is zero on (RK,g,m /mRK,g,m ) the second condition on N (s)
follows from part 3 of lemma 1.1.3 of [Kat]. ✷

The following lemma will be proved in section 5.
Lemma 3.5 We can find an inverse system of proper schemes of finite type
Xm /OK nr with compatible actions of GLg (OK ) and a closed point x ∈ Xm such
that
1. ker(GLg (OK ) → GLg (OK /℘m )) acts trivially on Xm ,
2. the generic fibre of Xm /X0 is finite, etale and Galois with Galois group
ker(GLg (OK ) → GLg (OK /℘m )),
3. x is totally ramified in each Xm ,
4. and the inverse system of formal schemes (Xm )∧x with action of GLg (OK )
is isomorphic to the inverse system of the Spf RK,g,n .
Suppose that l is a prime not equal to p. We will let ΨiK,l,g,m denote the
ith vanishing cycle sheaf with coefficients in Qac
l for Spf RK,g,m in the sense of
i
Berkovich (see appendix II). Thus ΨK,l,g,m
is a finite dimensional Qac
l -vector
i
i
s
i
ac
space equal to Ql ⊗Zl lim→s R Ψη (Z/l Z). We set ΨK,l,g = lim→m ΨK,l,g,m and
53

we may drop the subscripts K and/or l when no confusion can arise. Let AK,g
×
denote the set of (γ, δ, σ) ∈ GLg (K) × DK,g
× WK such that
vK (γ) = vK (δ) + vK (σ).
×
on the tower of the RK,g,m gives rise to an
The action of GLg (K) × DK,g
action of AK,g on the tower RK,g,m ⊗OK nr L for any finite extension L/K nr .
More precisely (γ, δ, σ) ∈ AK,g acts as (γ, δ) ⊗ σ. In this way we get a left
action of AK,g on ΨiK,l,g .

Lemma 3.6 The action of AK,g on ΨiK,l,g is admissible/continuous.
Proof: The action of GLg (OK ) is smooth from the definitions. It follows
from lemma 3.4, corollary 4.5 of [Berk3] and lemma 3.5 that the action of
×
m
is smooth. Let Xm denote the kernel of GLg (OK ) → GLg (OK /℘K
OD
).
K,g
∼
i
i
Xm
It follows from lemmas 3.5 and II.3 that ΨK,l,g,m → (ΨK,l,g ) . Finally it
follows from lemma 3.5, the comparison theorem of [Berk3] and lemma II.1
that ΨiK,l,g,m is finite dimensional and has a continuous action of IK . ✷
×
over Qac
If ρ is a irreducible admissible representation of DK,g
l (and hence
necessarily finite dimensional) then we set

ΨiK,l,g (ρ) = Hom O×

DK,g

i
(ρ, ΨK,l,g
).

This is naturally an admissible GLg (K) × WK -module. More precisely
((γ, σ)φ)(x) = (γ, δ, σ)φ(ρ(δ)−1 x),
×
for any δ ∈ DK,g
with vK (det δ) = vK (γ) − vK (σ). Define a homomorphism
d : GLg (K) × WK → Z by dg (γ, σ) = vK (det γ) − vK (σ). The following lemma
is immediate.
×
Lemma 3.7 If ψ : Z → (Qac
l ) then

ΨiK,l,g (ρ ⊗ (ψ ◦ vK ◦ det)) ∼
= ΨiK,l,g (ρ) ⊗ (ψ −1 ◦ dg ).
There is a natural map of AK,g -modules
i
(ρ) ⊗ ρ −→ ΨiK,l,g ,
ΨK,l,g

which sends f ⊗ v to f (v). We will denote the image of this map ΨiK,l,g [ρ] and
we will let ΨiK,l,g,t [ρ] denote the preimage of ΨiK,l,g [ρ] in ΨiK,l,g,t . We will call
irreducible admissible representations of Dg× inertially equivalent if they differ
54

by twisting by a character of the form ψ ◦ vK ◦ det for some character ψ : Z →
×
i
(Qac
l ) . The submodule ΨK,l,g [ρ] only depends on the inertial equivalence class
×
of ρ. Because ODK,g is compact it is easy to check that
ΨiK,l,g ∼
=

ρ ⊗ ΨiK,l,g [ρ]

where the sum is over one representative of each inertial equivalence class of
×
.
irreducible admissible representation of DK,g
We will let e[ρ] denote the number of irreducible components of ρ|O× .
DK,g
×
It also equals the number of characters ψ : Z −→ (Qac
)
such
that
ρ ∼
=
l
×
ρ ⊗ (ψ ◦ vK ◦ det). Let ∆[ρ] be a set of e[ρ] elements δ ∈ DK,g such that the set
of vK (det δ) for δ ∈ ∆[ρ] run over a set of representatives of the congruence
×
we will we will let
classes mode[ρ]. If δ ∈ DK,g
ΨiK,l,g [ρ]δ
denote ΨiK,l,g [ρ] but with its AK,g action twisted so that (γ, , σ) acts via
(γ, δ −1 δ, σ). Then there is an isomorphism of AK,g -modules
∼

ΨiK,l,g (ρ) −→

ΨiK,l,g [ρ]δ ,
δ∈∆[ρ]

which sends f ⊗ v to (f (δ −1 v))δ .
We also introduce the virtual GLg (K) × WK -module
g−1

(−1)g−1−i [ΨiK,l,g (ρ)].

[ΨK,l,g (ρ)] =
i=0

The following lemma is proved in [Car3].
Lemma 3.8 If ρ is a character of K × then
−1
.
ΨK,l,1 (ρ) ∼
= ρ−1 ⊗ ρ ◦ Art K

4

Some simple Shimura varieties

In this section we shall introduce some Shimura varieties which will be the
main object of study in this paper. This class (or one close to it) of Shimura
varieties, which are particularly simple in a number of respects, were first
singled by Kottwitz (see [Ko4]).
55

We will use without comment notation established in section 1. Let U be
a sufficiently small open compact subgroup of G(A∞ ). By sufficiently small
we shall mean that the projection of U to G(Qx ) for some prime x contains no
element of finite order other than 1. Let S be a connected, locally noetherian
F -scheme and s a geometric point of S. Consider the functor that to (S, s)
associated the set of equivalence classes of quadruples (A, λ, i, η) where
• A is an abelian scheme of dimension dn2 ;
• λ : A → A∨ is a polarisation;
• i : B → End 0 (A) such that λ ◦ i(b) = i(b∗ )∨ ◦ λ for all b ∈ B and
tr (b|Lie(A) ) = (c ◦ tr F/E ◦ tr B/F )(nb) + tr B/F (b) − (c ◦ tr B/F )(b)
for all b ∈ B;
• η is a π1 (S, s)-invariant U -orbit of isomorphisms of B ⊗Q A∞ -modules
η : V ⊗Q A∞ → V As which take the standard pairing ( , ) on V to a
(A∞ )× -multiple of the λ-Weil pairing on V As (see [Ko3] pages 390-391).
We consider two quadruples (A, λ, i, η) and (A , λ , i , η ) equivalent if there is
an isogeny α : A → A which takes λ to a Q× multiple of λ , takes i to i and
takes η to η (see [Ko3] page 390). If s is a second geometric point of S then
there is a canonical bijection between the image of (S, s) and of (S, s ). Thus
we obtain a functor from connected, locally noetherian schemes S/F to sets
(see [Ko3] page 391).
Because U is sufficiently small this functor is represented by a smooth
projective scheme XU /F (see [Ko3] page 391). If V ⊂ U there is a natural
finite etale map XV →
→ XU . There is also a natural right action of G(A∞ )
on the inverse system of the XU : if g −1 V g ⊂ U then g : XV → XU by
(A, λ, i, η) → (A, λ, i, η ◦ g). If U and V are sufficiently small open compact
subgroups of G(A∞ ) and if V is a normal subgroup of U then the finite etale
cover XV → XU is Galois with group U/V . Thus if x is a geometric point of
XU we obtain a continuous homomorphism
π1alg (XU , x) −→ U.
(This map is only determined up to conjugation unless one chooses a compatible choice of liftings of x to all the covers XV .)
If ξ is a finite dimensional irreducible representation of G on a Qlac -vector
space Wξ then we obtain a representation
ξ

ξ : π1 (XU , x) −→ U −→ G(Ql ) −→ Aut (Wξ ).
56

Thus we also obtain a lisse etale Qac
l -sheaf Lξ /XU . Although the construction
of Lξ appears to depend on a choice of base points this is illusory (as we will
explain below). If g ∈ G(A∞ ) and U , V are sufficiently small open compact
subgroups of G(A∞ ) with g −1 V g ⊂ U then we have the morphism
g : XV −→ XU
and ξ(gl ) also gives rise to a morphism of sheaves
g : g ∗ Lξ −→ Lξ .
(We will explain the construction of this map g and why the choice of base point
does not effect the construction of Lξ by looking at the case of a locally constant
etale sheaf of (Z/lr Z)-modules. We will leave to the reader the standard and
rather tiresome extension to Qlac -sheaves. Thus suppose that a finite group G
acts freely on a scheme Y (on the right). Suppose also that H1 and H2 are
subgroups of G and that g ∈ G with gH1 g −1 ⊂ H2 . Let Xi = Y /Hi so that we
get a morphism g : X1 → X2 . Suppose that V is a finite free Z/lr Z-module
and that ρ : G → Aut (V ) is a homomorphism. As above we obtain a sheaf
Lρ on each Xi . Let us describe this sheaf without reference to base points. If
U → Xi is a finite etale cover of a Zariski open subset of Xi then Lρ (U ) is the
set of functions
f : π0 (Y ×Xi U ) −→ V
such that for all σ ∈ Hi and C ∈ π0 (Y ×Xi U ) we have
f (Cσ) = ρ(σ)−1 f (C).
To define a map g ∗ : Lρ → Lρ over X1 it suffices to give compatible maps
g : Lρ (U2 ) −→ Lρ (U1 ),
whenever we have a commutative diagram
U1 −→ U2
↓
↓
g
X1 −→ X2
with the vertical maps being finite etale covers of Zariski opens. If f : π0 (Y ×X2
U2 ) → V then we let g(f ) : π0 (Y ×X1 U1 ) → V be the function defined by
g(f )(C) = ρ(g)f (Cg).)
57

We will set
i
(XU ×F F ac , Lξ ).
H i (X, Lξ ) = lim Het
→U

∞

If g ∈ G(A ) and U , V are sufficiently small open compact subgroups of
G(A∞ ) with g −1 V g ⊂ U then we get a morphism
i
i
(XV ×F F ac , Lξ ).
(XU ×F F ac , Lξ ) −→ Het
g : Het

If V ⊂ U then we see that
i
i
(XV ×F F ac , Lξ )U/V .
(XU ×F F ac , Lξ ) ∼
Het
= Het

Thus H i (X, Lξ ) becomes an admissible G(A∞ )-module, in fact an admissible/continuous G(A∞ ) × Gal (F ac /F )-module. We will let [H(X, Lξ )] denote
the virtual G(A∞ ) × Gal (F ac /F )-module
i

(−1)n−1−i [H i (X, Lξ )]

(see appendix I).
Our distinguished embedding τ0 : F → C allows us to speak of the complex
points of XU , which we will denote XU (C), a smooth manifold. We get an
isomorphism
∼
i
(XU ×F F ac , Lξ ) −→ H i (XU (C), Lξ ).
Het

There is an element I ∈ B ⊗Q R (unique if n > 2) with the following properties.
• I 2 = −1.
• βI ∗ = −Iβ.
• The pairing b1 × b2 → (b1 , b2 I) is a positive definite symmetric form on
V ⊗Q R.
• For any embedding σ : F + → R the space V ⊗F + ,σ R is an (E ⊗Q
R)[I]/(I 2 )-module. Our choice of τ0 gives rise to an isomorphism (E ⊗Q
R)[I]/(I 2 ) ∼
= C[I]/(I 2 ). If σ = τ0 |F + we require that I = −i on V ⊗F + ,σ R.
On the other hand we require that the i eigenspace of I on V ⊗F + ,τ0 R
has C-dimension n.

We will let U∞ denote the centraliser of I in G(R). It is a maximal connected
compact mod centre subgroup of G(R). We will let U∞ denote a maximal
compact mod centre subgroup of G(R) containing U∞ . As on page 400 of
58

[Ko3] we can give a more explicit description of the smooth manifold XU (C).
It is the disjoint union of
# ker1 (Q, G) = # ker((F + )× /Q× NF/F + (F × ) −→ AF×+ /A× NF + /F (AF× ))
copies of the manifold
G(Q)\(G(A∞ )/U × G(R)/U∞ ).
Under this identification the right action of G(A∞ ) on inverse system of the
XU ’s corresponds to the action by right translation on the
G(Q)\(G(A∞ )/U × G(R)/U∞ ).
∼

Using in addition our identification ı : Qlac → C we see from Matsushima’s
formula that we get an isomorphism
H i (X, Lξ ) ∼
=

π

π ∞ ⊗ H i (Lie G(R), U∞ , π∞ ⊗ ξ),

where π runs over irreducible constituents of the space of automorphic forms
for G(A), each taken with its multiplicity in the space of automorphic forms.
(See [Ko4] page 655.) Thus we obtain the following lemma.
Lemma 4.1 As virtual G(A∞ )-modules we have an equality
[H(X, Lξ )] =
= # ker1 (Q, G)

π [π

∞

]

n−1−i
i (−1)

dim H i (Lie G(R), U∞ , π∞ ⊗ ξ),

where π runs over irreducible constituents of the space of automorphic forms
for G(A), each taken with its multiplicity in the space of automorphic forms.
Let us now give a slightly modified definition of XU . For this purpose
suppose that U = U p × Up,0 × ri=1 Uwi , where U p ⊂ G(A∞,p ), Up,0 ⊂ Q×
p and
op ×
for i ≥ 1, Uwi ⊂ (Bwi ) . We give an equivalent moduli problem represented by
XU /Fw . We consider the functor which takes a connected locally noetherian
Fw -scheme and a geometric point s to equivalence classes of (r + 5)-tuples
(A, λ, i, η p , η p,0 , η wi )/S where
• A/S is an abelian scheme of dimension dn2 ;
• λ : A −→ A∨ is a polarisation;
59

• i : B → End (A) ⊗Z Q such that λ ◦ i(b) = i(b∗ )∨ ◦ λ for all b ∈ B, for
i > 1 we have Lie (A) ⊗Fp Fwi = (0) and Lie (A) ⊗Fp Fwic is a projective
sheaf of rank [Fv+i : Qp ]n2 , Lie (A) ⊗Fp Fw is a projective sheaf of rank n,
and Lie (A) ⊗Fp Fwc is a projective sheaf of rank ([Fw : Qp ]n − 1)n;
• η p is a π1 (S, s)-invariant U p -orbit of isomorphisms of B ⊗Q A∞,p -modules
η p : V ⊗Q A∞,p → V p As which take the standard pairing ( , ) on V ⊗Q
A∞,p to a (A∞,p )× multiple of the λ-Weil pairing on V p As ;
∼

• η p,0 denotes a π1 (S, s)-invariant Up0 -orbit of isomorphisms Qp → Qp (1);
• η w1 is a π1 (S, s)-invariant Uw1 -orbit of isomorphisms of Fw -modules η w1 :
∼
Λ11 ⊗Zp Qp → εVw1 As ;
• for i > 1, η wi is a π1 (S, s)-invariant Uw1 -orbit of isomorphisms of Bwi ∼
modules η wi : Λi ⊗Zp Qp → Vwi As .

We call two (r + 5)-tuples (A, λ, i, η p , η p,0 , η wi ) and (A , λ , i , (η p ) , η p,0 , η wi )
equivalent if there exists an isogeny α : A → A and γ ∈ Q× such that α
carries λ to γλ , i to i , η p to (η p ) , and η wi to η wi ; and such that η p,0 = γη p,0 .
The image of this functor is canonically independent of the base point s so we
can think of it as a functor on connected locally noetherian Fw -schemes. Then
this functor is also represented by XU ×F Fw . The isomorphism between these
two moduli problems is given by mapping (A, λ, i, η p , η p,0 , η wi ) to (A, λ, i, η )
where
n
⊗ ηw 1 ) ⊕
η = η p × (((IdOF,w

i>1

n
ηwi ) ⊕ ((IdOF,w
⊗ ηw1 ) ⊕

ηwi )∨ηp,0 ).
i>1

The dual ∨ηp,0 is taken with respect to the canonical pairing on Λ ⊗Zp Qp
−1
and ηp,0
composed with the λ-Weil pairing on Vp A. The action of G(Qp ) in
this picture may be described as follows. An element (g0 , g1 , ..., gr ) ∈ Q×
p ×
r
p
p
op ×
i=1 (Bwi ) maps (A, λ, i, η , η p,0 , η wi ) to (A, λ, i, η , g0 η p,0 , η wi ◦ gi ).

5

Integral models

Next we wish to describe an integral model for XU over OF,w . More precisely
suppose that U p ⊂ G(A∞,p ) is a sufficiently small open compact subgroup
and suppose that m = (m1 , ..., mr ) ∈ Zr≥0 . Then we will let U p (m) ⊂ G(A∞ )
denote the product
r
p

U ×

Zp×

×

op ×
op
ker((OB
) −→ (OB
/wimi )× ).
w
w
i

i=1

60

i

For simplicity we will restrict attention to open compact subgroups of this
form. Given U p and m as above we shall consider the functor from locally
noetherian connected OF,w -schemes S with a geometric point s to sets which
takes (S, s) to the set of equivalence classes of (r + 4)-tuples (A, λ, i, η p , αi )
where
• A/S is an abelian scheme of dimension dn2 ;
• λ : A −→ A∨ is a prime to p polarisation;
• i : OB → End (A) ⊗Z Z(p) such that λ ◦ i(b) = i(b∗ )∨ ◦ λ for all b ∈ OB ,
for i > 1 we have Lie (A) ⊗OF,p OF,wi = (0) and Lie (A) ⊗OF,p OF,wic is a
projective sheaf of rank [Fv+i : Qp ]n2 , Lie (A) ⊗OF,p OF,w is a projective
sheaf of rank n, and Lie (A) ⊗OF,p OF,wc is a projective sheaf of rank
([Fw : Qp ]n − 1)n;
• η p is a π1 (S, s)-invariant U p -orbit of isomorphisms of B ⊗Q A∞,p -modules
η p : V ⊗Q A∞,p → V p As which take the standard pairing ( , ) on V ⊗Q
A∞,p to a (A∞,p )× multiple of the λ-Weil pairing on V p As ;
• α1 : w1−m1 Λ11 /Λ11 → εA[w1m1 ](S) is a Drinfeld w1m1 -structure;
∼

• for i > 1, αi : (wi−mi Λi /Λi )S → A[wimi ] is an isomorphism of S-schemes
with OB -actions.
Two (r +4)-tuples (A, λ, i, η p , αi ) and (A , λ , i , (η p ) , αi ) are equivalent if there
exists a prime to p isogeny δ : A → A and γ ∈ Z×
(p) such that δ carries λ to γλ ,
p
p
i to i , η to (η ) , and αi to αi . Again this functor is canonically independent
of the base point s so we can think of it as a functor from connected locally
noetherian OF,w -schemes to sets. On connected locally noetherian Fw -schemes
it is naturally isomorphic to the functor defined in the last section. (Note that
because we are now assuming that Z×
p ⊂ U , we no longer require an analogue
of η p,0 .)
If m1 = 0 then it is known that this functor is represented by a projective
scheme XU p ,m /OF,w . (Representability and quasi-projectivity follow as on page
391 of [Ko3] or as in section 5.3 of [Car1]. Properness follows from the valuative
criterion as in section 5.5 of [Car1], the point being that if A is an abelian
variety of dimension dn2 with an action of an order in B over the field of
fractions of a DVR and if A has semistable reduction then A has good reduction
(otherwise the toric part of the reduction has too small a dimension to have
an action of an order in B). The level structure then extends uniquely to the
Neron model A of A, because A[n] is etale over the DVR for n supported on
61

w2 , ..., wr and the primes not dividing p (use the fact that Lie A[wi ]∞ = (0)
for i > 1).) Hence by 3.1, this functor is represented for all m by a projective
scheme XU p ,m /OF,w .
The inverse system of the XU p ,m /OF,w again has an action of G(A∞ ). The
action of g ∈ G(A∞,p ) just sends (A, λ, i, η p , αi ) to (A, λ, i, η p ◦ g, αi ). The
action of (g0 , g1 , ..., gr ) ∈ G(Qp ) is slightly trickier to describe. To do so let us
suppose that for each i ≥ 1 we have the following integrality conditions
op
• gi−1 ∈ OB,w
,
i
op
• g0−1 gi ∈ OB,w
,
i
mi −mi

• wi

op
gi ∈ OB,w
.
i

Under these assumptions we will define a morphism
(gi ) : XU p ,m −→ XU p ,m .
It will send (A, λ, i, η p , αi ) to (A/(C ⊕ C ⊥ ), pval p (g0 ) λ, i, η p , αi ◦ gi ), where
• C1 ⊂ εA[w1m1 ] is the unique closed subscheme for which the set of α1 (x)
with x ∈ g1 Λ11 /Λ11 is a complete set of sections;
• for i > 1, Ci = αi (gi Λi /Λi );
n
• C = (OF,w
⊗OF,w C1 ) ⊕

r
i=2

Ci ⊂ A[u−val p (g0 ) ];

• C ⊥ is the annihilator of C ⊂ A[u−val p (g0 ) ] inside A[(uc )−val p (g0 ) ] under
the λ-Weil pairing;
• pval p (g0 ) λ is the polarisation A/(C ⊕ C ⊥ ) → (A/(C ⊕ C ⊥ ))∨ which makes
the following diagram commute
A
↓
A/(C ⊕ C ⊥ )
−m1

• α1 ◦ g1 : w1

p−val p (g0 ) λ

−→

−→

A∨
↑
(A/(C ⊕ C ⊥ ))∨ ;

Λ11 /Λ11 → (εA[w1∞ ]/C1 )(S) is the homomorphism making

62

the following diagram commute
−m1

w1

Λ11 /Λ11
↓
−m1
w1 g1 Λ11 /g1 Λ11
↓
−m1
w1 Λ11 /g1 Λ11
↑
−m1
w1 Λ11 /Λ11

εA[w1∞ ]/C1 (S)
↓
m
∞
−→ (εA[w1 ]/C1 )[w1 1 ](S)
↓
m1
−→
(εA[w1 ]/C1 )(S)
↑
α1
m1
εA[w1 ](S);
−→
−→

−m

• for i > 1, αi ◦ gi : wi i Λi /Λi → A[wi∞ ]/Ci is the homomorphism making
the following diagram commute
−mi

wi

Λi /Λi
↓
−m
wi i gi Λi /gi Λi
↓
−mi
wi Λi /gi Λi
↑
−mi
wi Λi /Λi

A[wi∞ ]/Ci
↓
∼
m
∞
−→ (A[wi ]/Ci )[wi i ]
↓
∼
mi
−→
A[wi ]/Ci
↑
αi
−→
A[wimi ].

−→

It is tedious but straightforward to check that this does define an action.
We see that (p−2 , p−1 , ..., p−1 ) acts in the same way as p ∈ G(A∞,p ) and so
acts invertibly on the inverse system. Thus this definition can be extended to
the whole of G(Qp ). We also see that on the generic fibre (i.e. over Fw ) this
definition (when it makes sense) agrees with the action previously defined. (A
less tedious argument is to first note that this definition coincides with the
previously defined action on the generic fibre and then use the fact that the
generic fibre is Zariski dense in XU p ,m to check that first two assertions. That
the generic fibre is indeed dense follows at once from lemma 5.1 below.)
We remark that the lisse Qlac sheaf Lξ can be defined over the whole of
XU p ,m in exactly the same manner it was defined over the generic fibre XU p (m) .
If g ∈ G(A∞ ) maps XU p ,m to X(U p ) ,m then again ξ(gl ) induces a morphism of
sheaves
g : g ∗ Lξ −→ Lξ
over XU p ,m .
We next establish some important pieces of notation. We will let A/XU p ,m
denote the universal abelian variety. If A/S is an abelian scheme and if i :
63

OB → End (A/S) ⊗Z Z(p) then we will let GA denote the Barsotti-Tate OF,w module εA[w∞ ]. We will simply use G/XU p ,m to denote GA . If s is a closed
geometric point of XU p ,m we will let h(s) denote the height of Gset . We will
[h]
let X U p ,m denote the reduction XU p ,m ×Spec OF,w Spec k(w). We will let X U p ,m
denote the reduced closed subscheme of X U p ,m which is the closure of the set
of closed geometric points s with h(s) ≤ h. We will also let
(h)

[h]

[h−1]

X U p ,m = X U p ,m − X U p ,m .
The action of G(A∞ ) on the inverse system of the XU p ,m takes the inverse
(h)
system of locally closed subschemes X U p ,m to itself (because they are defined
in an invariant manner).
Lemma 5.1 Throughout this lemma we suppose that U p is sufficiently small.
Suppose also that m1 = 0 and that mi = mi for i > 1. Let s be a closed point
∼
of X U p ,m ×Spec k(w) k(w)ac and fix an isomorphism Gs0 → ΣFw ,n−h(s) .
1. The formal completion of XU p ,m ×Spec OF,w Spec OFwnr at s is isomorphic
to the universal formal deformation space for the Barsotti-Tate OF,w module Gs . Thus we get an identification
(XU p ,m ×Spec OF,w Spec OFwnr )∧s ∼
= Hom (T Gs , ΣFw ,n−h(s) );
(h(s))

while (X U p ,m ×Spec k(w) Spec k(w)ac )∧s is identified to the closed formal
subscheme
Hom (T Gs , ΣFw ,n−h(s) ) ⊂ Hom (T Gs , ΣFw ,n−h(s) ).
(h)

2. XU p ,m /Spec OF,w is smooth. Moreover each X U p ,m /Spec k(w) is either
empty or smooth of dimension h.
3. The closed points of X U p ,m ×Spec k(w) k(w)ac above s are in natural bijection with the surjective homomorphisms
→ Gset [wm1 ](k(s)).
δ : w−m1 Λ11 /Λ11 →
We will write sδ for the point corresponding to δ. Then we can identify
the formal completion of XU p ,m ×Spec OF,w Spec OFwnr at sδ with
Hom (w−m1 T Gs , ΣFw ,n−h(s) ) ×Spf RFw ,n−h(s) Spf RFw ,n−h(s),m1 ,
64

such that the morphism
(XU p ,m ×Spec OF,w Spec OFwnr )s∧δ −→ (XU p ,m ×Spec OF,w Spec OFwnr )s∧
corresponds to the natural morphism
Hom (w−m1 T Gs , ΣFw ,n−h(s) ) ×Spf RFw ,n−h(s) Spf RFw ,n−h(s),m1
↓
Hom (T Gs , ΣFw ,n−h(s) ).
(h(s))

Moreover the formal completion of X U p ,m at sδ corresponds to the closed
formal subscheme Hom (w−m1 T Gs , ΣFw ,n−h(s) ) inside
Hom (w−m1 T Gs , ΣFw ,n−h(s) ) ×Spf RFw ,n−h(s) Spf RFw ,n−h(s),m1 .
4. XU p ,m /OF,w is regular and flat.
(h)

(h)

(h)

5. X U p ,m /k(w) is smooth and the morphism X U p ,m → X U p ,m is finite and
flat of degree #GLn (OF,w /wm1 )/#GLn−h (OF,w /wm1 ).
6. Suppose that (U p ) ⊂ U p and that for all i we have mi ≥ mi . Then the
natural morphism
X(U p ) ,m −→ XU p ,m
is finite and flat of degree
r
p

r
m
#GLn (OF,wi /wi i

p

[U : (U ) ]
i=1

OF,wi )/(

m

i=1

#GLn (OF,wi /wi i OF,wi )).

If m1 = m1 then this morphism is in fact etale.
Proof: First of all it is standard that (XU p ,m ×Spec OF,w Spec OFwnr )∧s is the
formal deformation space for (r + 2)-tuples deforming (As , λs , is , αi,s ) (where
i > 1). By the Serre-Tate theorem this is the same as deformations of the
∼
(r + 2)-tuple (As [p∞ ], λs , is , αi,s ). As λ : As [u∞ ] → As [(uc )∞ ] we see that this
is the same as deformations of the (r + 1)-tuple (As [u∞ ], is , αi,s ). As As [wi∞ ]
is ind-etale for i > 1 it has a unique deformation over any Artinian local ring
with residue field k(s) as does αi,s . Thus we need only consider deformations
of the pair (As [w∞ ], is ). As OB,w ∼
= Mn (OF,w ) this is the same as deformations
∞
of Gs = εAs [w ] with its OF,w -action. This proves the first assertion of the
lemma.
65

The rest of the first part of the lemma follows from the discussion before
lemma 2.3 and from corollary 2.4. The second part of the lemma follows from
the first.
The first assertion of the third part of the lemma follows from lemma 3.1.
(h(s))
The second assertion follows from the discussion proceeding lemma 3.2. X U p ,m
(h(s))

can be constructed as the reduced subscheme of the fibre product of X U p ,m
(h(s))

and XU p ,m over XU p ,m . Thus (X U p ,m )∧sδ is the reduced formal subscheme
of the fibre product over Hom (T Gs , ΣFw ,n−h(s) ) of Hom (T Gs , ΣFw ,n−h(s) ) and
Hom (w−m1 T Gs , ΣFw ,n−h(s) ) ×Spf RFw ,n−h(s) Spf RFw ,n−h(s),m1 . (Here we make use
(h(s))

of lemma 2.6.) Hence (X U p ,m )s∧δ is the reduced formal subscheme of
Hom (w−m1 T Gs , ΣFw ,n−h(s) ) ×Spf RFw ,n−h(s) Spf RFw ,n−h(s),m1 ,

i.e. Hom (w−m1 T Gs , ΣFw ,n−h(s) ).
The fourth part now follows on applying proposition 4.3 of [Dr] because
both these properties can be detected on formal completions at closed points.
∧
= dim A,
(If A is a noetherian local ring with maximal ideal m then dim Am
∧
∧ 2
∧
2 ∼
m/m → m /(m ) and Am /A is faithfully flat.) As for the fifth part, finiteness
follows from lemma 3.1. Smoothness and flatness follow from the computation
of the formal completions. The degree can also be computed on formal com(h)
pletions: suppose that s is a closed point of X U p ,m × Spec k(w)ac . The number
(h)

of closed points of X U p ,m × Spec k(w)ac above s is the number of surjective
homomorphisms from (OF,w /wm1 )n to (OF,w /wm1 )h . If sδ is one of these points
(h)
(h)
the degree of (X U p ,m × Spec k(w)ac )∧sδ over (X U p ,m × Spec k(w)ac )∧s is the rank
(h)

(h)

of ΣFh w ,n−h [wm1 ]. Thus the degree of X U p ,m over X U p ,m is

(#OF,w /wm1 )h(n−h) (#GLn (OF,w /wm1 )/#GLn (OF,w /wm1 )δ ) =
= #GLn (OF,w /wm1 )/#GLn−h (OF,w /wm1 ).
We can divide the proof of the sixth part into two cases: the case where
m1 = m1 and the case where U p = (U p ) and mi = mi for i > 1. In the
second of these two cases it is standard the morphism is etale of the stated
degree. In the first case it follows from lemma 3.2. ✷
(We remark that one can use the results of Drinfeld’s paper [Dr] to show
[h]
that in fact if m1 = 0 then X U p ,m is smooth. We will not give details here as
we will not need this result. It seems to us an interesting question whether
this remains true for m1 > 0.)
The next lemma will be proved in section 8 below.
66

(0)

Lemma 5.2 The scheme X U p ,m is non-empty.
As a first application of this lemma we have the following corollary.
(h)

Corollary 5.3 The scheme X U p ,m for h = 0, ..., n − 1 is smooth of pure dimension h.
As a second application we now provide the postponed proof of lemma 3.5.
Proof of lemma 3.5: Choose a totally real field F + with a place w above
p such that Fw+ ∼
= K and choose an imaginary quadratic field E in which p
splits. We may then choose u, B, ∗, τ0 , β and Λi as in section 1 and such
that dimF B = g 2 . Also choose a sufficiently small open compact subgroup
U p ⊂ G(A∞,p ). Let
Xm = XU p ,(m,0,...,0) ×Spec OF,w Spec OFwnr
and let x be any closed point of
(g)

X U p ,(0,0,...,0) ×Spec k(w) Spec k(w)ac ⊂ X0 .
(The existence of x follows from the last lemma.) That the collection of the
Xm and the x follows from lemma 5.1. ✷
Now let Φi denote the vanishing cycles for X U p ,m ⊂ XU p ,m . Then we have
a spectral sequence
H i (X U p ,m × k(w)ac , Φj ⊗ Lξ ) ⇒ H i+j (XU p ,m × Fwac , Lξ ).
(See lemma II.2.) If (g, σ) ∈ G(A∞ ) × WFw then we have a natural map
(g, σ) : (g × Frobw(σ)
)∗ Φj = (g ◦ (F r∗ )f1 w(σ) × 1)∗ Φj ⊗ Lξ −→ Φj ⊗ Lξ .
w
Thus we get a smooth/continuous action of G(A∞ ) × WFw on
lim H i (X U p ,m × k(w)ac , Φj ⊗ Lξ )

→U p ,m

which is compatible with the action on H i+j (X, Lξ ) and the above spectral
sequence.
For any 0 < h ≤ n − 1 we get a long exact sequence (see for example [FK]
I.8.7 (3))
(h)

[h]

... −→ Hci (X U p ,m × k(w)ac , Φj ⊗ Lξ ) −→ H i (X U p ,m × k(w)ac , Φj ⊗ Lξ ) −→
[h−1]
−→ H i (X U p ,m × k(w)ac , Φj ⊗ Lξ ) −→ ...
Combining these two observations we obtain the following lemma.
67

Lemma 5.4 Suppose that for each 0 ≤ h ≤ n − 1, 0 ≤ i ≤ 2h and 0 ≤
(h)
j ≤ n − 1 the G(A∞ ) × WFw -module lim→U p ,m Hci (X U p ,m × k(w)ac , Φj ⊗ Lξ ) is
admissible/continuous. Then the same is true for each lim→U p ,m H i (X U p ,m ×
k(w)ac , Φj ⊗ Lξ ) and we have an equality of virtual G(A∞ ) × WFw -modules
(h)

×

i

(−1)i [H i (X, Lξ )Zp ] =

i,j,h

Hci (X U p ,m × k(w)ac , Φj ⊗ Lξ )].
(−1)i+j [ lim
p
→U ,m

We wish to further analyse the structure of X U p ,m . For s a closed point of
let Ms denote the kernel of the composite

(h)
X U p ,m

α1 : w−m1 Λ11 /Λ11 −→ Gs [w1m1 ](k(s)) −→ Gset [w1m1 ](k(s)).
Then Ms is a direct summand of w−m1 Λ11 /Λ11 which is free over OF,w /wm1 of
(h)
rank (n − h). The function s → Ms is locally constant on X U p ,m . (Suppose
that H is a finite abelian group, that S is a connected scheme and that F is
a lisse etale sheaf on S. If α : HS → F is a morphism of etale sheaves then
there is a subgroup H ⊂ H such that ker α = HS (cf page 49 of [KM]).) Thus
we have a decomposition
(h)

X U p ,m,M ,

X U p ,m =
M

where M runs over free OF,w /wm1 -submodules of w−m1 Λ11 /Λ11 of rank n − h
op ×
and where Ms = M for s a closed point of X U p ,m,M . If g ∈ (OB,w
) then g
gives an isomorphism
∼

g : X U p ,m,M −→ X U p ,m,g−1 M .
The following lemma follows at once (using lemma 5.1).
(h)

Lemma 5.5 Suppose that m1 = 0 and mi = mi for i > 1. Then X U p ,m ,M is
(h)

(h)

smooth of dimension h and X U p ,m ,M /X U p ,m is finite flat of degree
#PM (OF,w /wm1 )/#GLn−h (OF,w /wm1 ) =
= #(OF,w /wm1 )h(n−h) #GLh (OF,w /wm1 ).
Now suppose that M ⊂ Λ11 is a OF,w -submodule which is both a direct
summand and free of rank n − h. We will let PM ⊂ Aut (Λ11 ) denote the
maximal parabolic subgroup which stabilises M . Then we will set
r
∞

GM (A ) = G(A

∞,p

)×

Q×
p
68

× PM (Fw ) ×

(Bwopi )× .
r=2

We will also set
X U p ,m,M = X U p ,m,w−m1 M/M .
For fixed M the inverse system of the X U p ,m,M inherits an action of GM (A∞ ).
Then
Hci (X U p ,m,M × Spec k(w)ac , Φj ⊗ Lξ )
Hci (X M , Φj ⊗ Lξ ) = lim
p
→U ,m

is a smooth/continuous GM (A∞ ) × WFw -module.
We will next describe a natural map
(Oop /wm1 )×

i
ac
j
p
Ind PMB,w
(OF,w /wm1 ) Hc (X U ,m,M × Spec k(w) , Φ ⊗ Lξ )
↓
(h)
i
Hc (X U p ,m × Spec k(w)ac , Φj ⊗ Lξ ).
(Oop /wm1 )×

i
ac
j
p
A typical element of Ind PMB,w
(OF,w /wm1 ) Hc (X U ,m,M × Spec k(w) , Φ ⊗ Lξ ) is
represented by a function
op
f : (OB,w
/wm1 )× −→ Hci (X U p ,m,M × Spec k(w)ac , Φj ⊗ Lξ )

such that
f (γg) = γf (g)
op
for all γ ∈ PM (OF,w /wm1 ) and all g ∈ (OB,w
/wm1 )× . We map f to
op
(#PM (OF,w /wm1 )/#(OB,w
/wm1 )× )

g −1 f (g).
op
/wm1 )×
g∈PM (OF,w /wm1 )\(OB,w

op ×
This map is easily checked to be a well defined isomorphism of (OB,w
) modules.
Similarly we can define a natural map
(B op )×

(h)

Hci (X U p ,m × Spec k(w)ac , Φj ⊗ Lξ )
Ind PMw(Fw ) Hci (X M , Φj ⊗ Lξ ) −→ lim
p
→U ,m

(B op )×

as follows. A typical element of Ind PMw(Fw ) Hci (X M , Φj ⊗ Lξ ) is represented by
a locally constant function
f : (Bwop )× −→ Hci (X M , Φj ⊗ Lξ )
such that
f (γg) = γf (g)
69

for all γ ∈ PM (Fw ) and all g ∈ (Bwop )× . We map f to
op ×
PM (FW )/(Bw
)

g −1 f (g)dg,

where we choose Haar measures to give PM (Fw )/(Bwop )× volume 1, and where
the integral makes sense as it is in fact a finite sum (as f is locally constant and
PM (FW )/(Bwop )× is compact). This is a morphism of G(A∞ ) × WFw -modules.
Lemma 5.6 Suppose that Hci (X M , Φj ⊗Lξ ) is an admissible GM (A∞ )-module.
Then the above map gives an isomorphism of G(A∞ ) × WFw -modules
(B op )×

(h)

Hci (X U p ,m × Spec k(w)ac , Φj ⊗ Lξ ).
Ind PMw(Fw ) Hci (X M , Φj ⊗ Lξ ) −→ lim
p
→U ,m

(h)

In particular Hci (X U p ,m ×Spec k(w)ac , Φj ⊗Lξ ) is an admissible G(A∞ )×WFw module.
op ×
Proof: Recall the Iwasawa decomposition (Bwop )× = PM (Fw )(OB,w
) . It
follows that
op
op
→ PM (OF,w /wm1 )\(OB,w
PM (Fw )\(Bwop )× ∼
/wm1 )× .
= PM (OF,w )\(OB,w )× →

This gives rise to maps
(Oop /wm1 )×

i
ac
j
p
Ind PMB,w
(OF,w /wm1 ) Hc (X U ,m,M × Spec k(w) , Φ ⊗ Lξ )
↓
op ×
(Bw
)
i
Ind PM (Fw ) Hc (X M , Φj ⊗ Lξ )

which are compatible with the maps
(h)

Hci (X U p ,m × Spec k(w)ac , Φj ⊗ Lξ )
↓
(h)
i
lim→U p ,m Hc (X U p ,m × Spec k(w)ac , Φj ⊗ Lξ ).
As each of the maps
(Oop /wm1 )×

ac
j
i
p
Ind PMB,w
(OF,w /wm1 ) Hc (X U ,m,M × Spec k(w) , Φ ⊗ Lξ )
↓
(h)
i
Hc (X U p ,m × Spec k(w)ac , Φj ⊗ Lξ ).

70

is an isomorphism, the lemma will follow on passing to the limit as long as we
can check that the map
(Oop /wm1 )×

i
j
ac
p
lim→U p ,m Ind PMB,w
(OF,w /wm1 ) Hc (X U ,m,M × Spec k(w) , Φ ⊗ Lξ )
↓
op ×
)
(Bw
i
Ind PM (Fw ) Hc (X M , Φj ⊗ Lξ )

is an isomorphism. Injectivity is straightforward. As for surjectivity any f ∈
(B op )×
Ind PMw(Fw ) Hci (X M , Φj ⊗ Lξ ) being locally constant factors through one of the
op
finite quotients PM (OF,w /wm1 )\(OB,w
/wm1 )× . Then f will be in the image of
Ind

op
/wm1 )×
(OB,w

PM (OF,w /wm1 )

Hci (X U p ,m ,M × Spec k(w)ac , Φj ⊗ Lξ ) for some U p and m . ✷

Putting together the analysis of this section we obtain the following proposition.
Proposition 5.7 For h = 0, ..., n − 1 choose a direct summand Mh ⊂ Λ11
of rank n − h. Suppose that for each 0 ≤ h ≤ n − 1, 0 ≤ j ≤ n − 1 and
0 ≤ i ≤ 2h the GMh (A∞ )-module Hci (X Mh , Φj ⊗ Lξ ) is admissible. Then we
have an equality of virtual G(A∞ ) × WFw -modules
(B op )×

×

[H(X, Lξ )Zp ] =

h,j,i

(−1)n−1+i+j Ind PMw (Fw ) [Hci (X Mh , Φj ⊗ Lξ )].
h

(h)

We will let (XU p ,m )∧ (resp. XU∧p ,m,M ) denote the formal completion of
(h)

XU p ,m along the locally closed subscheme X U p ,m (resp. X U p ,m,M ). The comparison theorem of [Berk3] implies that Φi |X (h)p (resp. Φi |X U p ,m,M ) coincides with
U ,m

(h)
(h)
the formal vanishing cycles for X U p ,m ⊂ (XU p ,m )∧ (resp. X U p ,m,M ⊂ XU∧p ,m,M )
(h)
(see appendix II). In terms of G/X U p ,m (resp. G/X U p ,m,M ) the formal com-

pletion is completely characterised by the following useful universal property.

Lemma 5.8 Suppose that X is a locally noetherian OF,w -formal scheme and
assume p = 0 on X red . Suppose also that H/X is a Barsotti-Tate OF,w -module
and that γ is a Drinfeld wm1 -structure on H/X . Moreover suppose that we
(h)
are given a morphism f : X red → X U p ,m (resp. X U p ,m,M ) under which G with
its canonical Drinfeld wm1 -structure pulls back to H|X red with the Drinfeld
wm1 -structure γ|X red . Then there is a unique extension of f to a morphism
f : X → XU∧p ,m,M under which G with its canonical Drinfeld wm1 -structure
pulls back to H and γ respectively.
71

Proof: Let (A, λ, i, η p , αi ) be the pull back to X red of the universal object
over XU p ,m . Exactly as in the first paragraph of the proof of lemma 5.1 we see
that deformations of (A, λ, i, η p , αi ) to X are in natural bijection with the deformations of (f ∗ G, f ∗ α1 ). Thus we have a unique deformation (A , λ , i , (η p ) , αi )
over X of (A, λ, i, η p , αi ) which gives rise to (H, γ). Thus we have a unique
morphism f : X → XU p ,m such that the universal (r + 4)-tuple pulls back to
(A , λ , i , (η p ) , αi ). This morphism restricts on X red to f and so must factor
through XU∧p ,m,M . We see that f is also the unique such morphism extending
f under which (G, α1 ) pulls back to (H, γ). ✷

6

Igusa varieties of the first kind

In our setting there seem to be two natural analogues of the familiar Igusa
curves in the theory of elliptic modular curves. We will call these Igusa varieties
of the first and second kind. When we speak of these Igusa varieties we will
refer only to the analogue of the ordinary locus on the usual Igusa curves. We
have not looked at the question of whether our Igusa varieties admit natural
smooth compactifications, although we feel this is a natural and interesting
question. In the case of elliptic modular curves, the Weil pairing on the pdivisible group of an elliptic curve allows one to identify these two kinds of
Igusa variety.
In this section we introduce the more naive notion of Igusa variety of the
first kind in the context of the Shimura varieties we are studying. To this end
r
fix an integer h in the range 0 ≤ h ≤ n − 1. Also if m = (m1 , ..., mr ) ∈ Z≥0
then let m denote (0, m2 , ..., mr ).
(h)
(h)
By an Igusa variety of the first kind IU p ,m /X U p ,m we shall mean the mod∼
uli space for isomorphisms α1et : (w−m1 OF,w /OF,w )h (h) → G et [wm1 ]. Thus
X U p ,m

(h)
(h)
IU p ,m /X U p ,m

is Galois (and in particular finite etale, but not necessarily con(h)

(h)

nected) with Galois group GLh (OF,w /wm1 ). The morphism IU p ,m → X U p ,m
(h)
factors naturally through IU p ,m if m1 < m1 and mi = mi for i > 1. The
(h)

inverse system of the IU p ,m has a natural action of G(A∞,p ) × GLh (OF,w ) ×
r
op
×
i=2 (OB,wi ) .
Let (Z × GLh (Fw ))+ denote the sub-semigroup of elements (c, g) ∈ Z ×
GLh (Fw ) such that w to the integral part of −c/(n − h) times g is inte(h)
gral. Then the inverse system of the IU p ,m has an action of G(A∞,p ) × Q×
p ×
(Z × GLh (Fw ))+ × ri=2 (Bwopi )× extending that of G(A∞,p ) × GLh (OF,w ) ×
72

r
op
×
∞,p
) to the reader. First suppose
i=2 (OB,wi ) . We leave the action of G(A
et
×
+
that (g0 , c, g1 , gi ) ∈ Qp × (Z × GLh (Fw )) × ri=2 (Bwopi )× also satisfies
op
op
• for i > 1 we have gi−1 ∈ OB,w
and g0−1 gi ∈ OB,w
,
i
i

• (g1et )−1 ∈ Mh (OF,w ) and g0−1 g1et ∈ Mh (OF,w ),
• (n − h)w(g0 ) ≤ c ≤ 0,
mi −mi

• for i > 1 we have wi
m −m1 et
g1

• w1 1

op
gi ∈ OB,w
,
i

∈ Mh (OF,w ).

Under these assumptions we will define a morphism
(h)

(h)

(g0 , c, g1et , gi ) : IU p ,m −→ IU p ,m .
It will send (A, λ, i, η p , α1et , αi ) to (A/(C ⊕ C ⊥ ), pval p (g0 ) λ, i, η p , α1et ◦ g1et , αi ◦ gi ),
where we have set
• C1 ⊂ εA[w1m1 ] is the unique closed subscheme for which there is an exact
sequence
h
(0) −→ ker F −f1 c −→ C1 −→ α1et (Fwh /OF,w
[(g1et )−1 ]) −→ (0),

(this makes sense as if d denotes the integral part of −c/(n − h) then
h
d
h
et −1
0
ker F −f1 c ⊃ GA
[wd ] and Get
A [w ] ⊃ α(Fw /OF,w [(g1 ) ]) (we are using the
+
fact that (c, g1 ) ∈ (Z × GLh (Fw )) ));
• for i > 1, Ci = αi (gi Λi /Λi );
n
⊗OF,w C1 ) ⊕
• C = (OF,w

r
i=2

Ci ⊂ A[u−val p (g0 ) ];

• C ⊥ is the annihilator of C ⊂ A[u−val p (g0 ) ] inside A[(uc )−val p (g0 ) ] under
the λ-Weil pairing;
• pval p (g0 ) λ is the polarisation A/(C ⊕ C ⊥ ) → (A/(C ⊕ C ⊥ ))∨ which makes
the following diagram commute
A
↓
A/(C ⊕ C ⊥ )

p−val p (g0 ) λ

−→

−→
73

A∨
↑
(A/(C ⊕ C ⊥ ))∨ ;

−m1

• α1et ◦ g1et : (w1

OF,w /OF,w )h(h)

IU p ,m

→ (εA[w1∞ ]/C1 )et is the homomorphism

making the following diagram commute
−m1

OF,w /OF,w )h
↓
−m1 et h
h
w1 g1 OF,w /g1et OF,w
↓
−m1 h
h
w1 OF,w /g1et OF,w
↓
−m1 h
h
w1 OF,w /g1et OF,w
↑
(w1

(w1−m1 OF,w /OF,w )h

(εA[w1∞ ]/C1 )et
↑
m
∞
−→
(εA[w1 ]/C1 )et [w1 1 ]
↓
m1
(εA[w1 ]/C1 )et
−→
↓
m1 et
et
−→ εA[w1 ] /α1 ((Fw /OF,w )h [(g1et )−1 ])
↑
−→

αet

εA[w1m1 ]et ;

1
−→

−m

• for i > 1, αi ◦ gi : wi i Λi /Λi → A[wi∞ ]/Ci is the homomorphism making
the following diagram commute
−mi

Λi /Λi
↓
−mi
wi gi Λi /gi Λi
↓
−mi
wi Λi /gi Λi
↑
−mi
wi Λi /Λi
wi

A[wi∞ ]/Ci
↑
∼
m
∞
−→ (A[wi ]/Ci )[wi i ]
↓
∼
mi
−→
A[wi ]/Ci
↑
αi
A[wimi ].
−→
−→

It is tedious but straightforward to check that this does define an action.
We see that (p−2 , p−1 , ..., p−1 ) acts in the same way as p ∈ G(A∞,p ) and so acts
invertibly on the inverse system. Thus this definition can be extended to the
whole of Qp× × (Z × GLh (Fw ))+ × ri=2 (Bwopi )× . (A less tedious argument is
to use the compatibility described below with the action of G(A∞,p ) × Q×
p ×
r
op ×
PM (Fw ) × i=2 (Bwi ) on the inverse system of the X U p ,m,M .)
We will denote by Fr∗
We see that

f1

+
the element (p−f1 , −1, 1) ∈ Q×
p × (Z × GLh (Fw )) .

∗
+
×
1. Q×
p × Z × GLh (Fw ) is generated by Qp × (Z × GLh (Fw )) and Fr

2. Fr∗

f1

(h)

(h)

−f1

;

: IU p ,m → I(U p ),m is just (Fr∗ )f1 . (Note that according to the

definitions above Fr∗

f1

(h)

does take I(U p ),m to itself.)
74

h
→ OF,w
Now fix j : Λ11 →
with kernel M . This induces a homomorphism

j∗ : PM (Fw ) →
→
Z × GLh (Fw )
g
−→ w ◦ det(g|M ) × j ◦ g ◦ j −1 ).
(h)

We will define a morphism j ∗ : IU p ,m → X U p ,m,M such that
j∗

(h)

−→

(h)

(Fr∗ )f1 (n−h)m1

IU p ,m
↓
X U p ,m

X U p ,m,M
↓

−→

(h)

X U p ,m

commutes. More precisely j ∗ is the map which takes (A, λ, i, η p , α1et , αi ) to
m f (n−h) )
m f (n−h) )
(A(p 1 1
, λ(p 1 1
, i, η p , α1 , F m1 f1 (n−h) ◦ αi ) where
α1 (x) = F m1 f1 (n−h) ◦ α1et ◦ j(x).
(To see that α1 is well defined and that it is a Drinfeld level structure use
(h)
lemma 3.1.) Because X U p ,m,M /X U p ,m is finite flat of degree
#(OF,w /wm1 )h(n−h) #GLh (OF,w /wm1 )
(see lemma 5.5), because X U p ,m,M is smooth and hence normal (see lemma
5.5), and because the composite
(Fr∗ )f1 (n−h)m1

(h)

(h)

−→

IU p ,m −→ X U p ,m

(h)

X U p ,m

is also finite flat of the same degree we see that j ∗ is an isomorphism.
r
op ×
Suppose that g ∈ G(A∞,p ) × Q×
p × PM (Fw ) ×
i=2 (Bwi ) and that j∗ (g) ∈
r
+
op ×
p
G(A∞,p ) × Q×
p × (Z × GLh (Fw )) ×
i=2 (Bwi ) . Suppose also that (U ) ⊃
−1 p
g U g. If for each i we have mi >> mi then
(h)
IU p ,m

j∗ (g)Fr∗

↓

f1 (n−h)(m1 −m1 )

−→
g

−→

X U p ,m,M

(h)

I(U p ) ,m
↓
X (U p ) ,m ,M

commutes.
We now look at natural formal extensions of these Igusa varieties. In
(h)
(h)
particular we will let (IU p ,m )∧ /(XU p ,m )∧ denote the unique etale covering with
(h)

(h)

reduced subschemes IU p ,m /X U p ,m (see [Berk2]). If t ∈ Z≥0 then we will let
(h)
(h)
(IU p ,m )∧ (t)/(IU p ,m )∧ denote the moduli space for Drinfeld wt -structures on
(h)
G/(IU p ,m )∧ .
75

(h)

(h)

Lemma 6.1
1. The natural morphism (IU p ,m )∧ (t) −→ (IU p ,m )∧ is finite
and flat of degree #GLn−h (OF,w /wt ).
(h)

(h)

2. (IU p ,m )∧ (t)/(IU p ,m )∧ (t) is the unique etale cover with reduced subschemes
(h)

(h)

IU p ,m /X U p ,m .
(h)

3. (IU p ,m )∧ (t) has the following universal property. Suppose that X is a
locally noetherian OF,w -formal scheme and assume p = 0 on X red . Suppose also that H/X is a Barsotti-Tate OF,w -module and that we are given
(h)
a morphism f : X red → IU p ,m under which G pulls back to H|X red . Then
we have an exact sequence
(0) → H0 → H → Het → (0)
over X , with H0 formal and Het ind-etale. Suppose finally that γ is a
Drinfeld wt -structure on H0 /X . Then there is a unique extension of f
(h)
to a morphism f : X → (IU p ,m )∧ under which G pulls back to H and the
(h)
canonical Drinfeld wt -structure on G/(IU p ,m )∧ (t) pulls back to γ.
Proof: The first part follows from corollary 3.3. The second part follows
because
∼
(h)
(h)
(h)
(IU p ,m )∧ (t) −→ (IU p ,m )∧ ×(I (h)p )∧ (IU p ,m )∧ (t).
U ,m

(h)

From the definition of (IU p ,m )∧ (t) the third part reduces to the special case
(h)
t = 0. In this case, by lemma 5.8, we obtain a unique morphism X → (IU p ,m )∧
under which G pulls back to H. The third part of the lemma now follows from
the following standard result (which in turn follows easily from, for instance,
proposition 1.1 of section I of [Arti]).
Lemma 6.2 Suppose that Z → Y is a finite etale morphism of locally noetherian formal schemes. Suppose that X is also a locally noetherian formal scheme
and that we have a commutative diagram
X red → X
↓
↓
Z −→ Y.
Then there is a unique diagonal morphism X → Z making the diagram still
commute.

76

✷
We will let (GLn−h (Fw ) × GLh (Fw ))+ denote the set of pairs (g 0 , g et ) in
GLn−h (Fw ) × GLh (Fw ) for which there exists a scalar a ∈ Fw× such that
both ag et ∈ Mh (OF,w ) and (ag 0 )−1 ∈ Mn−h (OF,w ). This is a subsemigroup
of GLn−h (Fw ) × GLh (Fw ). There is a natural homomorphism from
r

G(A∞,p ) × Q×
p × GLn−h (Fw ) × GLh (Fw ) ×
to

(Bwopi )×
i=2

r
∞,p

G(A

)×

Q×
p

× Z × GLh (Fw ) ×

(Bwopi )×
i=2

under which
(g p , gp,0 , gw0 , gwet , gwi ) −→ (g p , gp,0 , w(det gw0 ), gwet , gwi ).
We will denote this map g → [g]. Under this homomorphism
r

G(A

∞,p

)×

Q×
p

(Bwopi )×

+

× (GLn−h (Fw ) × GLh (Fw )) ×

i=2

is taken to
r

G(A
If

∞,p

)×

Q×
p

(Bwopi )× .

+

× (Z × GLh (Fw )) ×

i=2

is a uniformiser in OF,w then we will let
Fr∗

f1 (n−h)

= (1, p−f1 (n−h) ,

−1

, 1, 1)

in

r

G(A

∞,p

)×

Qp×

(Bwopi )× .

+

× (GLn−h (Fw ) × GLh (Fw )) ×

Then
[Fr∗

f1 (n−h)

] = Fr∗

f1 (n−h)

i=2

,

r
op ×
and G(A∞,p ) × Q×
p × GLn−h (Fw ) × GLh (Fw ) ×
i=2 (Bwi ) is generated
∞,p
×
semi-group by G(A ) × Qp × (GLn−h (Fw ) × GLh (Fw ))+ × ri=2 (Bwopi )×
−f1 (n−h)
∗

Fr

.

77

as a
and

(h)

The inverse system of the (IU p ,m )∧ (t) has a natural action of G(A∞,p ) ×
r
+
op ×
Q×
p ×(GLn−h (Fw )×GLh (Fw )) ×
i=2 (Bwi ) , which is compatible via [ ] with
the action of G(A∞,p ) × Qp× × (Z × GLh (Fw ))+ × ri=2 (Bwopi )× on the inverse
(h)
system of the IU p ,m . We will leave the action of G(A∞,p ) to the reader and
r
op ×
+
describe the action of Q×
p × (GLn−h (Fw ) × GLh (Fw )) ×
i=2 (Bwi ) . To this
end suppose that
r

(g0 , g10 , g1et , gi )

∈

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

(Bwopi )× ,
i=2

and that
op
op
and g0−1 gi ∈ OB,w
,
• for i > 1 we have gi−1 ∈ OB,w
i
i

• (g1et )−1 ∈ Mh (OF,w ) and g0−1 g1et ∈ Mh (OF,w ),
• g0−1 g10 ∈ Mn−h (OF,w ),
mi −mi

• for i > 1 we have wi
m −m1 et
g1

• w1 1

op
gi ∈ OB,w
,
i

∈ Mh (OF,w ),

Also choose a ∈ Z≥0 such that wa g1et ∈ Mh (OF,w ) and (wa g10 )−1 ∈ Mn−h (OF,w )
(if there is a choice, choose the maximal such a). Finally also suppose that
• wt−t +a g0 ∈ Mn−h (OF,w ).
We will define a morphism
(h)

(h)

(g0 , g10 , g1et , gi ) : (IU p ,m )∧ (t) −→ (IU p ,m )∧ (t ),
which extends

(h)

(h)

[(g0 , g10 , g1et , gi )] : IU p ,m −→ IU p ,m .
(h)

Let C 1 be the unique closed subscheme of G[wm1 ]/IU p ,m for which there is a
short exact sequence
0

h
[(g1et )−1 ]) −→ (0).
(0) −→ ker F −f1 w(det g1 ) −→ C 1 −→ α1et (Fwh /OF,w

To define the desired extension (g0 , g10 , g1et , gi ) of [(g0 , g10 , g1et , gi )] it suffices (by
(h)
the universal property of (IU p ,m )∧ (t )) to specify a lifting G of G/C1 from
(h)

(h)

IU p ,m to (IU p ,m )∧ (t) together with a Drinfeld wt -level structure on (G )0 .
78

We now explain the construction of G and the Drinfeld wt -structure on
(G )0 . To do so fix a uniformiser of OF,w . Note that we have an embedding
αet

1
G et [wa ] −→ G/G 0 [wa ].
(Fw /OF,w )h [(g1et )−1 ] −→

(By an embedding we mean a compatible system of embeddings over each
(h)
closed subscheme of (IU p ,m )∧ (t).) We also have a Drinfeld wt -structure −a α10
on (G/G 0 [wa ])0 . We set
G = (G/G 0 [wa ])/((

−a

n−h
[(wa g10 )−1 ])+α1et ((Fw /OF,w )h [(g1et )−1 ])).
α10 )(Fwn−h /OF,w

This does not depend on the choice of
composite of −a α10 with

. By corollary 3.3 we see that the

a g0
1

(w−t OF,w /OF,w )n−h → (w−t OF,w /OF,w )n−h /((Fw /OF,w )n−h [(wa g10 )−1 ])
gives a Drinfeld wt -structure on (G )0 . This Drinfeld wt -structure is also
independent of the choice of .
It is tedious but straightforward to check that this does define an action. We see that (p−2 , p−1 , ..., p−1 ) acts in the same way as p ∈ G(A∞,p )
and so acts invertibly on the inverse system. Thus this definition can be exr
+
op ×
tended to the whole of Q×
p × (GLn−h (Fw ) × GLh (Fw )) ×
i=2 (Bwi ) . (A
less tedious argument is to use the compatibility described below with the
r
op ×
action of G(A∞,p ) × Q×
p × PM (Fw ) ×
i=2 (Bwi ) on the inverse system of the
f1 (n−h)

(h)

maps (IU p ,m )∧ (t) to itself and defines a lifting
XU∧p ,m,M .) Note that Fr∗
of (Fr∗ )f1 (n−h) , which is analogous to the canonical lifting of Frobenius in the
theory of elliptic modular curves.
n−h
h
→ OF,w
→ OF,w
and j 0 : Λ11 →
Now fix homomorphisms j et : Λ11 →
such
et
0
et
that j ⊕ j is an isomorphism. Let M = ker j . These choices induce
homomorphisms define a Levi component L(j 0 ,j et ) ⊂ PM , i.e. the elements of
PM which also preserve ker j 0 . They also induce an isomorphism
∼

GLn−h (Fw ) × GLh (Fw )
(j 0 , j et )∗ : L(j 0 ,j et ) →
0
g
−→ (j ◦ g ◦ (j 0 )−1 , j et ◦ g ◦ (j et )−1 ).
If

is a uniformiser in OF,w , we will define a morphism
(j 0 , j et ,

(h)

)∗ : (IU p ,m )∧ (m1 ) −→ XU∧p ,m,M

which extends the morphism
(h)

(j et )∗ : IU p ,m −→ X U p ,m,M .
79

To define such a morphism it suffices (by lemma 5.8) to specify a deformation
of the pair
m f (n−h) )
(h)
, F m1 f1 (n−h) ◦ α1et ◦ j et )/IU p ,m
(G (p 1 1
(h)

m1 f1 (n−h) )

to (IU p ,m )∧ (m1 ). As a deformation of G (p
we have the identification

∼

G 0 [wm1 ] × G et [wm1 ] →
(x, y)
−→

we take G/G 0 [wm1 ]. Then

G/G 0 [wm1 ]
−m1
x + y.

As a deformation of F m1 f1 (n−h) ◦α1et ◦j et we take (α10 ◦j 0 )⊕(α1et ◦j et ). (Note that
m f (n−h) )
(h)
over IU p ,m we are identifying G (p 1 1
and G/G 0 [wm1 ] so that F m1 f1 (n−h) :
m f (n−h) )
corresponds to the natural projection G → G/G 0 [wm1 ].)
G → G (p 1 1
Lemma 6.3

1. The morphism (j 0 , j et ,

)∗ is an isomorphism.

r
op ×
2. Suppose that g ∈ G(A∞,p ) × Q×
p × L(j 0 ,j et ) ×
i=2 (Bwi ) and suppose that
0 et
∞,p
×
(j , j )∗ (g) ∈ G(A ) × Qp × (GLn−h (Fw ) × GLh (Fw ))+ × ri=2 (Bwopi )× .
Suppose also that (U p ) ⊃ g −1 U p g and that for each i we have mi >> mi .
Then
(h)

(IU p ,m )∧ (m1 )
↓
∧
XU p ,m,M

(j 0 ,j et )∗ (g)Fr∗

f1 (n−h)(m1 −m1 )

−→
g

−→

commutes, where the vertical maps are (j 0 , j et ,

(h)

(I(U p ) ,m )∧ (m1 )
↓
∧
X(U p ) ,m ,M
)∗ .

Proof: The second part is formal. To prove the first part we will verify
(h)
that XU∧p ,m,M has the same universal property as (IU p ,m,M )∧ (m1 ). That is we
will show that if X is a locally noetherian OF,w -formal scheme, if p = 0 on
X red , if H/X is a Barsotti-Tate OF,w -module, if f : X red → X U p ,m,M is a
morphism under which G pulls back to (H/H0 [wm1 ])|X red and if γ is a Drinfeld
wm1 -structure on H0 /X , then there is a unique extension of f to a morphism
(h)
f : X → (IU p ,m )∧ under which G pulls back to H/H0 [wm1 ] and the canonical
Drinfeld wt -structure α1 ◦ j 0 on G 0 /XU∧p ,m,M pulls back to −m1 γ. To see that
XU∧p ,m,M has this universal property we use lemma 5.8 and note that there is
a natural bijection between
• Drinfeld wm1 -structures γ on H0 /X
• and Drinfeld wm1 -structures δ : w−m1 Λ11 /Λ11 → (H/H0 [wm1 ])[wm1 ] over
X which restrict to α1 ◦ j et on X red .
80

This bijection sends δ to m1 δ ◦ (j 0 |−1
) and γ to −m1 γ ◦ j 0 + α1et , where
w−m1 M/M
α1et : (w−m1 Λ11 /Λ11 ) →
→ Het [wm1 ] is the unique lifting over X of the pull back
from XU∧p ,m,M to X red of α1 : (w−m1 Λ11 /Λ11 ) →
→ G[wm1 ]et . ✷
(h)

We will let Φi (t)/IU p ,m ×Spec k(w) Spec k(w)ac denote the formal vanishing
(h)
(h)
cycles for IU p ,m ⊂ (IU p ,m )∧ (t). (If t = m1 then it follows from the last lemma
(h)
that (IU p ,m )∧ (t) is isomorphic to the completion of a proper scheme of finite
type over OF,w along a locally closed subscheme of the special fibre. In gen(h)
(h)
eral (IU p ,m )∧ (t) is etale locally isomorphic to (IU p ,m )∧ (t) with m1 = t. Thus
(h)

Φi (t)/IU p ,m ×Spec k(w) Spec k(w)ac is well defined.)
Note that, if U p ⊃ (U p ) and for each i we have mi ≤ mi , then the re(h)
(h)
striction of Φi (t)/IU p ,m ×Spec k(w) Spec k(w)ac to I(U p ) ,m ×Spec k(w) Spec k(w)ac
(h)

is canonically isomorphic to Φi (t)/I(U p ) ,m ×Spec k(w) Spec k(w)ac (see [Berk3]).
(h)

Suppose that x is a closed point of IU p ,m × Spec k(w)ac and suppose that
∼
jx : Σn−h → Gx0 . Then we obtain a natural map
(h)

jx∗ : ((IU p ,m )∧ (t) ×Spf OF,w Spf OFwnr )∧x −→ Spf RFw ,n−h,t ,
and hence a homomorphism
(jx∗ )∗ : ΨjFw ,l,n−h,t −→ Φj (t)x .
Lemma 6.4
∼

(jx∗ )∗ : ΨFj w ,l,n−h,t → Φj (t)x .
Proof: We will let Spf R(Gx ) (resp. Spf Rt (Gx0 )) denote the universal deformation space for Gx (resp. Gx0 with its (unique) Drinfeld wt level structure).
Then we have
(h)
((IU p ,m )∧ (t) ×Spf OF,w Spf OFwnr )∧x ∼
= Spf R(Gx ) ×Spf R0 (Gx0 ) Spf Rt (Gx0 )
∼
→ Hom (T Gx , ΣFw ,n−h ) ×Spf RFw ,n−h Spf RFw ,n−h,t .

As Hom (T Gx , ΣFw ,n−h ) and Spf RFw ,n−h are formally smooth we see that
Hom (T Gx , ΣFw ,n−h ) ×Spf RFw ,n−h Spf RFw ,n−h,t −→ Spf RFw ,n−h,t
induces an isomorphism on vanishing cycles (see lemma II.4). The lemma
follows. ✷
81

The inverse system of sheaves
(h)

Φi (t)/IU p ,m ×Spec k(w) Spec k(w)ac
+
has an action of G(A∞,p )×Q×
p ×(GLn−h (Fw )×GLh (Fw )) ×
in the following sense. If

r
op ×
i=2 (Bwi ) ×WFw

r

(g, σ) ∈ G(A

∞,p

(h)

)×

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

i=2

(Bwopi )× × WFw

(h)

and if [g] : IU p ,m → I(U p ) ,m then for t >> t we get a natural map
(g, σ) : ([g] × (Frobw(σ)
)∗ )∗ Φ(t ) −→ Φ(t)
w
(h)

on IU p ,m × Spec k(w)ac .
We now wish to describe the action of (g, σ) on stalks. Thus let x be a closed
(h)
)∗ )x, a closed point of
point of IU p ,m × Spec k(w)ac and let y = ([g] × (Frobw(σ)
w
∼
(h)
I(U p ) ,m × Spec k(w)ac . Suppose also that jx : Σn−h → Gx0 . If δ ∈ DF×w ,n−h and
if w(det δ) = w(det gw0 ) − w(σ) then we will define
∼

([g] × (Frobw(σ)
)∗ × δ)(jx ) : ΣFw ,n−h → Gy0 .
w
To do so it suffices to give an isomorphism
0

(pf1 (w(det gw )−w(σ)) ) ∼

→ Gx0 .

ΣFw ,n−h

We simply take jx ◦ δ. We will write simply
jy = ([g] × (Frobw(σ)
)∗ × δ)(jx ),
w
but recall that it depends on a choice of δ. We see that, for t >> t ,
(h)

j∗

(h)

jy∗

x
((IU p ,m )∧ (t) ×Spf OF,w Spf OFwnr )∧x −→
Spf RFw ,n−h,t
↓
↓

((IU p ,m )∧ (t ) ×Spf OF,w Spf OFwnr )∧y −→ Spf RFw ,n−h,t

commutes (the left vertical arrow being g × (Frobw(σ)
)∗ and the right vertical
w
arrow (gw0 , δ)). Hence
Φj (t)x
↑

ΨFj w ,l,n−h,t

g×σ

←−
0 ,δ,σ)
(gw

←−
82

Φj (t )y
↑

ΨjFw ,l,n−h,t

also commutes (the left vertical arrow being (jx∗ )∗ and the right vertical arrow
w(σ) ∗
being (jy∗ )∗ = ([g] × (Frobw
) × δ)(jx )∗∗ ).
If we set
Hci (I (h) , Φj ⊗ Lξ ) =

(h)

lim Hci (IU p ,m ×Spec k(w) Spec k(w)ac , Φj (t) ⊗ Lξ ),

→U p ,m,t

then Hci (I (h) , Φj ⊗ Lξ ) becomes a smooth
r

G(A

∞,p

)×

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

i=2

(Bwopi )× × WFw

module. Then we have the following lemma.
Lemma 6.5

1. If Γt denotes the kernel of the homomorphism
GLn−h (OF,w ) →
→ GLn−h (OF,w /wt )

then for t ≤ t we have a canonical isomorphism
∼

Φi (t) −→ Φi (t )Γt .
2. The action of the semigroup
r
∞,p

G(A

)×

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

i=2

(Bwopi )× × WFw

on Hci (I (h) , Φj ⊗ Lξ ) is admissible/continuous.
Proof: The first part follows by calculating on stalks using isomorphisms
and the above compatibility. The second part follows from the first. ✷

(jx∗ )∗

We also have the following lemma which we will prove in the next section.
Lemma 6.6 Fr∗

f1 (n−h)

acts invertibly on each

(h)

Hci (IU p ,m ×Spec k(w) Spec k(w)ac , Φj (t) ⊗ Lξ ).
We are now in a position to prove the following result.

83

1. The action of the semi-group

Proposition 6.7

r

G(A

∞,p

)×

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

i=2

(Bwopi )× × WFw

on Hci (I (h) , Φj ⊗Lξ ) extends uniquely to an admissible/continuous action
of
r

G(A

∞,p

)×

Qp×

× GLn−h (Fw ) × GLh (Fw ) ×

2. If we fix a triple (j 0 , j et ,
smooth

i=2

(Bwopi )× × WFw .

) as above then we get an isomorphism of

r
op ×
∼
G(A∞,p ) × Q×
p × GLn−h (Fw ) × GLh (Fw ) ×
i=2 (Bwi ) × WFw =
r
×
∞,p
op ×
∼
= G(A ) × Qp × L(j 0 ,j et ) × i=2 (Bwi ) × WFw

modules

∼

Hci (I (h) , Φj ⊗ Lξ ) −→ Hci (X M , Φj ⊗ Lξ ).
3. The unipotent radical of PM (Fw ) acts trivially on
Hci (X M , Φj ⊗ Lξ ).
Proof: The first part follows from the lemma 6.6. For the second part we
consider the maps
Fr∗

f1 (n−h)m1

◦ ((j 0 , j et ,

(h)

)∗ )−1 : XU∧p ,m,M −→ (IU p ,m )∧ (m1 )

and the induced maps
(((j 0 , j et ,
from
to

)∗ )−1 )∗ ◦ (Fr∗

f1 (n−h)m1

)∗

(h)

Hci (IU p ,m ×Spec k(w) Spec k(w)ac , Φj (m1 ) ⊗ Lξ )
Hci (X U p ,m,M ×Spec k(w) Spec k(w)ac , Φj ⊗ Lξ ).

Combining lemmas 6.3 and 6.5 we see that these latter maps are isomorphisms.
Again by lemma 6.3 they are compatible as U p and m vary and give in the
limit an isomorphism
∼

Hci (I (h) , Φj ⊗ Lξ ) −→ Hci (X M , Φj ⊗ Lξ ).
84

That this isomorphism is compatible with
G(A∞,p ) × Qp× × GLn−h (Fw ) × GLh (Fw ) × ri=2 (Bwopi )× × WFw ∼
=
r
∼
= G(A∞,p ) × Qp× × L(j 0 ,j et ) × i=2 (Bwopi )× × WFw
actions again follows from lemma 6.3.
The final part follows from the second and from lemma I.1. ✷
n−h
→ OF,w
Corollary 6.8 For h = 0, ..., n − 1 choose homomorphisms jh0 : Λ11 →
h
such that jh0 ⊕ jhet is an isomorphism. Let Mh = ker jhet .
and jhet : Λ11 →
→ OF,w
Then we have an equality of virtual G(A∞ ) × WFw -modules
(B op )×

×

[H(X, Lξ )Zp ] =

7

h,j,i

(−1)n−1+i+j [Ind PMw (Fw ) Hci (I (h) , Φj ⊗ Lξ )].
h

Igusa varieties of the second kind

We now come to the slightly less obvious generalisation of Igusa curves. More
precisely we define the Igusa variety of the second kind,
(h)

(h)

JU p ,m,s = J (s) (G 0 /IU p ,m ).
(h)

(h)

Then JU p ,m,s /IU p ,m × Spec k(w)ac is Galois with group (ODFw ,n−h /ws )× (acting
on the right).
We will describe an action of the semigroup
r
+
G(A∞,p ) × Q×
p × (Z × GLh (Fw )) ×

i=2

(Bwopi )× × DF×w ,n−h

(h)

on the inverse system of the JU p ,m,s . Consider an element
r

(g

p

, gp,0 , c, gwet , gwi , δ)

∞,p

∈ G(A

)×Qp× ×(Z×GLh (Fw ))+ ×

i=2

(Bwopi )× ×DF×w ,n−h .

Choose a ∈ Fw× with c + (n − h) > (n − h)w(a) ≥ c. If (U p ) ⊃ (g p )−1 U p g p
and if for all i we have mi >> mi , then we let
(h)

(h)

(g p , gp,0 , c, gwet , gwi , δ) : IU p ,m × Spec k(w)ac −→ I(U p ) ,m × Spec k(w)ac
be the map
(g p , gp,0 , c, gwet , gwi ) × (Frob∗w )c−w(det δ) .
85

We will extend this to a compatible series of morphisms
(h)

(h)

(g p , gp,0 , c, gwet , gwi , δ) : JU p ,m,s −→ J(U p ) ,m ,s
for s > s . For this it suffices to give compatible isomorphisms
∼

((Frob∗w )c−w(det δ) ΣFw ,n−h )[ws ] → ((g p , gp,0 , c, gwet , gwi )∗ G 0 )[ws ]
(h)

over JU p ,m,s . First note that a−1 δ gives an isomorphism
∼

∗ c−w(det δ)
a−1 δ : (Frobw
)
ΣFw ,n−h → ΣFw ,n−h /ΣFw ,n−h [aF −f1 c ].

Also note that
∼

a : G 0 /G 0 [aF −cf1 ] → (g p , gp,0 , c, gwet , gwi )∗ G 0 .
Thus for our isomorphism
∼

((Frob∗w )c−w(det δ) ΣFw ,n−h )[ws ] → ((g p , gp,0 , c, gwet , gwi )∗ G 0 )[ws ]
we may simply take a−1 δ, followed by the map induced by the universal isomorphism
∼
ΣFw ,n−h [ws ] → G 0 [ws ]
(h)

over JU p ,m,s , in turn followed by a. It is straight forward but tedious to check
this is independent of the choice of a and does define an action.
f1

Note that the element (Fr∗ , 1) simply acts as (Fr∗ )f1 . (So for instance on
(h)
IU p ,m × Spec k(w)ac it acts as (Fr∗ )f1 = (Fr∗ )f1 × (Frob∗w )−1 .)
We will be most interested in the part of this action which is an action of
k(w)ac -schemes. To this end define
(DF×w ,n−h × GLh (Fw ))+
to be the set of elements
(δ, γ) ∈ DF×w ,n−h × GLh (Fw )
such that (w(det δ), γ) ∈ (Z × GLh (Fw ))+ . Also set
r

G(h) (A∞ ) = G(A∞,p ) × Qp× × DF×w ,n−h × GLh (Fw ) ×

86

(Bwopi )×
i=2

and
r
(h)

∞,p

∞ +

G (A ) = G(A

Q×
p

)×

×

(DF×w ,n−h

+

× GLh (Fw )) ×

(Bwopi )× .
i=2

If we embed G(h) (A∞ )+ into
r

G(A

∞,p

)×

Q×
p

+

× (Z × GLh (Fw )) ×

i=2

(Bwopi )× × DF×w ,n−h

by sending (g p , gp,0 , δ, gwet , gwi ) to (g p , gp,0 , w(det δ), gwet , gwi , δ), then G(h) (A∞ )
(h)
acts on the inverse system of the JU p ,m,s over k(w)ac . We note that this action
is compatible with w ◦ det : DF×w ,n−h −→ Z and the action of
r

G(A

∞,p

)×

Q×
p

(Bwopi )×

+

× (Z × GLh (Fw )) ×

i=2

(h)

on the inverse system of the IU p ,m .
If ρ is an irreducible admissible representation of DF×w ,n−h over Qac
l we get
(h)
a lisse etale sheaf Fρ /JU p ,m,s coming from the restriction of ρ to
×
ker(OD
−→ (ODFw ,n−h /ws )× ).
Fw ,n−h

If
r

(g

p

, gp,0 , c, gwet , gwi , δ)

∞,p

∈ G(A

defines a map

+
) × Q×
p × (Z × GLh (Fw )) ×

(h)

i=2

(Bwopi )× × DF×w ,n−h

(h)

JU p ,m,s −→ J(U p ) ,m ,s
then we obtain a morphism
(g p , gp,0 , c, gwet , gwi , δ) : (g p , gp,0 , c, gwet , gwi , δ)∗ (Fρ ⊗ Lξ ) −→ Fρ ⊗ Lξ .
Note moreover that
×
ker(OD
−→ (ODFw ,n−h /ws )×
Fw ,n−h
(h)

acts trivially on Fρ ⊗ Lξ over JU p ,m,s .
87

We remark that as a sheaf (without the action of any groups) Fρ only
depends on ρ up to twists by unramified characters. Thus Fρ ∼
= Fρ for some
ρ with finite image. The representation ρ can be thought of a representation
(h)
of the fundamental group of IU p ,m and hence defines a lisse etale sheaf over
(h)
(h)
IU p ,m which has base change to IU p ,m × Spec k(w)ac isomorphic to Fρ .
We will set
(h)

Hci (IU p ,m × Spec k(w)ac , Fρ ⊗ Lξ ).
Hci (I (h) , Fρ ⊗ Lξ ) = lim
p
→U ,m

Then Hci (I (h) , Fρ ⊗ Lξ ) has an admissible action of
r
∞,p

G(A

)×

Q×
p

+

× (Z × GLh (Fw )) ×

i=2

×
(Bwopi )× × (DF×w ,n−h /OD
)
Fw ,n−h

f1

and the element (Fr∗ , 1) acts trivially. Thus this action factors through the
surjection from
r
∞,p

G(A

)×

Q×
p

+

× (Z × GLh (Fw )) ×

i=2

×
(Bwopi )× × (DF×w ,n−h /OD
)
Fw ,n−h

×
to G(h) (A∞ )/COD
which sends
Fw ,n−h

(g p , gp,0 , c, gwet , gwi , δ)
to
(g p , gp,0 pf1 (w(det δ)−c) , δ, gwet , gwi ).
Thus we may and will consider Hci (I (h) , Fρ ⊗ Lξ ) as an admissible G(h) (A∞ )module. This is compatible with the action of G(h) (A∞ )+ on the inverse system
(h)
of the JU p ,m,s over k(w)ac .
×
Similarly the action of OD
on ΨjFw ,l,n−h,t (resp. ΨFj w ,l,n−h,t [ρ], where
Fw ,n−h
ρ is an irreducible admissible representation of DF×w ,n−h ) and on the inverse
(h)

system of the JU p ,m,s defines a sheaf F(ΨjFw ,l,n−h,t ) (resp. F(ΨjFw ,l,n−h,t [ρ])) on
(h)

each JU p ,m,s . If

r

(g

p

, gp,0 , c, gwet , gwi , δ)

defines a map

∈ G(A

∞,p

+
) × Q×
p × (Z × GLh (Fw )) ×

(h)

(h)

JU p ,m,s −→ J(U p ) ,m ,s ,
88

i=2

(Bwopi )× × DF×w ,n−h

and if
(δ, γ, σ) ∈ AFw ,n−h

defines a map

ΨFj w ,l,n−h,t −→ ΨjFw ,l,n−h,t

then we obtain a morphism (g p , gp,0 , c, gwet , gwi , (δ, γ, σ)) :
(g p , gp,0 , c, gwet , gwi , δ)∗ (F(ΨFj w ,l,n−h,t ) ⊗ Lξ ) −→ F(ΨFj w ,l,n−h,t ) ⊗ Lξ
(resp.
(g p , gp,0 , c, gwet , gwi , δ)∗ (F(ΨjFw ,l,n−h,t [ρ]) ⊗ Lξ ) −→ F(ΨFj w ,l,n−h,t [ρ]) ⊗ Lξ .)
Note moreover that
×
• ker(OD
−→ (ODFw ,n−h /ws )× ) acts trivially on F(ΨjFw ,l,n−h,t ) ⊗ Lξ
Fw ,n−h
(h)

and F(ΨFj w ,l,n−h,t [ρ]) ⊗ Lξ over JU p ,m.s ,

• that if Γt = ker(GLn−h (OF,w ) → GLn−h (OF,w /wt )) then
∼

F(ΨjFw ,l,n−h,t ) → F(ΨFj w ,l,n−h,t )Γt
and

∼

F(ΨFj w ,l,n−h,t [ρ]) → F(ΨFj w ,l,n−h,t [ρ])Γt ,

• and that

F(ΨjFw ,l,n−h,t ) =

ρ

F(ΨjFw ,l,n−h,t [ρ]),

where ρ runs over a set representatives of the inertial equivalence classes
of representations of DF×w ,n−h .
We will set
Hci (I (h) , F(Ψj ) ⊗ Lξ ) =

(h)

lim Hci (IU p ,m × Spec k(w)ac , F(ΨFj w ,l,n−h,t ) ⊗ Lξ )

→U p ,m,t

and
Hci (I (h) , F(Ψj [ρ])⊗Lξ ) =

(h)

lim Hci (IU p ,m ×Spec k(w)ac , F(ΨjFw ,l,n−h,t [ρ])⊗Lξ ).

→U p ,m,t

Then Hci (I (h) , F(Ψj ) ⊗ Lξ ) and Hci (I (h) , F(Ψj [ρ]) ⊗ Lξ ) have admissible actions
of
r
×
)∼
(Bwopi )× × (AFw ,n−h /OD
G(A∞,p ) × Qp× × (Z × GLh (Fw ))+ × i=2
=
Fw ,n−h
r
×
∞,p
+
op ×
∼
(B ) × GLn−h (Fw ) × WF .
= G(A ) × Q × (Z × GLh (Fw )) ×
p

i=2

89

wi

w

f1

Again the element (Fr∗ , 1) acts trivially. We see that
Hci (I (h) , F(Ψj ) ⊗ Lξ ) =

ρ

Hci (I (h) , F(Ψj [ρ]) ⊗ Lξ )

where again ρ runs over a set of representatives of the inertial equivalence
classes of representations of DF×w ,n−h .
One also has that
∼

Fρ ⊗ ΨjFw ,l,n−h,t (ρ) −→

δ∈∆[ρ]

δ ∗ F(Ψj [ρ]).

Hence
Hci (I (h) , Fρ ⊗ Lξ ) ⊗ ΨjFw ,l,n−h (ρ) ∼
= Hci (I (h) , F(Ψj [ρ]) ⊗ Lξ )e[ρ] ,
where the action of
(g p , gp,0 , c, gwet , gwi , γ, σ)
on Hci (I (h) , F(Ψj [ρ]) ⊗ Lξ )e[ρ] is compatible with the action of
(g p , gp,0 pf1 (w(det γ)−w(σ)−c) , δ, gwet , gwi ) ⊗ (γ, σ) ∈ G(h) (A∞,p ) × GLn−h (Fw ) × WFw
on Hci (I (h) , Fρ ⊗ Lξ ) ⊗ ΨFj w ,l,n−h (ρ), where δ ∈ DF×w ,n−h satisfies
w(det δ) = w(det γ) − w(σ).
We record this as the following lemma.
Lemma 7.1 We have a natural isomorphism
Hci (I (h) , F(Ψj ) ⊗ Lξ )n−h ∼
=

ρ

(Hci (I (h) , Fρ ⊗ Lξ ) ⊗ ΨjFw ,l,n−h (ρ))(n−h)/e[ρ]

under which the action of
(g p , gp,0 , c, gwet , gwi , γ, σ)
on Hci (I (h) , F(Ψj ) ⊗ Lξ ) is compatible with the action of
(g p , gp,0 pf1 (w(det γ)−w(σ)−c) , δ, gwet , gwi ) ⊗ (γ, σ) ∈ G(h) (A∞,p ) × GLn−h (Fw ) × WFw
on Hci (I (h) , Fρ ⊗ Lξ ) ⊗ ΨjFw ,l,n−h (ρ), where δ ∈ DF×w ,n−h satisfies
w(det δ) = w(det γ) − w(σ).
90

(h)

By a closed point x∞ of JU p ,m,∞ we shall mean a compatible system of
(h)
(h)
closed points xs of JU p ,m,s as s varies. If x is a closed point of IU p ,m ×Spec k(w)ac
then the following are equivalent
∼

• the choice of an isomorphism j : ΣFw ,n−h → Gx0
(h)

• and the choice a closed point x∞ of JU p ,m,∞ above x.
We will write jx∞ for the isomorphism corresponding to x∞ . Note that if
r

(g

p

, gp,0 , c, gwet , gwi )

∞,p

∈ G(A

)×

Q×
p

(Bwopi )× ,

+

× (Z × GLh (Fw )) ×

i=2

if δ ∈ DF×w ,n−h and if e = c − w(det δ) then
e ∗
((g p , gp,0 , c, gwet , gwi ) × (Frobw
) × δ)(jx∞ ) = j(gp ,gp,0 ,c,gwet ,gwi ,δ)x∞ .
(h)

(h)

If x∞ is a closed point of JU p ,m,∞ above a closed point x of IU p ,m ×
Spec k(w)ac then we set
F(ΨjFw ,l,n−h,t )x∞ = lim F(ΨFj w ,l,n−h,t )xs .
→s

We then have canonical isomorphisms (the composite depending on the choice
of x∞ above x)
∼

∼

F(ΨjFw ,l,n−h,t )x → F(ΨjFw ,l,n−h,t )x∞ → ΨjFw ,l,n−h,t .
Moreover for (g p , gp,0 , c, gwet , gwi , (δ, γ, σ)) in
r
∞,p

G(A

)×

Qp×

+

× (Z × GLh (Fw )) ×

i=2

(Bwopi )× × AFw ,n−h ,

for
and for

y = ((g p , gp,0 , c, gwet , gwi ) × (Frob∗w )c−w(det δ) )x
y∞ = (g p , gp,0 , c, gwet , gwi , δ)x∞

we have a commutative diagram
F(ΨjFw ,l,n−h,t )y
↓

F(ΨjFw ,l,n−h,t )y∞
↓
ΨjFw ,l,n−h,t

et ,g
(g p ,gp,0 ,c,gw
wi ,γ,σ)

−→

et ,g
(g p ,gp,0 ,c,gw
wi ,(δ,γ,σ))

−→

(δ,γ,σ)

−→
91

F(ΨjFw ,l,n−h,t )x
↓

F(ΨjFw ,l,n−h,t )x∞
↓
ΨjFw ,l,n−h,t .

The following proposition is of key importance for us. In the original
version of this paper we reduced its proof to an abstract result on formal vanishing cycles which Vladimir Berkovich kindly proved for us. This result with
Berkovich’s proof is reproduced in his appendix to this paper. In this version
of the paper we have found it simpler to incorporate Berkovich’s argument directly into this paper. Thus the latter half of the proof given below is entirely
due to to Berkovich.
Proposition 7.2 There is a unique homomorphism
κ : Φj (t) −→ F(ΨjFw ,l,n−h,t )
(h)

(h)

over IU p ,m × Spec k(w)ac such that if x∞ is a closed point of JU p ,m,∞ above a
(h)
closed point x of IU p ,m × Spec k(w)ac , then
κ : Φj (t)x −→ F(ΨFj w ,l,n−h,t )x
coincides with the inverse of the composite
(jx∗

)∗

∞
F(ΨjFw ,l,n−h,t )x −→ F(ΨjFw ,l,n−h,t )x∞ −→ ΨjFw ,l,n−h,t −→
Φj (t)x .

(h)

Proof: Because of the uniqueness it suffices to work locally on IU p ,m ×
(h)
Spec k(w)ac . Thus let W ⊂ IU p ,m × Spec k(w)ac be an open subset such that
(h)
W ∧ , the restriction of (IU p ,m )∧ (t) ×Spf OF,w Spf OFwnr to W , is affine. For any
(h)

positive integer s let Ws denote the pull back of W to JU p ,m,s and let Ws∧ /W ∧
denote the unique etale cover with reduced subschemes Ws /W .
Choose a lifting of W/k(w)ac to a smooth scheme of finite type Y /OFwnr .
Set
Y ∧ = YW∧ ×Spf OF nr Spf RFw ,n−h,t ,
w

and more generally
Ys∧ = (YW∧ )s ×Spf OF nr Spf RFw ,n−h,t ,
w

where (YW∧ )s /YW∧ is the unique etale cover with reduced subschemes Ws /W .
Also set
Y ∧ {N } = YW∧ ×Spf OF nr Spf RFw ,n−h,t /mN
Fw ,n−h,t ,
w

and more generally
Ys∧ {N } = (YW∧ )s ×Spf OF nr Spf RFw ,n−h,t /mN
Fw ,n−h,t .
w

92

Note also that the formal vanishing cycles for Ys∧ are just the constant sheaves
ΨjFw ,l,n−h,t .
Choose N (s) as in lemma 3.4 for the triple Fw , n − h, t. Then the action of (1 + ws ODFw ,n−h ) on ΣFw ,n−h lifts to an action on ΣFw ,n−h ×RFw ,n−h,t
N (s)
RFw ,n−h,t /mRFw ,n−h,t . Moreover for any positive integer a ≥ t the action of
N (s)

(1 + ws−t+a ODFw ,n−h ) on ΣFw ,n−h [wa ] ×RFw ,n−h,t RFw ,n−h,t /mRFw ,n−h,t is trivial.
Thus (1 + ws ODFw ,n−h )/(1 + ws+a−t ODFw ,n−h ) acts diagonally on
∧
{N (s)}.
ΣFw ,n−h,t [wa ] × Ys+a−t
∧
As Ys+a−t
{N (s)}/Ys∧ {N (s)} is finite, etale and Galois with Galois group

(1 + ws ODFw ,n−h )/(1 + ws+a−t ODFw ,n−h ),
the quotient is a finite, flat group scheme Hs0 [wa ]/Ys∧ {N (s)}. The direct system of the H0 [wa ] define a formal Barsotti-Tate OF,w -module Hs0 /Ys∧ {N (s)}.
Note that Hs0 [wt ] ∼
= ΣFw ,n−h,t [wt ], and so Hs0 inherits a Drinfeld wt -structure.
Also note that over Ws+a−t we have an isomorphism
∼
Hs0 [wa ] ∼
= ΣFw ,n−h [wa ] → G 0 [wa ].

The composite isomorphism descends to an isomorphism over Ws . Thus we
see that over Ws we get a canonical isomorphism between G 0 and Hs0 . More
generally for s > s we get a canonical isomorphism between the pull back of
Hs0 to Ys∧ {N (s)} and the restriction of Hs0 to Ys∧ {N (s)}.
Let Hset /Ys∧ denote the unique lifting of G et /Ws to an ind-etale BarsottiTate OF,w -module. By corollary 2.10 we can recursively find an extension of
Barsotti-Tate OF,w -modules
(0) −→ Hs0 −→ Hs −→ Hset −→ (0)
over Ys∧ {N (s)} which restricts over Ys∧ {N (s − 1)} to the pull back
et
0
−→ Hs−1 −→ Hs−1
−→ (0).
(0) −→ Hs−1

We will simply write H for any Hs .
(h)
From the universal property of (IU p ,m )∧ (t) we obtain a unique morphism
of formal schemes over Spf OFwnr ,
(h)

κ∗s : Ys∧ {N (s)} −→ (IU p ,m )∧ (t) × Spf OFwnr
93

(h)

which extends the natural map Ws → IU p ,m × Spec k(w)ac and such that G
pulls back to H and the universal Drinfeld wt -structure on G 0 pulls back to
the Drinfeld wt -structure we have just defined on H0 . From the definition of
Ws∧ and lemma 6.2 we see that κ∗s lifts to a unique morphism
κs∗ : Ys∧ {N (s)} −→ Ws∧
which extends the identity map on Ws and such that G pulls back to H and the
universal Drinfeld wt -structure on G 0 pulls back to the Drinfeld wt -structure
we have just defined on H0 . Note that
κ∗

Ys∧ {N (s)}
↑

s
−→

κ∗s+1

Ws∧
↑

∧
∧
Ys+1
{N (s)} −→ Ws+1

commutes. Note also that if x is a closed point of Ws and if x∞ is a closed
(h)
point of JU p ,m,∞ lying above x then
κ∗

s
(Ys∧ {N (s)})∧x
(Ws∧ )∧x
−→
↓
↓
N (s)
Spf RFw ,n−h,t /mRFw ,n−h,t → Spf RFw ,n−h,t

commutes, where the right hand vertical arrow is jx∗∞ .
The rest of the argument is entirely due to Vladimir Berkovich, to whom
we are extremely grateful. By his lemma II.5 we see that for every positive
integer N we can find a positive integer s such that N (s) ≥ N and a morphism
κ(N )∗ : Ys∧ −→ Ws∧
(h)

such that for each closed point x of Ws and each closed point x∞ of JU p ,m,∞
lying above x
(Ys∧ {N })∧x
↓
N
Spf RFw ,n−h,t /mR
Fw ,n−h,t

κ(N )∗

−→
→

(Ws∧ )∧x
↓
Spf RFw ,n−h,t

commutes, where the right hand vertical arrow is jx∗∞ .
We will let Ψj (Z/lr Z) denote the j th vanishing cycle sheaf constructed for
the constant sheaf Z/lr Z on Spf RFw ,n−h,t and Φj (Z/lr Z) the j th vanishing
cycle sheaf constructed for the constant sheaf Z/lr Z on Ws∧ . Thus
ΨjFw ,l,n−h,t ∼
= (lim Ψj (Z/lr Z)) ⊗Zl Qac
l
←r

94

and

Φj (t) ∼
= (lim Φj (Z/lr Z)) ⊗Zl Qac
l .
←r

By theorem 4.1 of [Berk3], for any positive integer r we may choose a positive
integer N such that any two morphisms of formal schemes over Ofwnr ,
Spf RFw ,n−h,t [[X1 , ..., Xh ]] −→ Spf RFw ,n−h,t
which agree on Spf (RFw ,n−h,t /mN
RFw ,n−h,t )[[X1 , ..., Xh ]] induce the same map on
vanishing cycles
Ψj (Z/lr Z) ←− Ψj (Z/lr Z).

As the formal completion of any Ws∧ or Ys∧ at a closed point is isomorphic
to Spf RFw ,n−h,t [[X1 , ..., Xh ]] we see that we can find a positive integer s (still
perhaps depending on r) and a morphism of constructible sheaves over Ws ,
κ : Φj (Z/lr Z) −→ Ψj (Z/lr Z),
(h)

such that for any closed point x of Ws and any closed point x∞ of JU p ,m,∞
above x the morphism
κ : Φj (Z/lr Z)x −→ Ψj (Z/lr Z)
coincides with the inverse of (jx∗∞ )∗ . In particular we see that κ is an isomorphism.
∼
×
Moreover if δ ∈ OD
we see that the natural map δ ∗ Φj (Z/lr Z) →
Fw ,n−h
Φj (Z/lr Z) (which arises as Φj (Z/lr Z) is a pull back from W ) corresponds
∼
under κ to the composite of the natural map δ ∗ Ψj (Zlr Z) → Ψj (Z/lr Z) (which
arises as Φj (Z/lr Z) is a pull back from Spec k(w)ac ) with the automorphism
×
δ of Ψj (Z/lr Z) (which arises from the action of OD
on Spf RFw ,n−h,t ).
Fw ,n−h
(This can be checked by working on stalks and using the commutativity of the
diagram
Φj (Z/lr Z)δx
↓
Φj (Z/lr Z)x

∗
)∗
(jδx
∞

−→

(jx∗∞ )∗

−→

Ψj (Z/lr Z)
↓

Ψj (Z/lr Z),

where the right hand vertical arrow is δ.)
We will let F(Ψj (Z/lr Z)) denote the etale sheaf over W obtained by descending Ψj (Z/lr Z)/Ws by the diagonal action of (ODFw ,n−h /ws )× . Thus
F(ΨFj w ,l,n−h,t ) ∼
= (lim F(Ψj (Z/lr Z))) ⊗Zl Qlac .
←r

95

We see that κ descends to an isomorphism
κ : Φj (Z/lr Z) −→ F(Ψj (Z/lr Z))
over W such that for any closed point x of W and any closed point x∞ of
(h)
JU p ,m,∞ above x the morphism
κ : Φj (Z/lr Z)x −→ F(Ψj (Z/lr Z))x
coincides with the inverse of
∗

∗

(jx∞ )
∼
F(Ψj (Z/lr Z))x → F(Ψj (Z/lr Z))xs ∼
= Ψj (Z/lr Z) −→ Φjx ,

where xs is the image in Ws of x∞ . By looking at stalks we see that the
morphisms κ are compatible as r varies and hence we can glue the morphisms
κ to give the map whose existence is asserted in the proposition. ✷
The next two corollaries are checked by working on stalks.
Corollary 7.3 The homomorphism κ in the proposition is an isomorphism.
Corollary 7.4 Suppose that g = (g p , gp,0 , gw0 , gwet , gwi ) is an element of
r

G(A

∞,p

Q×
p

)×

(Bwopi )× ,

+

× (GLn−h (Fw ) × GLh (Fw )) ×

and that

i=2

(h)

(h)

[g] : IU p ,m −→ I(U p ) ,m .
Suppose also that (gw0 , δ, σ) ∈ AFw ,n−h and that t >> t . Then
([g] × (Frobw(σ)
)∗ )∗ Φj (t )
w
↓
0

gw )−w(det δ) ∗ ∗
([g] × (Frobw(det
) ) F(ΨjFw ,l,n−h,t )
w

g×σ

−→
0 ,δ,σ)
[g]×(gw

−→

Φj (t)
↓

F(ΨFw ,l,n−h,t )

commutes (where the vertical arrows are induced by κ).
The next three corollaries follow easily from the previous one.
Corollary 7.5 Under κ the homomorphism Fr∗
(h)

f1 (n−h)

× 1 from

Hci (IU p ,m × Spec k(w)ac , Φj (t) ⊗ Lξ )
96

to

(h)

Hci (IU p ,m × Spec k(w)ac , Φj (t) ⊗ Lξ )
corresponds to the homomorphism 1 × (

−1

,

−1

, 1) from

(h)

Hci (IU p ,m × Spec k(w)ac , F(ΨjFw ,l,n−h,t ) ⊗ Lξ )
to

(h)

Hci (IU p ,m × Spec k(w)ac , F(ΨjFw ,l,n−h,t ) ⊗ Lξ ).

Hence lemma 6.6 follows.
Corollary 7.6 κ induces an isomorphism
∼

Hci (I (h) , Φj ⊗ Lξ ) → Hci (I (h) , F(Ψj ) ⊗ Lξ ).
Moreover if g = (g p , gp,0 , gw0 , gwet , gwi ) is an element of
r
∞,p

G(A

)×

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

(Bwopi )×
i=2

and if σ ∈ WFw , then the action of g × σ on the left hand side corresponds to
the action of [g] × gw0 × σ on the right hand side.
Corollary 7.7 The action of
r

G(A

∞,p

)×

Q×
p

+

× (GLn−h (Fw ) × GLh (Fw )) ×

(Bwopi )×
i=2

on Hci (I (h) , Φj ⊗ Lξ ) extends uniquely to an action of
r
∞,p

G(A

)×

Q×
p

× GLn−h (Fw ) × GLh (Fw ) ×

(Bwopi )× .
i=2

Combining these with lemma 7.1 we get the following corollary.
Corollary 7.8 We have an isomorphism
∼

Hci (I (h) , Φj ⊗ Lξ )n−h →

ρ

(Hci (I (h) , Fρ ⊗ Lξ ) ⊗ ΨjFw ,l,n−h (ρ))(n−h)/e[ρ] ,

97

where ρ runs over irreducible admissible representations of DF×w ,n−h up to inertial equivalence. Moreover if (g p , gp,0 , gw0 , gwet , gwi , σ) is an element of
r
∞,p

G(A

)×

Q×
p

× GLn−h (Fw ) × GLh (Fw ) ×

i=2

(Bwopi )× × WFw ,

then the action of (g p , gp,0 , gw0 , gwet , gwi , σ) on the left hand side corresponds to
the action of
(g p , gp,0 p−f1 w(σ) , w(δ), gwet , gwi ) × (gw0 , σ)
on Hci (I (h) , Fρ ⊗ Lξ ) ⊗ ΨjFw ,l,n−h (ρ), where δ ∈ DF×w ,n−h satisfies
w(det δ) = w(det gw0 ) − w(σ).
We will let dh denote the homomorphism
×
GLn−h (Fw ) × WFw −→ G(h) (A∞ )/OD
Fw ,n−h
(gw0 , σ)
−→ (1, p−f1 w(σ) , δ, 1, 1),

where
w(det δ) = w(det gw0 ) − w(σ).
If we set
[Hc (I (h) , Fρ ⊗ Lξ )] =

i

(−1)h−i [Hci (I (h) , Fρ ⊗ Lξ )],

then we can combine corollaries 6.8 and 7.8 to obtain the following theorem.
n−h
→ OF,w
Theorem 7.9 For h = 0, ..., n − 1 choose homomorphisms jh0 : Λ11 →
h
and jhet : Λ11 →
→ OF,w
such that jh0 ⊕ jhet is an isomorphism. Let Mh = ker jhet .
Then we have an equality of virtual G(A∞ ) × WFw -modules
Z×
p

[H(X, Lξ )

n−1

(B op )×

]=
h=0

ρ

e[ρ]−1 Ind PMw (Fw ) ([Hc (I (h) , Fρ ⊗ Lξ )] ∗dh [ΨFw ,l,n−h (ρ)]),
h

where ρ runs over representatives of the inertial equivalence classes of irreducible admissible representations of DF×w ,n−h
(See the discussion before lemma 3.7 for the definition of dn . See appendix
I for the definition of ∗dn .)
98

8

k(w)ac points.

The purpose of this section is to give a reasonably explicit description of the
(h)
inverse system of sets JU p ,m,s (k(w)ac ) together with its action of G(h) (A∞ ).
This we will do by combining the theory of Honda and Tate (which describes
simple abelian varieties over k(w)ac up to isogeny - see [Tat1]) with some
Galois cohomology calculations which closely follow work of Kottwitz (and
which allows us to describe the possible polarisations on these abelian varieties
- see [Ko3] and [Ko4]).
r
If U p is an open compact subgroup of G(A∞,p ), if m ∈ Z≥0
and if s ∈ Z≥0
then set
r

U p (m, s) = U p ×Zp× ×(1+ws ODFw ,n−h )×(1+wm1 Mh (OF,w ))×

i=2

op
),
(1+wimi OB,w
i

an open compact subgroup of G(h) (A∞ ).
Also set
(h)
J (h) (k(w)ac ) = lim
JU p ,m,s (k(w)ac ).
p
←−U ,m,s

This set has a natural right action of G(h) (A∞ )+ and we see that
(h)

JU p ,m,s (k(w)ac ) = J (h) (k(w)ac )/U p (m, s).
Also if x ∈ J (h) (k(w)ac ) then we define the stalk of Fρ ⊗ Lξ to be the direct
(h)
limit of its stalks at the images of x in each JU p ,m,s . For each such x there is
a canonical isomorphism
∼

(Fρ ⊗ Lξ )x → ρ ⊗ ξ
such that for any g ∈ G(h) (A∞ )+ we have a commutative diagram
(Fρ ⊗ Lξ )xg
↓
ρ⊗ξ

g

−→
0 )⊗ξ(g )
ρ(gw
l

−→

(Fρ ⊗ Lξ )x
↓
ρ ⊗ ξ.

As a first step we will see that when considering k(w)ac -points one can (as
in characteristic zero) work with abelian varieties up to isogeny, rather than up
to prime to p-isogeny. To this end we have the following lemma, whose proof
is straight forward. (The main point being that if x is a closed geometric point
(h)
of JU p ,m,s then Gx ∼
= Gx0 × Gxet .)
99

1. J (h) (k(w)ac ) is in bijection with equivalence classes of (r +
Lemma 8.1
6)-tuples
(A, λ, i, η p , ηp,0 , ηw0 , ηwe , ηwi ),
where
• A/k(w)ac is an abelian variety of dimension dn2 ;
• λ : A → A∨ is a polarisation;

• i : B → End (A) ⊗Z Q such that

– for all b ∈ B we have λ ◦ i(b) = i(b∗ )∨ ◦ λ,
– for i > 1 the ring OF,wi acts trivially on Lie A,
– Lie A ⊗OF,p OF,w is a one-dimensional k(w)ac -vector space;
∼

• η p : V ⊗Q A∞,p → V p A is an isomorphism of B ⊗Q A∞,p -modules under which the standard pairing, ( , ), on V corresponds to a (A∞,p )×
multiple of the λ-Weil pairing on V p A;
∼

• ηp,0 : Qp → Qp (1);

• ηw0 : Σn−h −→ εA[w∞ ]0 is an isogeny;
∼

• ηwe : Fwh → εVw A;

∼

• for i > 1, ηwi : Λi ⊗Zp Qp → Vwi A is an isomorphism of Bwi modules.

Here we call two such (r + 6)-tuples, (A, λ, i, η p , ηp,0 , ηw0 , ηwe , ηwi ) and
(A , λ , i , (η p ) , ηp,0 , (ηw0 ) , (ηwe ) , ηwi ), equivalent if there is an isogeny α :
A → A , γ ∈ Q× and a ∈ Z×
p such that
• γλ = α∨ ◦ λ ◦ α,

• α ◦ i(b) = i (b) ◦ α for all b ∈ B,
• (η p ) ◦ α = η p ,

• γaηp,0 = ηp,0 ,

• (ηw0 ) ◦ α = ηw0 ,

• (ηwe ) ◦ α = ηwe ,

• (ηwi ) ◦ α = ηwi .
2. Under this bijection the action of
(g p , gp,0 , gw0 , gwe , gwi ) ∈ G(h) (A∞ )+
100

on J (h) (k(w)ac ) corresponds to the map which sends
(A, λ, i, η p , ηp,0 , ηw0 , ηwe , ηwi )
to
(A, λ, i, η p ◦ g p , ηp,0 ◦ gp,0 , ηw0 ◦ gw0 , ηwe ◦ gwe , ηwi ◦ gwi ).
3. In particular the action of G(h) (A∞ )+ on J (h) (k(w)ac ) extends to an action of G(h) (A∞ ).
In the rest of this section we will give a group theoretic description of
J (k(w)ac ). We start with an application of the theory of Honda and Tate
(see [Tat1]).
(h)

Lemma 8.2
where

1. There is a bijection between isogeny classes of pairs (A, i)

• A/k(w)ac is an abelian variety of dimension dn2 ;
• i : B → End (A) ⊗Z Q such that

– for i > 1 the ring OF,wi acts trivially on Lie A,
– Lie A ⊗OF,p OF,w is a one-dimensional k(w)ac -vector space;

• εA[w∞ ]e has height h;
˜ where
and pairs (M, w)

• M/F is a CM field extension which is embeddable into B over F ,
˜ is a place of M above w such that
• w

[Mw˜ : Fw ]n = [M : F ](n − h),
˜ N is inert
• there is no intermediate field M ⊃ N ⊃ F such that w|
in M .
˜ correspond. Then C = End 0B (A) is the
2. Suppose that (A, i) and (M, w)
division algebra with centre M and invariants as follows.
• If x is a place of M not dividing wwc then inv x (C) = inv x (B op ⊗F
M ).
• If x is a place of M which divides wwc but not w
˜ w˜ c then inv x (C) =
0.
• inv w˜ (C) = [M : F ]/n.
101

• inv w˜c (C) = −[M : F ]/n.
Moreover
dimM (End B (A) ⊗Z Q) = (n/[M : F ])2 .
Proof: In the proof of this lemma we will use results from appendix III
without comment.
We will first show that any A as in the first part of the lemma is a simple
object in the category of abelian varieties up to isogeny with B-action. To
this end choose a simple factor A of A in the category of abelian varieties up
to isogeny with B-action. Suppose that A corresponds to a p-adic type over
F with minimal representative (M, η). Choose a place x of F such that Bx is
a division algebra and such that x |uc . Let y be a place of M above x. If x|p
then (as x|u but x = w) A[y ∞ ] is etale and hence ηy = 0. In any case we see
that, if C = End 0B (A ), then
inv y (C ) = −[My : Fw ]inv x (B),
and so
Thus

[C : M ]1/2 ≥ n/[M : F ].
dim A ≥ dn2 ,

which implies A = A , as desired.
Thus let A correspond to a p-adic type over F with minimal representative
(M, η). Note that if y is a place of M dividing u but not dividing w then
A[y ∞ ] is etale and hence ηy = 0. Moreover as A[w∞ ]0 is a simple object in
the category of Barsotti-Tate groups up to isogeny with Bw -action we see that
˜∞]
there is a unique place w˜ of M above w with ηw˜ = 0. Then A[w∞ ]0 = A[w
and as this Barsotti-Tate group has height [Fw : Qp ]n(n − h) we see that
[Mw˜ : Fw ][C : M ]1/2 = n − h.
Also as the Newton polygon of A[w∞ ]0 has Newton polygon which is pure of
slope 1/([Fw : Qp ](n − h)) we see that
ηw˜ = ew/w
˜ /((n − h)fw/p ).
Hence we see that
• inv w˜ C = [Mw˜ : Fw ]/(n − h) = [C : M ]−1/2 ,
• inv w˜c C = −[Mw˜ : Fw ]/(n − h) = −[C : M ]−1/2 ,
102

• and for any other place x of M we have
inv x C = −[Mx : Fx ]inv x (B).
As
dn2 = dim A = [M : Q]n[C : M ]1/2 /2
we see that
n = [M : F ][C : M ]1/2
and hence that
(n − h)[M : F ] = n[Mw˜ : Fw ].

Because we can find an extension N : M such that N splits B and [N : F ]2 =
[B : F ], we see that M embeds in B over F . Finally as (M, η) was chosen
minimal we see that there is no intermediate field M ⊃ N ⊃ F such that w|
˜N
is inert in M .
Conversely if (M, w)
˜ is as in the theorem we consider the p-adic type over
F , (M, η) where
• ηw˜ = ew/w
˜ /((n − h)fw/p ),
• ηx = 0 for any other place x|u of M ,
• ηw˜c = ew/p
˜ (1 − 1/((n − h)[Fw : Qp ])),
• ηx = ex/p for any other place x|uc of M .
Let (A, i) be the corresponding abelian variety with B-action. Again using the
results listed in appendix III we see that (A, i) has the properties listed in the
lemma. ✷
We now want to add polarisations to the picture. To this end we follow
the approach of Kottwitz, [Ko3]. The next lemma is presumably the analogue
in our language of “the vanishing of the Kottwitz invariant”.
Lemma 8.3 Keep the notation of the last lemma and suppose that (A, i) and
(M, w)
˜ correspond. Then we can find
• a polarisation λ0 : A → A∨ such that the λ0 -Rosati involution preserves
B ⊗ M and induces the involution ∗ ⊗ c on it,
• and a finitely generated B ⊗ M -module W0 together with an alternating
pairing
, 0 : W0 × W0 −→ Q
which is ∗ ⊗ c-Hermitian

103

such that
1. there is an isomorphism of B ⊗ M ⊗ A∞,p -modules
∼

W0 ⊗ A∞,p → V p A
which takes

,

0

to an (A∞,p )× -multiple of the λ0 -Weil pairing on V p A,

2. and there is an isomorphism of B ⊗ R-modules
∼

W0 ⊗ R → V ⊗ R
which takes
V ⊗ R.

,

0

to a R× multiple of our standard pairing ( , ) on

Proof: By lemma 9.2 of [Ko3] there is a polarisation λ0 : A → A∨ such
that the λ0 -Rosati involution preserves B ⊗F M and acts on it as ∗ ⊗ c. Let
C = End B (A) ⊗Z Q and let ‡0 denote the λ0 -Rosati involution restricted to
C. We see from lemma 8.2 that C is a division algebra with centre M and
that ‡0 |M = c.
The first step of the proof will be to show that, up to isogeny, we can lift
A with its B ⊗F M -action and its polarisation over OFwac .
Let M + denote the maximal totally real subfield of M . For a|[C : M ]1/2
we will let Xa ⊂ C denote the locally closed M + -subvariety of semi-simple
elements δ such that δ ‡0 = δ and the characteristic polynomial of δ over M
is an ath , but no higher, power. (Note that if a polynomial over F + is a ath
power over (M + )ac it is already one over M + .) Then
C ‡0 =1 =

Xa (M + ).

Computing over (M + )ac we see that
dim Xa = [C : M ] + (a − [C : M ]/a).
As C ‡0 =1 is an affine space over M + of dimension [C : M ] and as for a = [C :
M ]1/2 we have dim Xa < [C : M ], we see that we can find an element
δ ∈ C ‡0 =1 −

Xa (M + ).
a=[C:M ]1/2

Set N = M (δ). Then N is a maximal subfield of C, which is preserved by
‡0 , which is a CM-field and which satisfies ‡0 |N = c. Set N + = M + (δ) the
maximal totally real subfield of N .
104

We see that N also splits B (as it does so locally at all places of F by
∼
lemma 8.2). Choose an isomorphism α : B ⊗F N → Mn (N ) and let ∗α
denote the involution α ◦ (∗ ⊗ c) ◦ α−1 on Mn (N ). If x ∈ Mn (N ) we will define
x ∈ Mn (M ) by (x )ij = xcji . Then we have x∗α = ax a−1 for some a ∈ GLn (N )
with a a−1 ∈ N × . We see that (a a−1 )(a a−1 )c = (a )−1 (a a−1 )a = 1 and so by
Hilbert’s theorem 90 a a−1 = γ/γ c for some γ ∈ N × . Replacing a by γa we
see that we may suppose that a = a. If we compose α with conjugation by
b in GLn (N ) then we change a to bab . Thus by suitable choice of α we may
suppose that
α(x∗⊗c ) = aα(x) a−1
for some diagonal matrix a ∈ GLn (N + ), with diagonal entries a1 , ..., an say.
As ∗ ⊗ c is a positive involution on Mn (N ) we see that ai aj is totally positive
for all i and j. Thus multiplying a by a scalar we may suppose that each ai is
totally positive.
Considering ε ∈ Mn (N ), let A1 = εA and let j : A1 → A denote the
tautological inclusion. Let i1 : N → End 0 (A1 ) be the map induced by i and
let λ1 = j ∨ ◦ λ0 ◦ j, a polarisation on A1 . If for i = 1, ..., n we let εi denotes
the element of Mn (N ) which has a 1 in the ith entry in the first column and
zeroes elsewhere, then we get an isogeny
(ε1 ◦ j) + ... + (εn ◦ j) : An1 −→ A.
Then the diagram
A
↑

An1

λ

−→
⊕λ1 ◦(ai /a1 )

−→

A∨
↓
An1

0
(A) is N ,
commutes. Note that, as the centraliser of B ⊗F N in B ⊗F End B
0
the centraliser of i1 (N ) in End (A1 ) is just i1 (N ) itself.
Now (up to isogeny) we can lift A1 to an abelian scheme A1 /OFwac in such
a way that the action i1 of N lifts to an action ˜i1 of N on A1 . (See [Tat1].)
Choose a polarisation µ : A1 × Fwac → A∨1 × Fwac for which the Rosati involution
induces c on ˜i1 (N ) (see lemma 9.2 of [Ko3]). It extends to a homomorphism
µ : A1 → A∨1 , which is again a polarisation (see [Ko3], page 392). Let µ denote
the pull back of µ to A1 . As λ1 and µ both induce c on N and as i1 (N ) is its
own centraliser in End 0 (A1 ) we see that λ1 = µ ◦ x for some x ∈ N . As λ1 and
µ are both polarisations, x must in fact be a totally positive element of N + .
Then λ1 = µ ◦ x is a polarisation of A1 which reduces to λ1 . Set A = (A1 )n ,
˜ 0 = ⊕n λ
˜ ˜
˜i = Mn (˜i1 ◦ α) : B ⊗F M → End 0 (A) and λ
j=1 1 ◦ i(aj /a1 ).

105

ac
Because Lie A1 ⊗OFwac Fwac is a F ⊗ Fwac ∼
= (Fwac )Hom (F,Fw ) -module, we get a
decomposition

Lie A1 ⊗OFwac Fwac ∼
=

(Lie A1 )σ .
ac )
σ∈Hom (F,Fw

We also have a decomposition
Lie A1 ⊗OFwac Fwac ∼
= Lie A1 [p∞ ] ⊗OFwac Fwac ∼
=

x

Lie A1 [x∞ ] ⊗OFwac Fwac ,

where x runs over places of F above p. Then
Lie A1 [x∞ ] ⊗OFwac Fwac ∼
=

(Lie A1 )σ ,
σ

where now σ runs over embeddings σ : F → Fwac such that x is the induced
place of F . Let Hom (F, Fwac )+ denote those embeddings which induce the place
u on E, so that Hom (F, Fwac ) = Hom (F, Fwac )+ Hom (F, Fwac )+ ◦ c. Then we
deduce that there is a unique σ0 ∈ Hom (F, Fwac )+ such that (Lie A1 )σ0 = (0).
Moreover σ0 induces w on F and (Lie A1 )σ0 ∼
= Fwac .
ac
We can find an embedding κ : Fw → C such that κ ◦ σ0 = τ0 , our
distinguished embedding F → C. Set
W0 = H1 ((A ×Spec OFwac ,κ Spec C)(C), Q).

˜ 0 ) which
This is a B ⊗F M -module with an alternating pairing (coming from λ
is ∗ ⊗ c-Hermitian for the action of B ⊗F M . We see at once that W0 ⊗ A∞,p
is equivalent to V p A as a B ⊗F M ⊗Q A∞,p -module with ∗ ⊗ c-Hermitian
A∞,p -alternating pairing.
It remains to show that W0 ⊗R has invariants (see section 1) (n−1, 1) at τ0
and (n, 0) at any other embedding F + → R. Note first that the invariants of
W0 ⊗ R are the same as the invariants of the F ⊗Q R-module with c-Hermitian
alternating pairing , 1 on W1 ⊗Q R, where
W1 = H1 ((A1 ×Spec OFwac ,κ Spec C)(C), Q),
and

,

1

˜ 1 . As an F -module we see that W1 ∼
comes from λ
= F n . Also
W1 ⊗Q R ∼
= (Lie A1 ) ⊗OFwac ,κ C,

and so it is an F ⊗Q C-module, not simply an F ⊗Q R-module. Corresponding
to F ⊗Q C ∼
= CHom (F,C) we get a decomposition
W1 ⊗Q R ∼
=

τ ∈Hom (F,C)

106

(W1 ⊗Q R)τ .

As W1 ⊗Q R ∼
= (F ⊗Q R)n we see that for all τ ,
dimC (W1 ⊗Q R)τ + dimC (W1 ⊗Q R)τ ◦c = n.
On the other hand
• (W1 ⊗Q R)κ◦σ0 ∼
= C,
• but if τ = κ ◦ σ0 while τ |E = (κ ◦ σ0 |E then (W1 ⊗Q R)τ = (0).
As the alternating form on (W1 ⊗Q R) is c ⊗ c-Hermitian for the action of
F ⊗Q C we see that
W1 ⊗Q R =
(W1 ⊗Q R)τ
τ

is an orthogonal direct sum for this alternating form.
For a suitable choice of i ∈ C a square root of −1 the c-symmetric form
(W1 ⊗Q R) × (W1 ⊗Q R) → C given by
x × y −→ ix, y 1 + i x, y 1
√
√
is positive definite. Choose −1 ∈ E ⊗Q R such that κ ◦ σ0 ( −1) = −i. If
τ |E = c ◦ κ ◦ σ0 |E then
√
√
x × y −→ −1x, y 1 + −1 x, y 1
is positive definite on (W1 ⊗Q R)τ , while if τ |E = κ ◦ σ0 |E then it is negative
definite on (W1 ⊗Q R)τ . It follows that the invariants of W0 ⊗Q R coincide
with those of V ⊗Q R and so these are equivalent as B ⊗Q R-modules with
8-Hermitian R-alternating pairings up to R× -multiples. ✷
Keep the notation of the last two lemmas. Let ‡0 denote the λ0 -Rosati
involution on C = End 0B (A). Let H0AV /Q denote the reductive algebraic group
such that for any Q-algebra R the R-points of H0AV are the set of g ∈ C ⊗Q R
such that g ‡0 g ∈ R× . Also let D = End B⊗M (W0 ), so that D is isomorphic
to the centraliser of M in B op , and let †0 denote the involution on B op =
End B (W0 ) and on D induced by , 0 . Let H0LA /Q (resp. G0 /Q) denote the
reductive algebraic group such that for any Q-algebra R the R-points of H0LA
are the set of g ∈ D ⊗Q R such that g †0 g ∈ R× (resp. g ∈ B op ⊗Q R such that
g †0 g ∈ R× ). Then
• H0LA ⊂ G0 ,
• G and G0 are inner forms of each other,
107

• and H0AV and H0LA are inner forms of each other. (If Isom (H0AV , H0LA )
denotes the variety of isomorphisms between these algebraic groups, we
need to show that Isom (H0AV , H0LA ) has a connected component which
is geometrically connected. Thus it suffices to show that there is an
∞,p ∼
∞,p
→ H0AV ×Q A
which is conjugate to all its
isomorphism H0LA ×Q A
Gal (Qac /Q) transforms. The existence of such a isomorphism follows
∞,p
∞,p
from the equivalence of W0 ⊗Q A
and V p A ⊗A∞,p A
as B ⊗F M ⊗Q
∞,p
∞,p
A -modules with ∗ ⊗ c-Hermitian A -alternating pairing.)
Moreover we have a natural isomorphism
H0AV (A∞,p ) ∼
= H0LA (A∞,p ).
Also let φ0 denote the class in H 1 (Q, G0 ) which represents the difference between (V, ( , )) and (W0 , , 0 ).
We see that there are natural bijections between the following sets.
1. G(Q)-conjugacy classes of F -embeddings j : M → B op such that #◦j =
j ◦ c.
2. Equivalence classes of B ⊗F M -modules together with a ∗ ⊗ c-Hermitian
Q-alternating form on that module which are equivalent to V as Bmodules with ∗-Hermitian Q-alternating pairing.
3. The preimage of φ0 under H 1 (Q, H0LA ) −→ H 1 (Q, G0 ).
(The map from the first to the second set sends j to (V, ( , )) considered as
a B ⊗F M -module via Id ⊗ j : B ⊗F M → B ⊗F B op .)
Lemma 8.4 This bijection induces a bijection between the following sets.
1. G(A∞,p )-conjugacy classes of F -embeddings j : M → B op such that
# ◦ j = j ◦ c.
∞,p

2. The preimage of φ0 under H 1 (Q, H0LA (A

∞,p

)) −→ H 1 (Q, G0 (A

)).

Proof: We see that G(A∞,p )-conjugacy classes of F -embeddings j : M →
∞,p
B such that # ◦ j = j ◦ c are in bijection with classes x ∈ H 1 (Q, H0LA (A ))
which lift to a class y ∈ H 1 (Q, H0LA ) mapping to φ0 ∈ H 1 (Q, G0 ). Any
∞,p
such x certainly maps to φ0 in H 1 (Q, G0 (A )). So we must show that if
∞,p
∞,p
x ∈ H 1 (Q, H0LA (A )) maps to φ0 in H 1 (Q, G0 (A )), then we can lift x to
such a y.
op

108

Note that φ0 maps to zero in H 1 (R, G0 ) (by lemma 8.3) and in
×
H 1 (Qp , G0 ) = H 1 (Qp , (Buop ⊗Qp Qpac )× × (Qac
p ) ) = (0).
∞,p

Thus x ∈ H 1 (Q, H0LA (A )) ⊂ H 1 (Q, H0LA (A)) maps to φ0 ∈ H 1 (Q, G0 (A)).
Let A(G0 ) and A(H0LA ) be the groups defined in section 2.1 of [Ko2]. Then
according to proposition 2.6 of [Ko2] we have a commutative diagram with
exact rows as follows.
(0) → ker1 (Q, H0LA ) → H 1 (Q, H0LA ) → H 1 (Q, H0LA (A)) → A(H0LA )
↓
↓
↓
↓
(0) → ker1 (Q, G0 ) → H 1 (Q, G0 ) → H 1 (Q, G0 (A)) → A(G0 ).

The lemma now follows from a diagram chase, because of the following two
observations.
1. ker1 (Q, H0LA ) →
→ ker1 (Q, G0 ).
2. A(H0LA ) → A(G0 ).
The first of these follows because letting Z0 denote the centre of G0 the
composite homomorphism
ker1 (Q, Z0 ) −→ ker1 (Q, H0LA ) −→ ker1 (Q, G0 )
is an isomorphism by the argument on pages 393 and 394 of [Ko3]. The second
follows by direct computation from the definitions. In fact, if [F + : Q][B :
F ]1/2 = [M + : Q][D : M ]1/2 is odd then A(G0 ) = (0) and A(H0LA ) = (0). If
on the other hand [F + : Q][B : F ]1/2 = [M + : Q][D : M ]1/2 is even then the
natural homomorphism A(H0LA ) → A(G0 ) is the unique isomorphism
∼

Z/2Z −→ Z/2Z.
✷
We also see that there are bijections between the following sets.
1. Equivalence classes of polarisations λ : A → A∨ such that the λ-Rosati
involution takes B ⊗F M to itself and acts on it as ∗ ⊗ c, and where two
polarisations λ and λ are equivalent if there exists δ ∈ End 0B (A) such
that λ is a Q× -multiple of δ ∨ λδ.
2. Equivalence classes of non-zero elements γ ∈ C ‡0 =1 such that γ = δ ‡0 δ
for some δ ∈ C ⊗Q R, and where γ and γ are equivalent if there exists
‡0
δ ∈ C× and µ ∈ Q×
>0 such that γ = µδ γδ.
109

3. Equivalence classes of non-zero elements γ ∈ C ‡0 =1 such that γ = µδ ‡0 δ
for some δ ∈ C ⊗Q R and some µ ∈ R× , and where γ and γ are equivalent
if there exists δ ∈ C× and µ ∈ Q× such that γ = µδ ‡0 γδ.
4. ker(H 1 (E/Q, H0AV (E)) −→ H 1 (C/R, H0AV (C))).
5. ker(H 1 (Q, H0AV ) −→ H 1 (R, H0AV )).
(The equivalence between the first two parts sends γ to λ0 ◦γ. The equivalence
between the last two parts results because
H 1 (E, H0AV ) = H 1 (E, (C ⊗E E ac )× × (E ac )× ) = (0).)
We deduce that we have a bijection between the following two sets.
1. Equivalence classes of polarisations λ : A → A∨ such that
• the λ-Rosati involution takes B ⊗F M to itself and acts on it as
∗ ⊗ c,

• there is an equivalence of B ⊗A∞,p -modules with ∗-Hermitian A∞,p alternating pairings between V p A with the λ-Weil pairing and V ⊗
A∞,p with our standard pairing ( , );

and where two polarisations λ and λ are equivalent if there exists δ ∈
0
End B
(A) such that λ is a Q× -multiple of δ ∨ λδ.
2. Those elements of ker(H 1 (Q, H0AV ) −→ H 1 (R, H0AV )) which map to φ0
∞,p
in H 1 (Q, G0 (A )).
We will call two polarisations λ, λ : A → A∨ nearly equivalent if V p A
with its λ-Weil pairing is equivalent to V p A with its λ -Weil pairing as a
B ⊗F M ⊗Q A∞,p -module with ∗ ⊗ c-Hermitian A∞,p -alternating pairing. This
is a strictly coarser equivalence relation than our previous notion of equivalent.
We have the following lemma.
Lemma 8.5 There are bijections between the following sets.
1. Near equivalence classes of polarisations λ : A → A∨ such that
• the λ-Rosati involution takes B ⊗F M to itself and acts on it as
∗ ⊗ c,

• there is an equivalence of B ⊗A∞,p -modules with ∗-Hermitian A∞,p alternating pairing between V p A with its λ-Weil pairing and V ⊗
A∞,p with our standard pairing ( , ).
110

2. The preimage of φ0 under
∞,p

H 1 (Q, H0AV (A

)) ∼
= H 1 (Q, H0LA (A

∞,p

∞,p

)) −→ H 1 (Q, G0 (A

)).

3. G(A∞,p )-conjugacy classes of F -embeddings j : M → B op such that
# ◦ j = j ◦ c.
This bijection can be arranged so that λ and j correspond if and only if V ⊗A∞,p
with its standard pairing ( , ) is equivalent to V p A with its λ-Weil pairing as
B ⊗F M ⊗Q A∞,p -modules with ∗ ⊗ c-Hermitian A∞,p -alternating pairings.
Proof: We have to show that the preimage of φ0 under the homomorphism
H 1 (Q, H0AV (A

∞,p

∞,p

)) ∼
= H 1 (Q, H0LA (A

∞,p

)) −→ H 1 (Q, G0 (A

))

is contained in the image of ker(H 1 (Q, H0AV ) → H 1 (R, H0AV )). Suppose that
∞,p
∞,p
x ∈ H 1 (Q, H0AV (A )) maps to φ0 ∈ H 1 (Q, G0 (A )). Again by proposition
2.6 of [Ko3] we have an exact sequence
H 1 (Q, H0AV ) −→ H 1 (Q, H0AV (A

∞,p

)) ⊕ H 1 (R, H0AV ) −→ A(H0AV ),

and so it suffices to check that x maps to zero under the map
∞,p

H 1 (Q, H0AV (A

)) −→ A(H0AV ).

By lemma 2.8 of [Ko3] we have a commutative diagram
∞,p

H 1 (Q, H0AV (A
↓
A(H0AV )

∞,p

∼

)) −→ H 1 (Q, H0LA (A
↓
=
A(H0LA )

)) −→ H 1 (Q, G0 (A
↓
A(G0 ).
→

∞,p

))

(The injectivity of the map A(H0LA ) → A(G0 ) was explained in the proof of
∞,p
lemma 8.4.) Thus it suffices to show that φ0 ∈ H 1 (Q, G0 (A )) maps to
zero in A(G0 ). But φ0 ∈ ker(H 1 (Q, G0 ) → H 1 (R, G0 )) by lemma 8.3 and
∞,p
H 1 (Qp , G0 ) = (0). Thus φ0 ∈ H 1 (Q, G0 (A )) has the same image in A(G0 )
as φ0 ∈ H 1 (Q, G0 (A)), i.e. 0 (by proposition 2.6 of [Ko3]). ✷
Now let PHT(h) denote the set of triples (M, w, [j]) where

• M is a CM-field extension of F ,
• w is a place of M above w such that
[Mw : Fw ]n = [M : F ](n − h),
111

• there is no intermediate field M ⊃ N ⊃ F such that w|N is inert in M ,
• [j] is a G(A∞,p )-conjugacy class of F -embeddings
j : M → B op
such that # ◦ j = j ◦ c.
Combining lemmas 8.1 and 8.5 we see that there is a surjective map
P : J (h) (k(w)ac ) −→ PHT(h)
which sends
(A, λ, i, η p , ηp,0 , ηw0 , ηwe , ηwi ),
to the triple (M, w, [j]) associated to the near equivalence class of (A, i, λ) by
lemma 8.5. Note that the action of G(h) (A∞ ) on J (h) (k(w)ac ) preserves the
fibres of P.
Let z = (M, w, [j]) ∈ PHT(h) . Suppose that j ∈ [j]. We make the following
definitions.
1. Dj will denote the centraliser in B op of jM and †j will denote the restriction of # to Dj .
2. Vj will denote the B ⊗F M -module V with its B ⊗F M action via Id ⊗ j :
B ⊗F M → B ⊗F B op . If j ∈ [j] then the B ⊗F M ⊗Q A∞,p -modules with
∗⊗ c-Hermitian A∞,p -alternating pairings Vj ⊗Q A∞,p and Vj ⊗Q A∞,p are
equivalent. This equivalence can be realised by an element of G(A∞,p ).
3. Hj /Q will denote the reductive algebraic group coming from the B⊗F M automorphisms of Vj which preserve the standard alternating pairing
( , ) up to a scalar multiple. This group comes with a natural embedding ιj : Hj → G. Moreover, if j ∈ [j] then we have an isomorphism
∼

Hj ×Q A∞,p → Hj ×Q A∞,p ,
which is canonical up to conjugation in Hj (A∞,p ). This isomorphism is
achieved via the maps ιj and ιj and conjugation in G(A∞,p ).
4. Unless F + = Q and n = 2, there is a distinguished extension τ0 (j) :
M → C of τ0 : F → C. It is defined as follows. The equivalence class of
Vj as a B ⊗F M ⊗Q R-module with ∗ ⊗ c-Hermitian R-alternating pairing
is classified by a collection of pairs (aτ , bτ ) for τ : M + → R. In fact
we have (aτ , bτ ) = (0, n/[M : F ]) for all but one embedding τ1 for which
112

(aτ1 (j) , bτ1 (j)) = (1, n/[M : F ] − 1). Moreover τ1 |F + = τ0 |F + . We see that
τ1 is uniquely determined except in the exceptional case excluded at the
start of this paragraph. We define τ0 (j) to be the unique embedding
M → C extending τ1 on M + and τ0 on F .

If j, j ∈ [j] and τ0 (j) = τ0 (j ) then we have an equivalence of B ⊗F M ⊗Q
A-modules with ∗ ⊗ c-Hermitian A-alternating pairings between Vj ⊗Q A
and Vj ⊗Q A. This equivalence can be realised by an element of G(A).
Thus we have an isomorphism
∼

Hj ×Q A → Hj ×Q A,
which is canonical up to conjugation in Hj (A). (If F + = Q and n = 2
we may suppress the requirement that τ0 (j) = τ0 (j ).)
Lemma 8.6 Keep the above notation.
1. For any embedding τ0 : M → C extending τ0 we can find a j ∈ [j] with
τ0 (j ) = τ0 .
∼

2. If j, j ∈ [j] and τ0 (j) = τ0 (j ) then we can find an isomorphism Hj →
∼
Hj compatible with one of our canonical isomorphisms Hj ×Q A → Hj ×Q
A. (If F + = Q and n = 2 we may suppress the requirement that τ0 (j) =
τ0 (j ).)
Proof: We first look at part one. Choose j0 ∈ [j]. As in the discussion before
lemma 8.4 we see that G(Q)-conjugacy classes of elements of [j] correspond to
elements of
∞

ker(H 1 (Q, Hj0 ) −→ H 1 (Q, Hj0 (A )) ⊕ H 1 (Q, G)).
Thus the possibilities for Vj ⊗Q R correspond to the image of
∞

ker(H 1 (Q, Hj0 ) −→ H 1 (Q, Hj0 (A )) ⊕ H 1 (Q, G))
in H 1 (R, Hj0 ). As in lemma 8.4 we have a commutative diagram with exact
rows
(0) → ker1 (Q, Hj0 ) → H 1 (Q, Hj0 ) → H 1 (Q, Hj0 (A)) → A(Hj0 )
↓
↓
↓
↓
1
1
1
(0) → ker (Q, G) → H (Q, G) → H (Q, G(A)) → A(G).
where
113

→ ker1 (Q, G)
• ker1 (Q, Hj0 ) →
• and A(Hj0 ) → A(G).
Then a diagram chase shows that the possibilities for Vj ⊗Q R correspond to
ker(H 1 (R, Hj0 ) −→ H 1 (R, G)),
i.e. to equivalence classes of B ⊗F M ⊗Q R-modules with a ∗ ⊗ c-Hermitian
R-alternating form which are equivalent as B ⊗Q R-module with ∗-Hermitian
R-alternating form to V ⊗Q R with its standard pairing ( , ). The first part
of the lemma follows.
We now turn to the second part of the lemma. Let Zj denote the centre of
Hj . The key point will be that
∼

ker1 (Q, Zj ) −→ ker1 (Q, Hj ).
This is proved as on pages 393 and 394 of [Ko3]. As Vj ⊗ A is equivalent to
Vj ⊗ A the difference between Vj and Vj corresponds to an element of
ker(ker1 (Q, Hj ) −→ H 1 (Q, G)),
i.e. to an element of
ker(ker1 (Q, Zj ) −→ H 1 (Q, G)).
Let this element of ker1 (Q, Zj ) be represented by a cocycle σ → zσ . Then we
can find α ∈ G(Qac ) and β ∈ Zj (A) with
zσ = α−1 σ(α) = β −1 σ(β)
for all σ ∈ Gal (Qac /Q). If h ∈ Hj then αhα−1 ∈ Hj . Moreover if σ ∈
Gal (Qac /Q) then
σ(αhα−1 ) = αzσ σ(h)zσ−1 α−1 = ασ(h)α−1 .
∼

Thus conjugation by α gives an isomorphism Hj → Hj over Q.
∼
Suppose that g ∈ G(A) gives an isomorphism Vj ⊗Q A → Vj ⊗Q A. Then
βα−1 g ∈ Hj (A). For all σ ∈ Gal (Qac /Q) we see that σ(βα−1 g) = βα−1 g, and
so βα−1 g ∈ Hj (A). Altering g on the right by an element of Hj (A) we see
that we may suppose that
g = αβ −1 .
114

As conjugation by β −1 is trivial on Hj we see that g and α induce the same
isomorphism
∼
Hj ×Q A → Hj ×Q A,
as desired. ✷
We will write Dz for any of the M -algebras Dj for any j ∈ [j]. (They are
all isomorphic as their invariants are given by
inv x (Dj ) = [Mx : Fx ]inv x (B op ).)
Note that up to conjugacy we have a unique embedding Dz → B op . If τ0 :
LA
M → C extends τ0 : F → C then we will write Hz,τ
/Q for any one of the
0
algebraic groups Hj for j ∈ [j] with τ0 (j) = τ0 . It comes with an embedding
LA
LA
ιz,τ
: Hz,τ
→ G which is well defined up to G(A)-conjugacy.
0
0
Now suppose that (A, i, λ) is a triple associated to z. We will make the
following definitions.
1. We will let C(A,i,λ) denote End 0B (A) and we will let ‡(A,i,λ) denote the
λ-Rosati involution on C(A,i,λ) .
2. We will let H(A,i,λ) /Q denote the algebraic group such that for any Qalgebra R, H(A,i,λ) (R) is the group of elements g ∈ C(A,i,λ) ⊗Q R with
g ‡(A,i,λ) g ∈ R× .
If j ∈ [j] then we get an equivalence of B ⊗F M ⊗Q A∞,p -modules with ∗ ⊗ cHermitian A∞,p -alternating pairings between Vj ⊗Q A∞,p and V p A. Thus we
get an isomorphism
∼

Hj ×Q A∞,p −→ H(A,i,λ) ×Q A∞,p ,
which is well defined up to H(A,i,λ) (A∞,p )-conjugacy. We also then get an
isomorphism
∼
Hj ×Q Qac −→ H(A,i,λ) ×Q Qac ,

which is specified up to H(A,i,λ) (Qac )-conjugacy by the condition it is compatible with the isomorphism
Vj ⊗Q A

∞,p ∼

∞,p

→ V p A ⊗A∞,p A

(itself defined up to H(A,i,λ) (A∞,p )-conjugacy). Thus H(A,i,λ) is an inner form
of Hj (cf the discussion after lemma 8.3). Since the λ-Rosati involution is
positive, H(A,i,λ) (R) is compact mod centre.
115

Lemma 8.7 Suppose that (A, i, λ) and (A , i , λ ) are both associated to z.
Suppose also that j ∈ [j]. Then we can find an isomorphism
∼

H(A,i,λ) −→ H(A ,i ,λ )
∼

compatible with some choices of the canonical isomorphisms Hj ×Q A∞,p −→
∼
H(A,i,λ) ×Q A∞,p and Hj ×Q A∞,p −→ H(A ,i ,λ ) ×Q A∞,p .
Proof: We can find an isogeny
α : A −→ A
such that
• i (x) = αi(x)α−1 for all x ∈ B ⊗F M ,
‡

(A,i,λ)
• and λ = α−∨ λγα−1 for some γ ∈ C(A,i,λ)
δ ∈ C(A,i,λ) ⊗Q R.

=1

with γ = δ ‡(A,i,λ) δ for some

×
Then (γ, 1) ∈ C(A,i,λ)
× E × represents an element of

ker(H 1 (E/Q, H(A,i,λ) (E)) −→ H 1 (Q, H(A,i,λ) (A))).
Let Z(A,i,λ) denote the centre of H(A,i,λ) . As
• H 1 (E, H(A,i,λ) ) = (0),
• H 1 (E, Z(A,i,λ) ) = (0),
∼

• and ker1 (Q, Z(A,i,λ) ) → ker1 (Q, H(A,i,λ) ) (again by the same argument
used on pages 393 and 394 of [Ko3]),
we deduce that
ker(H 1 (E/Q, H(A,i,λ) (E)) −→ H 1 (Q, H(A,i,λ) (A)))
equals
ker(H 1 (E/Q, Z(A,i,λ) (E)) −→ H 1 (E/Q, Z(A,i,λ) (AE ))).

×
× E × such that
Thus we can find (δ, µ) ∈ C(A,i,λ)

(µ−c δ ‡(A,i,λ) γδ, µ/µc ) ∈ M × × E × .
Note that we may take µ = 1. Then replacing α by αδ we see that without
loss of generality we may suppose that γ ∈ M × (and hence that γ is a totally
positive element of M + ).
116

∼

It follows (from γ ∈ M ) that α induces an isomorphism C(A,i,λ) → C(A ,i ,λ )
(x → αxα−1 ) which takes ‡(A,i,λ) to ‡(A ,i ,λ ) and hence induces an isomorphism
∼
H(A,i,λ) → H(A ,i ,λ ) .
×
We may choose µ ∈ (A∞,p )× and δ ∈ (A∞,p
such that γ = µ−1 δ c δ.
M )
∼
p
p
Suppose that β : V A → V A is an isomorphism of B ⊗F M ⊗Q A∞,p -modules
with alternating pairings up to (A∞,p )× -multiples. Then we see that
β −1 (V p α)δ −1 ∈ H(A,i,λ) (A∞,p ).
Altering β on the right by an element of H(A,i,λ) (A∞,p ), we may suppose that
β = (V p α)δ −1 and hence that β and V p α induce the same isomorphism
∼

H(A,i,λ) ×Q A∞,p → H(A ,i ,λ ) ×Q A∞,p .
the second part of the lemma follows. ✷
We will write Cz for any of the M -algebras C(A,i,λ) . (They are all isomorphic
as they have the same invariants by lemma 8.2.) Also from the invariants we
see that for any place x = w or wc of M we have Cz,x ∼
= Dz,x . We will write
AV
Hz for any of the algebraic groups H(A,i,λ) for (A, i, λ) associated to z. This
is well defined up to inner automorphism. If τ0 : M → C is any extension of
τ0 : F → C then there is an isomorphism
∼

LA
Hz,τ
×Q A∞,p −→ HzAV ×Q A∞,p ,
0

which is canonical up to HzAV (A∞,p )-conjugacy. In particular we have an embedding
ιzAV : HzAV (A∞,p ) → G(A∞,p )
well defined up to G(A∞,p )-conjugacy. We also have isomorphisms
×
×
× ∼
HzAV (Qp ) ∼
= Q×
p × Cz,u = Qp × Cz,w ×

x|w,x=w

GLn/[M :F ] (Mx ) ×

×
.
Cz,x
i>1 x|wi

But there exist embeddings (unique up to conjugation)
• Cz,w → DFw ,n−h over Fw (firstly Mw → DFw ,n−h because [Mw : Fw ]|(n −
h), and secondly we find that the centraliser of Mw in DFw ,n−h has invariant [Mw : Fw ]/(n − h) = [M : F ]/n = inv w Cz ),
•

x|w,x=w

Mn/[M :F ] (Mx ) → Mh (Fw ) over Fw (because

(n/[M : F ])
x|w,x=w

[Mx : Fw ] = n − n[Mw : Fw ]/[M : F ] = h),
117

• and for each i > 1,

x|wi

Cz,x ∼
= Dz,wi → Bwopi over Fwi .

Thus we may extend ιzAV to an embedding
ιzAV : HzAV (A∞ ) → G(h) (A∞ )
well defined up to G(h) (A∞ )-conjugacy.
We finish this section with the promised description of J (h) (k(w)ac ).
Proposition 8.8 The map
P : J (h) (k(w)ac ) −→ PHT(h)
is a surjection with fibres preserved by G(h) (A∞ ). If z ∈ PHT(h) then P −1 (z)
is isomorphic as a right G(h) (A∞ )-set to # ker1 (Q, HzAV ) copies of
×
AV
(h)
∞
ιAV
z (Hz (Q))\G (A )/Zp .
−1 −1
This identification is canonical up to replacing ιAV
by y → gιAV
z
z (xyx )g
(h)
∞
AV
for g ∈ G (A ) and x ∈ Hz (Q) and simultaneously left translating the
isomorphism by g.

Proof: We have already proved the first sentence, so fix z ∈ PHT(h) . Then
z corresponds to a near equivalence class of triples (A, i, λ). This near equivalence class consists of ker1 (Q, HzAV ) equivalence classes. Fix one such equivalence class C = [(A, i, λ)] and let C denote the set of points
(A , λ , i , η p , ηp,0 , ηw0 , ηwe , ηwi )
of J (h) (k(w)ac ) with (A , i , λ ) equivalent to (A, i, λ). We will show that C is
isomorphic as a right G(h) (A∞ )-set to
ι(A,i,λ) (H(A,i,λ) (Q))\G(h) (A∞ )/Z×
p.
The proposition will then follow.
First we see that any point of C can be written in the form
(A, λ, i, η p , ηp,0 , ηw0 , ηwe , ηwi ).
Thus G(h) (A∞ ) acts transitively on C. Finally the stabiliser in G(h) (A∞ ) of x0
is just ι(A,i,λ) (H(A,i,λ) )Z×
p. ✷

118

9

An application of Fujiwara’s trace formula.

×
Let ϕ ∈ Cc∞ (G(h) (A∞ )+ /Z×
p × ODFw ,n−h ). In this section we will find (subject
to some restrictions) a group theoretic description for

tr (ϕ|Hc (I (h) , Fρ ⊗ Lξ )).
Our main tool will be Fujiwara’s trace formula (see [Fu]). This is a form
of the Lefschetz trace formula for the cohomology with compact supports of
smooth but not necessarily proper varieties over finite fields. This formula was
conjectured by Deligne and had been proved modulo some sort of resolution
of singularities by Pink (see [P]).
Any such ϕ can be written as a finite sum of the form
ϕ=

ag char U p (m,0)gU p (m,0)
g

for some fixed U p and m (depending on ϕ). As always we can and will assume
that U p is sufficiently small.
By a fixed point of [U p (m, 0)gU p (m, 0)] we will mean a point
x ∈ J (h) (k(w)ac )/(U p (m, 0) ∩ gU p (m, 0)g −1 )
such that x = xg ∈ J (h) (k(w)ac )/U p (m, 0). This set appears to depend
on g not just on U p (m, 0)gU p (m, 0), but if we replace g by u1 gu2 (with
u1 , u2 ∈ U p (m, 0)) the two sets are in natural bijection via x → xu−1
1 . (If
p
−1
u1 gu2 = u1 gu2 , with u1 , u2 ∈ U (m, 0) as well, then x → x(u1 ) gives
the same map.) We will denote this set defined up to canonical bijection
Fix([U p (m, 0)gU p (m, 0)]).
Suppose x is such a fixed point. Choose g ∈ U p (m, 0)gU p (m, 0) and a point
x ∈ J (h) (k(w)ac ) above x ∈ J (h) (k(w)ac )/U p (m, 0) ∩ gU p (m, 0)g −1 . Then we
see that
xg = xu
for some u ∈ U p (m, 0). We will set
tr [U p (m, 0)gU p (m, 0)]|(Fρ ⊗ Lξ )x = tr (π ⊗ ξ)(gu−1 ).
We will check that this is independent of the various choices. First if we
replace x by xv for some v ∈ U p (m, 0) ∩ gU p (m, 0)g −1 then gu−1 is replaced by
v −1 gu−1 v and so the value of the trace is unchanged. Secondly if we replace g
by u1 gu2 and x by x(u1 )−1 then gu−1 is replaced by u1 gu−1 u−1
1 and again the
119

value of the trace is unchanged. Thus tr [U p (m, 0)gU p (m, 0)]|(Fρ ⊗ Lξ )x is a
well-defined function on Fix([U p (m, 0)gU p (m, 0)]).
Again suppose that x ∈ Fix([U p (m, 0)gU p (m, 0)]) and again choose g ∈
p
U (m, 0)gU p (m, 0) and x ∈ J (h) (k(w)ac ) above x ∈ J (h) (k(w)ac )/U p (m, 0) ∩
gU p (m, 0)g −1 . Let z = P(x). Then we can represent x by an element y ∈
G(h) (A∞ ), and we see that
yg = ιAV
z (a)yu
for some a ∈ HzAV (Q) and some u ∈ U p (m, 0). We will show that the conjugacy
class [a] of a in HzAV (Q) depends only on x. We have to check independence
of the following choices.
• We could postmultiply a by an element of
−1
p
−1
AV
(ιAV
z ) (yU (m, 0)y ) ∩ Hz (Q).

But as HzAV (R) is compact modulo the centre this intersection is a finite
group and so as U p (m, 0) is sufficiently small we see that
p
−1
−1
AV
(ιAV
z ) (yU (m, 0)y ) ∩ Hz (Q) = {1}.
AV
p
• We could replace y by ιAV
z (b)yv with b ∈ Hz (Q) and v ∈ U (m, 0) ∩
p
−1
−1
gU (m, 0)g . In this case a is replaced by bab and u is replaced by
v −1 u(g −1 vg).

• We could replace g by u1 gu2 and y by yu−1
with u1 , u2 ∈ U P (m, 0).
1
Then a remains unchanged and u is replaced by uu2 .
• We could preconjugate ιzAV by b ∈ HzAV (Q) and postconjugate by g ∈
G(h) (A∞ ) while replacing y by g y. Then u is unchanged and a is replaced
by b−1 ab.
Thus we may write [a(x)] for this conjugacy class. Notice that
tr [U p (m, 0)gU p (m, 0)]|(Fρ ⊗ Lξ ) = tr (ρ ⊗ ξ)(ιzAV (a(x))),
because gu−1 = y −1 ιAV
z (a)y.
Now we ask the converse question: given a ∈ HzAV (Q) how many points
x ∈ Fix([U p (m, 0)gU p (m, 0)]) are there with [a(x)] = [a]? One may check that
the answer is the cardinality of the double coset space
−1
p
p
AV
#(ιAV
z (Hz (Q))\X/U (m, 0) ∩ gU (m, 0)g )

120

where
X = {y ∈ G(h) (A∞ ) : y −1 ιzAV ([a])y ∩ gU p (m, 0) = ∅}.

If a, b ∈ HzAV (Q) and if both y −1 ιzAV (a)y and y −1 ιzAV (b)y ∈ gU p (m, 0) then
−1
p
AV
−1
−1
ιAV
z (a b) ∈ y gU g y and so (because U is sufficiently small and Hz (R)
is compact modulo its centre) we see that a = b. We deduce that the number
of x ∈ Fix([U p (m, 0)gU p (m, 0)]) with [a(x)] = [a] is also given by
p
p
−1
#(ιAV
z (ZHzAV (a)(Q))\X /U (m, 0) ∩ gU (m, 0)g )

where
X = {y ∈ G(h) (A∞ ) : y −1 ιzAV (a)y ∈ gU p (m, 0)}.

A similar argument shows that for any y ∈ G(h) (A∞ ) we have

p
p
−1
ιAV
z (ZHzAV (a)(Q))y(U (m, 0) ∩ gU (m, 0)g ) =
p
p
−1
= b∈Z AV (a)(Q) ιAV
z (b)y(U (m, 0) ∩ gU (m, 0)g ),
Hz

and so the number of x ∈ Fix([U p (m, 0)gU p (m, 0)]) with [a(x)] = [a] is also
given by
vol (U p (m, 0) ∩ gU p (m, 0)g −1 )−1
p
vol ({y ∈ ιzAV (ZHzAV (a)(Q))\G(h) (A∞ ) : y −1 ιAV
z (a)y ∈ gU (m, 0)}),
where we use any Haar measure on G(h) (A∞ ) and where we use a Haar measure
on ιAV
z (ZHzAV (a)(Q)) which gives each point volume 1. This can be rewritten
vol (U p (m, 0) ∩ gU p (m, 0)g −1 )−1
G(h) (A∞ )
vol (ιAV
(char gU p (m,0) ),
z (ZHzAV (a)(Q))\ZG(h) (A∞ ) (a))OιAV (a)
z

where again the measure on ιzAV (ZHzAV (a)(Q)) gives each point volume 1 and
where the Haar measures on each other groups are arbitrary as long as they
are chosen consistently for each occurrence of a given group. This appears
to depend on the choice of g ∈ [U p (m, 0)gU p (m, 0)]. Adding the formulas for
g running over a set of representatives for U p (m, 0)gU p (m, 0)/U p (m, 0) and
dividing by
#(U p (m, 0)gU p (m, 0)/U p (m, 0)) = [U p (m, 0) : U p (m, 0) ∩ gU p (m, 0)g −1 ],
we see that the number of x ∈ Fix([U p (m, 0)gU p (m, 0)]) with [a(x)] = [a] is
also given by
vol (U p (m, 0))−1
G(h) (A∞ )
vol (ιAV
(char U p (m,0)gU p (m,0) ).
z (ZHzAV (a)(Q))\ZG(h) (A∞ ) (a))OιAV (a)
z

121

We remark that this number may be infinite.
×
) is acceptable if it can
We will say that ϕ ∈ Cc∞ (G(h) (A∞ )+ /Zp× × OD
Fw ,n−h
be written as a finite sum
αi char U p (m,0)gi U p (m,0)

ϕ=
i

with U p sufficiently small and where
1. for y ∈ i U p (m, 0)gi U p (m, 0) the p-adic valuation of every eigenvalue of
yw0 is strictly less than the p-adic valuation of every eigenvalue of ywe ;
2. each Fix([U p (m, 0)gi U p (m, 0)]) is a finite set;
3. and, for each i,
(h)

tr ([U p (m, 0)gi U p (m, 0)]|Hci (IU p ,m × Spec k(w)ac , Fρ ⊗ Lξ )) =
= x∈Fix([U p (m,0)gi U p (m,0)]) tr ([U p (m, 0)gi U p (m, 0)]|(Fρ ⊗ Lξ )x ).

i (−1)

i

(h)

Here [U p (m, 0)gi U p (m, 0)] defines a correspondence on IU p ,m which lifts
(h)
to a natural cohomological correspondence on Fρ ⊗ Lξ over (IU p ,m ×
(h)
Spec k(w)ac ). It therefore acts on Hci (IU p ,m × Spec k(w)ac , Fρ ⊗ Lξ ). (See
[Fu].)
This definition is only useful if we have a good supply of acceptable functions ϕ. This is provided by the following lemma, whose key ingredient is
Fujiwara’s trace formula.
×
Lemma 9.1 Suppose that ϕ ∈ Cc∞ (G(h) (A∞ )+ /Z×
p × ODFw ,n−h ). Fix δ ∈
DF×w ,n−h with w(det δ) = 1. Then for N >> 0 the function ϕ|(1, pf1 N , δ N , 1, 1)
defined by
(ϕ|(1, pf1 N , δ N , 1, 1))(y) = ϕ(y(1, pf1 N , δ N , 1, 1))

is acceptable.
Proof: The first condition is easily checked. The latter two conditions follow
from corollary 5.4.5 of [Fu] because
[U p (m, 0)gi (1, p−f1 N , δ −N , 1, 1)U p (m, 0)] = (Fr∗ )f1 N .[U p (m, 0)gi U p (m, 0)]
in the notation of [Fu] (see the third paragraph of section 7). ✷
We now show how we can calculate the trace of an acceptable function on
the cohomology of Igusa varieties of the first kind.
122

×
Lemma 9.2 Suppose that ϕ ∈ Cc∞ (G(h) (A∞ )+ /Z×
p × ODFw ,n−h ) is acceptable,
then
1
AV
z∈PHT(h)
[a]⊂HzAV (Q) (# ker (Q, Hz ))
G(h) (A∞ )
vol (ZHzAV (a)(Q)\ZHzAV (a)(A∞ ))OιAV (a) (ϕ)tr (ρ ⊗ ξ)(ιAV
z (a)).
z

tr (ϕ|Hc (I (h) , Fρ ⊗ Lξ )) = (−1)h

This sum is finite and all the terms occurring are finite numbers. For each
non-zero term we have F (a) ⊃ M and
∞
ZG(h) (A∞ ) (a) = ιAV
z (ZHzAV (a)(A )).

We may make any consistent choices for the Haar measures implicit in this
formula as long as the Haar measure on ZHzAV (a)(Q) gives points measure 1
and as long as the measures used on ZG(h) (A∞ ) (a) and ZHzAV (a)(A∞ ) correspond
under ιzAV .
G(h) (A∞ )

Proof: We first check that if OιAV (a)
z

(ϕ) = 0 then

∞
ZG(h) (A∞ ) (a) = ιAV
z (ZHzAV (a)(A )).
G(h) (A∞ )

0
If OιAV (a) (ϕ) = 0 then the p-adic valuation of every eigenvalue of ιAV
z (a)w
z
e
is strictly less than the p-adic valuation of every eigenvalue of ιAV
z (a)w (because
ϕ is acceptable). Thus there is a constant κ such that a place x of M (a) ⊂ Cz
above w divides w if and only if
(a)x :Fw ]
|a|1/[M
> κ.
x

Hence if x is a place of M (a) above w then any other place of M (a) above
x|F (a) also lies above w. Let N/(F (a) ∩ M ) denote the normal closure of
M (a)/F (a) ∩ M , then N has the same property that two places x and x of
N above the same place of F (a) either both lie above w or neither lie above
w. Fix a place x of N above w and let ∆ denote the decomposition group for
x in Gal (N/F (a) ∩ M ). Let σ ∈ Gal (N/F (a) ∩ M ). Then some (resp. all)
places of N above the place σ(x)|F (a) lie above w if and only if
(Gal (N/F (a))σ∆) ∩ (Gal (N/M )∆) = ∅
(resp.
(Gal (N/F (a))σ∆) ⊂ (Gal (N/M )∆) ).

Thus we see that Gal (N/M )∆ is a union of double cosets of the form
Gal (N/F (a))σ∆,
123

i.e.
Gal (N/F (a))Gal (N/M )∆ = Gal (N/M )∆.
As Gal (N/(F (a) ∩ M )) is generated by Gal (N/F (a)) and Gal (N/M ) we see
that
Gal (N/(F (a) ∩ M )) = Gal (N/(F (a) ∩ M ))Gal (N/M )∆ = Gal (N/M )∆.
This translates into w|F (a)∩M being inert in M . By the minimality of (M, w)
we conclude that F (a) ⊃ M and so
ZG(h) (A∞ ) (a) ⊂ ZG(h) (A∞ ) (M ) = HzAV (A∞ ).
This establishes the desired equality.
If
αi char U p (m,0)gi U p (m,0)
ϕ=
i

then
tr (ϕ|Hc (I (h) , Fρ ⊗ Lξ )) = vol (U p (m, 0)) i,j αi (−1)h−j
(h)
tr ([U p (m, 0)gi U p (m, 0)]|Hcj (IU p ,m × Spec k(w)ac , Fρ ⊗ Lξ )),
where we use the same Haar measure to compute tr ϕ as we do to compute
vol (U p (m, 0)). The lemma now follows from the definition of acceptable and
from our previous calculations. ✷
Although it appears that we have a purely group theoretic expression for
the trace this is illusory as the definition of HzAV involves abelian varieties.
Thus we must further massage the formula.
Let νzAV : HzAV −→ Gm denote the multiplier character (so that νzAV (x) =
‡
x x). Also let ZHzAV (a)(A)1 (resp. ZHzAV (a)(R)1 ) denote the kernel of
|ν| : ZHzAV (a)(A) −→ R×
>0
(resp. the kernel of
|ν| : ZHzAV (a)(R) −→ R×
>0 ).

We have an exact sequence

{1} → ZHzAV (a)(R)1 → ZHzAV (a)(Q)\ZHzAV (a)(A)1 →
→ ZHzAV (a)(Q)\ZHzAV (a)(A∞ ) → {1},
and hence vol (ZHzAV (a)(Q)\ZHzAV (a)(A∞ )) equals
vol (ZHzAV (a)(Q)\ZHzAV (a)(A))vol (ZHzAV (a)(R)1 )−1 .
124

Moreover if we use Tamagawa measure on ZHzAV (a)(A)1 then the main theorem
of [Ko5] tells us that
vol (ZHzAV (a)(Q)\ZHzAV (a)(A∞ ))
= #A(ZHzAV (a)(Q))(# ker1 (Q, ZHzAV (a))−1 vol (ZHzAV (a)(R)1 )−1
= κB (# ker1 (Q, ZHzAV (a)(Q)))−1 vol (ZHzAV (a)(R)1 )−1 ,
where κB = 2 if [B : Q]/2 is even and κB = 1 otherwise. (See the introduction
to [Ko5], formula 4.2.2 of [Ko1], compute A(ZHzAV (a)(Q)) directly from the
definition and note that [B : Q]/2 is even if and only if [ZCz (a) : Q]/2 is.)
Thus the right hand side of the main equality of lemma 9.2 can be rewritten
(−1)h κB

1
1
AV
[a]⊂HzAV (Q) (# ker (Q, Hz )/# ker (Q, ZHzAV (a)))
G(h) (A∞ )
OιAV (a) (ϕ)vol (ZHzAV (a)(R)1 )−1 tr (ρ ⊗ ξ)(ιAV
z (a)),
z

z∈PHT(h)

where we use measures on ZHzAV (a)(R)1 and ZG(h) (A∞ ) (a) compatible with Tamagawa measure on ZHzAV (a)(A)1 and the exact sequence
{1} → ZHzAV (a)(R)1 → ZHzAV (a)(A)1 → ZG(h) (A∞ ) (ιAV
z (a)) → {1}.
Now suppose that a and a ∈ HzAV (Q) are conjugate under HzAV (A). Then
ZHzAV (a) and ZHZAV (a ) are inner forms of each other which become isomorphic
over A. Moreover the Tamagawa measures on ZHzAV (a)(A)1 and ZHzAV (a )(A)1
agree under this isomorphism (use the definition of Tamagawa measure and
the discussion in paragraph two on page 631 of [Ko3]). Thus
G(h) (A∞ )

OιAV (a)
z

G(h) (A∞ )

(ϕ)vol (ZHzAV (a)(R)1 )−1 = OιAV (a ) (ϕ)vol (ZHzAV (a )(R)1 )−1 .
z

The number of HzAV (Q)-conjugacy classes in the HzAV (A)-conjugacy class
of a in HzAV (Q) is
# ker(ker1 (Q, ZHzAV (a)) −→ ker1 (Q, HzAV )).
For the moment let Z (resp. Z ) denote the centre of HzAV (resp. ZHzAV (a)).
Then we have homomorphisms
ker1 (Q, Z) −→ ker1 (Q, Z ) −→ ker1 (Q, ZHzAV (a)) −→ ker1 (Q, HzAV ),
where as on pages 393 and 394 of [Ko3] we see that
∼

ker1 (Q, Z ) −→ ker1 (Q, ZHzAV (a))
125

and

∼

ker1 (Q, Z) −→ ker1 (Q, HzAV ).
Thus
# ker(ker1 (Q, ZHzAV (a)) −→ ker1 (Q, HzAV ))
equals
# ker1 (Q, ZHzAV (a))/# ker1 (Q, HzAV ).
In particular this number only depends on a up to HzAV (A)-conjugacy. Thus
we may again rewrite the right hand side of the main equality of lemma 9.2 as
G(h) (A∞ )

(−1)h κB

OιAV (a)
z

z∈PHT(h)

a

(ϕ)vol (ZHzAV (a)(R)1 )−1 tr (ρ ⊗ ξ)(ιAV
z (a)),

where the second sum runs over representatives of HzAV (A)-conjugacy classes
of elements a ∈ HzAV (Q) such that F (a) ⊃ M (if z = (M, w, [j])) and where
we use Haar measures on ZHzAV (a)(R)1 and ZG(h) (A∞ ) (a) compatible with Tamagawa measure on ZHzAV (a)(A)1 and the exact sequence
{1} → ZHzAV (a)(R)1 → ZHzAV (a)(A)1 → ZG(h) (A∞ ) (ιzAV (a)) → {1}.
Consider the following three sets.
(h)

1. The set FPAV of pairs (z, [a]) where z = (M, w, [j]) ∈ PHT(h) and [a] is
a HzAV (A)-conjugacy class in HzAV (Q) such that F (a) ⊃ M .
(h)

2. The set FPLA of triples (z, τ0 , [a]) where z = (M, w, [j]) ∈ PHT(h) , τ0 :
LA
(A) conjugacy class of elements
M → C extends τ0 and [a] is a Hz,τ
0
LA
LA
(R)
a ∈ Hz,τ0 (Q) such that F (a) ⊃ M and with a is elliptic in both Hz,τ
0
(h)

×
+
and Dz,
= Q and n = 2 drop the τ0 , so that FPLA simply
w . (If F
consists of pairs (z, [a]).))

3. The set FP(h) of equivalence classes of pairs (a, w) where a ∈ G(Q) is
an element which is elliptic in G(R) and where w is a place of the field
F (a) above w such that
(n − h)[F (a) : F ] = n[F (a)w : Fw ].
We consider two pairs (a, w) and (a , w ) equivalent if a and a are con∼
jugate by an element of G(A) which induces an isomorphism F (a)w →
F (a )w taking w to w .

126

If (a, w) ∈ FP(h) then we define an element ι(a, w) ∈ G(h) (A∞ ) as follows.
We set ι(a, w)p = a ∈ G(A∞,p ). We set ι(a, w)p,0 = ν(a) ∈ Q×
p . If x|u is a
op ×
place of F other than w then we set ι(a, w)x = a ∈ (Bx ) . We set ι(a, w)0w =
×
e
→ DF×w ,n−h . Finally we set ι(a, w)w
a ∈ F (a)w
= a ∈ x F (a)×
x ⊂ GLh (Fw ),
where the product is over places x = w of F (a) which divide w. Note that
ι(a, w) is well defined up to G(h) (A∞ )-conjugacy.
(h)
Our expression for tr (ϕ|Hc (I (h) , Fρ ⊗ Lξ )) is in terms of a sum over FPAV .
We wish to turn this into a sum over FP(h) . To this end we will consider two
maps.
(h)

(h)

1. The map φ : FPLA → FPAV which sends (z, τ0 , [a]) to the pair (z, [a ])
where a is an element of HzAV (Q) conjugate to a in HzLA (A∞,p ) ∼
=
HzAV (A∞,p ). We will see below that such an a exists and is unique
up to HzAV (A)-conjugacy.
(h)

2. The map ψ : FPLA → FP(h) which sends (z, τ0 , [a]) (with z = (M, w, [j])
to (ιLA
z (a), w ) where w is the unique place of M (a) above the place w
of M .
Lemma 9.3 The map φ is well defined. It is surjective and the fibre of (z, [a])
has [F (a) : F ] elements, unless F + = Q, n = 2 and [F (a) : F ] = 2 in which
case it has 1 element.
Proof: Fix z = (M, w, [j]) ∈ PHT(h) and τ0 : M → C extending τ0 . We
LA
will give a natural map from conjugacy classes in Hz,τ
(A), which are elliptic
0
×
AV
LA
in Hz,τ0 (R) and Dz,w , to conjugacy classes in Hz (A) as follows.
LA
1. We use the isomorphism Hz,τ
(A∞,p ) ∼
= HzAV (A∞,p ), which is canonical
0
up to conjugacy, to associate conjugacy classes in these two groups.

2. We use the isomorphism
Q×
p ×

x|u,x=w

× ∼
Dz,x
= Q×
p ×

×
,
Cz,x
x|u,x=w

which is canonical up to conjugacy, to associate conjugacy classes in
these two groups.
× ∼
3. We use the natural identification with elliptic conjugacy classes in Dz,
w =
GLn/[M :F ] (Mw ) with conjugacy classes in Cz,×w . (Cz,w is a division algebra
with centre Mw and dimension (n/[M : F ])2 .)

127

LA
(R) to
4. We use the natural map from elliptic conjugacy classes in Hz,τ
0
AV
conjugacy classes in its compact mod centre inner form, Hz (R). This
map is surjective. (Elliptic conjugacy classes transfer to any inner form
and in HzAV (R) stable conjugacy and conjugacy coincide because HzAV (R)
is compact mod centre.)

We claim that under this map the preimage of [a] has [(M ⊗Q R)(a∞ ) :
M ⊗Q R] elements. (Unless M + = Q and n = 2 when it has only 1 element.) If
[a ] is one such preimage then the other preimages are just the [(a )∞ ×a∞ ] with
LA
a∞ stably conjugate to a∞ in Hz,τ
(R). Thus the preimages are in bijection
0
with
1
LA
LA (a∞ )) −→ H (R, Hz,τ )).
ker(H 1 (R, ZHz,τ
0
0

Elements of this set also parametrise equivalence classes of B ⊗F ((M ⊗Q
R)(a∞ ))-modules with a ∗⊗c-Hermitian R-alternating pairing which are equivalent as B ⊗F M ⊗Q R-modules with ∗ ⊗ c-Hermitian R-alternating pairing
to V ⊗ R with its standard pairing, ( , ). These in turn are parametrised
by sequences of pairs of integers (aτ , bτ ) for τ : (M ⊗Q R)(a∞ ) → R where
(aτ , bτ ) = (n/[(M ⊗Q R)(a∞ ) : F ⊗Q R], 0) for all but one such embedding τ1
for which τ1 |M = τ0 and (aτ1 , bτ1 ) = (n/[(M ⊗Q R)(a∞ ) : F ⊗Q R] − 1, 1). Thus
the preimage of [a] ⊂ HzAV (A) does have [(M ⊗Q R)(a∞ ) : M ⊗Q R] elements,
unless M + = Q and n = 2 when it has only 1 element.
LA
To complete the proof of the lemma it suffices to show that [a] ⊂ Hz,τ
(A)
0
AV
LA
maps to [a ] ⊂ Hz (A) then [a] contains an element of Hz,τ0 (Q) if and only if
[a ] contains an element of HzAV (Q). This follows from theorem 6.6 of [Ko2] if
we can verify that the group R(I/Q) of that paper vanishes for every centraliser
I of a semi-simple element in H(Q) where H/Q is a quasi-split inner form
LA
of HzAV (and hence of Hz,τ
). This can be verified as in lemma 2 of [Ko4].
0
Alternatively one can note that it fits in an exact sequence
ker1 (Q, I) → ker1 (Q, H) → Hom (R(I/Q), Q/Z) → A(I) → A(H) → (0)

(combine section 4.6 of [Ko2] with the definition of A(H) and A(I) and the
isomorphism 4.2.2 of [Ko1]). If [B : Q]/2 is odd then a direct calculation
shows that A(H) = A(I) = (0), while if [B : Q]/2 is even then the morphism
∼
A(I) → A(H) is the unique isomorphism Z/2Z → Z/2Z. On the other hand
the map ker1 (Q, I) −→ ker1 (Q, H) is surjective because (arguing as on pages
393 and 394 of [Ko3] we see that) the composite
ker1 (Q, Z(H)) −→ ker1 (Q, Z(I)) −→ ker1 (Q, I) −→ ker1 (Q, H)

(where Z(H) (resp. Z(I)) denotes the centre of H (resp. I)) is an isomorphism. Thus R(I/Q) = (0). ✷
128

Lemma 9.4 The map ψ is a bijection
(h)

∼

ψ : FPLA −→ FP(h) .
Proof: Suppose (a, w) represents an element of FP(h) . Let M denote the
minimal subfield of F (a) which contains F and for which w|M is inert in
F (a). (It is an exercise in the splitting of primes in number fields to show
such a unique minimal subfield exists.) Let j : M → B op be the tautological
embedding. Then the equivalence class of V ⊗Q R as a B ⊗F M ⊗Q R-module
(via j) with ∗ ⊗ c-Hermitian R-alternating pairing has invariants (aτ , bτ ) (for
τ : M + → R) with (aτ , bτ ) = (n/[M : F ], 0) for all τ except one for which we
get (n/[M : F ] − 1, 1). Call this exceptional embedding τ0 . Its restriction to
(h)
F + is τ0 . Then ((M, w|M , [j]), τ0 , [a]) is a point of FPLA mapping to the class
of (a, w) and it is unique. The lemma follows. (If F + = Q and n = 2 drop τ0 ,
which is no longer well defined.) ✷
Putting these results together we get the following formula for the trace of
ϕ on Hc (I (h) , Fρ ⊗ Lξ ).
×
Proposition 9.5 Suppose that ϕ ∈ Cc∞ (G(h) (A∞ )+ /Z×
p ×ODFw ,n−h ) is acceptable, then

tr (ϕ|Hc (I (h) , Fρ ⊗ Lξ )) = (−1)h κB
[F (a) :

[(a,w)]∈FP(h)
(h) (A∞ )
G
F ]−1 vol (ZG (a)(R)10 )−1 Oι(a)
(ϕ)tr (ρ ⊗

ξ)(ι(a)),

where κB = 2 if [B : Q]/2 is even and κB = 1 otherwise. (If F + = Q and
n = 2 we must drop the [F (a) : F ]−1 term.)
This sum is finite and all the terms occurring are finite numbers.
We choose measures on ZG(h) (A∞ ) (a) and on ZG (a)(R)10 compatible with
• Tamagawa measure on ZG (a)(A)1 ,
• the exact sequence
{1} −→ ZG (a)(R)1 −→ ZG (a)(A)1 −→ ZG (a)(A∞ ) −→ {1},
• the association of measures on ZG (a)(R)10 and ZG (a)(R)1 (see page 631
of [Ko5]),
• the association of measures on
Z(Bwop )× (a) ∼
=

GLn/[F (a):F ] (F (a)x )
x|w

129

and on
(ι(a)) ∼
ZD ×
=
Fw ,n−h ×GLh (Fw )
×
DF (a)w ,(n−h)/[F (a)w :Fw ] ×

x|w,x=w

GLh/([F (a):F ]−[F (a)w :Fw ]) (F (a)x )

(see page 631 of [Ko5]),
• and the isomorphism
ZG (a)(A∞ ) ∼
=
∞,p
ZG (a)(A ) × Q×
p × ZD ×

Fw ,n−h ×GLh (Fw )

10

(ι(a)) ×

r
i=2

Z(Bwopi )× (a).

The cohomology of Igusa varieties

In this section we compute Hc (I (h) , Fρ ⊗ Lξ ) in terms of H(X, Lξ ). We will
use results and notation from appendix IV without comment.
For h = 0, ..., n − 1 let Ph ⊂ GLn denote the parabolic subgroup consisting
of block upper triangular matrices with an (n − h) × (n − h)-block in the top
left hand corner and an (h × h)-block in the bottom right hand corner. We
will let Phop denote the opposite parabolic (lower triangular matrices with the
same block structure). Also let Nh (resp. Nhop ) denote the unipotent radical of
Ph (resp. Phop ) and Lh denote the Levi component Ph ∩ Phop (∼
= GLn−h × GLh ).
×
Fix an irreducible admissible representation ρ of DFw ,n−h . We will define
a homomorphism
×
×
Red(h)
ρ : Groth (GLn (Fw )) −→ Groth (DFw ,n−h /ODFw ,n−h × GLh (Fw ))

as follows.
First we have a homomorphism
Groth (GLn (Fw )) −→ Groth (GLn−h (Fw ) × GLh (Fw ))
1/2

which sends [π] to [JNhop (π) ⊗ δPh ] (see appendix I). Secondly we have a
homomorphism
×
× GLh (Fw ))
Groth (GLn−h (Fw ) × GLh (Fw )) −→ Groth (DF×w ,n−h /OD
Fw ,n−h

which sends [α ⊗ β] to
ψ

vol (DF×w ,n−h /Fw× )−1 tr α(ϕJL (ρ∨ ⊗ψ) )[ψ ⊗ β],
130

×
so that α and ρ∨ ⊗ψ have the
where ψ runs over characters of DF×w ,n−h /OD
Fw ,n−h
same central character, and where we use associated measures on GLn−h (Fw )
and DF×w ,n−h . (That this second map is well defined follows from corollary
IV.5.) Redρ(h) will denote the composite.
The homomorphism Red(h)
ρ extends naturally to a homomorphism
∞
(h)
(A∞ )).
Red(h)
ρ : Groth (G(A )) −→ Groth (G

We will need a couple of lemmas in local harmonic analysis. It is convenient
to fix
×
• the Haar measure on Fw× giving OF,w
volume 1,
×
• the Haar measure on DF×w ,n−h giving OD
F

volume 1,

W ,n−h

• and the Haar measure on GLn−h (Fw ) associated to our choice of Haar
measure on DF×w ,n−h .
Lemma 10.1 Suppose that ϕ0 ∈ Cc∞ (DF×w ,n−h /OF×w ,n−h ). Then we can find
an element PCρ (ϕ0 ) ∈ Cc∞ (GLn−h (Fw )) with the following properties.
1. If π is an irreducible admissible representation of GLn−h (Fw ) then
tr π(PCρ (ϕ0 )) =
ψ

tr ψ(ϕ0 )vol (DF×w ,n−h /Fw× )−1 tr π(ϕJL (ρ∨ ⊗ψ) )

×
where ψ runs over characters of DF×w ,n−h /OD
so that α and ρ∨ ⊗ ψ
Fw ,n−h
have the same central character.

2. If g ∈ GLn−h (Fw ) is a non-elliptic semi-simple element then
OgGLn−h (Fw ) (PCρ (ϕ0 )) = 0.
3. If g ∈ GLn−h (Fw ) is an elliptic semi-simple element and if g ∈ DF×w ,n−h
is an element with the same characteristic polynomial then
−1 )

OgGLn−h (Fw ) (PCρ (ϕ0 )) = (−1)(n−h)(1−[Fw (g):Fw ]

D×

Og Fw ,n−h (ϕ0 )tr ρ(g).

4. If g ∈ GLn−h (Fw ) is in the support of PCρ (ϕ0 ) and if λ is an eigenvalue
of g then (n − h)w(λ) is in the image under w ◦ det of the support of ϕ0 .
131

∼

×
Proof: Via w ◦ det : DF×w ,n−h /OD
→ Z we may and we shall think
Fw ,n−h
∞
0
0
of ϕ ∈ Cc (Z). We will let A denote the set of elements of GLn−h (Fw ) all
whose eigenvalues have w-valuation in the image under (n − h)−1 w ◦ det of the
support of ϕ0 . We will let Am ⊂ GLn−h (Fw ) denote (w ◦ det)−1 ({m}). We
then set
PCρ (ϕ0 ) = (ϕ0 ◦ w ◦ det)ϕJL (ρ∨ ) char A0 ,

and

ϕ = (ϕ0 ◦ w ◦ det)ϕJL (ρ∨ ) .

Note that by definition PCρ (ϕ0 ) has property 4 of the lemma.
It follows from lemma IV.1 that for a non-elliptic regular semi-simple element g ∈ GLn−h (Fw ) we have
OgGLn−h (Fw ) (ϕ) = 0,
while if g ∈ GLn−h (Fw ) is a elliptic regular semi-simple element and if g ∈
DF×w ,n−h is an element with the same characteristic polynomial then
OgGLn−h (Fw ) (ϕ) = (−1)n−h−1 vol (DF×w ,n−h /ZD×

Fw ,n−h

(g))ϕ0 (g)tr ρ(g).

Parts 2 and 3 of the lemma follow (because the valuation of all eigenvalues of
an elliptic element of GLn (Fw ) are equal).
It also follows that at all regular semi-simple elements of GLn−h (Fw ) the
functions ϕ and PCρ (ϕ0 ) have the same orbital integrals. Hence by theorem
2f of appendix 1 of [DKV] we see that for any admissible representation π of
GLn−h (Fw ) we have
tr π(ϕ) = tr π(PCρ (ϕ0 )).
Thus it suffices to prove the first part of the lemma with ϕ replacing PCρ (ϕ0 ).
Suppose that π is an irreducible admissible representation of GLn−h (Fw )
with central character ψπ . Also let ψρ denote the central character of ρ. If
ψπ |O× = ψρ |−1
then tr π(ϕ) = 0 as desired. Thus suppose that ψπ |O× =
O×
Fw

ψρ |

×
OF
w

=
=
=
=
=
=

. Then

Fw

Fw

tr π(ϕ)
0
x∈Z ϕ (x)tr π(ϕJL (ρ∨ ) char Ax )
n−h−1
0
i=0
x≡imodn−h ϕ (x)(ψπ ψρ )((x − i)/(n − h))tr π(ϕJL (ρ∨ ) char Ai )
n−h−1
−1
0
i=0
x∈Z (n − h)
ψ n−h =ψπ ψρ ϕ (x)ψ(x − i)tr π(ϕJL (ρ∨ ) char Ai )
tr π(ϕJL (ρ∨ )⊗ψ char Ai )
(n − h)−1 ψn−h =ψπ ψρ x∈Z ϕ0 (x)ψ(x) n−h−1
i=0
×
0
−1
−1
ψ n−h =ψπ ψρ tr ψ(ϕ )(n − h) vol (ODFw ,n−h ) tr π(ϕJL (ρ∨ )⊗ψ )
×
0
× −1
ψ n−h =ψπ ψρ tr ψ(ϕ )vol (DFw ,n−h /Fw ) tr π(ϕJL (ρ∨ )⊗ψ ).
132

The lemma follows. ✷
Lemma 10.2 Let ρ be an irreducible admissible representation of DF×w ,n−h .
×
) and that ϕe ∈ Cc∞ (GLh (Fw )). SupSuppose that ϕ0 ∈ Cc∞ (DF×w ,n−h /OD
Fw ,n−h
pose moreover that if g 0 (resp. g e ) is in the support of ϕ0 (resp. ϕe ) then the padic valuation of every eigenvalue of g 0 is strictly less than the p-adic valuation
of every eigenvalue of g e . Also fix Haar measures µn and µh on GLn (Fw ) and
GLh (Fw ). Then we can find a function IPCρ (ϕ0 , ϕe ; µn , µh ) ∈ Cc∞ (GLn (Fw ))
with the following properties.
1. Let g ∈ GLn (Fw ) be a semi-simple element. Then
GLn (Fw )

Og

(IPCρ (ϕ0 , ϕe ; µn , µh )) =

(−1)n−h−1

(g 0 ,g e )

GLh (Fw )

Oge

D×

(ϕe )Og0Fw ,n−h (ϕ0 )tr ρ(g 0 ),

where (g 0 , g e ) runs over a set of representatives for conjugacy classes in
DF×w ,n−h × GLh (Fw ) such that, if g 0 denotes a semi-simple element of
GLn−h (Fw ) with the same characteristic polynomial as g 0 , then (g 0 , g e )
GL (F )
is conjugate to g in GLn (Fw ). Whenever (tr ρ(g 0 ))Oge h w (ϕe ) = 0 we
see that ZGLn−h (Fw )×GLh (Fw ) (g 0 × g e ) = ZGLn (Fw ) (g 0 , g e ) and we take corresponding measures on these two groups in the two sides of this equality
of orbital integrals.
2. If π is an irreducible admissible representation of GLn (Fw ) and if
1/2

[JNhop (π) ⊗ δPh ] =

α,β

mα,β [α ⊗ β]

with α (resp. β) running over irreducible admissible representations of
GLn−h (Fw ) (resp. GLh (Fw )) and with mα,β ∈ Z (and almost all 0), then
tr π(IPCρ (ϕ0 , ϕe ; µn , µh )) =
= α,β,ψ tr ψ(ϕ0 )mα,β vol (DF×w ,n−h /Fw× )−1 tr α(ϕJL (ρ∨ ⊗ψ) )tr β(ϕe )
with α (resp. β, resp. ψ) running over irreducible admissible represen×
tations of GLn−h (Fw ) (resp. GLh (Fw ), resp. DF×w ,n−h /OD
).
Fw ,n−h
Proof: The choice of measure µh on GLh (Fw ) and our fixed choice of Haar
measure on GLn−h (Fw ) determine a Haar measure on Lh (Fw ).
Let E0 (resp. Ee ) denote the set of p-adic valuations of elements in the
support of ϕ0 (resp. ϕe ). By our assumptions E0 and Ee are disjoint finite
133

sets. Let S denote the set of elements g 0 × g e ∈ Lh (Fw ) such that the p-adic
valuations all the eigenvalues of g 0 lie in E0 and the p-adic valuations of all
the eigenvalues of g e lie in Ee . If g ∈ S then ZGLn (Fw ) (g) = ZLh (Fw ) (g). By
lemma 10.1 S contains the support of PCρ (ϕ0 ) × ϕe .
Define a function on GLn (Fw ) by
L (Fw )

Og h

W (g) =
g

(PCρ (ϕ0 ) × ϕe ),

where the sum is over sets of representatives of Lh (Fw )-conjugacy classes contained in the GLn (Fw ) conjugacy class of g. We will show that this function
satisfies the hypotheses of theorem B of section 1.n. of [V1]. It will then follow
from that theorem that there is a function
IPC(ϕ0 , ϕe ; µn , µh ) ∈ Cc∞ (GLn (Fw ))
such that for all g ∈ GLn (Fw ) we have
L (Fw )

OgGLn (Fw ) (IPC(ϕ0 , ϕe ; µn , µh )) =

Og h
g

(PCρ (ϕ0 ) × ϕe ),

where the sum is over sets of representatives of Lh (Fw )-conjugacy classes contained in the GLn (Fw ) conjugacy class of g, where we use our fixed measures
L (F )
on GLn (Fw ) and Lh (Fw ), and where whenever Og h w (PCρ (ϕ0 ) × ϕe ) = 0 we
use conjugate measures on the conjugate groups ZGLn (g)(Fw ) and ZLh (g )(Fw ).
The first part of the lemma will then follow from this and lemma 10.1.
First note that W is clearly invariant under conjugation.
Now suppose that (T, u) is a standard pair (for GLn (Fw )) in the sense of
section 1.m of [V1]. If t ∈ T we will let E(t) denote the multiset of p-adic
valuations of eigenvalues of t. We will also let E0 (t) (resp. Ee (t)) denote the
submultiset of E(t) consisting of elements which also lie in E0 (resp. Ee ). Note
that tu is conjugate to an element of S if and only if t is conjugate to an
element of S if and only if #E0 = n − h and #Ee = h. In particular the
support of W in T u is contained in the set tu such that the p-adic valuation
of all the eigenvalues of t lie in the finite set E0 ∪ Ee . Hence W has compact
support in T u.
We will let S(T ) denote the set of elements t ∈ T which are conjugate to
an element of S. If s ∈ S(T ) and gsg −1 ∈ S then
gT ug −1 ⊂ ZGLn (Fw ) (gtg −1 ) ⊂ Lh (Fw ).

If t ∈ T ∩ g −1 Sg then

L (F )

w
0
e
h
W (tu) = Ogtug
−1 (PCρ (ϕ ) × ϕ ).

134

In particular if s is a regular element of T (in the sense of section 1.l. of [V1])
then we see that W is constant in some neighbourhood of s (by, for instance,
theorem A of section 1.n. of [V1]).
Suppose s ∈ T . Let u1 = u, u2 , ..., um be unipotent elements of ZGLn (Fw ) (s)
such that
• for all i the GLn (Fw )-orbit of sui is open in the union of the GLn (Fw )orbits of suj for j ≤ i;
• and for any unipotent element v ∈ ZGLn (Fw ) (s), su is in the closure of
the GLn (Fw )-orbit of sv if and only if sv is GLn (Fw ) conjugate to some
suj .
(See section 1.j. of [V1].) Fix a Haar measure on ZGLn (s)(Fw ). This determines a canonical Haar measure on each ZGLn (suj )(Fw ) (see section 1.d. of
GL (F )
GL (F )
[V1]). Then we can choose functions f1 n w , ..., fm n w ∈ Cc∞ (GLn (Fw ))
such that
GLn (Fw )

• for j < i the support of fi
suj ,
GL (Fw )

• if j = i then Osuj n
GL (Fw )

• and Osui n

GLn (Fw )

(fi

GLn (Fw )

(fi

does not meet the GLn (Fw )-orbit of

) = 0,

) = 1.

(See section 1.k. of [V1].) To verify the hypotheses of theorem B of section
1.n. of [V1] it remains to show that there is a neighbourhood V of s in T such
that for all t ∈ V which are regular in T (in the sense of section 1.l. of [V1])
we have the equality
GLn (Fw )

W (tu) =

W (sui )Otu

GLn (Fw )

(fi

).

i

(This equality is independent of the choice of Haar measure on ZGLn (tu)(Fw )
as long as in the case W (tu) = 0 we choose the conjugate Haar measure on
ZLh (atua−1 )(Fw ) = aZGLn (tu)(Fw )a−1 , where atua−1 ∈ S.)
First suppose that s ∈ S(T ). Then each W (sui ) = 0. On the other hand
we can find a neighbourhood V of s in T such that if t ∈ V then E(t) = E(s).
Then V ∩ S(T ) = ∅ and so for any t ∈ V we have W (tu) = 0 and the desired
equality holds.
Now suppose that s ∈ S(T ) and that gsg −1 ∈ S. Replacing T by gT g −1 , s
by gsg −1 and u by gug −1 we may suppose that T ⊂ Lh , s ∈ S and u ∈ Lh (Fw ).
Because s ∈ S we see
135

• that for each i, ui ∈ Lh (Fw );
• that for all i the Lh (Fw )-orbit of sui is open in the union of the Lh (Fw )orbits of the suj for j ≤ i;
• and that for any unipotent element v ∈ ZGLn (Fw ) (s), su is in the closure
of the Lh (Fw )-orbit of sv if and only if sv is Lh (Fw )-conjugate to some
suj .
It follows from lemma 2.5. of [V1] that we can find a neighbourhood V of s in
T such that
• V ⊂S
• and for any compact set A ⊂ GLn (Fw ) one can find a compact set C ⊂
Lh (Fw )\GLn (Fw ) such that, if Lh (Fw )g ∈ C then for each i = 1, ..., m
g −1 V ui g ∩ A = ∅.
As in section 2.5. of [V1] it follows that we can find h ∈ Cc∞ (GLn (Fw )) such
that
h(xg)dx
Lh (Fw )

is 1 if Lh (Fw )g ∈ C and 0 otherwise. If we set
Lh (Fw )

fi

GLn (Fw )

(g) =
GLn (Fw )

h(x)fi

(x−1 gx)dx

then we see that
Lh (Fw )

• fi

∈ Cc∞ (Lh (Fw )),
Lh (Fw )

• for j < i the support of fi

does not meet the Lh (Fw )-orbit of suj ,

• for t ∈ V and for any i, j = 1, ..., m we have
GL (Fw )

Otuj n

GLn (Fw )

(fi

(argue as page 954 of [V1]),
L (Fw )

• if j = i then Osuhj
L (Fw )

• and Osuhi

Lh (Fw )

(fi

Lh (Fw )

(fi

) = 0,

) = 1.
136

L (Fw )

) = Otuhj

Lh (Fw )

(fi

)

Using theorem A of section 1.n. of [V1] we see that for t ∈ V which is also
regular as an element of T we have
W (tu) =
=

L (Fw )

L (F )

Osuhi w (PCρ (ϕ0 ) × ϕe )Otuh
GLn (Fw )
GL (F )
(fi n w ).
i W (sui )Otu
i

Lh (Fw )

(fi

)

This completes the proof of the first part of the lemma.
For the second part, the Weyl integration formula tells us that
tr π(IPCρ (ϕ0 , ϕe ; µn , µh )) = T (#WG (T ))−1
GL (F )
DG (t)Ot n w (IPCρ (ϕ0 , ϕe ; µn , µh ))χπ (t)dt,
T reg
where
• T runs over GLn (Fw )-conjugacy classes of maximal tori in GLn (Fw ),
• WG (T ) denotes the normaliser of T in GLn (Fw ) modulo T ,
• T reg denotes the subset of regular elements of T ,
• DG (t) = | det((ad (t) − 1)|Lie G/Lie T )|.
(See for instance section A.3.f of [DKV] and note that χπ is locally integrable.)
By the first part of the lemma this can be rewritten
tr π(IPCρ (ϕ0 , ϕe ; µn , µh )) = T (#WLh (Fw ) (T ))−1
GL
(F )
GL (F )
DG (t0 × te )Ot0 n−h w (PCρ (ϕ0 ))Ote h w (ϕe )χρ (t)dt0 dte ,
T reg
where now
• T runs over Lh (Fw )-conjugacy classes of maximal tori in Lh (Fw ),
• and WLh (Fw ) (T ) denotes the normaliser of T in Lh (Fw ) modulo T .
Let Pt0 ×te denote the parabolic associated to t0 × te as in section 2 of [Cas].
If Pt0 ×te is not a subset of Phop then by the assumption on the supports of ϕ0
and ϕe and by lemma 10.1 we see that
GLn−h (Fw )

Ot0

GLh (Fw )

(PCρ (ϕ0 ))Ote

(ϕe ) = 0.

If on the other hand Pt0 ×te ⊂ Phop then
• DG (t0 × te ) = DLh (t0 × te )δPh (t0 × te ) (from the definitions)
• and χπ (t0 × te ) = χπN op (t0 × te ) (by theorem 5.2 of [Cas]).
h

137

Thus we obtain
tr π(IPCρ (ϕ0 , ϕe ; µn , µh ))
−1
=
T (#WLh (Fw ) (T ))
GL
(F )
GL (F )
DLh (Fw ) (t0 × te )Ot0 n−h w (PCρ (ϕ0 ))Ote h w (ϕe )χπN op (t)δPh (t)dt
T reg
h

1/2

= tr (JNhop (π) ⊗ δPh )(PCρ (ϕ0 ) × ϕe ),

and the second part of the lemma follows. ✷
Corollary 10.3 If π is an admissible representation of GLn (Fw ) and if ϕ0 ,
ϕe , µn and µh are as in the lemma then
tr Redρ(h) (π)(ϕ0 × ϕe ) = tr π(IPCρ (ϕ0 , ϕe ; µn , µh )).

We can now prove our second main theorem.
Theorem 10.4
×

Redρ(h) [H(X, Lξ )Zp ] = n[Hc (I (h) , Fρ ⊗ Lξ )]

in Groth (G(h) (A∞ )).

Proof: By lemma 9.1, it suffices to check that for any
×
• ϕp ∈ Cc∞ (G(A∞,p ) × (Q×
p /Zp ) ×

r
op ×
i=2 (Bwi ) ),

×
• ϕ0 ∈ Cc∞ (DF×w ,n−h /OD
),
Fw ,n−h

• and ϕe ∈ Cc∞ (GLh (Fw )),

such that ϕ = ϕw × ϕ0 × ϕe is acceptable, we have

(h)
tr (Red(h)
, Lξ ⊗ Fρ )(ϕ).
ρ (H(X, Lξ )))(ϕ) = ntr Hc (I

(Note that, if C ∈ R and ψ0 , ..., ψm are characters of Z we can a function
ϕ ∈ Cc∞ (Z>C ) such that ψ0 (ϕ ) = 1 but ψi (ϕ ) = 0 for i = 1, ..., m.)
But by corollary 10.3, proposition VII.1 and lemma 10.2 we have
tr (Redρ(h) (H(X, Lξ )))(ϕ)
= tr H(X, Lξ )(ϕw × IPCρ (ϕ0 , ϕe ; µn , µh ))
= (−1)n κB n a [F (a) : F ]−1 (−1)n/[F (a):F ] vol (ZG (a)(R)10 )−1
G(A∞ )
Oa
(ϕw × IPCρ (ϕ0 , ϕe ; µn , µh ))
= (−1)h κB n [(a,w)]∈FP(h) [F (a) : F ]−1 (−1)n/[F (a):F ]−(n−h)/[F (a)w :Fw ]
G(h) (A∞ )

vol (ZG (a)(R)10 )−1 Oι(a)

(ϕ)tr (ρ ⊗ ξ)(ι(a)),

where we drop the term [F (a) : F ]−1 if n = 2 and F + = Q. Here κB = 2
if [B : Q]/2 is even and = 1 otherwise and the choices of measures are as
in proposition 9.5. Comparing this formula with proposition 9.5, the trace
identity and hence the theorem follows. ✷
138

11

The main theorems

To state our third main theorem let us establish a little more notation. Let
red(h)
ρ : Groth (GLn (Fw )) −→ Groth (GLh (Fw ))
to be the composite of the map
Groth (GLn (Fw )) −→ Groth (GLn−h (Fw ) × GLh (Fw ))
1/2
[π] −→ [JNhop (π) ⊗ δPh ]
and the map
Groth (GLn−h (Fw ) × GLh (Fw )) −→ Groth (GLh (Fw ))
which sends [α ⊗ β] to
vol (DF×w ,n−h /Fw× )−1 tr α(ϕJL (ρ∨ ) )[β]
if the product of the central characters of α and ρ is 1 and sends [α ⊗ β] to 0
otherwise. Then red(h)
ρ extends to a homomorphism
r
∞

Groth (G(A )) −→ Groth (G(A

∞,p

)×

Q×
p

× GLh (Fw ) ×

(Bwopi )× ).
i=2

Note that
Red(h)
ρ (π) =
ψ

ψ ⊗ redρ(h) (π),

×
where ψ runs over characters of DF×w ,n−h /OD
.
Fw ,n−h
Combining theorems 7.9 and 10.4 we at once obtain the following result.

Theorem 11.1 In Groth l (G(A∞ ) × WFw ) we have
×

n[H(X, Lξ )Zp ] =

n−1

×

n
w
Ind Ph (F
redρ(h) [H(X, Lξ )Zp ] ∗|Art −1 | [ΨFw ,l,n−h (ρ)]
w)

GL (F )

K

h=0

ρ

where ρ runs over irreducible admissible representations of DF×w ,n−h and where
Z
×
|Art −1
K | : WFw → p ⊂ Qp .
Let us rephrase this theorem another way. Define
r

n-red(h)
ρ

∞

: Groth (G(A )) −→ Groth (G(A
139

∞,p

)×

Q×
p

× GLh (Fw ) ×

(Bwopi )× )
i=2

1/2

op
in the same manner we defined red(h)
ρ except that we replace JNh (π) ⊗ δPh by
simply JNhop (π). We may decompose

[H(X, Lξ )] =

[π][Rξ (π)]
π

where π runs over irreducible admissible representations of G(A∞ ) and where
[Rξ (π)] ∈ Groth (Gal (F ac /F )). We will need the following lemma, which
follows from lemma 4.1 and corollary VI.2.
Lemma 11.2 Suppose that π and π are irreducible admissible representations
of G(A∞ ) such that
• πp ∼
= (π )p ,
• [Rξ (π)] = 0,
• and [Rξ (π )] = 0.
Then πp ∼
= πp .
Then we have the following reformulation of theorem 11.1.
Theorem 11.3 Suppose that π = π p × πp,0 × πw1 × ... × πwr is an irreducible admissible representation of G(A∞ ) such that πp,0 |Zp× = 1. Then in
Groth l (GLn (Fw ) × WFw ) we have
GL (F )

(h)
w
n
n[πw ][Rξ (π)|WFw ] = (dim[Rξ (π)]) n−1
ρ n-Ind Ph (Fw ) ((n-redρ [πw ])
h=0
−h/2
−1
⊗ | |p ) ◦ Art −1
[ΨFw ,l,n−h (ρ) ⊗ ((πp,0
Qp )|WFw ])

where ρ runs over irreducible admissible representations of DF×w ,n−h .
As a special case we get the following consequence.
Corollary 11.4 Suppose that π = π p × πp,0 × πw1 × ... × πwr is an irreducible
admissible representation of G(A∞ ) such that πp,0 |Zp× = 1 and πw is supercuspidal. Then in Groth l (GLn (Fw ) × WFw ) we have
−1
n[πw ][Rξ (π)|WFw ] = (dim[Rξ (π)])[ΨFw ,l,n (JL −1 (πw )∨ ) ⊗ (πp,0
◦ Art −1
Qp )|WFw ].

Proof: Use the following facts.
• If πw is supercuspidal and if N is the unipotent radical of a proper
parabolic subgroup of GLn (Fw ) then JN (πw ) = (0).
140

• If πw is a supercuspidal representation of GLn (Fw ) and if πw is a square
integrable representation of GLn (Fw ) with the same central character,
then it follows from the results listed in appendix IV that tr πw (ϕπw ) = 0
unless πw ∼
= πw in which case it equals vol (DF×w ,n /Fw× ).
✷
Theorem 11.5 Suppose that K is a p-adic field and l = p is a prime. Suppose
that π is a supercuspidal representation of GLg (K). Then there is a continuous
semi-simple representation
rl (π) : WK −→ GLg (Qlac )
such that
[ΨK,l,g (JL −1 (π ∨ ))] = [π ⊗ rl (π)].
Proof: Choose (E, F + , w, B, ∗, τ0 , β, Λi , ξ) as in section 1 and such that
• Fw+ ∼
= K,
• [B : F ] = g 2 ,
• and ξ is sufficiently regular that H i (X, Lξ ) = (0) for i = g − 1 (see the
last paragraph of section 1 of [Ko4] for the existence of such a ξ).
By corollary VII.2 we may choose an irreducible admissible representation π
of G(A∞ ) such that
• [Rξ (π)] = 0,
×
• πw ∼
,
= π ⊗ (ψ ◦ det) for some unramified character ψ of K × /OK

• and πp,0 |Z×p = 1.
By the previous corollary we see that in Groth l (GLg (K) × WK ) we have
−1
g[πw ⊗ Rξ (π)|WK ] = (dim[Rξ (π)])[ΨK,l,g (JL −1 (πw∨ )) ⊗ (πp,0
◦ Art 1Qp )|WK ].

Thus, if we set
−1
[rl (π)] = g(dim[Rξ (π)])−1 [Rξ (π)|WK ⊗ (πp,0 ◦ Art −1
Qp )|WK ⊗ (ψ ◦ Art K )],

we see that
[rl (π)] ∈ Groth l (WK )
141

and
[ΨK,l,g (JL −1 (π ∨ ))] = [π][rl (π)].
Clearly dim[rl (π)] = g. Finally by our assumption on ξ, we see that Rξ (π)
is a true representation and hence [rl (π)] can also be represented by a true
representation rl (π). ✷
The following lemma follows from the definitions, from lemma 3.7 and from
lemma 3.8.
Lemma 11.6 Suppose that K and K are p-adic fields and l = p is a prime.
∼

1. If σ : K → K is an isomorphism of Qp -algebras then for any irreducible
supercuspidal representation π of GLg (K ) we have
rl (π ◦ σ) = rl (π )σ ,
∼

where, if we fix an extension σ of σ to an isomorphism σ : K ac → (K )ac ,
then rl (π )σ (x) = rl (π )(σxσ −1 ).
2. If σ ∈ Aut (Qlac ) and if π is an irreducible supercuspidal representation
of GLg (K) then
rl (σ(π)) = σ(rl (π)).
3. If π is an irreducible supercuspidal representation of GLg (K) and if ψ is
×
then
a character of K × /OK
−1
).
rl (π ⊗ (ψ ◦ det)) = rl (π) ⊗ (ψ −1 ◦ Art K
−1
4. If π is a character of K × then rl (π) = π −1 ◦ Art K
.

For the rest of this section we will use without comment the notation
established in appendix IV.
Theorem 11.7 Suppose that K is a p-adic field and l = p is a prime. Suppose
also that s and g are positive integers and that π is an irreducible supercuspidal
representation of GLg (K). Then
[ΨK,l,gs (JL −1 (Sp s (π)∨ ))] =
s
s−j
[Sp j (π) (π ⊗ | det |j ) ... (π ⊗ | det |s−1 )]
j=1 (−1)
g(1−s)/2
[rl (π ⊗ | det |j−1 ) ⊗ |Art −1
].
K |
Proof: We will argue by induction on s. The case s = 1 is just the previous
theorem. Thus suppose the theorem is proved for all s < s.
Choose (E, F + , w, B, ∗, τ0 , β, Λi , ξ) as in section 1 and such that
142

• Fw+ ∼
= K,
• and [B : F ] = g 2 s2 .
By corollary VII.2 we may choose an irreducible admissible representation π
of G(A∞ ) such that
• dim[Rξ (π)] = 0,
×
• πw ∼
,
= Sp s (π) ⊗ (ψ ⊗ det) for some character ψ of K × /OK

• and πp,0 |Zp× = 1.
If we write π for π ⊗ (ψ ◦ det), then by theorem 11.3 and lemma IV.3 we
see that
gs[Sp s (π )][Rξ (π)] =
(dim[Rξ (π)])
ΨK,l,g(s−h ) (JL

GLsg (K)
[Sp h (π ⊗
gh (K)
−1
⊗|
(Sp s−h (π )∨ )) ⊗ ((πp,0

s−1
h =0
−1

n-Ind P

| det |s−h )×
−gh /2

|p

) ◦ Art −1
Qp )|WK ].

By the inductive hypothesis we may rewrite this
g(s−1)/2

gs[Sp s (π )][Rξ (π) ⊗ ((πp,0 ⊗ | |p

) ◦ Art −1
Qp )|WK ] =

g(s−1)/2
]+
(dim[Rξ (π)])[ΨK,l,gs (JL −1 (Sp s (π )∨ )) ⊗ |Art −1
K |
GLgs (K)
s−h
s−1
s−h −j
n-Ind P (K) [(Sp j (π ) (π ⊗ | det |j )
(dim[Rξ (π)]) h =1 j=1 (−1)
h g
... (π ⊗ | det |s−h −1 )) × Sp h (π ⊗ | det |s−h )][rl (π ⊗ | det |j−1 )].

143

By lemma IV.2 this can be rewritten
g(s−1)/2
]=
[ΨK,l,gs (JL −1 (Sp s (π )∨ )) ⊗ |Art −1
K |
g(s−1)/2

gs(dim[Rξ (π)])−1 [Sp s (π )][Rξ (π) ⊗ ((πp,0 ⊗ | |p
) ◦ Art −1
Qp )|WK ]−
s−1
s−1−h
)]−
h =1 [Sp s (π )][rl (π ⊗ | det |
s−1
s−1−h
s−h −j
(−1)
[ω(Γj,s−1−h −j,h +1 (π ))][rl (π ⊗ | det |j−1 )]−
h =1
j=1
s−1
s−h
s−h −j
[ω(Γj,s−h −j,h (π ))][rl (π ⊗ | det |j−1 )] =
h =1
j=1 (−1)
g(s−1)/2

) ◦ Art −1
gs(dim[Rξ (π)])−1 [Sp s (π )][Rξ (π) ⊗ ((πp,0 ⊗ | |p
Qp )|WK ]−
s−1
s−1−h
)]+
h =1 [Sp s (π )][rl (π ⊗ | det |
s−2
s−j
s−h −j
[ω(Γj,s−h −j,h (π ))][rl (π ⊗ | det |j−1 )]−
j=1
h =2 (−1)
s−j
s−1
s−h −j
[ω(Γj,s−h −j,h (π ))][rl (π ⊗ | det |j−1 )] =
j=1
h =1 (−1)
g(s−1)/2

) ◦ Art −1
gs(dim[Rξ (π)])−1 [Sp s (π )][Rξ (π) ⊗ ((πp,0 ⊗ | |p
Qp )WK ]−
s−1
s−1−h
)]+
h =1 [Sp s (π )][rl (π ⊗ | det |
s−1
s−j
[ω(Γj,s−1−j,1 (π ))][rl (π ⊗ | det |j−1 )] =
j=1 (−1)
s
j=1 [Sp j (π

(π ⊗ | det |j )

)
[Sp s (π )][A ],

...

(π ⊗ | det |s−1 )][rl (π ⊗ | det |j−1 )]+

for some [A ] ∈ Groth (WK ). Then by lemma 3.7 we see that
[ΨK,l,gs (JL −1 (Sp s (π)∨ ))] =
s
j=1 [Sp j (π)

(π ⊗ | det |j ) ... (π ⊗ | det |s−1 )]
g(1−s)/2
] + [Sp s (π)][A],
[rl (π ⊗ | det |j−1 ) ⊗ |Art −1
K |
for some [A] ∈ Groth (WK ).
It remains to show that [A] = 0. By lemma VII.4 we may choose an
irreducible admissible representation π of G(A∞ ) such that
• dim[Rξ (π )] = 0,
• πw ∼
= (π
×
×
K /OK
,

...

(π ⊗ | det |s−1 )) ⊗ (ψ ◦ det)−1 for some character ψ of

• and πp,0 |Z×p = 1.

144

Now let π denote π ⊗ (ψ ◦ det)−1 . By theorem 11.3 and lemma IV.3 we also
see that
gs[π

...

(π ⊗ | det |s−1 )][Rξ (π )] =
GL (K)

s−1−h
n-Ind P gs(K) [(π
(dim[Rξ (π )]) s−1
h =0 (−1)
gh
ΨK,l,g(s−h ) (JL −1 (Sp s−h (π ⊗ | det |h )∨ ))⊗
−gh /2
(((πp,0 )−1 ⊗ | |p
) ◦ Art −1
Qp )|WK ].

...

(π ⊗ | det |h −1 ))×

By the inductive hypothesis and what we have already proved, this can be
rewritten
gs[π

...

(π ⊗ | det |s−1 )][Rξ (π )|WK ⊗ (πp,o ◦ Art −1
Qp )|WK ] =

(−1)s−1 (dim[Rξ (π )])[Sp s (π )][A ⊗ (ψ ◦ det)]+
GL (K)
s−h
j−1
n-Ind P gs(K) [(π ... (π ⊗ | det |h −1 ))
(dim[Rξ (π )]) s−1
j=1 (−1)
h =0
gh
×(Sp j (π ⊗ | det |h ) (π ⊗ | det |h +j ) ... (π ⊗ | det |s−1 ))]
g(1−s)/2
].
[rl (π ⊗ | det |h +j−1 ) ⊗ |Art −1
K |
Again using lemma IV.2 this becomes
gs[π

...

(π ⊗ | det |s−1 )][Rξ (π )|WK ⊗ (πp,o ◦ Art −1
Qp )|WK ] =

(−1)s−1 (dim[Rξ (π )])[Sp s (π )][A ⊗ (ψ ◦ det)]+
s−h
j−1
(dim[Rξ (π )]) s−1
[ω(Γh ,j,s−1−h −j (π ))]
h =0
j=1 (−1)
−1 g(1−s)/2
[rl (π ⊗ | det |h +j−1 ) ⊗ |Art K
]−
|
s−2
s−h
j −1
[ω(Γh ,j ,s−1−h −j (π ))]
h =0
j =2 (−1)
g(1−s)/2
]=
[rl (π ⊗ | det |h +j−1 ) ⊗ |Art −1
K |
(−1)s−1 (dim[Rξ (π )])[Sp s (π )][A ⊗ (ψ ◦ det)]+
(dim[Rξ (π )]) s−1
... (π ⊗ | det |s−1 )]
h =0 [π
g(1−s)/2
].
[rl (π ⊗ | det |h ) ⊗ |Art −1
K |
In particular we see that [A] = 0, as desired. ✷
Suppose that π is an irreducible admissible representation of GLg (K).
Then we can find
• a parabolic subgroup P ⊂ GLn with a Levi component isomorphic to
GLg1 × ... × GLgt ,
• and an irreducible supercuspidal representation πi of GLgi (K);
145

such that π is a subquotient of
GL (K)

g
n-Ind P (K)
(π1 × ... × πt ).

Moreover the multiset {πi } is independent of all choices. Thus we may define
t

[rl (π)] =
i=1

(gi −g)/2
[rl (πi ) ⊗ |Art −1
].
K |

The following lemma follows at once from lemma 11.6.
Lemma 11.8 Suppose that K and K are p-adic fields and l = p is a prime.
∼

1. If σ : K → K is an isomorphism of Qp -algebras then for any irreducible
admissible representation π of GLg (K ) we have
rl (π ◦ σ) = rl (π )σ ,
∼

where, if we fix an extension σ of σ to an isomorphism σ : K ac → (K )ac ,
then rl (π )σ (x) = rl (π )(σxσ −1 ).
2. If σ ∈ Aut (Qac
l ) and if π is an irreducible admissible representation of
GLg (K) then
rl (σ(π)) = σ(rl (π)).
3. If π is an irreducible admissible representation of GLg (K) and if ψ is a
×
then
character of K × /OK
rl (π ⊗ (ψ ◦ det)) = rl (π) ⊗ (ψ −1 ◦ Art −1
K ).
We now return to the analysis of [Rξ (π)|WFw ].
Theorem 11.9 Suppose that π is an irreducible admissible representation of
G(A∞ ). Then
n[Rξ (π)|WFw ] = (dim[Rξ (π)])[rl (πw ) ⊗ (πp,0 ◦ |Art −1
Fw |)].
Proof: Consider the two homomorphisms
Θ1 , Θ2 : Groth (GLn (Fw )) −→ Groth l (GLn (Fw ) × WFw )
defined by
Θ1 ([π]) = [π ⊗ rl (π)]
146

for any irreducible π and
n−1
GL (F )

Θ2 ([π]) =
h=0

ρ

n
w
−1 −h/2
n-Ind Ph (F
n-red(h)
]
ρ [π][ΨFw ,l,n−h (ρ) ⊗ |Art K |
w)

for any admissible π (where ρ runs over irreducible admissible representations
of DF×w ,n−h ). By theorem 11.3 we only need to show that Θ1 = Θ2 . Moreover
it follows from lemma A.4.f of [DKV] that we only need check that Θ1 ([π]) =
Θ2 ([π]) when π is a full induced from square integrable.
Thus suppose that we have positive integers s1 , ..., st and n1 , ..., nt such that
n = s1 n1 + ... + st nt . Suppose also that for i = 1, ..., t we have an irreducible
supercuspidal representation πi of GLni (Fw ). Let P ⊂ GLn be a parabolic
subgroup with Levi component GLs1 n1 × ... × GLst nt and write π for
GL (F )

n-Ind P (Fnw ) w (Sp s1 (π1 ) × ... × Sp st (πt )).
We must check that Θ1 ([π]) = Θ2 ([π]).
If h1 , ..., ht are positive integers such that hi ≤ si we will let
• Phi ⊂ GLsi ni denote a parabolic subgroup with Levi component GLhi ni ×
GL(si −hi )ni ,
• h = h1 n1 + ... + ht nt ,
• P{hi } ⊂ GLh denote a parabolic subgroup with Levi component GLh1 n1 ×
... × GLht nt ,
• P{hi } ⊂ GLn−h denote a parabolic subgroup with Levi component
GL(s1 −h1 )n1 × ... × GL(st −ht )nt ,
By lemma IV.8 we see that
Θ2 ([π]) =
vol (DF×w ,n−h /Fw× )−1
(Fw )
GL
∨
tr (n-Ind P n−h
(Fw ) (Sp s1 −h1 (π1 ) × ... × Sp st −ht (πt )))(ϕJL (ρ ) )
hi

ρ

{hi }

GL (F )

GL (F )

n
w
n-Ind Ph (F
[(n-Ind P{hh} (Fww ) Sp h1 (π1 ⊗ | det |s1 −h1 ) × ...
w)
i
−h/2
×Sp ht (πt ⊗ | det |st −ht )) × (ΨFw ,l,n−h (ρ) ⊗ |Art −1
)],
Fw |

where h1 , ..., ht run over positive integers with hi ≤ si , where ρ runs over
irreducible admissible representations of DF×w ,n−h . Using the second part of
147

lemma IV.4 we see that this becomes
Θ2 ([π]) =
GLn (Fw )
si −1
hi =0 n-Ind P (Fw ) [Sp s1 (π1 ) × ...×
GLsi ni (Fw )
Sp hi (πi ⊗ | det |si −hi ) × (ΨFw ,l,(si −hi )ni (JL −1 (Sp si −hi (πi )∨ ))
(n-Ind P (F
w)
hi
⊗|Art F−1w |(ni (si −hi )−n)/2 )) × ...Sp st (πt )].
t
i=1

Now by theorem 11.7 this becomes
Θ2 ([π]) =
GL (F )
si −1
si −hi
si −hi −j
n-Ind P (Fnw ) w [Sp s1 (π1 ) × ...×
hi =0
j=1 (−1)
GLsi ni (Fw )
(n-Ind P (F
(Sp j (πi ) (πi ⊗ | det |j ) ... (πi ⊗ | det |si −1−hi )
w)
hi
×Sp hi (πi ⊗ | det |si −hi ))
−1 (ni −n)/2
j−1
×... × Sp st (πt )][rl (πi ⊗ | det | ) ⊗ |Art K |
].
t
i=1

Next by lemma IV.2 we rewrite this
Θ2 ([π]) =
t
i=1

si −1
si −hi
si −hi −j
hi =1
j=1 (−1)
GL (F )
n-Ind P (Fnw ) w [Sp s1 (π1 ) × ... × ω(Γj,si −hi −j,hi ) × ... × Sp st (πt )]
(ni −n)/2
[rl (πi ⊗ | det |j−1 ) ⊗ |Art −1
]+
K |
t
si −1
si −hi
si −hi −j
i=1
hi =0
j=1 (−1)
GLn (Fw )
n-Ind P (Fw ) [Sp s1 (π1 ) × ... × ω(Γj,si −1−hi −j,hi +1 ) × ... × Sp st (πt )]
−1 (ni −n)/2
[rl (πi ⊗ | det |j−1 ) ⊗ |Art K
|
]=
si
j=1

t
i=1

GL (F )

n-Ind P (Fnw ) w [Sp s1 (π1 ) × ... × ω(Γj,−1,si +1−j )×
(ni −n)/2
... × Sp st (πt )][rl (πi ⊗ | det |j−1 ) ⊗ |Art −1
]=
K |
[π]

t
i=1

si −1
j=0 [rl (πi

(ni −n)/2
]=
⊗ | det |j ) ⊗ |Art −1
K |

Θ1 ([π]).
The theorem follows. ✷
Corollary 11.10 Suppose that π is an irreducible admissible representation
of G(A∞ ). Then either ±[Rξ (π)] is a true representation.
148

Proof: Suppose not, then by the Weil conjectures for all but finitely many
finite places x of F we have [Rξ (π)|WFx ] is neither a true representation, nor
the negative of a true representation. This contradicts theorem 11.9. ✷
We now use our results to extend a theorem of Clozel [Cl1].
Theorem 11.11 Suppose that L is a CM field and that Π is a cuspidal automorphic representation of GLg (AL ) satisfying the following conditions:
• Π∨ ∼
= Πc ,
• Π∞ has the same infinitesimal character as some algebraic representation
over C of the restriction of scalars from L to Q of GLg ,
• and for some finite place x of L the representation Πx is square integrable.
Then there is a strictly positive integer a(Π) and a continuous representation
Rl (Π) of Gal (Lac /L) over Qac
l such that for any finite place y of L not dividing
l we have
[Rl (Π)|WFy ] = a(Π)[rl (Πy )].
Proof: Suppose first that L = EF + where E is an imaginary quadratic field
such that x|Q splits in E and where F + is a totally real field with [F + : Q]
even. In this case we will write F for L.
Choose (B, ∗, τ0 , β, Λi ) as in section 1 such that B is a division algebra with
centre F such that
• [B : F ] = g 2 ,
• B splits at all places of F other than x and xc
• and Bx and Bxc are division algebras.
(Here we are using the assumption that [F + : Q] is even.) By theorem VI.4,
corollary VI.5 and lemma VI.6 we can find
• an algebraic representation ξ of G over Qlac ,
• and an automorphic representation π of G(A)
such that if we set BC (π) = (ψ, Π), then
• JL (Π) = Π
• and dim[Rξ (π)] = 0.
149

If e(π) is the sign of dim[Rξ (π)], set
• [Rl (Π)] = e(π)g[Rξ (π ∞ ) ⊗ rec(ψ c )|Gal (F ac /F ) ]
• and a(Π) = e(π) dim[Rξ (π ∞ )].
From theorem 11.9 it follows that for all finite places y of F such that
• y |xxc ,
• y|Q splits in E
• and y |l,
we have
[Rl (Π)|WFy ] = a(Π)[rl (Πy )].
Next suppose that y|Q is inert in E or that y|xxc . Let p denote the rational
prime under y. We can find a real quadratic field A such that
• Ap ∼
= Ep
• and x|Q splits in A.
Let E denote the third quadratic subfield of AE, let (F + ) = AF + and let
F = E (F + ) = AF . Note that E is an imaginary quadratic field in which
both p and x|Q split. Let x denote a prime of F above x and let y denote a
∼
prime of F above y which does not divide x (x )c . Note also that Fx → Fx and
∼
Fy → Fy . The x component of the automorphic restriction ResFF (Π) is square
integrable and hence ResFF (Π) is cuspidal. Moreover by strong multiplicity one
ResFF (Π)c ∼
= ResFF (Π)∨ , and ResFF (Π) has the same infinitesimal character as
an algebraic representation of GLg (F ⊗Q C) over C. Thus we can associate
to ResFF (Π) a continuous representation Rl (ResFF (Π)) of Gal (F ac /F ) and a
positive integer a(ResFF (Π)) such that for all places z of F for which
• z |x (x )c ,
• z|Q splits in E
• and z |l,
we have
[Rl (ResFF (Π))|WF ] = a(ResFF (Π))[rl (ResFF (Π)z )].
z

It follows from the Cebotarev density theorem that
a(Π)[Rl (ResFF (Π))] = a(ResFF (Π))[Rl (Π)|Gal (F ac /F ) ].
150

Thus

a(ResFF (Π))[Rl (Π)|WFy ] =
a(Π)[Rl (ResFF (Π))|WF ] =
y

a(Π)a(ResFF (Π))[rl (ResFF (Π)y )] =
a(Π)a(ResFF (Π))[rl (Πy )],
and we have established the theorem in the special case.
Now we will turn to the proof in the general case.
If A is an imaginary quadratic field such that x|Q splits in E then set
• FA+ to be the maximal totally real subfield of AL,
• FA = AFA+ = AL,
• xA a prime of FA above x,
• σA to be the non-trivial element of Gal (FA /L)
• and

A

to be the non-trivial character of Gal (A/Q).
∼

Then [FA+ : Q] is even and xA |Q splits in A. Moreover Lx → FA |xA and
so as before we see that ResFFA (Π) continues to satisfy the conditions of the
theorem, but for FA . Thus, from what we have already proved, there is a
continuous representation Rl (ResLFA (Π)) of Gal (Lac /FA ) and a positive integer
a(ResLFA (Π)) such that for all places z |l of FA we have
[Rl (ResLFA (Π))|WFA,z ] = a(ResLFA (Π))[rl (ResFLA (Π)z )].
It follows from the Cebotarev density theorem that
[Rl (ResFLA (Π))σA ] = [Rl (ResLFA (Π))]
and that if A is a second such field then
a(ResLFA (Π))[Rl (ResLFA (Π))|Gal (Lac /FA FA ) ] =
a(ResFLA (Π))[Rl (ResLFA (Π))|Gal (Lac /FA FA ) ].
Fix one such quadratic extension A0 . Let {ρi } be a set of representatives of the equivalence classes of irreducible continuous representations of
Gal (Lac /FA0 ) on finite dimensional Qac
l -vector spaces. Let I be the set of inσA0 ∼
dices such that ρi = ρi and ρi is a constituent of [Rl (ResLFA (Π))]. Let J be
0

151

σ
the set of indices such that ρi A0 ∼
= ρi and ρi is a constituent of [Rl (ResLFA0 (Π))].
For i ∈ I choose an extension ρi of ρi to Gal (Lac /L). Also write

[Rl (ResLFA (Π))] =

bi [ρi ].

0

i∈I∪J

Let
ρ=

ρi .
i∈I∪J

Let H denote the Zariski closure of the image of ρ and let H 0 denote the connected component of the identity in H. Also let M/FA0 denote the fixed
field of ρ−1 H 0 . If N/L is a finite Galois extension disjoint from M then
ρGal (F ac /N A0 ) is Zariski dense in H and so we have the following results.
1. If i ∈ I ∪ J then ρi |Gal (Lac /N A0 ) is irreducible.
2. If i ∈ I then ρi |Gal (Lac /N ) is irreducible.
3. If i, j ∈ I ∪ J and ρi |Gal (Lac /N A0 ) ∼
= ρj |Gal (Lac /N A0 ) then i = j.
4. If i, j ∈ I, if δ = 0 or 1 and if ρi |Gal (Lac /N ) ∼
= ρj |Gal (Lac /N ) ⊗
and δ = 0.

δ
A0

then i = j

In particular if A/Q is a quadratic extension as above such that FA is
linearly disjoint from M over L then
• ρi |Gal (Lac /FA0 A) is irreducible for all i ∈ I ∪ J
σ
• and if, for some i, j ∈ I ∪ J, we have ρi A0 |Gal (Lac /FA0 A) ∼
= ρj |Gal (Lac /FA0 A)
σA0
then ρi = ρj .

We have also seen that
(dim[Rl (ResLFA (Π))])[Rl (ResLFA (Π))|Gal (Lac /FA0 A) ] =
0
(dim[Rl (ResLFA (Π))]) i∈I∪J bi [ρi |Gal (Lac /FA0 A) ].
Thus we must have
(dim[Rl (ResLFA (Π))])[Rl (ResLFA (Π))] =
0

Gal (Lac /L)

(dim[Rl (ResLFA (Π))])( i∈J (bi /2)[(Ind Gal (Lac /FA ) ρi )|Gal (Lac /FA ) ]+
0
δAi
ac
b
[(ρ
⊗
]),
)|
i
A0 Gal (L /FA )
i∈I i
where δAi = 0 or 1.
152

Choose such an extension A1 so that FA1 is linearly disjoint from M over
L. Set
Gal (Lac /L)

[Rl (Π)] =

(bi /2)[Ind Gal (Lac /FA ) ρi ] +
0

i∈J

i∈I

bi [(ρi ⊗

δA1 i
A0 )].

Also set
a(Π) = a(ResLFA (Π))
0

so that
dim[Rl (π)] = a(Π)g.
Suppose now that A is such a quadratic extension of Q such that FA is
linearly disjoint from M A1 over L. Then

i∈I

bi [(ρi ⊗

δA1 i
A0 )|Gal (Lac /FA1 A) ])

=
i∈I

bi [(ρi ⊗

δAi
A0 )|Gal (Lac /FA A1 ) ])

and so δAi = δA1 i for all i ∈ I. Hence
(dim[Rl (ResLFA (Π))])[Rl (Π)|Gal (Lac /FA ) ] = (dim[Rl (Π)])[Rl (ResLFA (Π))].
Given any finite place y |l of L we can choose an imaginary quadratic
extension A/Q such that
• LA is disjoint from M A1 over L,
• y splits as y y in LA
• and x|Q splits in A.
Then

(dim[Rl (ResLFA (Π))])[Rl (Π)|WFy ] =
(dim[Rl (Π)])[Rl (ResLFA (Π))|WF ] =
y
(dim[Rl (Π)])a(ResLFA (Π))[rl (Πy )],

and so
[Rl (Π)|WFy ] = a(Π)[rl (Πy )]
as desired. ✷
(Attempts to construct Galois representations by first constructing them
over many quadratic extensions are not new (see for instance [BR]).)
From this one can deduce the following extension of theorem 11.9.

153

Corollary 11.12 Suppose that π is an automorphic representation of G(A)
such π∞ is cohomological for ξ. Let BC (π) = (ψ, Π) and suppose that JL (Π)
is cuspidal. Then JL (Π) satisfies the hypotheses of theorem 11.11 and
na(JL (Π))[Rξ (π ∞ )] = (dim[Rξ (π ∞ )])[Rl (JL (Π)) ⊗ rec(ψ)|−1
Gal (F ac /F ) ].
In particular if y |l is a place of F then
−1
−1
n[Rξ (π ∞ )] = (dim[Rξ (π ∞ )])[rl (JL (Π)y ) ⊗ (ψy|
)|Gal (F ac /F ) ].
◦ Art E
y
E

Proof: Using the Cebotarev density theorem, this follows easily from theorems 11.9 and 11.11. ✷
We remark that the results of this section depend on the main theorem
of [Ko4] via theorem VI.1 and corollary VI.5, both of which rely on theorem
A.4.2 of [CL] (the former via theorem A.5.2 of [CL]). However we believe that
we could have avoided this logical dependence on the main theorem of [Ko4]
at the expense of doing a little more work. More precisely one can calculate
directly from the definitions ΨK,l,g (ρ)GLg (OK ) . If π is an irreducible admissible
representation of G(A∞ ) this suffices to calculate
×

(dim(πw )Zp ×GLn (OFw ) )[Rξ (π )|WFw ]
π

where π runs over irreducible admissible representations of G(A∞ ) for which
(π )w ∼
= π w (by using an argument similar to the proof of the last theorem).
This tells us [Rξ (π)|WFw ] for all but finitely many places w of F which lie over
a rational prime which splits in E, and this in turn suffices to prove theorem
A.4.2 of [CL].

12

The local Langlands conjecture.

We will start this section by checking various basic functoriality properties of
our map rl . Throughout this section K will denote a finite extension of Qp and
l will denote a prime other than p. Recall that we have fixed an isomorphism
∼
ı : Qac
l → C.
Lemma 12.1 Suppose that π is an irreducible admissible representation of
GLg (K) and that χ is a smooth character of K × . Then
[rl (π ⊗ (χ ◦ det))] = [rl (π) ⊗ (χ−1 ◦ Art −1
K )].
154

Proof: It is easy to reduce to the case that π is supercuspidal, so suppose
that π is supercuspidal. Choose an imaginary quadratic field M in which p
+
∼
splits and a totally real field L+ with a place x(+) such that Lx(+)
= K. Set
+
∼
L = M L and choose a place x of L above x(+). Thus Lx = K. Let χ be a
−1
continuous character of AL× /L× L×
∞ such that χχx is unramified. By corollary
VII.3 we may choose a cuspidal automorphic representation Π of GLg (AL )
such that
• Πc ∼
= Π∨ ,
• Π∞ has the same infinitesimal character as some algebraic representation
of RSLQ (GLg ),
×
• and Πx ∼
.
= π ⊗ (ψx ◦ det) for some character ψx of K × /OK

From theorem 11.11 (applied at good places of L) and from the Cebotarev
density theorem we see that
a(Π)[Rl (Π ⊗ (χ ◦ det))] = a(Π ⊗ (χ ◦ det))[Rl (Π) ⊗ recl,ı (χ)−1 ].
Applying theorem 11.11 at x we conclude that
−1
[rl (Πx ⊗ χx )] = [rl (Πx ) ⊗ (χ−1
x ◦ Art K )].

The lemma now follows from lemma 11.6. ✷
Lemma 12.2 Suppose that π is an irreducible admissible representation of
GLg (K) with central character ψπ . Then
det rl (π) = (ψπ ⊗ | |g(g−1)/2 )−1 ◦ Art −1
K .
Proof: Again it is easy to reduce to the case that π is supercuspidal, so
suppose that π is supercuspidal. Choose an imaginary quadratic field M in
∼
which p splits and a totally real field L+ with a place x(+) such that L+
x(+) = K.
Set L = M L+ and choose a place x of L above x(+). Thus Lx ∼
= K. By
corollary VII.3 we may choose a cuspidal automorphic representation Π of
GLg (AL ) such that
• Πc ∼
= Π∨ ,
• Π∞ has the same infinitesimal character as some algebraic representation
of RSLQ (GLg ),
155

×
• and Πx ∼
.
= π ⊗ (ψx ◦ det) for some character ψx of K × /OK

From theorem 11.11 (applied at good places of L) and from the Cebotarev density theorem we see that for all σ ∈ Gal (Qac /Q) there exist α1 (σ), ..., αn (σ) ∈
Qac
l such that
• Rl (Π)(σ) has eigenvalues α1 (σ), ..., αn (σ), each with multiplicity a(Π),
• and α1 (σ)...αn (σ) = recl,ı (ψπ ⊗ | |g(g−1)/2 )−1 (σ).
(See for instance the first paragraph of the proof of proposition 1 of [Tay]
for more details of this sort of argument.) Applying theorem 11.11 at x we
conclude that
det rl (Πx ) = (ψΠ,x ⊗ | |g(g−1)/2 )−1 ◦ Art −1
K .
The lemma now follows from lemma 11.6. ✷
Lemma 12.3 Suppose that π is an irreducible admissible representation of
GLg (K). Then
[rl (π ∨ )] = [rl (π ⊗ | det |1−g )∨ ].
Proof: Again it is easy to reduce to the case that π is supercuspidal, so
suppose that π is supercuspidal. Choose an imaginary quadratic field M in
∼
which p splits and a totally real field L+ with a place x(+) such that L+
x(+) = K.
Set L = M L+ and choose a place x of L above x(+). Thus Lx ∼
= K. By
corollary VII.3 we may choose a cuspidal automorphic representation Π of
GLg (AL ) such that
• Πc ∼
= Π∨ ,
• Π∞ has the same infinitesimal character as some algebraic representation
of RSLQ (GLg ),
×
.
• and Πx ∼
= π ⊗ (ψx ◦ det) for some character ψx of K × /OK

From theorem 11.11 (applied at good places of L) and from the Cebotarev
density theorem we see that
a(Π ⊗ | det |1−g )[Rl (Π∨ )] = a(Π∨ )[Rl (Π ⊗ | det |1−g )∨ ].
Applying theorem 11.11 at x we conclude that
[rl (Π∨x )] = [rl (Πx ⊗ | det |1−g )∨ ].
156

The lemma now follows from lemma 11.6. ✷
Now suppose that K /K is a cyclic Galois extension of prime degree q. If π
is an irreducible admissible representation of GLg (K) then one can associate
to π its base change lifting ResK
K (π) to K (see theorem 6.2 of chapter 1 and
the discussion on pages 59 and 60 of [AC]). Also if π is a Gal (K /K)-regular
(see section 2.4 of [HH] for the definition of this concept) generic irreducible
admissible representation of GLg (K ) one can associate to π its automorphic
K
induction Ind K
K (π ) to K (see theorem 2.4 of [HH]). Then ResK (π) is an irreK
(π ) is an irreducible
ducible admissible representation of GLg (K ) and Ind K
admissible representation of GLqg (K).
We will need to make use of the global analogues of these constructions,
which we now recall. Suppose that L /L is a cyclic Galois extension of number
fields of prime degree q. Let τ denote a generator of Gal (L /L) and let η denote
a non-trivial character of
×
×
× 0
A×
L /L (L∞ ) (NL /L AL ).

If Π is a cuspidal automorphic representation of GLg (AL ) then we can associate
to Π an “induced from cuspidal” (see definition 4.1 of chapter 3 of [AC])
representation ResLL Π of GLg (AL ) with the following properties.
1. ResLL (Π) is cuspidal if and only if Π = Π ⊗ (η ◦ det).
2. A cuspidal automorphic representation Π of GLg (AL ) is of the form
ResLL Π for some cuspidal automorphic Π if and only if Π ∼
= Π ◦ τ.
3. If x is a place of L which splits in L and x is a place of L above x then
ResLL (Π)x ∼
= Πx .
4. If x is a finite place of L which is inert in L then
ResLL (Π)x ∼
= ResLLxx (Πx ).
(See theorems 4.2 and 5.1 of [AC].) Now suppose that Π is a cuspidal automorphic representation of GLg (AL ). Then there is an “induced from cuspidal”
representation Ind LL Π of GLgq (AL ) with the following properties.
1. Ind LL (Π ) ⊗ (η ◦ det) ∼
= Ind LL (Π ).
2. If Π ∼
= Π ◦ σ then Ind LL (Π ) is cuspidal.
157

3. If x is a place L which splits as x1 ...xq in L then
GL (L )
Ind LL (Π )x ∼
= n-Ind Q(Lqgx ) x (Πx1 × ... × Πxq ),

where Q is a parabolic subgroup of GLqg with Levi component GLqg .
4. For all but finitely many places x of L which are inert in L we have
Ind LL (Π )x ∼
= Ind LLxx (Πx ).
(See theorem 6.2, lemma 6.4 and corollary 6.5 of [AC].) The following lemma
seems to be well known (see section 1.5 of [HH]), but for lack of an explicit
reference we give the proof.
Lemma 12.4 Keep the above notation and suppose that x is a finite place of
L which is inert in L .
1. Πx is Gal (Lx /Lx )-regular.
2. The only generic, irreducible, admissible representation π of GLqg (Lx )
such that
• π ⊗ (ηx ◦ det) ∼
=π
• and

GL (L )
ResLLxx (π) ∼
= n-Ind Q(Lqgx ) x (Πx × ... × (Πx ◦ τ q−1 ))

(where Q ⊂ GLqg is the parabolic subgroup defined above)
is Ind LLxx (Πx ).
3. Ind LL (Π )x ∼
= Ind LLxx (Πx ).
Proof: Note that the first part follows from lemma 2.3 of [HH]. Also note
that the third part follows from the second part and the definition of Ind LL
(see section 6 of chapter 3 of [AC]). Thus it remains to prove the second part.
We can write
Πx ∼
=(

i∈I

Sp si (πi ))

(

i∈J

Sp si (πi ))

where πi ∼
= πi ◦ τ if i ∈ I , but not if i ∈ J . For i ∈ I choose an irreducible
admissible representation πi such that ResLLxx πi ∼
= πi . Then
GL

(Lx )

n-Ind Q(Lqgx )

Πx ∼
=(

i∈I

Sp si (πi ) q )
158

(

i∈J

q−1
j=0

Sp si (πi ◦ τ j ))

(use the fact that Πx is Gal (Lx /Lx )-regular generic). Moreover
Ind LLxx (Πx ) ∼
=(

q−1
j=0

i∈I

Sp si (πi ⊗ (ηxj ◦ det)))

(

i∈J

Sp si (Ind LLxx (πi )))

(see [HH] and assertion 2.6 (a) of [BHK]), and hence
ResLLxx Ind LLxx (Πx ) ∼
=(

i∈I

Sp si (πi ) q )

(

q−1
j=0

i∈J

Sp si (πi ◦ τ j ))

(see [AC] and assertion 2.6 (b) of [BHK]). In particular
GL (L )
ResLLxx Ind LLxx (Πx ) ∼
= n-Ind Q(Lqgx ) x Πx .

Now suppose that π is a generic, irreducible, admissible representation of
GLqg (Lx ) such that
• π ⊗ (ηx ◦ det) ∼
=π
• and

GL (L )
ResLLxx (π) ∼
= n-Ind Q(Lqgx ) x (Πx × ... × (Πx ◦ τ q−1 )).

We may write
π∼
=(

i∈I

q−1
j=0

Sp si (πi ⊗ (ηxj ◦ det)))

(

i∈J Sp si (πi ))

where πi ∼
= πi ⊗ (ηx ◦ det) if i ∈ J, but not if i ∈ I. If i ∈ J then we can write
πi = Ind LLxx πi , where πi is an irreducible supercuspidal representation. Then
ResLLxx π ∼
=(

Lx
q
i∈I Sp si (ResLx πi ) )

(

i∈J

q−1
j=0

Sp si (πi ◦ τ j ))

(see [AC] and assertion 2.6 (b) of [BHK]). Note that for i ∈ I ResLLxx πi ∼
=
Lx
∼
(ResLx πi ) ◦ τ , while for i ∈ J we have πi = πi ◦ τ . Thus we may identify I
with I and J with J so that
• for i ∈ I we have ResLLxx πi ∼
= πi
• and for i ∈ J we have πi ∼
= πi ◦ τ j(i) for some j(i).
Then
• for i ∈ I we have πi ∼
= πi ⊗ (ηx ◦ det)j(i) , for some j(i)
• and for i ∈ J we have πi ∼
= πi .
159

Thus

π∼
= Ind LLxx Πx ,

as desired. ✷
Lemma 12.5 Suppose that π is an irreducible admissible representation of
GLg (K). Then
K
(π))] = [rl (π)|WK ].
[rl (ResK
Proof: Again one may reduce to the case that π is square integrable, so
suppose that π is square integrable. (See section 6.2 of chapter 1 and pages
59 and 60 of [AC].) Choose an imaginary quadratic field M in which p splits.
Also choose a cyclic Galois extension (L )+ /L+ of totally real fields and a place
+
x(+) of L+ such that x(+) is inert in (L )+ and the extension (L )+
x(+) /Lx(+)
is isomorphic to the extension K /K. Set L = M L+ (resp. L = M (L )+ ) and
choose a place x of L above x(+). Thus the extension Lx /Lx is also isomorphic
to K /K. Choose a place y of L which splits completely in L and which lies
above a rational prime other than p which splits in M . By corollary VII.3 we
may choose a cuspidal automorphic representation Π of GLg (AL ) such that
• Πc ∼
= Π∨ ,
• Π∞ has the same infinitesimal character as some algebraic representation
L
of RSQ
(GLg ),
×
,
• Πx ∼
= π ⊗ (ψx ◦ det) for some character ψx of K × /OK

• and Πy is supercuspidal.
Then there is an “induced from cuspidal” representation ResLL (Π) of GLg (AL )
such that for all places w of L we have
• ResLL (Π)w = ResLLww (Πw ) if w is inert in L ,
• and ResLL (Π)w = Π⊗q
w if w splits in L .
From the second of these conditions we see that ResLL (Π) is supercuspidal
at every place above y and hence is cuspidal automorphic. From the second
of these conditions we also see that ResLL (Π)∞ has the same infinitesimal
character as some algebraic representation of RSLQ (GLg ).
If w is a finite place of L at which Πw is unramified and if w is a prime of L
above w then, from the compatibility of base change with parabolic induction
and from the explicit description of base change when g = 1 (see part (d) of
160

theorem 6.2 of chapter 1 of [AC]), we see that if w is a prime of L above w
then
[Rl (ResLL (Π))|WL ] = a(ResLL (Π))[rl (Πw )|WL ].
w

w

Thus, from theorem 11.11 (applied at good places of L ) and from the Cebotarev density theorem we see that
a(Π)[Rl (ResLL (Π)] = a(ResLL (Π))[Rl (Π)|Gal ((L )ac /L ) ].
Applying theorem 11.11 at x we conclude that
[rl (ResK
K (Πx ))] = [rl (Πx )|WL ].
x

The lemma now follows from lemma 11.6. ✷
Lemma 12.6 Suppose that π is a generic, Gal (K /K)-regular, irreducible,
admissible representation of GLg (K ). Then
g(1−q)/2
K
)] = [(Ind W
[rl (Ind K
K (π ) ⊗ | det |
WK rl (π ))].

Proof: One may reduce to the case that π = Sp 2 (π 0 ), where π 0 is supercuspidal, so suppose that π has this form. (See corollary 5.5 and theorem 5.6
of [HH].) Note in particular that in this case g is even. Choose an imaginary
quadratic field M in which p splits. Also choose a cyclic Galois extension
(L )+ /L+ of totally real fields and a place x(+) of L+ such that x(+) is inert
+
in (L )+ and the extension (L )+
x(+) /Lx(+) is isomorphic to the extension K /K.
Set L = M L+ (resp. L = M (L )+ ) and choose a place x of L above x(+).
Thus the extension Lx /Lx is also isomorphic to K /K. Choose a generator
σ of Gal (L /L). Choose a place y of L which is inert in L and which lies
above a rational prime other than p which splits in M . Choose a supercuspidal representation πy of GLg (Ly ) such that πy ∼
= πyσ ⊗ ψ for any character ψ
×
×
of (Ly ) /OL ,y . (To see that this is possible one may argue as follows. First
choose any irreducible supercuspidal representation πy0 of GLg (Ly ). Then take
πy = πy0 ⊗ χ, where χ is a character of (Ly )× such that
(ψπy χg )|O×

L ,y

= (ψπy χg )|O× ◦ σ.)
L ,y

By corollary VII.3 we may choose a cuspidal automorphic representation Π of
GLg (AL ) such that
• Πc ∼
= Π∨ ,
161

• Π∞ has the same infinitesimal character as some algebraic representation
of RSLQ (GLg ),
×
,
• Πx ∼
= π ⊗ (ψx ◦ det) for some character ψx of (K )× /OK

• and Πy ∼
= πy ⊗ (ψy ◦ det) for some character ψy of (Ly )× /OL× ,y .

Note that in particular Πσ ∼
= Π.
Consider the cuspidal automorphic representation Ind LL Π of GLqg (AL ).
Using the the strong multiplicity one theorem we see that
(Ind LL Π)∨ ∼
= (Ind LL Π)c .
If w is an infinite place of L which splits as w1 ...wq in L , then (Ind LL Π)w is a
GL (L )
subquotient of n-Ind Q(Lqgw ) w (Πw1 × ... × Πwq ), where Q is a parabolic subgroup
of GLqg with Levi component GLgq . In particular this allows one to check that
Ind LL (Π)∞ has the same infinitesimal character as some algebraic representation of RSLQ (GLqg ) (use the fact that g is even). Moreover by proposition 5.5
of [HH] we see that Ind LL (Π)y is supercuspidal.
From theorem 11.11 (applied at good places of L) and from the Cebotarev
density theorem we see that
Gal ((L )ac /L)

a(Π)[Rl (Ind LL (Π) ⊗ | det |g(1−q)/2 )] = a(Ind LL (Π))[Ind Gal ((L )ac /L ) Rl (Π)].
Applying theorem 11.11 at x we conclude that
WK
g(1−q)/2
[rl (Ind K
)] = [(Ind W
rl (Πx ))].
K (Πx ) ⊗ | det |
K

The lemma now follows from lemma 11.6. ✷
If π is an irreducible admissible representation of GLg (K) we will set
recl (π) = rl (π ∨ ⊗ | det |(1−g)/2 ).
With this new normalisation we have the following restatement of lemma 11.8
and of the preceding lemmas.
Lemma 12.7 Let K /K be a cyclic Galois extension of prime degree q and
let π be an irreducible admissible representation of GLg (K). Then we have the
following results.
1. If τ ∈ Gal (K ac /Qp ) then recl (π ◦ τ ) = recl (π)τ .
2. If g = 1 then recl (π) = π ◦ Art −1
K .
162

3. If ψπ is the central character of π then det recl (π) = recl (ψπ ).
4. If χ is a character of K × then recl (π ⊗ (χ ◦ det)) = recl (π) ⊗ recl (χ).
5. recl (ResK
K (π)) = recl (π)|WK .
6. If π is an irreducible admissible representation of GLg (K ) then
WK
recl (Ind K
K (π )) = Ind WK recl (π ).
We next turn to some cases of non-Galois global automorphic induction,
which were established by one of us (M.H.) in [Har2]. Indeed in a sense the rest
of this section is superfluous, as we could simply refer to section 4 of [Har2].
However we will repeat the arguments here in somewhat greater detail, as we
can now be slightly more direct. We will repeat not only arguments of [Har2],
but also arguments of Henniart from [BHK] and [He6].
Proposition 12.8 Suppose that L3 ⊃ L2 ⊃ L1 are CM-fields with L3 /L1
soluble and Galois. Suppose that χ be a character of AL×2 /L×
2 such that
1. χc = χ−1 ;
2. for every embedding τ : L2 → C giving rise to an infinite place x we
have
χx : z →
→ (τ z/cτ z)pτ
where pτ ∈ Z and if τ = τ then pτ = pτ ;

3. there is a finite place y of L1 which is inert in L3 , which does not divide
l and and for which the stabiliser of the character χy ◦ NL3 /L2 of (L3 )×
y
in Gal (L3 /L1 ) is Gal (L3 /L2 ).
×
Let φ be a character of A×
L1 /L1 such that

1. φc = φ−1 ;
2. if [L2 : L1 ] is odd then φ∞ = 1;
3. if [L2 : L1 ] is even, then for every embedding τ : L1 → C giving rise to
an infinite place x we have
φx : z →
→ (τ z/|τ z|)±1 ;
4. φy is unramified.

163

Then there is a cuspidal automorphic representation ILL21 (χ) of GL[L2 :L1 ] (AL1 )
such that
• ILL21 (χ)c ∼
= ILL21 (χ)∨ ;
• (ILL21 (χ)⊗(φ◦det))∞ has the same infinitesimal character as an algebraic
representation of RSLQ1 (GL[L2 :L1 ] );
• ILL21 (χ)y is supercuspidal;
• and

[Rl (ILL21 (χ) ⊗ (φ ◦ det))] = a(ILL21 (χ) ⊗ (φ ◦ det))
Gal (Lac
−1
−1
3 /L1 )
[Ind Gal (Lac
◦ NL2 /L1 )| |(1−[L2 :L1 ])/2 )].
/L2 ) recl,ı (χ (φ
3

Proof: The proof will be by induction on [L3 : L1 ], there being nothing to
prove in the case [L3 : L1 ] = 1.
Now consider the inductive step. Because L3 /L1 is soluble we may choose
a subextension L3 ⊃ L4 ⊃ L1 with L4 /L1 cyclic Galois with prime degree q.
Let σ be a generator of Gal (L4 /L1 ) and let σ be a lift of σ to Gal (L3 /L1 ).
We will consider separately the cases L4 ⊂ L2 and L4 ∩ L2 = L1 .
Suppose first that L4 ⊂ L2 . Set φ = φ ◦ NL4 /L1 unless [L2 : L4 ] is odd in
which case set φ = 1. Then from the inductive hypothesis we see that there
is a cuspidal automorphic representation ILL24 (χ) of GL[L2 :L4 ] (AL4 ) such that
• ILL24 (χ)c ∼
= ILL24 (χ)∨ ;
• (ILL24 (χ)⊗(φ ◦det))∞ has the same infinitesimal character as an algebraic
representation of RSLQ4 (GL[L2 :L4 ] );
• ILL24 (χ)y is supercuspidal;
• and

[Rl (ILL24 (χ) ⊗ (φ ◦ det))] =
Gal (Lac /L )
a(ILL24 (χ) ⊗ (φ ◦ det))[Ind Gal (L3ac /L24 ) recl,ı (χ−1 (φ )−1 | |(1−[L2 :L4 ])/2 )].
3

By theorem 11.11 and lemma 12.7 we see that
WL

[recl (ILL24 (χ)y )] = [Ind WL4,y recl (χy )],
2,y

and hence that

WL

[recl (ILL24 (χ)yσ )] = [Ind WσL4,y recl (χσy )].
2,y

164

Thus
[recl (ILL24 (χ)y )|WL3,y ] =

[recl (χy ◦ NL3,y /L2,y ◦ τ )],

τ ∈Gal (L3 /L2 )\Gal (L3 /L4 )

and
[recl (ILL24 (χ)σy )|WL3,y ] =

[recl (χy ◦ NL3,y /L2,y ◦ τ σ)].

τ ∈Gal (L3 /L2 )\Gal (L3 /L4 )

In particular by our assumption on χy we see that
[recl (ILL24 (χ)y )] = [recl (ILL24 (χ)yσ )]
and conclude that

ILL24 (χ)y ∼
= ILL24 (χ)σy .

Now set
ILL21 (χ) = Ind LL14 ILL24 (χ).
By the strong multiplicity one theorem we see that
ILL21 (χ)∨ ∼
= ILL21 (χ)c .
If w is an infinite place of L1 below places x1 , ..., xq of L4 then ILL21 (χ)x is a
GL

(L1,x )

2 :L1 ]
(ILL24 (χ)x1 × ... × ILL24 (χ)xq ), where Q ⊂ GL[L2 :L1 ]
subquotient of Ind Q(L[L1,x
)
is a parabolic subgroup with Levi component GLq[L2 :L4 ] . Using this one can
check that (ILL21 (χ) ⊗ (φ ◦ det))∞ has the same infinitesimal character as an
algebraic representation of RSLQ1 (GL[L2 :L1 ] ). Moreover

L

1,y
ILL21 (χ)y = Ind L4,y
(ILL24 (χ)y )

is supercuspidal by proposition 5.5 of [HH]. From theorem 11.11 we see that
for any finite place x of L4 not dividing l and lying below places x1 , ..., xr of
L2 we have
r

[recl (ILL24 (χ)x ⊗ (φx ◦ det))] =

WL

[Ind WL4,x recl (χxi (φx ◦ NL2,xi /L4,xi ))].
2,xi

i=1

By lemma 12.7 we conclude that for all but finitely many finite places x of L1
lying below places x1 , ..., xr of L2 we have
r

[recl (ILL21 (χ)x

⊗ (φx ◦ det))] =

WL

i=1

[Ind WL1,x recl (χxi (φx ◦ NL2,xi /L1,x ))].

165

2,xi

Finally using the Cebotarev density theorem and theorem 11.11 we see that
[Rl (ILL21 (χ) ⊗ (φ ◦ det)] =
Gal (Lac /L )
a(ILL21 (χ) ⊗ (φ ◦ det))[Ind Gal (L3ac /L12 ) recl,ı (χ−1 (φ−1 ◦ NL2 /L1 )| |(1−[L2 :L1 ])/2 )].
3

Now we turn to the case L2 ∩ L4 = L1 . In this case by inductive hypothesis there is a cuspidal automorphic representation ILL24L4 (χ ◦ NL2 L4 /L2 ) of
GL[L2 :L1 ] (AL4 ) such that
• ILL24L4 (χ ◦ NL2 L4 /L2 )c ∼
= ILL24L4 (χ ◦ NL2 L4 /L2 )∨ ;
• (ILL24L4 (χ ◦ NL2 L4 /L2 ) ⊗ (φ ◦ NL4 /L1 ◦ det))∞ has the same infinitesimal
character as an algebraic representation of RSLQ4 (GL[L2 :L1 ] );
• ILL24L4 (χ ◦ NL2 L4 /L2 )y is supercuspidal;
• and
[Rl (ILL24L4 (χ ◦ NL2 L4 /L2 ) ⊗ (φ ◦ NL4 /L1 ◦ det))] =
a(ILL24L4 (χ ◦ NL2 L4 /L2 ) ⊗ (φ ◦ NL4 /L1 ◦ det))
Gal (Lac /L )
[Ind Gal (L3ac /L42 L4 ) recl,ı ((χ−1 ◦ NL2 L4 /L2 )(φ−1 ◦ NL2 L4 /L1 )| |(1−[L2 :L1 ])/2 )].
3

By theorem 11.11 and lemma 12.7 we see that for any prime x of L4 not
dividing l and lying below primes x1 , ..., xr of L2 L4 we have
r

[recl (ILL24L4 (χ

◦ NL2 L4 /L2 )x )] =

WL

[Ind W(L4,xL

2 4 )xi

i=1

recl (χx ◦ N(L2 L4 )xi /L2,xi )].

In particular we see that
σ
)]
[recl (ILL24L4 (χ ◦ NL2 L4 /L2 )x )] = [recl (ILL24L4 (χ ◦ NL2 L4 /L2 )σx

and so by the strong multiplicity one theorem
ILL24L4 (χ ◦ NL2 L4 /L2 ) ∼
= ILL24L4 (χ ◦ NL2 L4 /L2 )σ .
Thus by theorem 4.2 of chapter 3 of [AC] there is a cuspidal automorphic
representation Π of GL[L2 :L1 ] (AL1 ) such that ResLL41 (Π) = ILL24L4 (χ ◦ NL2 L4 /L2 ).
Again theorem 4.2 of chapter 3 of [AC] tells us that
Π∨ ∼
= Πc ⊗ (η ◦ det)
166

× ×
×
for some character η of A×
L1 /L1 L1,∞ (NL4 /L1 AL4 ). The norm map gives an
isomorphism
∼

×
×
+
×
× ×
+ ×
× 0
+ A + ).
NL1 /L+1 : A×
L1 /L1 L1,∞ (NL4 /L1 AL4 ) −→ AL+ /(L1 ) ((L1,∞ ) ) (NL+
L
4 /L1
1

On the other hand because

L+
4

4

is totally real we see that

×
×
+
×
×
+
× 0
×
+ ×
+ A + ) = A + /(L ) (L
+A +)
A×
/(L+
1 ) ((L1,∞ ) ) (NL+
1
1,∞ ) (NL+
L
L
L+
L
4 /L1
4 /L1
1

4

1

4

and hence that
×
×
× ×
×
×
+ A + ).
NL1 /L+1 : AL×1 /L×
1 L1,∞ (NL4 /L1 AL4 ) → AL1 /L1 L1,∞ (NL+
L
4 /L1
4

×
Thus we can find a character ψ of AL×1 /L1× L1,∞
such that ψ ◦ NL1 /L1+ = η and
hence
(Π ⊗ (ψ ◦ det))∨ = (Π ⊗ (ψ ◦ det))c .

Note that therefore

(ILL24L4 (χ) ⊗ (ψ ◦ NL4 /L2 ◦ det))∨ = (ILL24L4 (χ) ⊗ (ψ ◦ NL4 /L2 ◦ det))c .
If x is an infinite place of L1 lying under an infinite place x of L4 we see that
Πx ∼
= ILL24L4 (χ ◦ NL2 L4 /L2 )x . Thus (Π ⊗ (φ ◦ det))∞ has the same infinitesimal
character as an algebraic representation of RSLQ1 (GL[L2 :L1 ] ). From lemma 6.12
of chapter 1 and the discussions on pages 52/53 and 59/60 of [AC] we see that
Πy must be supercuspidal.
By lemma 12.7, for all but finitely many pairs (x, x) of a place x of L1 and
a place x of L4 above x we have
[recl ((Π ⊗ (φψ ◦ det))x )|WL4,x ] = [recl ((ILL24L4 (χ) ⊗ ((φψ) ◦ NL4 /L1 ◦ det))x )].
It follows from theorem 11.11 and the Cebotarev density theorem that
]=
a(ILL24L4 (χ) ⊗ (φψ ◦ NL4 /L1 ◦ det))[Rl (Π ⊗ (φψ ◦ det))|Gal (Lac
3 /L4 )
L4
a(Π ⊗ (φψ ◦ det))[Rl (IL2 L4 (χ) ⊗ (φψ ◦ NL4 /L1 ◦ det))]
and hence that
[Rl (Π ⊗ (φψ ◦ det))|Gal (L3ac /L4 ) ] = a(Π ⊗ (φψ ◦ det))
Gal (Lac /L )
[Ind Gal (L3ac /L42 L4 ) recl,ı ((χ−1 ◦ NL2 L4 /L2 )(φ−1 ψ −1 ◦ NL2 L4 /L1 )| |(1−[L2 :L1 ])/2 )].
3

Gal (Lac /L )

4
−1
3
As Ind Gal (Lac
◦ NL2 L4 /L2 )|WL4,y is irreducible we see that
/L2 L4 ) recl,ı (χ
3

[Rl (Π ⊗ (φψ ◦ det))] = a(Π ⊗ (φψ ◦ det))
Gal (Lac
−1
−1 −1
(1−[L2 :L1 ])/2
3 /L1 )
)],
[Ind Gal (Lac
/L2 ) recl,ı (χ (φ ψ η ◦ NL2 /L1 )| |
3

167

× ×
×
for some character η of A×
L1 /L1 L1,∞ (NL4 /L1 AL4 ). Thus

[(Rl (Π ⊗ (φψ ◦ det)) ⊗ recl,ı (ψ ⊗ (η )−1 ))c ] =
[(Rl (Π ⊗ (φψ ◦ det)) ⊗ recl,ı (ψ ⊗ (η )−1 ))∨ ]
and hence by theorem 11.11, lemma 12.7 and the strong multiplicity one theorem we see that
(Π ⊗ (η ◦ det))c = (Π ⊗ (η ◦ det))∨ .
Replacing Π by Π ⊗ (η ◦ det), we have that Πc = Π∨ and
[Rl (Π ⊗ (φψ(η )−1 ◦ det))] = a(Π ⊗ (φψ(η )−1 ◦ det))
Gal (Lac /L )
[Ind Gal (L3ac /L21 ) recl,ı (χ−1 (φ−1 ψ −1 η ◦ NL2 /L1 )| |(1−[L2 :L1 ])/2 )],
3

and hence (using theorem 11.11, lemma 12.7 and the Cebotarev density theorem)
[Rl (Π ⊗ (φ ◦ det))] = a(Π ⊗ (φ ◦ det))
Gal (Lac /L )
[Ind Gal (L3ac /L12 ) recl,ı (χ−1 (φ−1 ◦ NL2 /L1 )| |(1−[L2 :L1 ])/2 )].
3

Thus we may set

ILL21 (χ)

= Π. ✷

Recall that if r is a continuous representation of WK over C and if Ψ is a
continuous additive character of K then we have the following.
• An L-factor
L(r, s) = det((1 − Frobp /(#k(℘K ))s )|WrIK )−1 ,
where WrIK denotes the inertial invariants of r.
• An -factor

(r, s, Ψ).

(See for instance [Tat2]. In the notation of [Tat2] we have (r, s, Ψ) =
(rωs , Ψ, µΨ ), where µΨ is the additive Haar measure on K which is self
dual with respect to Ψ.)
• A γ-factor

γ(r, s, Ψ) = L(r∨ , 1 − s) (r, s, Ψ)/L(r, s).

If moreover π1 and π2 are irreducible admissible representations of GLg1 (K)
and GLg2 (K) then we also have the following.
168

• An L-factor L(π1 × π2 , s).
• An -factor (π1 × π2 , s, Ψ).
• A γ-factor
γ(π1 × π2 , s, Ψ) = L(π1∨ × π2∨ , 1 − s) (π1 × π2 , s, Ψ)/L(π1 × π2 , s).
(See [JPSS] for the definitions. In the case g2 = 1 and π2 is trivial we will
simply drop it from the notation.) Note that if π is unramified then
L(π, s) = L(recl (π), s).
Corollary 12.9 Suppose that L3 ⊃ L2 ⊃ L1 are CM-fields with L3 /L1 soluble
×
and Galois. Suppose that χ be a character of A×
L2 /L2 such that
1. χc = χ−1 ;
2. for every embedding τ : L2 → C giving rise to an infinite place x we
have
χx : z →
→ (τ z/cτ z)pτ
where pτ ∈ Z and if τ = τ then pτ = pτ ;

3. and there is a finite place y of L1 which is inert in L3 , which does not
divide l, which is unramified over L+
1 and for which the stabiliser of the
×
character χy ◦ NL3 /L2 of (L3 )y in Gal (L3 /L1 ) is Gal (L3 /L2 ).
Then for all but finitely many places x of L1 we have
Gal (Lac /L )

1
3
L(ILL21 (χ)x , s) = L((Ind Gal (Lac
/L2 ) recl,ı (χ))|WL1,x , s) =

L(recl (χx ), s).

3

x|x

Proof: We only need show that we can choose a character φ as in proposition
×
of the form described in proposition 12.8.
12.8. Let φ∞ be a character of L1,∞
We have a commutative diagram with exact rows
(0) →
(0) →

×
L1,∞
×

x

↑

×
OL×1 NL1 /L+1 (L1,∞

OL×1 ,x

×

x

→

AL×1
↑

OL×1 ,x ) → L1× NL1 /L1+ A×
L1

→ Cl (L1 )
↑
→ Cl (L1 )1+c ,

where Cl (L1 ) denotes the ideal class group of L1 . Thus it suffices to define φ
×
1
on x OL×1 ,x /(OL×1 ,y (NL1 /L+1 x OL×1 ,x )) so that it equals φ−1
∞ on OL1 . Let OL+
1

169

denote those elements of OL×+ with norm down to Q equal to 1. Then φ∞ is
1

trivial on OL1 1 . Thus it suffices to check that
OL×1 ∩ (OL×1 ,y (NL1 /L+1

x

OL×1 ,x )) ⊂ OL1 + .
1

So suppose α ∈ OL×1 ∩(OL×1 ,y (NL1 /L1+ x OL×1 ,x )). Then, because y is unramified
+ ×
∞ ×
over L+
1 , we see that α ∈ (L1 ) ∩ (NL1 /L1+ (AL1 ) ). But we have a right exact
sequence
×
(L+
1 ) −→

x

×
+
(L+
L×
1,x −→ Gal (L1 /L1 ) −→ (0).
1 )x /NL1 /L+
1

Thus α must fail to be a norm at an even number of infinite places x of L+
1,
+
i.e. α is negative at an even number of infinite places x of L1 . Thus the norm
down to Q of α is positive and hence 1. ✷
Corollary 12.10 Suppose that L3 /L1 is a soluble Galois extension of CMfields and suppose that L2 and L2 are intermediate fields between L3 and L1 .
Let Ψ = x Ψx be a non-trivial additive character of AL1 /L1 . Suppose that χ
×
×
×
(resp. χ ) is a character of A×
L2 /L2 (resp. AL /(L2 ) ) such that
2

1. χc = χ−1 (resp. (χ )c = (χ )−1 );
2. for every embedding τ : L2 → C (resp. τ : L2 → C) giving rise to an
infinite place x (resp. x ) we have
χx : z −→ (τ z/cτ z)pτ
(resp.
χx : z −→ (τ z/cτ z)pτ )

where pτ (resp. pτ ) ∈ Z and if τ = τ1 (resp. τ = τ1 ) then pτ = pτ1
(resp. pτ = pτ );
1

3. there is a finite place y (resp. y ) of L1 which is inert in L3 , which does
not divide l, which is unramified over L+
1 and for which the stabiliser of
the character χy ◦NL3 /L2 (resp. χy ◦NL3 /L2 in Gal (L3 /L1 ) is Gal (L3 /L2 )
(resp. Gal (L3 /L2 )).

170

Suppose that ψ and ψ are algebraic characters of A×
L1 . Then for all places x
of L1 which are inert in L3 and which do not divide l we have
WL

[recl ((ILL21 (χ)x ⊗ (ψx ◦ det))] = [Ind WL1,x recl (χx (ψx ◦ NL2,x /L1,x ))]
2,x

and
WL

[recl ((ILL1 (χ )x ⊗ (ψx ◦ det))] = [Ind WL1,x recl (χx (ψx ◦ NL2,x /L1,x ))]
2

and

2,x

γ((ILL21 (χ) ⊗ (ψ ◦ det))x × (ILL1 (χ ) ⊗ (ψ ◦ det))x , s, Ψx ) =
2

WL
γ((Ind WL1,x recl (χx (ψx ◦ NL2,x /L1,x )))⊗
2,x
WL
(Ind WL1,x recl (χx (ψx ◦ NL2,x /L1,x ))), s, Ψx ).
2,x

Proof: This follows from the previous corollary and from theorem 4.1 of
[He3]. ✷
Now fix a non-trivial additive character Ψ of K.
Lemma 12.11 Fix a finite Galois extension K3 /K. For each pair (K2 , χ),
where K2 /K is a finite subextension of K3 /K and where χ is a character
of K2× of finite order, we can choose an irreducible admissible representation
K
IK
(χ) of GL[K2 :K] (K) which satisfies the following properties.
2
WK
K
(χ))] = [Ind W
recl (χ)].
1. [recl (IK
2
K
2

2. Whenever (K2 , χ) and (K2 , χ ) are two such pairs (with both K2 and K2
inside the same fixed K3 ) and ψ is a character of K × of finite order we
have
K
K
γ((IK
(χ) ⊗ (ψ ◦ det)) × IK
(χ ), s, Ψ) =
2
2
WK
K
γ(Ind WK recl (χ(ψ ◦ NK2 /K )) ⊗ Ind W
WK recl (χ ), s, Ψ).
2

2

Proof: Choose an extension of totally real fields L30 /L0 and a place x0 of
L , which is inert in L03 and for which the extension L03,x0 /L0x0 is isomorphic
to K3 /K. (This may be constructed as in lemma 3.6 of [He1]. Using weak
approximation one can ensure that all the number fields of that argument can
be taken to be totally real). Choose an imaginary quadratic field M and a
real quadratic field N such that N is disjoint from L03 over Q and such that
p splits completely in M N . Let x1 and y1 denote two places of M N above p
0

171

which have the same restriction to M . Set L1 = M N L0 and let x (resp. y)
denote the places of L which lie above x0 and x1 (resp. x0 and y1 ). Also set
L1 = L0 M N and L3 = L03 M N . Let x (resp. y) denote the place of L1 above
x0 and x1 (resp. y1 ). Thus x and y are inert in L3 and the extension L3,x /L1,x
and K3 /K and L3,y /L1,y are all isomorphic.
Fix a pair (K2 , χ) as in the lemma and let L2 /L1 be the subfield of L3
corresponding to K2 ⊂ K3 under the isomorphism of L3,x /L1,x and K3 /K.
Choose pτ as in corollary 12.10 and all divisible by the inertial degree
fK2 /K . Let χ∞ denote the character of L×
2,∞ corresponding to this choice of
×
pτ . Also choose a character χy of K2 for which the stabiliser of χ2 ◦ NK3 /K2
in Gal (K3 /K1 ) is Gal (K3 /K2 ). (For this it suffices to choose a finite order
×
character χy of OK
with the same property. Again it suffices to choose a
2
×
continuous homomorphism OK
→ Zp with the same property (then compose
2
it with a character of Zp of sufficiently large order). Again it suffices to choose
×
a Qp -linear map OK
⊗Z Qp → Qp with the same property. But using the
2
p-adic log and the normal basis theorem we find that there is a commutative
diagram
∼
×
⊗Z Qp −→
OK
K[Gal (K3 /K)]
3
↓
↓
∼
×
OK2 ⊗Z Qp −→ K[Gal (K3 /K2 )\Gal (K3 /K)],

where the top horizontal map is Gal (K3 /K)-equivariant, where the left hand
vertical map is induced by the norm map and where the right hand vertical
map is the natural projection. The existence of the desired homomorphism is
now immediate.) Now as in the proof of corollary 12.9 we can find a character
χ of AL×2 such that
• χ−1 = χc ,
• χ|L×2,∞ = χ∞ ,
• χx χ−1 is unramified,
• and χy χ−1
y is unramified.
(One must use the fact that x and y are split over the maximal totally real
subfield L+
2 of L2 . The argument is easier than in the proof of corollary 12.9
because χ∞ |O×+ = 1.)
L2

−1/fK2 /K

Now set ψ∞ = χ∞ |L×

1,∞

and choose a character ψ of AL×1 which is

unramified at x and which restricts to ψ∞ at ∞. One can check that χx (ψx ◦
NL2,x /L1,x ) has finite order and hence is a twist of χ by an unramified character
172

of finite order. Replacing ψ by a twist by a suitable character of finite order
one may assume that χ = χx (ψx ◦ NL2,x /L1,x ).
Finally we set
K
(χ) = ILL21 (χ)x ⊗ (ψx ◦ det).
IK
2

The lemma follows from corollary 12.10. ✷

We will let Cusp (GLg (K)) denote the set of isomorphism classes of irreducible admissible representations of GLg (K) and we will let
Cusp K =

∞

Cusp (GLg (K)).

g=1

We will let Z[Cusp K ] denote the free Z-module with basis the elements of
Cusp K . Then we may extend the definition of L(π1 × π2 , s), (π1 × π2 , s, Φ)
and γ(π1 × π2 , s, Φ) to bilinear maps from Z[Cusp K ] × Z[Cusp K ] to the multiplicative abelian group of non-zero meromorphic functions on C. We may
also extend
• recl to a homomorphism Z[Cusp K ] → Groth l (WK ),
• ∨ to a homomorphism Z[Cusp K ] → Z[Cusp K ],
• and ⊗(ψ ◦ det) to a Z[Cusp K ] → Z[Cusp K ], for any character ψ of K × .
(Note that to any irreducible admissible representation π of GLg (K) we can
associate a class [π] ∈ Z[Cusp K ], i.e. if π is a subquotient of n-Ind (π1 ×...×πr )
with each πi irreducible supercuspidal then [π] = [π1 ] + ... + [πr ]. Note however
that we do not in general have L(π, s) = L([π], s) etc.)
Lemma 12.12 Fix a finite Galois extension K3 /K. We can associate to any
irreducible g-dimensional representation r of WK /WK3 , an element [πK3 /K (r)]
in Z[Cusp K ] with the following properties.
1. For any such r we have recl [πK3 /K (r)] = r.
2. For any irreducible representations r and r of WK /WK3 and any character ψ of K × of finite order, we have
γ([πK3 /K (r) ⊗ (ψ ◦ det)] × [πK3 /K (r )]∨ , s, Ψ) = γ(r ⊗ recl (ψ) ⊗ (r )∨ , s, Ψ).
Proof: This follows from the previous lemma and from Brauer’s theorem
that representations induced from characters of subgroups form a Z-basis of
the Grothendieck group of virtual representations of the finite group WK /WK3 .
✷
173

Corollary 12.13 Fix a finite Galois extension K3 /K. If r is an irreducible
representation of WK then [πK3 /K (r)] can be represented by a supercuspidal
representation πK3 /K (r). The map
r −→ πK3 /K (r)
is an injection from the irreducible representations of WK /WK3 to Cusp K .
Proof: Suppose that [πK3 /K (r)] =
ments of Cusp K . Then

i

ai [πi ] where the [πi ] are distinct ele-

γ([πK3 /K (r)] × [πK3 /K (r)]∨ , s, Ψ)
has a zero at s = 0 of order
other hand

i

ai2 (see proposition 8.1 of [JPSS]). On the

γ([πK3 /K (r)] × [πK3 /K (r)]∨ , s, Ψ) = γ(r ⊗ r∨ , s, Ψ)
and so has a simple zero at s = 1. The corollary follows. ✷
Corollary 12.14 Fix a finite Galois extension K3 /K. If r and r are irreducible representations of WK /WK3 and if ψ is a continuous character of K ×
of finite order then
L((πK3 /K (r) ⊗ (ψ ◦ det)) × πK3 /K (r )∨ , s) = L(r ⊗ recl (ψ) ⊗ (r )∨ , s)
and
((πK3 /K (r) ⊗ (ψ ◦ det)) × πK3 /K (r )∨ , s, Ψ) = (r ⊗ recl (ψ) ⊗ (r )∨ , s, Ψ).
In particular πK3 /K (r) and r have the same conductor.
Proof: This follows from lemma 12.12 and the previous corollary as in
lemma 4.4 and proposition 4.5 of [He3]. ✷
Lemma 12.15 We can associate to any irreducible continuous g-dimensional
representation r of WK with finite image, an irreducible supercuspidal representation π(r) of GLg (K) with the following properties.
1. For any such r we have recl [π(r)] = r.

174

2. For any continuous irreducible representations r and r of WK with finite
images and for any character ψ of K × of finite order, we have
L((π(r) ⊗ (ψ ◦ det)) × π(r )∨ , s) = L(r ⊗ recl (ψ) ⊗ (r )∨ , s)
and
((π(r) ⊗ (ψ ◦ det)) × π(r )∨ , s, Ψ) = (r ⊗ recl (ψ) ⊗ (r )∨ , s, Ψ).
Proof: As K has finitely many extensions of given degree there are countably many irreducible continuous representations r of WK . List them r1 , r2 , ...
and set gi = dim ri . There are only finitely many irreducible supercuspidal
representations of GLgi (K) with the same conductor as ri and with central
character det(ri ) ◦ Art K . (For instance, as there are only finitely many ir×
which are trivial on a given open compact
reducible representations of DK,g
i
subgroup and which have given central character, this can be deduced from
the Jacquet-Langlands correspondence (see sections 2.5 and 2.6 of [He4]).) For
any positive integer I we may find a set KI of finite Galois extensions of K
such that
• if K and K ∈ K0 then either K ⊃ K or K ⊃ K ;
•

K ∈KI

K = K ac ;

• KI ⊂ KI−1 ;
• and for each K , K ∈ KI and each i ≤ I we have
πK /K (ri ) = πK

/K (ri ).

(Argue by recursion on I.) Set π(ri ) = πK /K (ri ) for any K ∈ Ki . The lemma
now follows easily. ✷
Corollary 12.16 If r is an irreducible continuous representation of WK with
finite image and if ψ is a character of K × of finite order then
π(r ⊗ recl (ψ)) = π ⊗ (ψ ◦ det).
Proof: Look at the zero at s = 0 of
γ([π(r) ⊗ (ψ ◦ det)] × [π(r ⊗ recl (ψ))]∨ , s, Ψ) = γ(r ⊗ r∨ , s, Ψ).
✷
175

Corollary 12.17 The map recl gives a bijection between isomorphism classes
of irreducible supercuspidal representations of GLg (K) with central character
of finite order and equivalence classes of g-dimensional irreducible continuous
representations of WK with finite image.
Proof: This now follows from the previous lemma and corollary and from
theorem 1.2 of [He4]. ✷
Corollary 12.18 The map recl gives a bijection between Cusp (GLg (K)) and
the set of equivalence classes of g-dimensional irreducible continuous representations of WK . Moreover π1 ∈ Cusp (GLg1 (K)) and π2 ∈ Cusp (GLg2 (K))
then
L(π1 × π2 , s) = L(recl (π1 ) ⊗ recl (π2 ), s)
and
(π1 × π2 , s, Ψ) = (recl (π1 ) ⊗ recl (π2 ), s, Ψ).
Proof: Any irreducible supercuspidal representation of GLg (K) is of the
form π ⊗ (ψ ◦ det), where ψπ is finite order and ψ is unramified. The corollary
follows as in sections 4.2, 4.3 and 4.4 of [He5]. ✷
Corollary 12.19 The bijection recl from Cusp (GLg (K)) to the set of equivalence classes of g-dimensional irreducible continuous representations of WK is
∼
independent of the choice of l = p and of the choice of isomorphism ı : Qac
l → C
1/2
(which we have assumed is chosen so that ı| |K is valued in R×
>0 ).
Proof: This follows from the last corollary and from theorem 4.1 of [He5].
✷
As described in section 4.4 of [Rod] one may naturally extend
∼

recl : Cusp K −→ Irrl (WK )
to a series of bijections
recK : Irr(GLg (K)) −→ WDRepg (WK )
for all g ∈ Z>0 . We will let Sp g = (r, N ) denote the g-dimensional WeilDeligne representation of WK on a complex vector space with basis e0 , ..., eg−1
where
i
• r(σ)ei = |Art −1
K | ei for all σ ∈ WK and all i = 0, ..., g − 1

176

• and where N ei = ei+1 .
Then Rodier sets
recK (Sp s1 (π1 )

...

Sp st (πt )) = (recl (π1 ) ⊗ Sp s1 ) ⊕ ... ⊕ (recl (πt ) ⊗ Sp st ).

Then we have
recK,l (π) = (recl (π), N (π))
for some N (π).
Theorem 12.20 The map recK is a local Langlands correspondence. (See the
introduction for the definition of a local Langlands correspondence.)
Proof: That this follows from what we have already proved seems to be well
known, but for lack of an explicit reference we sketch the argument.
It follows from lemma 12.7 and the definition of recK that
−1
• if π ∈ Irr(GL1 (K)) then recK (π) = π ◦ Art K
;

• if [π] ∈ Irr(GLg (K)) and χ ∈ Irr(GL1 (K)) then recK (π ⊗ (χ ◦ det)) =
recK (π) ⊗ recK (χ);
• and if [π] ∈ Irr(GLg (K)) then det recK (π) = recK (ψπ ).
Suppose that π is an irreducible admissible representation of GLg (K).
Then we can write
π∼
= Sp s1 (π1 ) ... Sp st (πt ),
with π1 , ..., πt irreducible supercuspidals. Moreover we have
π∨ ∼
= Sp s1 (π1∨ ⊗ | det |1−s1 )

...

Sp st (πt∨ ⊗ | det |1−st ).

(In the case t = 1 this can be deduced from proposition 1.1 (d) and proposition
2.10 of [Z]. Then the case that π is tempered follows from another application
of proposition 1.1 (d) of [Z]. Finally the general case follows from proposition
1.1 (d) of [Z] and corollary 2.7 of chapter XI of [BW].) Hence using lemma
12.7, the definition of recK and the isomorphism
1−s
Sp ∨s ∼
= Sp s ⊗ |Art −1
K |

we see that
• if [π] ∈ Irr(GLg (K)) then recK (π ∨ ) = recK (π)∨ .
177

It remains to check that if [π1 ] ∈ Irr(GLg1 (K)) and [π2 ] ∈ Irr(GLg2 (K))
then
L(π1 × π2 , s) = L(recK (π1 ) ⊗ recK (π2 ), s)
and

(π1 × π2 , s, Ψ) = (recK (π1 ) ⊗ recK (π2 ), s, Ψ).

Recall that in [JPSS] the factors L(π1 × π2 , s) and (π1 × π2 , s, Ψ) are only
defined directly for π1 and π2 generic. In this case if
πi ∼
= Sp s1 (πi,1 )

...

Sp sti (πi,ti )

with each πi,j supercuspidal, then
t1

L(π1 × π2 , s) =
and

j1 =1 j2 =1
t1

(π1 × π2 , s, Ψ) =

t2

L(π1,j1 × π2,j2 , s)

t2

j1 =1 j2 =1

(π1,j1 × π2,j2 , s, Ψ)

(see theorems 3.1 and 9.5 of [JPSS]). In general these formulae are used to
define L(π1 × π2 , s) and (π1 × π2 , s, Ψ) for any irreducible admissible π1 and
π2 . As by definition we have
L(r1 ⊕ r2 , s) = L(r1 , s)L(r2 , s)
and
(r1 ⊕ r2 , s, Ψ) = (r1 , s, Ψ) (r2 , s, Ψ)

for all Weil-Deligne representations r1 and r2 , we only need to check that
L(Sp s1 (π1 ) × Sp s2 (π2 ), s) = L(recK (π1 ) ⊗ recK (π2 ) ⊗ Sp s1 ⊗ Sp s2 , s)
and
(Sp s1 (π1 ) × Sp s2 (π2 ), s, Ψ) = (recK (π1 ) ⊗ recK (π2 ) ⊗ Sp s1 ⊗ Sp s2 , s, Ψ)
for all irreducible supercuspidal representations π1 and π2 , and for all positive
integers s1 ≥ s2 .
By theorems 3.1 and 8.2 of [JPSS] (see also equation (14) of section 8.2 of
[JPSS]), we see that if s1 ≥ s2 then
L(Sp s1 (π1 ) × Sp s2 (π2 ), s) =

s2 −1
i=0

178

L(π1 × (π2 ⊗ | det |s1 +i−1 ), s)

and
γ(Sp s1 (π1 ) × Sp s2 (π2 ), s, Ψ) =

s1 −1 s2 −1
i=0 j=0

γ((π1 ⊗ | det |i ) × (π2 ⊗ | det |j ), s, Ψ).

Using corollary 12.18, we see that it suffices to check if r1 and r2 are irreducible
Weil-Deligne representations of WK and if s1 ≥ s2 are positive integers, then
L(r1 ⊗ r2 ⊗ Sp s1 ⊗ Sp s2 , s) =

s2 −1
i=0

−1 s1 +i−1
|
), s)
L(r1 ⊗ r2 ⊗ |Art K

and
γ(r1 ⊗ r2 ⊗ Sp s1 ⊗ Sp s2 , s, Ψ) =
Note that if s1 ≥ s2 then

s1 −1 s2 −1
i=0 j=0

−1 i+j
| , s, Ψ).
γ(r1 ⊗ r2 ⊗ |Art K

s2

Sp s1 ⊗ Sp s2

∼
=

i=1

i−1
Sp s1 +s2 +1−2i ⊗ |Art −1
.
K |

The desired equality of L-factors follows at once from the definitions in section
4.1.6 of [Tat2]. The desired equality of γ-factors follows easily if we can show
that for any irreducible Weil-Deligne representation r of WK we have
t−1

γ(r ⊗ Sp t , s, Ψ) =

i=0

i
γ(r ⊗ |Art −1
K | , s, Ψ).

To prove this we consider two cases. If r is ramified then according to
section 4.1.6 of [Tat2] we have
t−1

t−1

γ(r ⊗ Sp t , s, Ψ) = (

i=0

r⊗

−1 i
| , s, Ψ)
|Art K

=
i=0

i
γ(r ⊗ |Art −1
K | , s, Ψ).

Thus we may suppose that r is unramified and hence that dim r = 1. Again
using the formulae of section 4.1.6 of [Tat2] we see that
γ(r ⊗ Sp t , s, Ψ) =
t−2
−1 i
−1 i
t−1
( t−1
i=0 (r ⊗ |Art K | )(FrobK )
i=0 r ⊗ |Art K | , s, Ψ)(−1)
t−1
t−1
−1 −i
−1 i
∨
−1
=
i=0 L(r ⊗ |Art K | , 1 − s)( i=0 L(r ⊗ |Art K | , s))
t−1
t−2
−1 s+i
−1 s+i
, s, Ψ) i=0 (−(r ⊗ |Art K | )(FrobK )
i=0 γ(r ⊗ |Art K |
−i−1
i
|
,
L(r∨ ⊗ |Art −1
1
− s)/L(r ⊗ |Art −1
K
K | , s)) =
t−1
−1 s+i
, s, Ψ).
i=0 γ(r ⊗ |Art K |

The theorem follows. ✷

179

I

Appendix: Generalities on admissible representations.

If G is a group and g ∈ G we will let
• Z(G) denote the centre of G,
• ZG (g) denote the centraliser of g in G,
• and [g] the conjugacy class of g in G.
If π is a representation of G we will let Wπ denote the vector space on which
the image of π acts, and we will let ψπ denote the central character of π (if it
has one).
Now suppose that G is a topological group such that every neighbourhood
of the identity contains a compact open subgroup. Suppose also that Ω is an
algebraically closed field of characteristic 0. then we will let
Cc∞ (G)
denote the space of locally constant Ω-valued functions on G with compact
support. If ψ : Z(G) → Ω× is an admissible character of Z(G) then we will
let
Cc∞ (G, ψ)
denote the space of locally constant Ω-valued functions ϕ on G such that
• ϕ(zg) = ψ(z)ϕ(g) for all z ∈ Z(G) and g ∈ G
• and the image of the support of ϕ in G/Z(G) is compact.
We may choose a (left or right) Haar measure µ on G such that every
compact subgroup of G has measure in Q. Then we may speak of an Ωvalued Haar measure meaning a non-zero element of Ωµ. If ϕ ∈ Cc∞ (G), if
π is an admissible representation G over Ω and if we fix an (Ω-valued) Haar
measure on G then we have a well defined endomorphism π(ϕ) of Wπ . The
endomorphism π(ϕ) has finite rank and so tr π(ϕ) makes sense. Similarly if ψ
is an admissible character of Z(G), if ϕ ∈ Cc∞ (G, ψ −1 ), if π is an admissible
representation G with central character ψ and if we fix Haar measures on
G and Z(G) then again we have a well defined endomorphism π(ϕ) of Wπ .
Again the endomorphism π(ϕ) has finite rank and so tr π(ϕ) makes sense. If
ϕ ∈ Cc∞ (G) or Cc∞ (G, ψ) and if we fix Haar measures on G and ZG (g) then
we will let
OgG (ϕ)
180

denote the integral
ϕ(xgx−1 )dx,
G/ZG (g)

if this integral converges. All these notations depend on a choice of Haar
measure(s) which we are suppressing. We will try to make clear in the accompanying text which measures we have chosen. If the choice of Haar measure
on a particular group enters twice into a particular formula we will always
suppose that we make the same choice both times, unless there is an explicit
statement to the contrary. In such cases it will often be irrelevant which choice
we make, only that we make a consistent choice.
Now suppose that H/K is a reductive algebraic group. Let P ⊂ H be
a parabolic subgroup with unipotent radical N ⊂ P . If π is an admissible representation of (P/N )(K) then we define an admissible representation
Ind H
P (π) of H(K) as follows. The underlying space will be the set of function
f : H(K) → Wπ such that
• f (hg) = π(h)(f (g)) for all g ∈ H(K) and h ∈ P (K);
• there exists an open subgroup U ⊂ H(K) such that f (gu) = f (g) for all
u ∈ U and g ∈ H(K).
If f is such a function and g ∈ H(K) then we set
(g(f ))(h) = f (hg)
for all h ∈ H(K). Conversely if π is an admissible representation of G(K)
then the space of N (K)-coinvariants Wπ,N (K) is naturally an admissible representation πN of (P/N )(K).
Often it is convenient to use instead an alternative normalisation. To
1/2
describe this, choose a square root | |K : K × → Ω× of | |K . If fK is even
1/2
we will suppose that | |K takes a uniformiser to p−fK /2 . Then we will let
H
n-Ind P (π) denote the normalised induction as in [BZ]. Thus n-Ind H
P (π) =
1/2
1/2
1/2
H
Ind P (π ⊗ δP ) where δP (h) = | det(ad (h)|Lie N )|K . Similarly if π is an
admissible representation of H(K), we will define the Jacquet module JN (π)
−1/2
to be the admissible representation πN ⊗ δP
of (P/N )(K).
Now return to the general topological group G such that every neighbourhood of the identity in G contains a compact open subgroup. Let Irr(G) denote
the set of isomorphism classes of irreducible admissible representations of G
over Ω. Let Groth (G) denote the abelian group of formal sums
nΠ Π
Π∈Irr(G)

181

where nΠ ∈ Z and where for any open compact subgroup U ⊂ G there are
only finitely many Π ∈ Irr(G) with both ΠU = (0) and nΠ = 0. If (π, V ) is an
admissible representation of G then we will define
[π] =
Π∈Irr(G)

nΠ (π)Π ∈ Groth (G)

as follows. Given Π ∈ Irr(G) choose an open compact subgroup U ⊂ G such
that ΠU = (0). Then ΠU is an irreducible H(U \G/U )-module. We let nΠ (π)
denote the number of H(U \G/U )-Jordan-Holder factors of π U isomorphic to
ΠU . This is independent of the choice of U . (To see this suppose U ⊂ U .
Let F i be a Jordan-Holder filtration on π U . Let (F i ) = H(U \G/U )F i . It
suffices to show that (F i ) /(F i+1 ) contains ΠU once or not at all depending
on whether F i /F i+1 is or is not congruent to ΠU . This is easy to verify.) We
list some basic properties of this construction.
1. [ ] is additive on short exact sequences.
2. Let K denote a p-adic field. Suppose that G = G1 × GLn (K) and that
H = G1 × P (K) where P ⊂ GLn is a parabolic subgroup. Then there
GLn (K)
is a unique homomorphism Ind P (K)
: Groth (H) → Groth (H) such
GL (K)

n
that for any admissible representation π of H we have Ind P (K)
[π] =

GL (K)

n
π].
[Ind P (K)

3. Suppose that G = G1 × G2 and that πi is an admissible representation
Gi for i = 1, 2. Then π1 ⊗ π2 is an admissible representation of G1 × G2 .
If π1 and π2 are irreducible so is π1 ⊗ π2 . We can define a product
Groth (G1 ) ⊗ Groth (G2 ) → Groth (G1 × G2 ) which sends [Π1 ] ⊗ [Π2 ]
to [Π1 ⊗ Π2 ] for any irreducible admissibles Π1 and Π2 . Then for any
admissible representations πi of Gi for i = 1, 2 we have [π1 ⊗π2 ] = [π1 ][π2 ].
4. More generally suppose that G = G1 ×G2 and that we have a continuous
homomorphism d : G2 → Z(G1 ) with discrete image. Suppose that
π1 is an admissible representation of G1 and that π2 is an admissible
representation of G2 . Then we define the representation π1 ⊗d π2 of
G1 × G2 by (π1 ⊗d π2 )(g1 , g2 ) = π1 (g1 d(g2 )) ⊗ π2 (g2 ). Then π1 ⊗d π2
is admissible. If Π1 and Π2 are irreducible so is Π1 ⊗d Π2 and so we
can define a product Groth (G1 ) ⊗ Groth (G2 ) → Groth (G1 × G2 ) which
sends [Π1 ] ⊗ [Π2 ] to [Π1 ⊗d Π2 ]. We will denote this product ∗d . Then for
any admissible representation π1 of G1 and π2 of G2 we have [π1 ⊗d π2 ] =
[π1 ] ∗d [π2 ].
182

It some special cases it will be convenient to introduce a slight variant of
Groth (G). For this suppose that l is a prime number and Ω = Qlac . Suppose that G has an open subgroup H × Γ. By an H × Γ-smooth/continuous
representation of G we shall mean a representation π of G such that
• π|H is smooth (i.e. the stabiliser of any element of Wπ is open)
• we can write Wπ = lim→ Wi where Wi are finite dimensional Γ invariant
subspaces of Wπ such that the representation
π : Γ −→ Aut (Wi )
is continuous with respect to the l-adic topology on WπU .
By an H × Γ-admissible/continuous representation of G we shall mean a representation π of G such that
• π|H is smooth (i.e. the stabiliser of any element of Wπ is open)
• and for any open subgroup U ⊂ H, the vector space WπU is finite dimensional and the representation
π : Γ −→ Aut (WπU )
is continuous with respect to the l-adic topology on WπU .
We will let IrrH×Γ,l (G) denote the set of isomorphism classes of irreducible H ×
Γ-admissible/continuous representations of G. We will also let Groth H×Γ,l (G)
denote the abelian group of formal sums
nΠ Π
Π∈IrrH×Γ,l (G)

where nΠ ∈ Z and where for any open compact subgroup U ⊂ H there are
only finitely many Π ∈ IrrH×Γ,l (G) with both ΠU = (0) and nΠ = 0. If (π, V )
is an H × Γ-admissible/continuous representation of G then we can define
[π] ∈ Groth H×Γ,l (G) as before. We will usually suppress the choice of H and
Γ. Our examples will all be of one of the following forms. Here K will denote
a finite field extension of Qp .
1. H is a topological group such that every neighbourhood of the identity
in G contains a compact open subgroup, Γ is a Galois group with the
Krull topology and G = H × Γ.
183

2. H is a topological group such that every neighbourhood of the identity
in G contains a compact open subgroup, Γ = IK and G = H × WK .
×
3. G = AK,g (see section 3), H = GLg (OK ) × OD
and Γ = IK .
K,g

In the latter two cases it is a theorem of Grothendieck that Irrl (G) = Irr(G)
and hence that Groth l (G) ⊂ Groth (G).
Finally consider the following special situation. Let K be a p-adic field.
For h = 1, ..., n − 1 we will let Ph denote the parabolic subgroup of GLn (K)
consisting of matrices (gij ) with gij = 0 if i > n − h and j ≤ n − h. We will let
Nh denote the unipotent radical of Ph and Lh the Levi component consisting
of matrices (gij ) ∈ Ph with gij = 0 for i ≤ n − h and j > n − h. Also let
m
) for the
Zh denote the centre of Lh . Abusing notation we will write Nh (℘K
m
elements in Ph (F ) ∩ ℘K Mn (OK ). This is in fact a group.
Lemma I.1
1. If V is an admissible Ph (K)-module and if for all u ∈
Nh (K) we have (u − 1)2 = 0 on V then Nh (K) acts trivially on V .
2. If V is a smooth Ph (K)-module which is admissible as a Lh (K)-module
then Nh (K) acts trivially on V .
3. If G1 is any locally compact totally disconnected group and if V is a
smooth G1 × Ph (K)-module which ia admissible as a G1 × Lh (K)-module
then Nh (K) acts trivially on V .
Proof: For the first part consider the open compact subgroups Um consisting
of elements of Ph (OK ) which reduce modulo ℘m
K to the identity and modulo
−m
2m
/℘
).
Note
that
℘2m
to
an
element
of
N
(O
U
h
K
m is normalised by Nh (℘K ).
K
K
−m
Thus V Um is a finite dimensional smooth Nh (℘m
K )-module, and as Nh (℘K )
−m
Um
is compact, V
is semi-simple. Thus if u ∈ N (℘K ) we see that u = 1 on
Um
Um
, the first part of the lemma
V . As Nh (K) = m Nh (℘−m
K ) and V =
mV
follows.
Now consider the second part of the lemma. If χ is a character of Zh (K)
then set
Viχ =
ker(z − χ(z))i
z∈Zh (K)

and
V∞χ =

Viχ .
i

Because V is an admissible Lh (K)-module we have
V =
χ

184

V∞χ .

(This follows because for any open compact subgroup U ⊂ Lh (K), V U is a
finite dimensional smooth Zh (K)-module, and hence
VU =
χ

(Vχ∞ ∩ V U ).)

Thus it suffices to show for each χ and i that Viχ is a Ph (K)-module on which
Nh (K) acts trivially. We will do this by induction on i for fixed χ. For i = 0
χ
there is nothing to prove. Thus assume the result is true for Vi−1
and we will
χ
prove it for Viχ . By the first part of this lemma it suffices to show that Viχ /Vi−1
χ
is a Ph (K)-submodule of V /Vi−1
on which Nh (K) acts trivially. Suppose that
χ
v ∈ V /Vi−1 . By smoothness, v is invariant by Nh (℘m
K ) for some m. If u is
any element of Nh (K) we may choose z ∈ Zh (K) such that zuz −1 ∈ Nh (℘m
K ).
Then we have
uv = uz −1 χ(z)v = χ(z)z −1 (zuz −1 )v = χ(z)z −1 v = v.
The second part of the lemma follows.
The third part of the lemma follows easily from the second. ✷

II

Appendix: Vanishing cycles

Here we will collect some facts about vanishing cycles.
Let K/Qpnr be a finite field extension, let O denote its ring of integers and
let l be a prime integer different from p. Suppose that X/O is a proper scheme
of finite type.
Lemma II.1 If x is a closed point of X then (Ri Ψη (Qlac )X )x is a finite diac
mensional Qac
l -vector space with a continuous action of Gal (K /K).
Lemma II.2 If L/X is a lisse Qlac -sheaf then
Ri Ψη (L) ∼
= (Ri Ψη (Qac
l )) ⊗ Ls ,
where Ls is the restriction of L to the special fibre of X.
Lemma II.3 Suppose that Y /X is a finite cover with an action of a finite
group G. Suppose that the generic fibres are a Galois etale cover with group
G. Suppose that x is a closed point of X which is totally ramified in Y , and
let y be its preimage in Y . Then
∼

(Ri Ψη (Qlac )X )x → (Ri Ψη (Qlac )Y )yG .
185

In [Berk3], a vanishing cycles functor is constructed for a certain class of
formal schemes over O. The comparison theorem 3.1 of [Berk3] implies that if
X is a formal scheme over O, which is isomorphic to the formal completion of
a proper scheme of finite type X/O along a subscheme Y of the special fibre
of X, then there is a canonical isomorphism of sheaves
Ri Ψη (Z/lm Z)Xη ∼
= Ri Ψη (Z/lm Z)Xη |Y .
It follows that the projective system of constructible sheaves Ri Ψη (Z/lm Z)Xη
i
ac
form a Zl -sheaf and, therefore, there is a well defined Qac
l -sheaf R Ψη (Ql )X . It
i
ac
is canonically isomorphic to R Ψη (Ql )X |Y , and the automorphism group of the
formal scheme X acts on it. More generally the construction of Ri Ψη (Qac
l )X is
functorial in X , i.e. if X and Y are two such formal schemes and if f : X → Y
then there is a natural map of Qlac -sheaves on X red
i
ac
f ∗ : (f red )∗ Ri Ψη (Qac
l )Y −→ R Ψη (Ql )X .

The continuity theorem from [Berk3] implies that there exists an ideal of definition of X such that any automorphism of X , trivial modulo this ideal, acts
ac
i
ac
i
trivially on the Qac
l -sheaves R Ψη (Ql )X . The construction of R Ψη (Ql )X extends to any special formal scheme X which is etale locally isomorphic to the
formal completion of a proper scheme of finite type X/O along a subscheme Y
of the special fibre of X. Again this construction is functorial in X . The following lemma follows easily by reduction to the algebraic case using Berkovich’s
comparison theorem.
Lemma II.4 Suppose that X and Y are special formal schemes each of which
is etale locally isomorphic to the formal completion of a proper scheme of finite
type over O along a subscheme of its special fibre. Then
∼
Ri Ψη (Qac
l )X ×Y =

j

ac
i
Ri Ψη (Qac
l )X ⊗ R Ψη (Ql )Y .

We end this section with a lemma of Berkovich’s (see the lemma in [Berk4]).
Lemma II.5 (Berkovich) Let X and Y be special affine formal schemes,
say X = Spf A and Y = Spf B. Let J ⊂ B be the maximal ideal of definition
for Y, and set Y{N } = Spec (B/J N +1 ). Assume that X is isomorphic to
the formal completion of an affine scheme of finite type X = Spec A /Spec O
along a closed subscheme of its special fibre. Let I ⊂ A be the maximal ideal of
definition of this subscheme. Furthermore assume that we are given projective
186

systems {Xn }n≥0 and {Yn }n≥0 of finite etale coverings of X and Y respectively.
Let Yn {N } denote the pull back of Y{N } to Yn . Suppose finally that we are
given compatible morphisms
ϕn : Yn {n} −→ Xn .
Then given any positive integer N for m >> 0 (depending on N ) we can find
a morphism
ϕ : Ym −→ Xm
such that

ϕ|Ym {N } = ϕm |Ym {N } .
Proof: As in the proof of the lemma in [Berk4] we see that we have Xn =
Spf An and Yn = Spf Bn , where An /A and Bn /B are finite etale. We set
B∞ = lim→ Bn and J∞ = JB∞ . Again as in the proof of the lemma of
[Berk4] we see that (B∞ , J∞ ) is a Henselian pair. The map ϕn induces a
homomorphism
n+1
.
ϕn : A −→ An −→ Bn /J n+1 Bn −→ B∞ /J∞

By corollary 1 on page 567 and remark 2 on page 587 of [El] we see that there
exists an integer t such that for all n >> 0 there exists a homomorphism
ϕn : A −→ B∞
with
n+1−t
.
ϕn ≡ ϕn mod J∞

Fix such an n, which we also suppose greater than N + t.
Note that as A /O is finitely generated ϕn is in fact valued in some Bm for
a
∩ Bm = J a Bm we see that for m >> 0
m >> 0. As J∞
ϕn ≡ ϕm mod J N +1 Bm .
Thus ϕn (I ) ⊂ JBm and so we may extend ϕn to a continuous homomorphism
A → Bm such that
ϕn
A −→
Bm
↓
↓
ϕm
Am −→ Bm /J N +1 Bm

commutes. By lemma 6.2 we see that we get a morphism
ϕ : Am −→ Bm
with ϕ ≡ ϕm mod J N +1 Bm , as desired. ✷
187

III

Appendix: Abelian varieties over Fpac.

In this appendix we will explain how the theory of Honda and Tate [Tat1]
allows us to classify simple abelian varieties over Fac
p .
By a CM field we will mean a number field M such that for any embedding
i : M → C the image iM is stable under complex conjugation and such
that the automorphism c of M induced by complex conjugation on iM is
independent of the embedding i. Equivalently either M is totally real or a
totally imaginary quadratic extension of a totally real field. We will let Q[PM ]
denote the free abelian group on the places of M above p. If i : M → N is
a finite extension we get natural maps i∗ : Q[PM ] → Q[PN ] induced by
x → y|x ey/x y and i∗ : Q[PN ] → Q[PM ] induced by y → fy/x x if y|x. If I is
a fractional ideal of M then we set [I] = x x(I)x ∈ Q[PM ].
By a p-adic type for a CM field M we shall mean an element η ∈ Q[PM ]
such that η + c∗ η = [p]. We will call p-adic types η ∈ Q[PM ] and η ∈
Q[PM ] equivalent if there is a CM field M , a p-adic type η ∈ Q[PM ]
and embeddings i : M → M and i : M → M such that i∗ (η ) = η and
i∗ (η ) = η . By a p-adic type we shall mean an equivalence class of p-adic types
for various CM fields M . Then any p-adic type b has a minimal representative
(M, η) such that if (M , η ) ∈ b then there exists i : M → M such that
η = i∗ η. (To see this choose (M , η ) ∈ b with M /Q Galois, let H denote the
subgroup of σ ∈ Gal (M /Q) such that σ∗ η = η and set M = (M )H .) We
call a p-adic type b ordinary if for any (M, η) ∈ b and any x ∈ PM we have
ηx ηcx = 0.
Suppose that q = pr is a power of p. By a q-number one means an algebraic
number π such that for any embedding i : Q[π] → C we have πc(π) = q.
To any q-number π we associate a CM-type b(π) = [(Q[π], [π]/r)]. To π
Honda and Tate also associate a simple abelian variety Aπ /Fq . The simple
factors of Aπ ×Fq Fqs are all isogenous to Aπs . Thus all the simple factors of
Aπ ×Fq Fpac are isogenous: we will denote them Aπ /Fac
p . We see that Aπ ∼ Aπ s .
If b(π) = b(π ) then we can find positive integers n and n such that (up
to Galois conjugation) [π n ] = [(π )n ]. Then (after replacing π by a suitable
Galois conjugate) π n /(π )n is a unit with all archimedean absolute values 1
and hence a root of unity. Thus we can find a positive integer m such that π nm
and (π )n m are Galois conjugate. Thus Aπnm is isogenous to A(π )n m and so
Aπ ∼ Aπ . This allows us to write Ab(π) for Aπ /Fac
p . If η is is any p-adic type
for a CM field M the for some positive integer r we have that rη ∈ Z[PM ] and
hence for a second positive integer h we have that rhη = [α] for some α ∈ OM .
Then β = αc(α)/prh is a unit in the ring of integers of the maximally totally
real subfield M + of M . Thus π = α2 β −1 is a p2hr -number and b(π) = [(M, η)].
188

Thus to any p-adic type we can associate a well defined isogeny class of simple
abelian varieties Ab /Fac
p . It follows easily from the theory of Honda and Tate
that this gives a bijection between p-types and isogeny classes of simple abelian
varieties over Fac
p . The following further results also follow easily from their
theory.
1. If b is a p-adic type with minimal representative (M, η) then End 0 (Ab )
is the division algebra with centre M and invariants
• inv x End 0 (Ab ) = 1/2 if x is real;
• inv x End 0 (Ab ) = ηx fx/p if x|p;
• inv x End 0 (Ab ) = 0 otherwise.

2. If b is a p-adic type with minimal representative (M, η) then dim Ab =
[M : Q][End 0 (Ab ) : M ]1/2 /2.
3. If b is a p-adic type with minimal representative (M, η) and if x is a
place of M above p then Ab [x∞ ] has height [Mx : Qp ][End 0 (Ab ) : M ]1/2
and its Newton polygon has pure slope ηx /ex/p .
Now fix a CM field F and a central simple F -algebra B. If M/F and
M /F are CM field extensions and if η and η are p-adic types for M and
M respectively the we will call them equivalent over F if there is a CM field
extension M /F , a p-adic type η ∈ Q[PM ] and embeddings i : M → M
and i : M → M over F such that i∗ (η ) = η and i∗ (η ) = η . By a p-adic
type over F we shall mean an F -equivalence class of p-adic types for various
CM fields M/F . Then any p-adic type b has a minimal representative (M, η)
such that if (M , η ) ∈ b then there exists i : M → M over F such that
η = i∗ η.
Now let B be an F -division algebra. We will consider the category of
pairs (A, i) up to isogeny, where A/Fac
p is an abelian variety and i : B →
0
ac
End (A/Fp ). As in section 3 of [Ko3] we can use the results of the last
paragraph to describe the simple objects of this category. They are in bijection
with p-adic types over F . If b is such a type we will let (Ab , ib ) denote the
corresponding simple object. We have the following additional properties.
1. If b is a p-adic type over F with minimal representative (M, η) then
End B (Ab ) is the division algebra with centre M and invariants
• inv x End B (Ab ) = 1/2 − inv x (B ⊗F M ) if x is real;
• inv x End B (Ab ) = ηx fx/p − inv x (B ⊗F M ) if x|p;
189

• inv x End B (Ab ) = −inv x (B ⊗F M ) otherwise.
2. If b is a p-adic type over F with minimal representative (M, η) then
dim Ab = [M : Q][B : F ]1/2 [End B (Ab ) : M ]1/2 /2.
3. If b is a p-adic type over F with minimal representative (M, η) and
if x is a place of M above p then Ab [x∞ ] has height [Mx : Qp ][B :
F ]1/2 [End (Ab ) : M ]1/2 and its Newton polygon has pure slope ηx /ex/p .

IV

Appendix: The local Jacquet-Langlands
correspondence, pseudo-coefficients and
Zelevinsky’s classification

Let Ω be an algebraically closed field of characteristic 0 and of cardinality
equal to that of C. Let K be a finite extension of Qp . Suppose that V /Ω is
a vector space and that π : GLg (K) → Aut (V ) is an irreducible admissible
representation with central character ψπ . We will call π supercuspidal if for
any v ∈ V and f in the smooth dual of V the function GLg (K) → Ω which
sends
x −→ f (xv)

is compactly supported modulo the centre K × of GLg (K). Choose an embedding of fields ı : Ω → C. We will call π square integrable if for any v ∈ V and
f in the smooth dual of V the function GLg (K)/K × → R which sends
x −→ |ı(f (xv))|2 |ı(ψπ (det x))|−2/g

is integrable. It follows from Zelevinsky’s classification [Z] that this definition
is independent of the choice of ı. We will call π,ı-preunitary if there is a pairing
( , ) from V × V to C such that
• (av1 + v2 , v3 ) = ı(a)(v1 , v3 ) + (v2 , v3 ) for all a ∈ Ω and v1 , v2 , v3 ∈ V ,
• (v1 , v2 ) = c(v2 , v1 ) for all v1 , v2 ∈ V (where c denotes complex conjugation),
• (v, v) > 0 for all non-zero v ∈ V ,
• (π(x)v1 , π(x)v2 ) = |ı(ψπ (det g))|2/g (v1 , v2 ) for all v1 , v2 ∈ V and x ∈
GLg (K).

190

Rogawski ([Rog2]) and Deligne, Kazhdan and Vigneras (see [DKV]) have
shown the existence of a unique bijection, which we will denote JL , from
×
irreducible admissible representations of DK,g
to square integrable irreducible
admissible representations of GLg (K) such that if ρ is an irreducible admissible
×
representation of DK,g
then the character χJL (ρ) of JL (ρ) satisfies
• χJL (ρ) (γ) = 0 if γ ∈ GLg (K) is regular semi-simple but not elliptic,
• χJL (ρ) (γ) = (−1)g−1 tr ρ(δ) if γ ∈ GLg (K) is regular semi-simple and
×
elliptic and if δ is an element of DK,g
with the same characteristic polynomial as γ.
If π is a square integrable irreducible admissible representation of GLg (K)
with central character ψπ then it seems that Deligne, Kazhdan and Vigneras
also show the existence of a function ϕπ ∈ Cc∞ (GLg (K), ψπ−1 ), which we will
call a pseudo-coefficient for π, with the following properties. (We always use
associated measures on inner forms of the same group.)
×
• tr π(ϕπ ) = vol (DK,g
/K × ).

• Suppose that

GLg1 × ... × GLgs = L ⊂ P ⊂ GLg

is a Levi component of a parabolic subgroup of GLg . Suppose also that
for i = 1, ..., s we are given a square integrable irreducible admissible
representation πi of GLgi (K) such that πi ∼
= π and such that ψπ1 ...ψπs =
ψπ . Then
GLg (K)
tr n-Ind P (K)
(π1 × ... × πs )(ϕπ ) = 0.
• If γ ∈ GLg (K) is a non-elliptic regular semi-simple element then
OγGLg (K) (ϕπ ) = 0.
×
• If γ ∈ GLg (K) is an elliptic regular semi-simple element and if δ ∈ DK,g
has the same characteristic polynomial as γ then
×
/ZD× (δ))tr JL −1 (π ∨ )(δ).
OγGLg (K) (ϕπ ) = (−1)g−1 vol (DK,g
K,g

(See section A.4 of [DKV], especially the introduction to that section and
subsection A.4.l .)
Lemma IV.1 Let π be a square integrable representation of GLg (K) and let
ϕπ be a pseudo-coefficient for π as above.
191

1. If γ ∈ GLg (K) is a non-elliptic semi-simple element then
OγGLg (K) (ϕπ ) = 0.
×
has
2. If γ ∈ GLg (K) is an elliptic semi-simple element and if δ ∈ DK,g
the same characteristic polynomial as γ then

OγGLg (K) (ϕπ ) = (−1)g(1−[K(γ):K]

−1 )

×
vol (DK,g
/ZD× (δ))tr JL −1 (π ∨ )(δ).
K,g

Proof: Consider the first part. Let T be a maximal torus containing γ.
Then
GLg (K)
0=
Γu (t)Oγu
(ϕπ )
u

where u runs over a set of representatives of the unipotent conjugacy classes in
ZGLg (γ)(K), where Γu denotes the Shalika germ associated to u and where and
where t is any regular element of T sufficiently close to γ. Then homogeneity
([HC], theorem 14(1)) tells us that
GLg (K)
(ϕπ )
0 = Γ1 (t)Oγu

for any regular t ∈ T sufficiently close to γ. By [Rog1], Γ1 (t) is not identically
zero near γ and the first part of the lemma follows.
Consider now the second part. Let T be an elliptic maximal torus in
×
. Then we can
GLg (K) containing γ. We can and will also think of T ⊂ DK,g
×
. For t a regular element of T sufficiently close to γ
take δ to be γ ∈ T ⊂ DK,g
we have
×
/T )tr JL −1 (π ∨ )(t) =
(−1)g−1 vol (DK,g

GLg (K)
Γu (t)Oγu
(ϕπ )
u

where u runs over a set of representatives of the unipotent conjugacy classes
in ZGLg (γ)(K) and where Γu denotes the Shalika germ associated to u. Again
using homogeneity ([HC], theorem 14(1)) we see that
×
(−1)g−1 vol (DK,g
/T )tr JL −1 (π ∨ )(δ) = OγGLg (K) (ϕπ ) lim Γ1 (t).
t→γ

Thus it suffices to check that
lim Γ1 (t) = (−1)g/[K(γ):K]−1 vol (ZD× (δ)/T ).
t→0

K,g

This is independent of the choices of measures, as long as we choose associated measures on ZGLg (γ)(K) and ZD× (δ). (Choices of Haar measures on
K,g

192

ZGLg (γ)(K) and T are implicit in the definition of Γu .) Thus we may choose
any measure on K × and Euler-Poincar´e measure on T and ZGLg (γ)(K) (see
section 1 of [Ko5]). Then we must use (−1)g/[K(γ):K]−1 times Euler-Poincar´e
measure on ZD× (δ) (by theorem 1 of [Ko5]). According to [Rog2] with these
K,g
choices of measures Γ1 (t) = 1 for regular t ∈ T sufficiently close to γ. On
the other hand according to [Se] with these measures vol (T /K × ) = 1 and
vol (ZD× (δ)/K × ) = 1. The second part of the lemma follows. ✷
K,g

Suppose that s|g is a positive integer and that π is a supercuspidal representation of GLg/s (K). Let Qs denote a parabolic subgroup of GLg with Levi
component GLsg/s . Zelevinsky ([Z]) describes the irreducible subquotients of
GL (K)

g
(π × π ⊗ | det | × ... × π ⊗ | det |s−1 )
n-Ind Qs (K)

as follows. Let Γ(s, π) be the graph with vertices labelled π ⊗ | det |j for
j = 0, ..., s − 1 and with one edge between π ⊗ | det |j and π ⊗ | det |j+1 for
j = 0, ..., s − 2 and no other edges. Zelevinsky shows that there is a bijection between directed graphs Γ with underlying undirected graph Γ(s, π) and
irreducible subquotients of
GL (K)

g
(π × π ⊗ | det | × ... × π ⊗ | det |s−1 ),
n-Ind Qs (K)

which, following Zelevinsky’s notation, we will denote Γ → ω(Γ).
Some particular subquotients will be of special importance for us. So we
will let Γabc (π) denote the directed graph with vertices labelled π ⊗ | det |j for
j = 0, ...a + b + c − 1 and
• a single edge from π ⊗ | det |j to π ⊗ | det |j−1 for j = 1, ..., a − 1 and for
j = a + b + 1, ..., a + b + c − 1,

• and a single edge from π ⊗ | det |j−1 to π ⊗ | det |j for j = a, ..., a + b.
Similarly we will let Γabc (π) denote the directed graph with vertices labelled
π ⊗ | det |j for j = 0, ...a + b + c − 1 and
• a single edge from π ⊗ | det |j−1 to π ⊗ | det |j for j = 1, ..., a and for
j = a + b, ..., a + b + c − 1,

• and a single edge from π ⊗ | det |j+1 to π ⊗ | det |j for j = a, ..., a + b − 2.
More over we will denote ω(Γt,s−1−t,0 ) = ω(Γ0,t,s−1−t ) by
Sp t (π)

(π ⊗ | det |t )

...

(π ⊗ | det |s−1 ),

for any t = 0, ..., s − 1.
Zelevinsky ([Z]) has proved the following results.
193

• Sp s (π) is square integrable and any square integrable representation is
of this form for a unique positive integer s|g and a unique supercuspidal
representation π of GLg/s (K).
• The only generic (“non-degenerate” in Zelevinsky’s terminology) subGLg (K)
(π × π ⊗ | det | × ... × π ⊗ | det |s−1 ) is Sp s (π).
quotient of n-Ind Qs (K)
Moreover Tadic ([Tad]) has shown that
• for any embedding ı : Ω → C the only ı-preunitary subquotients of
GLg (K)
(π × π ⊗ | det | × ... × π ⊗ | det |s−1 ) are Sp s (π) and π (π ⊗
n-Ind Qs (K)
| det |) ... (π ⊗ | det |s−1 ).
Lemma IV.2 Suppose that s1 +s2 = s|g are positive integers and that π is an
irreducible supercuspidal representation of GLg/s (K). Set gi = si g/s and let
P denote a parabolic subgroup of GLs with Levi component GLg1 × GLg2 . Let
Γ1 (resp. Γ2 ) be an oriented graph with unoriented underlying graph Γ(s1 , π)
(resp. Γ(s2 , π ⊗ | det |s1 )). Let Γ and Γ be the two (distinct) oriented graphs
with underlying unoriented graph Γ(s, π) which agree with Γ1 on Γ(s1 , π) and
GLg (K)
(ω(Γ1 ) × ω(Γ2 )) has a Jordanwith Γ2 on Γ(s2 , π ⊗ | det |s2 ). Then n-Ind P (K)
Holder series of length two and the two Jordan-Holder factors are ω(Γ) and
ω(Γ ).

Proof: We may and will assume that Qs ⊂ P . Let Us denote the unipotent
radical of Qs . By section 1.6 and theorem 2.8 of [Z] we can compute the
GLn (K)
(ω(Γ1 ) × ω(Γ2 ))). We find that they
Jordan-Holder factors of JUs (n-Ind P (K)
are all products (each taken with multiplicity one) of the form
(ρ ⊗ | det |j1 ) × ... × (ρ ⊗ | det |js ),
where j1 , ..., js runs over all permutations of 0, ..., s − 1 such that ji < ji if
there is an edge of either Γ1 or Γ2 running from i to i . This is the same as the
union (as sets with multiplicities) of the Jordan-Holder factors of ω(Γ) and
ω(Γ ) (see theorem 2.8 of [Z]). The lemma then follows from theorem 2.2 of
[Z]. ✷
Lemma IV.3 Suppose that s|g are positive integers and that π is an irreducible supercuspidal representation of GLg/s (K). For h = 0, ..., g − 1 let Nhop
be the unipotent subgroup of GLg introduced at the start of section 10.
1. If g |sh then JNhop (Sp s (π)) = (0) and JNhop (π
194

...

(π ⊗ | det |s−1 )) = (0).

2. If sh = gh for some positive integer h then
JNhop (Sp s (π)) = Sp h (π ⊗ | det |s−h ) × Sp s−h (π),
and
JNhop (π

...

(π ⊗ | det |s−1 )) = (π ... (π ⊗ | det |h −1 ))×
×((π ⊗ | det |h ) ... (π ⊗ | det |s−1 )).

Proof: These results follow easily from theorem 2.2 of [Z]. ✷
Lemma IV.4 Suppose that s|g are positive integers and that π is an irreducible supercuspidal representation of GLg/s (K).
1. If π is an irreducible admissible representation of GLg (K) which is not
GLg (K)
(π × π ⊗ | det | × ... × π ⊗ | det |s−1 ) then
a subquotient of n-Ind Qs (K)
tr π (ϕSp s (π) ) = 0.
2. If P is a proper parabolic subgroup of GLg with Levi component GLg1 ×
GLg2 and if π1 (resp. π2 ) is an irreducible admissible representation of
GLg1 (K) (resp. GLg2 (K)) then
GL (K)

g
tr n-Ind P (K)
(π1 × π2 )(ϕSp s (π) ) = 0.

3. Suppose that Γ is an oriented graph with underlying unoriented graph
Γ(s, π) and that Γ has s edges oriented from π ⊗ | det |j to π ⊗ | det |j+1 .
Then
×
tr ω(Γ)(ϕSp s (π) ) = (−1)s vol (DK,g
/K × ).
Proof: For the first part note that the proof of lemma A.4.f of [DKV] shows
that π can be written in Groth (GLg (K)) as an integral linear combination of
GLg (K)
n-Ind Pi (K)
(πi ) where Pi runs over parabolic subgroups of GLg , where πi is an
irreducible square integrable representation of the Levi component of Pi (K)
and where no (Pi , πi ) is conjugate to (GLg , Sp s (π)). (In fact in the notation
of [DKV] we have r(πi ) = r(Sp s (π)).)
For the second part note that it follows from lemma A.4.f of [DKV] that
we may write π1 ∈ Groth (GLg1 (K)) as a finite sum
GL

(K)

g1
π1i ,
a1i n-Ind P1i (K)

π1 =
i

195

where a1i ∈ Z, P1i ⊂ GLg1 is a parabolic subgroup and π1i is an irreducible
square integrable representation of the Levi component of P1i (K). Similarly
we have
GLg2 (K)
π2 =
a2i n-Ind P2i (K)
π2i .
i

For each pair of indices i, j choose a parabolic subgroup Pij ⊂ P ⊂ GLg such
that Pij (K) ∩ GLg1 (K) = P1i (K) and Pij (K) ∩ GLg2 (K) = P2i (K). Note that
for all i, j we have Pij = GLg . In Groth (GLg (K)) we have the equality
GL (K)

g
n-Ind P (K)

GLg (K)
π1i
ij (K)

a1i a2j n-Ind P

=
ij

× π2j .

The second part of the lemma follows.
The third part follows by a simple recursion from the second part and
lemma IV.2. ✷
Corollary IV.5 If s|g are positive integers, if π is an irreducible supercuspidal representation of GLg/s (K) and if π is an admissible representation of
GLg (K) then
×
vol (DK,g
/K × )−1 tr π (ϕSp s (π) ) ∈ Z.
Corollary IV.6 If s|g are positive integers, if π is an irreducible supercuspidal representation of GLg/s (K) and if π is a generic irreducible admissible
representation of GLg (K) such that
tr π (ϕSp s (π) ) = 0
then π ∼
= Sp s (π).
Corollary IV.7 If s|g are positive integers, if π is an irreducible supercuspidal
representation of GLg/s (K), if ı : Ω → C and if π is an ı-preunitary irreducible
admissible representation of GLg (K) such that
tr π (ϕSp s (π) ) = 0
then either π ∼
=π
= Sp s (π) or π ∼

...

(π ⊗ | det |s−1 ).

Suppose that si and gi are positive integers for i = 1, ..., t such that g =
g1 s1 +...+gt st . Suppose moreover that for i = 1, ..., t we are given an irreducible
supercuspidal representation πi of GLgi (K). Suppose first that

196

• if i < j then πj ∼
= πi ⊗ | det |a for any a ∈ Z≥1 with
1 + si − sj ≤ a ≤ si .
Also let P denote the parabolic subgroup of GLg consisting of block diagonal
matrices with diagonal blocks of size s1 g1 × s1 g1 , ..., st gt × st gt from top left to
bottom right. Then
GL (K)

g
(Sp s1 (π1 ) × ... × Sp st (πt ))
n-Ind P (K)

has a unique irreducible quotient which we will denote
Sp s1 (π1 )

...

Sp st (πt ).

If σ is any permutation of {1, 2, ..., t} such that (sσ1 , πσ1 ), ..., (sσt , πσt ) still
satisfies the above condition then
Sp sσ1 (πσ1 )

...

Sp sσt (πσt ) ∼
= Sp s1 (π1 )

...

Sp st (πt ).

Thus whether or not (s1 , π1 ), ..., (st , πt ) satisfy the above condition we may
define
Sp s1 (π1 ) ... Sp st (πt ) = Sp sσ1 (πσ1 ) ... Sp sσt (πσt ),
for any permutation σ of {1, 2, ..., t} such that (sσ1 , πσ1 ), ..., (sσt , πσt ) does satisfy the above condition. It follows from theorem 2.8 of [Z] that this notation
is compatible with our previous use of . Moreover any irreducible admissible representation π of GLg (K) is of this form and, moreover, the multiset
{(s1 , π1 ), ..., (st , πt )} is uniquely determined by π. (For these results see section
4.3 of [Rod], and note that a sketch of the unpublished result of I.N.Bernstein
(proposition 11 of [Rod]) can be found in [JS].)
We will call the collection {(si , πi )} unlinked if for all i = j the following
condition is satisfied.
• If πj ∼
= πi ⊗| det |a for a positive integer a then either a > si or a+sj ≤ si .
Zelevinsky shows ([Z], theorem 9.7) that if {(si , πi )} is unlinked then
Sp s1 (π1 )

...

GL (K)

g
Sp st (πt ) = n-Ind P (K)
(Sp s1 (π1 ) × ... × Sp st (πt ))

and that this representation is generic. Zelevinsky also shows ([Z], theorem
9.7) that any irreducible generic admissible representation of GLg (K) arises
in this way from some unlinked collection {(si , πi )}.
The following result follows from lemma 2.12 of [BZ].
197

Lemma IV.8 Suppose that si and gi for i = 1, ..., t are positive integers such
that g = g1 s1 + ... + gt st . Suppose also that πi is an irreducible supercuspidal
representation of GLgi (K) for i = 1, ..., t; and that P ⊂ GLg is a parabolic
subgroup with Levi factor GLs1 g1 × ... × GLst gt .
For h = 0, ..., g − 1 let Nhop < GLg be the unipotent subgroup defined at the
start of section 10. Then in Groth (GLh (K) × GLg−h (K)) we have an equality
between
GLg (K)
(Sp s1 (π1 ) × ... × Sp st (πt ))]
[JNhop (n-Ind P (K)
and
GLh (K)
hi [n-Ind P (K) (Sp h1 (π1

⊗ | det |s1 −h1 ) × ... × Sp ht (πt ⊗ | det |st −ht ))]
GLn−h (K)
(Sp s1 −h1 (π1 )
(K)

[n-Ind P

× ... × Sp st −ht (πt ))],

where the sum is over all positive integers h1 , ..., ht with hi ≤ si and h =
h1 g1 + ... + ht gt and where
• P ⊂ GLh is a parabolic subgroup with Levi component GLh1 g1 × ... ×
GLht gt
• and P ⊂ GLn−h is a parabolic subgroup with Levi component
GL(s1 −h1 )g1 × ... × GL(st −ht )gt

V

Appendix: The global Jacquet-Langlands
correspondence.

Let S(B) denote the set of places of F at which B ramifies. Recall that we are
assuming that at such a place Bx is a division algebra. The following theorem
was proved by Vigneras in her unpublished manuscript [V2], which relied on
a seminar of Langlands which to the best of our knowledge was never written
up. We will explain how it follows easily from an important theorem of Arthur
and Clozel [AC].
Theorem V.1
1. If ρ is an irreducible automorphic representation of
op
×
(B ⊗ A) then there is a unique irreducible automorphic representation
JL (ρ) of GLn (AF ), which occurs in the discrete spectrum and for which
JL (ρ)S(B) ∼
= ρS(B) .
2. If x ∈ S(B) and JL (ρx ) = Sp sx (πx ) then
198

• either JL (ρ)x ∼
= Sp sx (πx ),
• or JL (ρ)x ∼
= πx ... (πx ⊗ | det |sx −1 ).
3. The image of JL is the set of irreducible automorphic representations π
of GLn (AF ) such that
• π occurs in the discrete spectrum,

• and for every x ∈ S(B) there is a positive integer sx |n and an
irreducible supercuspidal representation πx of GLn/sx (Fx ) so that
either JL (ρ)x ∼
= πx ... (πx ⊗ | det |sx −1 ).
= Sp sx (πx ) or JL (ρ)x ∼

4. If ρ1 and ρ2 are two irreducible automorphic representations of (B op ⊗
A)× such that for all but finitely many places x of F we have ρ1x ∼
= ρ2x ,
then ρ1 = ρ2 (i.e. ρ1 ∼
= ρ2 and this representation occurs with multiplicity
1 in the space of automorphic forms).
Proof: Let H denote the algebraic group over Q such that H(R) = (B op ⊗Q
R)× for any Q-algebra R. We will confuse irreducible admissible representations occurring discretely in the space of automorphic forms (with fixed central
2
character restricted to R×
>0 ) with their completions in L . By twisting, we need
only consider representations which are trivial on R×
>0 .
Then by theorem B of [AC] we have, in the notation of [AC],
GLn ×F
adisc
(π)δ(π, ρ),

H
adisc
(ρ) =
π

where the sum is over (pre)unitary representations of GLn (AF )1 . Let us write
JL (ρx ) = Sp sx (ρ) (πx (ρ)) for x ∈ S(B). Moreover for T ⊂ S(B) let π(T, ρ)
denote
ρS(B) ×

x∈T

Sp sx (ρ) (πx (ρ)) ×

(πx (ρ)
x∈S(B)−T

...

(πx (ρ) ⊗ | det |sx (ρ)−1 )).

Then, using section 8 of [AC], lemma IV.4 and corollary IV.7 we see that
δ(π, ρ) = 0 unless π ∼
= π(T, ρ) for some T ⊂ S(B), in which case δ(π, ρ) = ±1.
Thus the equality of theorem B of [AC] becomes
aH
disc (ρ) =
T ⊂S(B)

n ×F
(π(T, ρ)).
±aGL
disc

H
The coefficients adisc
(ρ) are just the multiplicity of ρ in the space of autoGLn ×F
(π(T, ρ)) are defined by
morphic forms trivial on R×
>0 . The coefficients adisc

199

the equalities
N ×F
(π)tr π(f ) = L∈L |W0L ||W0GLn ×F |−1
aGL
disc
−1
s∈W (aL )reg | det(s − 1)aGLn ×F | tr (M (s, 0)ρQ,t (0, f ))
L

in the notation of section 9 of chapter 2 of [AC]. Choose x ∈ S(B). Then for
any z in the Bernstein centre for GLn (Fx ) we see that
N ×F
aGL
(π)tr π(f )πx (z) = L∈L |W0L ||W0GLn ×F |−1
disc
−1
s∈W (aL )reg | det(s − 1)aGLn ×F | tr (M (s, 0)ρQ,t (0, f ))ρQ,t (0)x (z).
L

Let D denote the variety of unramified twists of the representation πx (ρ)sx (ρ)
of GLn/sx (ρ) (Fx )sx (ρ) and suppose that z corresponds as in [Bern] to a regular function on D/W (GLn/sx (ρ) (Fx )sx (ρ) , D) (in the notation of [Bern]). If
Q = GLn × F then either ρQ,t (0)x (z) = 0 for all z which correspond to regular functions on D/W (GLn/sx (ρ) (Fx )sx (ρ) , D), or ρQ,t (0)x maps to a 0-cycle
on D/W (GLn/sx (ρ) (Fx )sx (ρ) , D) supported away from πx (ρ) × ... × (πx (ρ) ⊗
| det |sx (ρ) ). Choose z in the Bernstein centre corresponding to a regular function on the space D/W (GLn/sx (ρ) (Fx )sx (ρ) , D) which is 1 at πx (ρ)×...×(πx (ρ)⊗
| det |sx (ρ) ) and zero at all other terms occuring in our sum (which is finite for
any given f ). Then we see that
N ×F
(π)tr π(f ) =
aGL
disc

m(π)tr π(f ),
π

π

where
• m(π) denotes the multiplicity of π in the discrete part of the space of
automorphic forms invariant by R×
>0 ;
• and where both sums run over irreducible representations π such that πw
maps to πx (ρ) × ... × (πx (ρ) ⊗ | det |sx (ρ) ) in D/W (GLn/sx (ρ) (Fx )sx (ρ) , D).

GLN ×F
We deduce that adisc
(π) is just the multiplicity of π in the discrete part of
the space of automorphic forms invariant by R×
>0 .
Using the strong multiplicity one theorem for GLn (AF ), the theorem follows. ✷

Combining this with the facts that any automorphic representation of
GLn (AF ) which is supercuspidal at one place is cuspidal and that any cuspidal automorphic representation of GLn (AF ) is generic we obtain the following
corollary.
Corollary V.2 Suppose that ρ is an irreducible automorphic representation of
(B op ⊗A)× such that for one place x ∈ S(B) the component ρx is supercuspidal.
Then for all places x ∈ S(B) the component ρx is generic.
200

VI

Appendix: Clozel’s base change.

In this section we will give a description of automorphic representations of
G(A) in terms of automorphic representations on (B op ⊗Q A)× . This description is basically due to Clozel (see [Cl1] and [Cl2]), but there were a number of
gaps in his argument which were repaired with the help of Labesse (see [Lab]
and [CL]).
∼
As we have fixed ı : Qlac → C we can think of ξ as an irreducible algebraic
representation of G over C. Note that for any C-algebra R we have
E
RSQ
(G × E) × C ∼
= (G × C) ×C (G × C),

where the first factor corresponds to τ0 : E → C and the second factor to
τ0 ◦ c. We will let ξE denote the representation ξ ⊗ ξ of RSE
Q (G × E) over
C. It restricts to the representation ξ ⊗ (ξ ◦ c) of G(E∞ ) = RSE
Q (G × E)(R).
We will also use ξE for the restriction of this representation to GLn (F∞ ) ⊂
×
E∞
× GLn (F∞ ) ∼
= G(E∞ ) (see section 1).
We will call an irreducible admissible representation π∞ of G(R) (resp. Π∞
of GLn (F∞ )) cohomological for ξ (resp. cohomological for ξE ) if for some i,
H i ((Lie G(R)) ⊗R C, U∞ , π∞ ⊗ ξ) = (0),
(resp.
H i (Mn (F∞ ) ⊗R C, U (n, 0)[F

+ :Q]

, Π∞ ⊗ ξE ) = (0).)

Suppose that x is a place of Q which splits as x = yy c in E. Recall (from
∼
section 1) that the choice of a place y|x allows us to consider Qx → Ey as an
E-algebra and hence to identify
G(Qx ) ∼
= (Byop )× × Q×
x.
If π is an irreducible admissible representation of G(Qx ) we can then decompose
π∼
= πy ⊗ ψπ,yc .

If we vary our choice of y we find that πyc = πy# and that ψπ,y = ψπy ψπ,yc .
(Here we set πy# (g) = πy (g −# ).) We define BC (π) to be the representation
πy ⊗ πyc ⊗ (ψπ,yc ◦ c) ⊗ (ψπ,y ◦ c)
of

op
G(Ex ) ∼
= (Byop )× × (Byc )× × Ey× × Ey×c .
= (Bxop )× × Ex× ∼

Now suppose that x is a finite place of Q which is inert in E but such that
201

• x is unramified in F ;
• (Bxop , #) ∼
= (Mn (Fx ), †), where g † = w(g c )t w−1 with w the antidiagonal
matrix with ones on the antidiagonal.
These latter two conditions exclude only finitely many places of Q. If x is such
a place then G(Qx ) is quasi-split and split over an unramified extension. We
will fix a maximal torus Tx in a Borel subgroup Bx in G × Fx so that Bx (Fx )
consists of elements of G(Fx ) which correspond to upper triangular elements
of Mn (Fx ) and Tx (Fx ) consists of elements of G which correspond to diagonal
elements of Mn (Fx ). Thus Tx (Qx ) can be identified with the set of elements
(d0 ; d1 , ..., dn ) ∈ Qx× × (Fx× )n such that d0 = di dcn+1−i for i = 1, ..., n. If ψ is a
character of T (Qx ) we define a character BC (ψ) of Ex× × (Fx× )n by
BC (ψ)(d0 ; d1 , ..., dn ) = ψ(d0 dc0 ; d0 d1 /dnc , ..., d0 dn /d1c ).
Let B denote the Borel subgroup of upper triangular elements of GLn . If
π is an unramified representation of G(Qx ) which is a subquotient of the inG(Q )
duced representation n-Ind Bx (Qxx ) (ψ) then we will denote by BC (π) the unique
unramified representation of Ex× × GLn (Fx ) which is a subquotient of the normalised induction from Ex× × B(Fx ) of BC (ψ).
If Π is an irreducible automorphic representation of (B op ⊗Q A)× then define
Π# by
Π# (g) = Π(g −# ).
Using the strong multiplicity one theorem we see that
JL (Π# ) = JL (Π)∨ ◦ c.
Theorem VI.1 Suppose that π is an irreducible automorphic representation
of G(A) such that π∞ is cohomological for ξ. Then there is a unique irreducible
op
⊗Q A)× such that
automorphic representation BC (π) = (ψ, Π) of A×
E × (B
1. ψ = ψπ |cA× ;
E

2. if x is a place of Q which splits in E then BC (π)x = BC (πx );
3. for all but finitely many places x of Q which are inert in E we have
BC (π)x = BC (πx );
4. Π∞ is cohomological for ξE ;
×
c
⊂ G(R));
(where E∞
5. ψ∞
= ξ|−1
E×
∞

202

6. ψΠ |A× = ψ c /ψ;
E

7. Π# ∼
= Π.
Proof: We will deduce this from theorem A.5.2 of [CL].
1
⊂ T denote the kernel
Let T /Q denote the torus RSE
Q (Gm ) and let T
of the norm homomorphism T → Gm . We have a natural morphism T ×
G1 → G which is surjective on geometric points. It has kernel T 1 embedded
by t → (t, t−1 ). If π is an admissible representation of G(A) we obtain an
admissible representation π|(T ×G1 )(A) of (T × G1 )(A) by composing π with the
homomorphism T × G1 → G. (Use the fact that (T × G1 )(A) → G(A) is
continuous and open.) If π is automorphic then π|(T ×G1 )(A) is a direct sum
of irreducible subrepresentations. As far as we can see not all these direct
summands are automorphic for T × G1 . Rather suppose that gi ∈ G(A) form
×
a set of representatives for ν(G(A))/ν(G(Q))N(AE
). Then we get a bijection
of spaces of automorphic forms
∼

A(G(Q)\G(A)) →
f
−→

i

A((T × G1 )(Q)\(T × G1 )(A))gi T
(gi (f )|(T ×G1 )(A) )i .

1 (A)g −1
i

If π is an irreducible subquotient of π|(T ×G1 )(A) then π may not be automorphic but π composed with conjugation by one of the gi will be. Note that
(because G(Q) is dense in G(R)) one may assume that gi,∞ = 1 for all i.
If x is a place of Q which splits in E then we get an exact sequence
(0) −→ T 1 (Qx ) −→ (T × G1 )(Qx ) −→ G(Qx ) −→ (0).
If πx is an irreducible admissible representation of G(Qx ) then πx |(T ×G1 )(Qx ) is
also irreducible.
If x is a finite place of Q which is inert in E, but such that
• x is unramified in F ,
• (Bxop , #) ∼
= (Mn (Fx ), †), where g † = w(g c )t w−1 with w the antidiagonal
matrix with ones on the antidiagonal;
then we get an exact sequence
(0) −→ T 1 (Qx ) −→ (T × G1 )(Qx ) −→ G(Qx ) −→ (0),
if n is odd, while if n is even we get an exact sequence
x◦ν

(0) −→ T 1 (Qx ) −→ (T × G1 )(Qx ) −→ G(Qx ) −→ (Z/2Z) −→ (0).
203

In either case if πx is an unramified irreducible representation of G(Qx ) then
πx |(T ×G1 )(Qx ) contains a unique unramified subquotient which we will denote
πx |0(T ×G1 )(Qx ) .
If [F + : Q] > 1 or n > 2 then we have an exact sequence
(0) −→ T 1 (R) −→ (T × G1 )(R) −→ G(R) −→ (0),
while if F + = Q and n = 2 then we get an exact sequence
(0) −→ T 1 (R) −→ (T × G1 )(R) −→ G(R) −→ {±1} −→ (0).
If π∞ is a irreducible admissible representation of G(R) then it is cohomological
for ξ if and only if
−1
× = ξ| × ,
1. π∞ |E∞
E
∞

2. and there is an irreducible constituent π∞ of π∞ |G1 (R) and an i ∈ Z≥0
such that
H i (Lie G1 (R) ⊗R C, U∞ , π∞ ⊗ ξ|G1 ) = (0).
Thus if π is an irreducible automorphic representation of G(A) such that π∞
is cohomological for ξ we can find an irreducible automorphic representation
π for (T × G1 )(A) such that
• π |T 1 (A) = 1,
• if x is a place of Q which splits in E then πx = πx |(T ×G1 )(Qx ) ;
• for all but finitely many places x of Q which are inert in E we have
πx = πx |0(T ×G1 )(Qx ) ;
−1
× = ξ| × ;
• π∞ |E∞
E
∞

• and for some i we have
H i (Lie G1 (R) ⊗R C, U∞ , (π∞ ⊗ ξ)|G1 (R) ) = (0).
Thus π is of the form ψ c ⊗ π1 , where ψ is a character of E × \A×
E and π1 is an
−1
automorphic representation of G1 (A). Moreover ψ|T 1 (A) = ψπ1 |T 1 (A) .
Now we apply theorem A.5.2 of [CL] to π1 and we conclude that there
exists an automorphic representation Π of (B op ⊗ A)× such that
• if x is a place of Q which splits in E then Πx = BC (πx )|(Bxop )× ;
204

• for all but finitely many places x of Q which are inert in E we have
Πx = BC (πx )|(Bxop )× ;
• for some i we have
H i (Mn (F∞ ) ⊗R C, U (n, 0)[F

+ :Q]

, Π∞ ⊗ ξE ) = (0).

(The first of these properties is not explicitly stated in theorem A.5.2 of [CL].
However it follows easily from a slight modification of the proof. In the notation of the proof of theorem A.5.2 in [CL] divide the set S as a disjoint union
S = S1 ∪ S2 where S1 consists of places which split in E and S2 of places which
are inert. Now take fS = ( x∈S1 fx ) × fS2 where for x ∈ S1 , fx is any element
of Cc∞ (G0 (Qx )) and fS2 is the characteristic function of a sufficiently small
open compact subgroup, KS2 . Then we can still find a function ϕS associated
to fS . We conclude as in [CL] that if we fix an unramified representation ρ of
G0 (AS∪{∞} )
KS2
π ep (π∞ ) dim πS2 tr BC (πS1 )(ϕS1 ) =
G,θ
Π tr (Π∞ (ϕep )ΠS2 (ϕS2 )Iθ )tr ΠS1 (ϕS1 ),
where π runs over automorphic representations of G0 (A) with π S∪{∞} ∼
= ρ and
S∪{∞} ∼
Π runs over automorphic representations of G0 (AE ) with Π
= BC (ρ).
We deduce that if we fix an irreducible representation ρ of G0 (AS2 ∪{∞} ) which
is unramified outside S1 then
K

π

ep (π∞ ) dim πS2S2 =

Π

tr (Π∞ (ϕ∞ )ΠS2 (ϕS2 )Iθ ),

where π runs over automorphic representations of G0 (A) with π S2 ∪{∞} ∼
= ρ and
Π runs over automorphic representations of G0 (AE ) with ΠS2 ∪{∞} ∼
= BC (ρ).
The rest of the argument is as in [CL].)
It is now easy to check that (ψπ |A× , Π) satisfies the first six properties of
E
the theorem. Uniqueness follows from theorem V.1. The final property also
follows from V.1, because for all but finitely many places x of Q we have
∼
Π#
x = Πx . ✷
Corollary VI.2 If π and π are irreducible automorphic representations of
G(A) such that π∞ and π∞ are cohomological for ξ and such that πx ∼
= πx for
all but finitely many places x of Q, then πx ∼
= πx for all places x of Q which
split in E.
Proof: This follows from theorems V.1 and VI.1. ✷
205

Corollary VI.3 Suppose that π is an irreducible automorphic representation
of G(A) such that π∞ is cohomological for ξ. Suppose also that there exists a
place x of F such that
• x|Q splits in E,
• Bxop is split,
• and πx is supercuspidal.
Then for any place y of F such that
• y|Q splits in E
• and Byop is split,
πy is generic.
Proof: This follows from corollary V.2 and theorem VI.1. ✷
In the other direction we have the following result.
Theorem VI.4 Suppose that Π is an irreducible automorphic representation
×
such that
of (B op ⊗ A)× and that ψ is a character of A×
E /E
1. Π ∼
= Π# ,
2. ψΠ |A× = ψ c /ψ,
E

3. Π∞ is cohomological for ξE ,
×
4. and ξ|−1
= ψ|cE × (where E∞
⊂ G(R)).
E×
∞

∞

Then there is an irreducible automorphic representation π of G(A) such that
1. BC (π) = (ψ, Π),
2. and π∞ is cohomological for ξ.
Proof: This theorem will follow from proposition 2.3 of [Cl2]. (We caution
the reader that the proof of proposition 2.3 in [Cl2] seems to us rather sketchy
(see in particular the first paragraph of section 2.5 of [Cl2]). However this
is remedied in theorem A.3.1 of [CL] where a complete derivation of the key
trace identity is given.)

206

We will use the notation of the proof of theorem VI.1. Let π1 be the
automorphic representation of G1 (A) whose existence is guaranteed by proposition 2.3 of [Cl2]. Then ψ c × π1 is an irreducible automorphic represen×
tation of (T × G1 )(A) which vanishes on T 1 (A) (because if b ∈ AE
then
c
c
c
ψ (b/b ) = ψΠ (b) = ψπ1 (b/b ), the latter equality following from Clozel’s definition of “base change lift”). Thus ψ c × π1 is a subrepresentation of the restriction of some automorphic representation π of G(A) to (T ×G1 )(A). Again
from Clozel’s definition of “base change lift” we see that BC (π) = (ψπ |A× , Π).
E
−1
Finally because π1 is cohomological for ξ|G1 (R) and because ψ c |−1
× = ξ| × we
E∞
E∞
c
see that ψ∞
× π1,∞ and hence π∞ is cohomological for ξ. ✷
Corollary VI.5 Keep the notation and assumptions of the theorem. Then
dim[Rξ (π ∞ )] = 0.
Proof: Combine the theorem with a theorem of Kottwitz (see theorem A.4.2
of [CL]). ✷
It may sometimes be useful to combine theorem VI.4 with the following
lemma.
Lemma VI.6 Suppose that Π is an automorphic representation of (B op ⊗A)×
such that
1. Π ∼
= Π# ,
2. and Π∞ has the same infinitesimal character as some algebraic represenF
tation of RSQ
(GLn ) over C.
×
Then we can find a character ψ of A×
and an algebraic representation ξ
E /E
of G over C such that

1. ψΠ |A× = ψ c /ψ,
E

2. Π∞ is cohomological for ξE ,
−1
×
c
3. ξ|E
× = ψ∞ (where E∞ ⊂ G(R)),
∞

4. and ψ|O× = 1.
E,u

207

Proof: Because Π∞ has the same infinitesimal character as an algebraic
representation of RSFQ (GLn ) over C we see that
×
−→ C×
ψΠ∞ : F∞

is of the form
(xτ ) −→

τ (xτ )aτ τ (xcτ )bτ ,
τ

where aτ , bτ ∈ Z and where τ runs over Hom Q (F + , R) ∼
= Hom E,τ0 |E (F, C). As
∨ ∼
×
Π∞
we have
= Πc∞ we see that for all τ we have aτ + bτ = 0. Thus if x ∈ E∞
ψΠ∞ (x) = (τ0 (x)/τ0 (xc ))a ,
where a =

aτ ∈ Z. Define
×
−→ C×
ψ∞ : E∞

by
ψ∞ (x) = τ0 (x)−a .

×
then ψ∞ × Π∞ defines a representation of G(E∞ ) ∼
× GLn (F∞ ) such that
= E∞
c∨ ∼
c
) = ψ∞ × Π∞ .
ψΠc ∞ × Π∞
(ψ∞ × Π∞ ) ◦ c = ψ∞

(Note that the first c refers to the G-structure, the second and third to the
GL1 -structure and the fourth to the GLn -structure.)
We may choose an algebraic representation Ξ of RSE
Q G over C such that
∨
ψ∞ × Π∞ and Ξ have the same infinitesimal character. As (ψ∞ × Π∞ ) ◦ c ∼
=
ψ∞ × Π∞ we see that
Ξ◦c∼
= Ξ.
E
(Here c acts on E and so gives a C-morphism from RSQ
(G) × C to itself.)
Under the isomorphism

∼
(RSE
Q G) × C = (G × C) ×C (G × C)
we see that Ξ corresponds to ξ ⊗ξ for some algebraic representation ξ of G over
C, i.e. Ξ = ξE . Using τ0 to view C as an E-algebra we get an identification
G(C) ∼
= C× × GLn (F∞ )
and hence an embedding
× 2
) → G(C)
i : (E∞

208

which sends (x1 , x2 ) to (τ0 (x1 ), x2 ). Embedding G(C) as the first factor of
E
RSQ
(G)(C) ∼
= G(C) × G(C) we can extend i to a homomorphism
× 2
i : (E∞
) → RSE
Q (G)(C).

If instead we identify
×
×
∼
∼
RSE
Q (G)(C) = (E ⊗Q C) × GLn (F ⊗Q C) = (C ⊕ C) × GLn (F∞ ⊕ F∞ )

(using the identifications
∼

((τ0 ⊗ 1) ⊕ ((τ0 ◦ c) ⊗ 1)) : E ⊗Q C → C2
and

∼

2
((1 ⊗ τ0−1 ) ⊕ (1 ⊗ (c ◦ τ0−1 ))) : F ⊗Q C → F∞
)

then
i(x1 , x2 ) = (τ0 (x1 ), 1; x2 , 1).
×
Thus (ξ ◦ i)(x1 , x2 ) = τ0 (x1 /x2 )a . If x ∈ E∞
⊂ G(R) ⊂ G(C) then we can
c
identify x ∈ G(C) with i(xx , x). Thus ξ(x) = τ0 (xc )a , i.e.
−1
c
ξ|E
× = ψ∞ .
∞

Recall the exact sequence.
1−c

1+c

×
×
×
×
(0) −→ Q× \A× −→ E × \A×
E −→ E \AE −→ Q \A −→ Gal (E/Q) −→ (0).
× 1+c
Note that ψΠ−1 = ψΠc and so ψΠ is trivial on (AE
) . From the formulae at
the start of this proof we see that ψΠ∞ (−1) = 1. But from the exact sequence
1+c ×
we see that A× = Q× (A×
R , and so we deduce that
E)

ψΠ |A× = 1.
Again from the above exact sequence we see that
ψΠ = ψ ◦ (c − 1)
c−1
for some character ψ of (A×
/{±1}. Again from the explicit formulae at
E)
the start of this proof we see that
× c−1 .
× c−1 = ψ∞ |
ψ |(E∞
(E∞
)
)

×
Thus we can choose a character ψ of A×
E /E such that

209

• ψ|(A× )c−1 = ψ ,
E

× = ψ∞ ,
• ψ|E∞

• and ψ|O× = 1.
E,u

Then ψΠ |A× = ψ ◦ (c − 1).
E
Finally because ξE∨ and Π∞ have the same infinitesimal character we see
by theorems 6.1 and 7.1 of [En] that Π∞ is cohomological for ξE . ✷

VII

Appendix: The trace formula.

In this appendix we will give an expression for the trace of an element ϕ ∈
Cc∞ (G(A∞ )) on H(X, Lξ ). For simplicity we will derive this as a simple specialisation of the main result of [Arth], which relies on arthur’s trace formula.
However in our case this expression can be derived in a more elementary fashion by using the Lefschetz trace formula (cf [KS] or [Bew]). We will also give
some applications of this expression.
More precisely in this appendix we will prove the following result.
Proposition VII.1 Suppose that ϕ ∈ Cc∞ (G(A∞ ). Then
tr (ϕ|H(X, Lξ )) = (−1)n nκB γ (−1)n/[F (γ):F ]
G(A∞ )
[F (γ) : F ]−1 vol (ZG (γ)(R)10 )−1 Oγ
(ϕ)tr ξ(γ),
unless F + = Q and n = 2 in which case we drop the factors [F (γ) : F ]−1 .
Here
• γ runs over a set of representatives of G(A)-conjugacy classes in G(Q)
which are elliptic in G(R);
• κB = 2 if [B : Q]/2 is odd and κB = 1 otherwise;
• ZG (γ)(R)0 denotes the compact mod centre inner form of ZG (γ)(R) and
ZG (γ)(R)10 the kernel of
×
;
|ν| : ZG (γ)0 −→ R>0

• and we use measures on ZG (γ)(R)10 and ZG (γ)(A∞ ) compatible with
– Tamagawa measure on ZG (γ)(A),
210

– the decomposition
ZG (γ)(A) = ZG (γ)(A∞ ) × ZG (γ)(R),
– association of measures on ZG (γ)(R)0 and ZG (γ)(R),
– and the measure dt/t on R×
>0 .
Proof: By the discussion prior to lemma 4.1, by theorem 6.1 of [Arth] and
by remark 3 following that theorem we see that
tr (ϕ|H(X, Lξ )) = (−1)n δB # ker1 (Q, G) γ (−1)n/[F (γ):F ] (n/[F (γ) : F ])
∞
×
−1 G(A )
vol (ZG (γ)(Q)R×
(ϕ)tr ξ(γ),
>0 \ZG (γ)(A))vol (R>0 \ZG (γ)(R)0 ) Oγ
where
• the sum runs over a set of representatives of G(Q)-conjugacy classes in
G(Q);
• δB = 2 if F + = Q and n = 2 and δB = 1 otherwise;
• and we use associated measures on ZG (γ)(R) and ZG (γ)(R)0 .
(Note that in the notation of [Arth] we have
• δB = [KR : KR0 ],
• q(Mγ ) = n/[F (γ) : F ] − 1,
• |D(Mγ , B)| = n/[F (γ) : F ], unless n = 2 and F + = Q in which case
|D(Mγ , B)| = 1,
• |iG (γ)| = 1,
• ΦG (γ, ξ) = tr ξ(γ),
G(A∞ )

• and HG (γ) = Oγ

(ϕ).)

Note that
×
−1
=
vol (ZG (γ)(Q)R×
>0 \ZG (γ)(A))vol (R>0 \ZG (γ)(R)0 )
1
1 −1
vol (ZG (γ)(Q)\ZG (γ)(A) )vol (ZG (γ)(R)0 ) ,

where ZG (γ)(A)1 denotes the elements g ∈ ZG (γ)(A) with |ν(g)| = 1. By the
main theorem of [Ko5] we see that if we use Tamagawa measure then
vol (ZG (γ)(Q)\ZG (γ)(A)1 ) = κB /# ker1 (Q, ZG (γ)).
211

(Using the fact that [B : Q]/2 and [ZB (γ) : Q]/2 have the same parity, a direct
calculation shows that #A(ZG (γ)) = κB .) Moreover the G(A)-conjugacy class
of γ in G(Q) contains
# ker(ker1 (Q, ZG (γ)) −→ ker1 (Q, G))
G(Q)-conjugacy classes. As in the discussion (in the third paragraph) following
lemma 9.2 we see that
# ker(ker1 (Q, ZG (γ)) −→ ker1 (Q, G)) = # ker1 (Q, ZG (γ))/# ker1 (Q, G).
Thus we may rewrite Arthur’s formula to give the formula in the proposition.
✷
We will now draw a few corollaries from this lemma which are standard
facts.
Corollary VII.2 Suppose that S is a finite set of finite places of F such that
• if x ∈ S then Bx is split and x|Q splits in E,
• and if x and y are two elements of S with the same restriction to F +
then x = y.
For x ∈ S let πx0 be a square integrable representation of GLn (Fx ). Also let ξ
be an irreducible representation of G over Qlac . Then we can find an irreducible
admissible representation π of G(A∞ ) such that
• dim[Rξ (π)] = 0,

×
,
• for x ∈ S we have πx ∼
= πx0 ⊗(ψx ◦det) for some character ψx of Fx× /OF,x

• and for x ∈ S we have ψπ |O×

E,x|c
E

= 1.

Proof: We may suppose that for some x ∈ S the representation πx0 is supercuspidal. Let S(Q) denote the set of places of Q below places in S. If
y ∈ S(Q) then it gives rise to a distinguished place y of E above y, i.e. x|E
for any place x ∈ S above y. Decompose
G(A) ∼
= G(AS(Q)∪{∞} ) ×

(Z×
y ×

y∈S(Q)

(Bxop )× ).
x|y

If U ⊂ G(AS(Q)∪{∞} ) is an open compact subgroup, then set
ϕU = char U ×

y∈S(Q)

where
212

char Z×y ×

ϕx ,
x|y

• if x ∈ S then ϕx is the characteristic function of some open compact
subgroup,
• while if x ∈ S then then ϕx is the product of a pseudo-coefficient ϕπx0 for
×
πx0 with the characteristic function of det−1 (OF,x
).
We may and will choose U sufficiently small so that the only element of finite
order in the intersection of G(Q) with the support of ϕU is 1.
Then proposition VII.1 and lemma IV.1 tell us that
vol (G(R)01 )tr (ϕU |H(X, Lξ )) = nκB (dim ξ)

(dim JL −1 (πx0 )),
x∈S

where we use Tamagawa measure on G(A) = G(A∞ ) × G(R) and a measure on
G(R)10 compatible with this, the association of measures on G(R) and G(R)0 ,
the exact sequence
|ν|

(0) −→ G(R)10 −→ G(R)0 −→ R×
>0 −→ (0),
×
and the measure dt/t on R>0
. In particular we see that

(tr π(ϕU ))(dim[Rξ (π)]) = 0,
π

where π runs over irreducible admissible representations of G(A∞ ).
Thus we may choose an irreducible admissible representation π of G(A∞ )
such that both
• dim[Rξ (π)] = 0
• and tr π(ϕU ) = 0.
The first of these conditions implies that for some π∞ the representation π ×
π∞ is automorphic (apply Matsushima’s formula, lemma 4.1). The second
condition implies that
• for y ∈ S(Q) we have ψπ |O×

E,y c

= 1,

• and, for x ∈ S, we have
tr πx (ϕπx0 ⊗(ψx ◦det) ) = 0
×
(see the argument for lemma 10.1).
for some character ψx of Fx× /OF,x

213

Thus for any x in S with πx0 supercuspidal we see that πx ∼
= πx0 ⊗ (ψx ◦ det)
(use lemma IV.4). As we are assuming that some such place x exists it follows
from corollary VI.3 that for all x ∈ S the representation πx is generic and
hence it follows from corollary IV.6 that πx ∼
= πx0 ⊗ (ψx ◦ det) for all x ∈ S.
Thus π is our desired representation of G(A∞ ). ✷
Corollary VII.3 Suppose that L is a CM field which is the composite of a
totally real field L+ and an imaginary quadratic field M . Suppose that S is a
finite set of places of L such that
• if x ∈ S then x|Q splits in E,
• and if x and y are elements of S with the same restriction to L+ then
x = y.
For x ∈ S suppose that Πx0 is a square integrable representation of GLg (Lx ).
Suppose also that Ξ is an algebraic representation of RSLQ (GLg ) over C such
that Ξc ∼
= Ξ∨ (where c acts on RSLQ (GLg ) via its action on L). Then we can
find a cuspidal automorphic representation Π of GLg (AL ) such that
1. Πc ∼
= Π∨ ,
2. Π∞ has the same infinitesimal character as Ξ∨ |GLg (L∞ ) ,
×
3. and for all x ∈ S there is a character ψx of Lx× /OL,x
such that

Πx ∼
= Π0x ⊗ (ψx ◦ det).
Proof: We may assume that for some x ∈ S the representation Π0x is supercuspidal. Choose (E, F, B, ∗, τ0 , β) as in section 1 with E = M , F = L,
[B : F ] = g 2 and Bx split for all x ∈ S. We can choose an algebraic representation ξ of G over C such that ξE |GLn (L∞ ) = Ξ|GLn (L∞ ) . The corollary now
follows from corollary VII.2 and theorem VI.1. ✷
Lemma VII.4 Suppose that s|n is a positive integer. Suppose also that πw0
is an irreducible supercuspidal representation of GLn/s (Fw ). Then we can find
an irreducible admissible representation π ∞ of G(A∞ ) and a character ψw0 of
×
such that
Fw× /OF,w
1. dim[Rξ (π ∞ )] = 0,
2. πw ∼
= (πw0

...

(πw0 ⊗ | det |s−1 )) ⊗ (ψw0 ◦ det),
214

3. πp,0 |Z×p = 1.
Proof: Let S(B) denote the set of places of F at which B is ramified. Note
that if x ∈ S(B) then x|Q splits in E.
As
F
RSQ
(GLn ) × C ∼
= (GLn × C)Hom (F,C) ,

we may choose a maximal torus T ∼
= (GLn1 × C)Hom (F,C) and a Borel subgroup
B ⊃ T consisting of upper triangular matrices in (GLn × C)Hom (F,C) . Then we
can identify
X ∗ (T ) ∼
= (Zn )Hom (F,C)
in such a way that the set of B-positive weights, X ∗ (T )+ , consists of vectors
(xτ,i ) with xτ,i ≥ xτ,j whenever i ≤ j. We will let ρ ∈ X ∗ (T )+ denote half the
sum of the positive roots, i.e.
ρτ,i = (n + 1)/2 − i.
If Ξ is an irreducible algebraic representation of RSFQ (GLn ) over C we will let
x(Ξ) ∈ X ∗ (T )+ denote its heighest weight. Note that Ξc ∼
= Ξ∨ (where c acts
F
on RSQ (GLn ) via its action on F ) if and only if
x(Ξ)τ,i + x(Ξ)cτ,n+1−i = 0
for all τ ∈ Hom (F, C) and all i = 1, ..., n. We will use exactly similar notation
F
for RSQ
(GLn/s ).
Choose an irreducible algebraic representation Ξ of RSFQ (GLn/s ) over C
such that
• (Ξ )∨ ∼
= (Ξ )c
• and x(Ξ )τ,i+1 ≥ x(Ξ )τ,i + (s − 1) for all τ ∈ Hom (F, C) and all i =
1, ..., n − 1.
By corollary VII.3 we may choose a cuspidal automorphic representation Π
of GLn/s (AF ) such that
• (Π )∨ ∼
= (Π )c ,
• Π∞ has the same infinitesimal character as (Ξ )∨ ,
• Πx is supercuspidal for all x ∈ S(B),
×
• Πw ∼
.
= πw0 ⊗ (ψw1 ◦ det) for some character ψw1 of Fw× /OF,w

215

×
Also choose a character φ of A×
such that
F /F

• φ−1 = φc ;
• for every τ : F → C defining a place y of F we have
φy : z −→ (τ (z)/|τ (z)|)δτ ,
where δτ = 0 if either s or n/s is odd, while δτ = ±1 if both both s and
n/s are even;
• and φw is unramified.
(The existence of such a character φ is proved exactly as in the proof of corollary 12.9.) Note that Π∞ ⊗ φ∞ has infinitesimal character parametrised by
x ∈ X ∗ (T ), where
xτ,i = (n/s + 1)/2 − i − xτ,n/s+1−i + δτ /2.
According to the main theorem of [MW] there is an irreducible automorphic
representation Π of GLn (AF ) which occurs in the discrete spectrum and which
is a subquotient of
GL (A )

n-Ind Q(AnF ) F (Π ⊗ φ ⊗ | det |(1−s)/2 ) × ... × (Π ⊗ φ ⊗ | det |(s−1)/2 ),
s
. Morewhere Q ⊂ GLn is a parabolic subgroup with Levi component GLn/s
over we have the following properties.

1. Π∨ = Πc (by the strong multiplicity one theorem).
2. Π∞ has the same infinitesimal character as the algebraic representation
Ξ of RSFQ (GLn ) over C with
x(Ξ)τ,(I−1)s+J = 1/2(s − 1)(2I − 1 − n/s) + x(Ξ )τ,I − δτ /2,
for I = 1, ..., n/s and J = 1, ..., s. (Note that by our assumptions on
δτ and x(Ξ ) we do have x(Ξ) ∈ X ∗ (T )+ and so Ξ∨ has infinitesimal
character with parameter x ∈ X ∗ (T ) given by
xτ,(I−1)s+J =
(n + 1)/2 − (I − 1)S − J − 1/2(s − 1)(2(n/s + 1 − I) − 1 − n/s)−
x(Ξ )τ,n/s+1−I + δτ /2 =
(n/s + 1)/2 − I + (s + 1)/2 − J − x(Ξ )τ,n/s+1−I + δτ /2,
216

for I = 1, ..., n/s and J = 1, ..., s. This x ∈ X ∗ (T ) also parametrises the
infinitesimal character of any subquotient of
GL (F )

n-Ind Q(Fn∞ )∞ (Π∞ ⊗ φ∞ ⊗ | det |(1−s)/2 ) × ... × (Π∞ ⊗ φ∞ ⊗ | det |(s−1)/2 ).)
3. For each x ∈ S(B), Πx ∼
= (πx0 ... (πx0 ⊗ | det |s−1 )), for some supercus0
pidal representation πx of GLn/s (Fx ) (see [MW] and proposition 2.10 of
[Z]).
4. Πw ∼
= (πw0 ... (πw0 ⊗ | det |s−1 )) ⊗ (ψw0 ◦ det), for some character ψw0 of
×
Fw× /OF,w
(see [MW] and proposition 2.10 of [Z]).
Applying theorem V.1, lemma VI.6, theorem VI.4 and corollary VI.5 we
see that there is an irreducible automorphic representation π of G(A) such
that
• BC (π) = (ψ, JL −1 (Π)) (for some character ψ)
• and dim[Rξ (π ∞ )] = 0.
Then π ∞ is our desired representation of G(A∞ ). ✷

References
[AC]

J.Arthur and L.Clozel, Simple algebras, base change and the advanced
theory of the trace formula, Annals of Math. Studies 120, PUP 1989.

[Arth] J.Arthur, The L2 -Lefschetz numbers of Hecke operators, Invent. Math.
97 (1981), 257-290.
[Arti] M.Artin, Th´eor`emes de repr´esentabilit´e pour les espaces alg´ebriques,
Presses de l’Universit´e de Montr´eal 1973.
[BBM] P.Berthelot, L.Breen and W.Messing, Th´eorie de Dieudonn´e cristalline
II, LNM 930, Springer 1982.
´
[Berk1] V.G.Berkovich, Etale
cohomology for non-Archimedean analytic
spaces, Pub. Math. IHES 78 (1993), 5-161.
[Berk2] V.G.Berkovich, Vanishing cycles for formal schemes, Invent. Math.
115 (1994), 539-571.

217

[Berk3] V.G.Berkovich, Vanishing cycles for formal schemes II, Invent. Math.
125 (1996), 367-390.
[Berk4] V.G.Berkovich, appendix to this preprint.
[Bern] J.-N.Bernstein, Le “centre” de Bernstein (r´edig´e par P.Deligne), in J.N.Bernstein, P.Deligne, D.Kazhdan, M.-F.Vigneras “Repr´esentations
des groupes r´eductifs sur un corps local”, Hermann 1984.
[Bew] J.Bewersdorff, Eine Lefschetzsche Fixpunktformel fur Hecke Operatoren, Bonner Math. Schriften 164.
[BHK] C.J.Bushnell, G.Henniart and P.C.Kutzko, Correspondance de Langlands locale pour GLn et conducteurs de paires, Ann. Sci. E.N.S. 31
(1998), 537-560.
[BM]

P.Berthelot and W.Messing, Th´eorie de Dieudonn´e cristalline III.
Th´eor`emes d’´equivalence et de pleine fid´elit´e., in “The Grothendieck
Festschrift I”, Progress in Mathematics 86, Birkhauser, 1990.

[Bo]

P.Boyer, Mauvaise reduction des varieties de Drinfeld, to appear in
Invent. Math.

[BR]

D.Blasius and D.Ramakrishnan, Maass forms and Galois representations, in “Galois groups over Q”, eds. Y.Ihara, K.Ribet and J.-P.Serre,
Springer 1989.

[Bry]

J.Brylinski, Un lemme sur les cycles ´evanescents en dimension relative
1, Ann. Sci. ENS 19 (1986), 460-467.

[BW]

A.Borel and N.Wallach, Continuous cohomology, discrete subgroups,
and representations of reductive groups, Princeton U.P. 1980.

[BZ]

I.N.Bernstein and A.V.Zelevinsky, Induced representations of reductive
p-adic groups I, Ann. Sci. ENS (4) 10 (1977), 441-472.

[Car1] H.Carayol, Sur la mauvaise r´eduction des courbes de Shimura, Comp.
Math. 59 (1986), 151-230.
[Car2] H.Carayol, Sur les repr´esentations l-adiques associ´ees aux formes modulaires de Hilbert, Ann. Sci. ENS 19 (1986), 409-467.
[Car3] H.Carayol, Non-abelian Lubin-Tate theory, in L.Clozel and J.S.Milne
“Automorphic forms, Shimura varieties and L-functions II”, Academic
Press 1990.
218

[Cas]

W.Casselman, Characters and Jacquet modules, Math. Ann. 230
(1977), 101-105.

[Cl1]

L.Clozel, Repr´esentations Galoisiennes associ´ees aux representations
automorphes autoduales de GL(n), Pub. Math. IHES 73 (1991), 97145.

[Cl2]

L.Clozel, On the cohomology of Kottwitz’s arithmetic varieties, Duke
Math. J. 72 (1993), 757-795.

[CL]

L.Clozel
and
J.-P.Labesse,
Changement
de base pour les repr´esentations cohomologiques des certaines groupes
unitaires, appendix to [Lab].

[De1]

P.Deligne, Travaux de Shimura, Seminaire Bourbaki in LNM 244,
Springer 1971.

[De2]

P.Deligne, letter to Piatetski-Shapiro (1973).

[DKV] P.Deligne, D.Kazhdan, and M.-F.Vigneras, Repr´esentations des
alg`ebres centrales simples p-adiques, in J.-N.Bernstein, P.Deligne,
D.Kazhdan, M.-F.Vigneras “Repr´esentations des groupes r´eductifs sur
un corps local”, Hermann 1984.
[Dr]

V.G.Drinfeld, Elliptic modules, Math. USSR Sbornik 23 (1974), 561592.

[EGAI] A.Grothendieck and J.Dieudonn´e, El´ements de g´eom´etrie alg´ebriques
I: le langage des sch´emas, Publ. Math. IHES 4 (1960).
[El]

R.Elkik, Solutions d’´equations `a coefficients dans un anneau hens´elian,
Ann. Sci. ENS 6 (1973), 553-604.

[En]

T.J.Enright, Relative Lie algebra cohomology and unitary representations of complex Lie groups, Duke Math. J. 46 (1979), 513-525.

[Fu]

K.Fujiwara, Rigid geometry, Lefschetz-Verdier trace formula and
Deligne’s conjecture, Invent. Math. 127 (1997), 489-533.

[FK]

´
E.Freitag and R. Kiehl, Etale
cohomology and the Weil conjecture,
Springer 1988.

[Har1] M.Harris, Supercuspidal representations in the cohomology of Drinfel’d
upper half spaces: elaboration of Carayol’s program, Invent. Math. 129
(1997), 75-120.
219

[Har2] M.Harris, The local Langlands conjecture for GL(n) over a p-adic field,
n < p, Invent. Math. 134 (1998), 177-210.
[Has]

H.Hasse, Die Normenresttheorie relativ-Abelscher Zahlkorper als
Klassenkorpertheorie im Kleinen, J. reine agnew. Math. 162 (1930)
145-154.

[HC]

Harish-Chandra, Admissible invariant distributions on reductive p-adic
groups, Queen’s Papers in Pure and Applied Math. 48 (1978), 281-347.

[He1]

G.Henniart, La conjecture de Langlands locale pour GL(3), M´emoires
S.M.F. 11/12 (1984).

[He2]

G.Henniart, Le point sur la conjecture de Langlands pour GL(N ) sur
un corps local, in C.Goldstein “S´eminaire de th´eorie des nombres de
Paris, 1983-84” Birkhauser 1985.

[He3]

G.Henniart, On the local Langlands conjecture for GL(n): the cyclic
case, Ann. of Math. 123 (1986), 145-203.

[He4]

G.Henniart, La conjecture de Langlands locale num´erique pour GL(n),
Ann. Sci. E.N.S. (4) 21 (1988), 497-544.

[He5]

G.Henniart, Caract´erisation de la correspondence de Langlands locale
par les facteurs de paires, Invent. Math. 113 (1993), 339-350.

[He6]

G.Henniart, Une preuve simple des conjectures de Langlands pour
GL(n) sur un corps p-adiques, to appear in Invent. Math.

[HH]

G.Henniart and R.Herb, Automorphic induction for GL(n) (over local
nonarchimedean fields, Duke Math. J. 78 (1995), 131-192.

[HS]

H.Hopf and H.Samelson, Ein Satz uber die Wirkungsraume
geschlossener Liescher Gruppen, Comment. Math. Helv. 13 (1941),
240-251.

[I]

L.Illusie, D´eformations de groupes de Barsotti-Tate, d’apr`es
A.Grothendieck , in “S´eminaire sur les pinceaux arithm´etiques: la conjecture de Mordell”, asterisque 127 (1985), 151-198.

[JPSS] H.Jacquet, I.I.Piatetskii-Shapiro and J.Shalika, Rankin-Selberg convolutions, Amer. J. Math. 105 (1983), 367-483.

220

[JS]

H.Jacquet and J.Shalika, The Whittaker models of induced representations, Pacific J. of Math. 109 (1983), 107-120.

[Kat]

N.Katz, Serre-Tate local moduli, in “Surfaces Alg´ebriques” LNM 868,
Springer 1981.

[Ko1]

R.Kottwitz, Stable trace formula: cuspidal tempered terms, Duke
Math. J. 51 (1984), 611-650.

[Ko2]

R.Kottwitz, Stable trace formula: elliptic singular terms, Math. Ann.
275 (1986), 365-399.

[Ko3]

R.Kotwitz, Points on some Shimura varieties over finite fields, Jour.
of the AMS 5 (1992), 373-444.

[Ko4]

R.Kottwitz, On the λ-adic representations associated to some simple
Shimura varieties, Invent. Math. 108 (1992), 653-665.

[Ko5]

R.Kottwitz, Tamagawa Numbers, Annals of Math. 127 (1988), 629-646.

[Ku]

P.Kutzko, The Langlands conjecture for GL(2) of a local field, Ann. of
Math. 112 (1980), 381-412.

[KM]

N.Katz and B.Mazur, Arithmetic moduli of elliptic curves, Princeton
University Press 1985.

[KS]

Kuga and Sampson, , Amer. J. Math. 94 (1972), 486-500.

[Lab]

J.-P.Labesse, Cohomologie, stabilisation et changement de base,
Ast´erisque 257 (1999).

[Lan]

R.P.Langlands, Problems in the theory of automorphic forms, in “Lectures in modern analysis and applications III”, LNM 170, Springer
1970.

[LRS] G.Laumon, M.Rapoport and U.Stuhler, D-elliptic sheaves and the
Langlands correspondence, Invent. Math. 113 (1993), 217-338.
[LT]

J.Lubin and J.Tate, Formal complex multiplication in local fields, Ann.
of Math. 81 (1965), 380-387.

[Me]

W.Messing, The crystals associated to Barsotti-Tate groups: with applications to abelian schemes, LNM 264, Springer 1972.

[Mu1] D.Mumford, Abelian varieties, OUP 1974.
221

[Mu2] D.Mumford, The red book of varieties and schemes, LNM 1358,
Springer 1988.
[MW] C.Moeglin and J.-L.Waldspurger, Le spectre r´esiduel de GL(n), Ann.
Sci. ENS 22 (1989), 605-674.
[O]

F.Oort, Subvarieties of moduli space, Invent. Math. 24 (1974), 95-119.

[P]

R.Pink, On the calculation of local terms in the Lefschetz-Verdier trace
formula and its application to a conjecture of Deligne, Annals of Math.
135 (1992), 483-525.

u k est un corps p-adiques,
[Rod] F.Rodier, Repr´esentations de GL(n, k) o`
Ast´erisque 92-93 (1982), 201-218.
[Rog1] J.Rogawski, An application of the building to orbital integrals, Comp.
Math. 42 (1981), 417-423.
[Rog2] J.Rogawski, Representations of GL(n) and division algebras over a
p-adic field, Duke Math. J. 50 (1983), 161-196.
[Sc]

W.Scharlau, Quadratic and hermitian forms, Springer-Verlag (1985).

[Se]

J.-P.Serre, Cohomologie des groupes discrets in Prospects in Mathematics, Annals of Math. Studies 70 (1971), 77-169.

[Tad]

M.Tadic, Classification of unitary representations in irreducible representations of general linear group (non-archimedean case), Ann. Sci.
E.N.S. 19 (1986), 335-382.

[Tat1] J.Tate, Classes d’isog´enie des vari´et´es ab´eliennes sur un corps fini,
S´eminaire Bourbaki 352, LNM 179, Springer 1971.
[Tat2] J.Tate, Number theoretic background, in A.Borel and W.Casselman
“Automorphic forms, representations and L-functions”, Proc. Symposia in Pure Math. 33 (2), AMS 1979.
[Tay]

R.Taylor, l-adic representations associated to modular forms over
imaginary quadratic fields II, Invent. Math. 116 (1994), 619-643.

[V1]

M.-F.Vigneras, Caract´erisation des int´egrales orbitales sur un groupe
r´eductif p-adique, J. Fac. Sci. Univ. Tokyo 28 (1982), 945-961.

[V2]

M.-F.Vigneras, On the global correspondence between GL(n) and division algebras, lecture notes from IAS, Princeton, 1984.
222

[Z]

A.V.Zelevinsky, Induced representations of reductive p-adic groups II:
on irreducible representations of GL(n), Ann. Sci. E.N.S. (4) 13 (1980),
165-210.

[ZS]

O.Zariski and P.Samuel, Commutative algebra, volume II, Graduate
texts in mathematics 29, Springer 1975.

223

