Advances in Mathematics 228 (2011) 329–433
www.elsevier.com/locate/aim

Kac–Moody groups and cluster algebras
Christof Geiß a , Bernard Leclerc b,∗ , Jan Schröer c
a Instituto de Matemáticas, Universidad Nacional Autónoma de México, Ciudad Universitaria,

04510 México D.F., Mexico
b Bernard Leclerc, LMNO, Université de Caen, CNRS UMR 6139, F-14032 Caen Cedex, France
c Jan Schröer, Mathematisches Institut, Universität Bonn, Endenicher Allee 60, D-53115 Bonn, Germany

Received 22 February 2010; accepted 17 May 2011

Communicated by Andrei Zelevinsky

Abstract
Let Q be a finite quiver without oriented cycles, let Λ be the associated preprojective algebra, let g be
the associated Kac–Moody Lie algebra with Weyl group W , and let n be the positive part of g. For each
Weyl group element w, a subcategory Cw of mod(Λ) was introduced by Buan, Iyama, Reiten and Scott.
It is known that Cw is a Frobenius category and that its stable category C w is a Calabi–Yau category of
dimension two. We show that Cw yields a cluster algebra structure on the coordinate ring C[N (w)] of the
unipotent group N (w) := N ∩ (w−1 N− w). Here N is the pro-unipotent pro-group with Lie algebra the
completion n of n. One can identify C[N (w)] with a subalgebra of U (n)∗gr , the graded dual of the universal
enveloping algebra U (n) of n. Let S ∗ be the dual of Lusztig’s semicanonical basis S of U (n). We show
that all cluster monomials of C[N (w)] belong to S ∗ , and that S ∗ ∩ C[N (w)] is a C-basis of C[N (w)].
Moreover, we show that the cluster algebra obtained from C[N (w)] by formally inverting the generators of
the coefficient ring is isomorphic to the algebra C[N w ] of regular functions on the unipotent cell N w of the
Kac–Moody group with Lie algebra g. We obtain a corresponding dual semicanonical basis of C[N w ]. As
one application we obtain a basis for each acyclic cluster algebra, which contains all cluster monomials in
a natural way.
© 2011 Elsevier Inc. All rights reserved.
MSC: 14M99; 16G20; 17B35; 17B67; 20G05; 81R10
Keywords: Cluster algebra; Kac–Moody group; Quiver; Semicanonical basis; Frobenius category; Preprojective algebra

* Corresponding author.

E-mail addresses: christof@math.unam.mx (C. Geiß), bernard.leclerc@unicaen.fr (B. Leclerc),
schroer@math.uni-bonn.de (J. Schröer).
0001-8708/$ – see front matter © 2011 Elsevier Inc. All rights reserved.
doi:10.1016/j.aim.2011.05.011

330

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Contents
1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2. Definitions and known results . . . . . . . . . . . . . . . . . . . . . . . . . . .
3. Main results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4. Kac–Moody Lie algebras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5. Unipotent groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6. Evaluation functions and generating functions of Euler characteristics
7. Generalized minors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8. The coordinate rings C [N (w)] and C [N w ] . . . . . . . . . . . . . . . . . . .
9. The modules Vk and Mk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10. The add(Mi )-stratification of Cw . . . . . . . . . . . . . . . . . . . . . . . . .
11. Quasi-hereditary algebras associated to reduced expressions . . . . . . .
12. Mutations of clusters via dimension vectors . . . . . . . . . . . . . . . . . .
13. A sequence of mutations from Vi to Ti . . . . . . . . . . . . . . . . . . . . . .
14. Irreducible components associated to Cw . . . . . . . . . . . . . . . . . . . .
15. A dual PBW-basis and a dual semicanonical basis for A(Cw ) . . . . . .
16. Acyclic cluster algebras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17. Coordinate rings of unipotent radicals . . . . . . . . . . . . . . . . . . . . . .
18. Remarks and open problems . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

330
333
346
350
359
360
361
366
370
380
384
389
398
412
418
426
428
430
431
432

1. Introduction
1.1. This is the continuation of an extensive project to obtain a better understanding of the
relations between the following topics:
(i)
(ii)
(iii)
(iv)
(v)
(vi)

Representation theory of quivers.
Representation theory of preprojective algebras.
Lusztig’s (semi)canonical basis of universal enveloping algebras.
Fomin and Zelevinsky’s theory of cluster algebras.
Frobenius categories and 2-Calabi–Yau categories.
Cluster algebra structures on coordinate algebras of unipotent groups, Bruhat cells and flag
varieties.

The topics (i) and (iii) are closely related. The numerous connections have been studied by many
authors. Let us just mention Lusztig’s work on canonical bases of quantum groups, and Ringel’s
Hall algebra approach to quantum groups. An important link between (ii) and (iii), due to Lusztig
[50,51] and Kashiwara and Saito [45] is that the elements of the (semi)canonical basis are naturally parametrized by the irreducible components of the varieties of nilpotent representations of
a preprojective algebra.
Cluster algebras were invented by Fomin and Zelevinsky [9,23,24], with the aim of providing
a new algebraic and combinatorial setting for canonical bases and total positivity. One important
breakthrough was the insight that the class of acyclic cluster algebras with a skew-symmetric exchange matrix can be categorified using the so-called cluster categories. Cluster categories were

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

331

introduced by Buan, Marsh, Reineke, Reiten and Todorov [12], see also [46]. In a series of papers
by some of these authors and also by Caldero and Keller [15,14], it was established that cluster
categories have all necessary properties to provide the mentioned categorification. We refer to
the nice overview article [11] for more details on the development of this beautiful theory which
established a strong connection between the topics (i), (iv) and (v). More recently, a different and
more general type of categorification using representations of quivers with potentials was developed by Derksen, Weyman and Zelevinsky [19,20]. This provides another strong link between
topics (i) and (iv).
In [33] we showed that the representation theory of preprojective algebras Λ of Dynkin type
(i.e. type A, D or E) is also closely related to cluster algebras. We proved that mod(Λ) can be
regarded as a categorification of a natural (upper) cluster structure on the polynomial algebra
C[N ]. Here N is a maximal unipotent subgroup of a complex Lie group of the same type as Λ.
Let n be its Lie algebra, and let U (n) be the universal enveloping algebra of n. The graded dual
U (n)∗gr can be identified with the coordinate algebra C[N ]. By means of our categorification,
we were able to prove that all the cluster monomials of C[N ] belong to the dual of Lusztig’s
semicanonical basis of U (n). Note that the cluster algebra C[N ] is in general not acyclic.
The aim of this article is a vast generalization of these results to the more general setting
of symmetric Kac–Moody groups and their unipotent cells. We also provide additional tools for
studying the associated categories and cluster structures. For many cluster algebras we construct a
basis (called dual semicanonical basis) which contains all cluster monomials in a natural way. In
particular, we obtain such a basis for all acyclic cluster algebras. Also, we construct a dual PBWbasis of the cluster algebras involved. This provides another close link between Lie theory and
the representation theory of preprojective algebras. We show that the coordinate rings C[N (w)]
and C[N w ] are genuine cluster algebras in a natural way, and not just upper cluster algebras in
the sense of [9].
Let us give some more details. We consider preprojective algebras Λ = ΛQ attached to quivers Q which are not necessarily of Dynkin type. These algebras are therefore infinite-dimensional
in general. The category nil(Λ) of all finite-dimensional nilpotent representations of Λ is then
too large to be related to a cluster algebra of finite rank. Moreover, it does not have projective
or injective objects, and it lacks an Auslander–Reiten translation. However, Buan, Iyama, Reiten
and Scott [13] have attached to each element w of the Weyl group W = WQ of Q a subcategory
Cw of nil(Λ). They show that the categories Cw are Frobenius categories and the corresponding
stable categories C w are Calabi–Yau categories of dimension two. (These results were also discovered and proved independently in [36] in the special case when w is an adaptable element
of W .) Each subcategory Cw contains a distinguished maximal rigid Λ-module Vi associated to
each reduced expression i = (ir , . . . , i1 ) of w. (A module X is called rigid if Ext1Λ (X, X) = 0.)
Special attention is given to the algebra Bi := EndΛ (Vi )op , which turns out to be quasihereditary. There is an equivalence between Cw and the category of -filtered Bi -modules. This
allows us to describe mutations of maximal rigid Λ-modules in Cw in terms of the -dimension
vectors of the corresponding Bi -modules.
To the subcategory Cw we associate a cluster algebra A(Cw ) which in general is not acyclic,
and we show that Cw can be seen as a categorification of the cluster algebra A(Cw ). Each of
the modules Vi provides an initial seed of this cluster algebra. (As a very special case, we also
obtain in this way a new categorification of every acyclic cluster algebra with a skew-symmetric
exchange matrix and a certain choice of coefficients.) The proof relies on the fact that the algebra
A(Cw ) has a natural realization as a certain subalgebra of the graded dual U (n)∗gr , where n is
now the positive part of the symmetric Kac–Moody Lie algebra g = n− ⊕ h ⊕ n of the same type

332

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

as Λ. We show that again all the cluster monomials belong to the dual of Lusztig’s semicanonical
basis of U (n).
Next, we prove that A(Cw ) has a simple monomial basis coming from the objects of the
additive closure add(Mi ), where Mi = M1 ⊕ · · · ⊕ Mr is another Λ-module in Cw associated
to a reduced expression i of w. The modules Mk are rigid, but Mi is not rigid, except in some
trivial cases. We call it the dual PBW-basis of A(Cw ), and regard it as a generalization (in the
dual setting) of the bases of U (n) constructed by Ringel in terms of quiver representations,
when g is finite-dimensional [58]. We use this to prove that A(Cw ) is spanned by a subset of
the dual semicanonical basis of U (n)∗gr . Thus, we obtain a natural basis of A(Cw ) containing
all the cluster monomials. We call it the dual semicanonical basis of A(Cw ). We prove that
A(Cw ) is isomorphic to the coordinate ring of the finite-dimensional unipotent subgroup N (w)
of the symmetric Kac–Moody group attached to g. Moreover, we show that the cluster algebra
obtained from A(Cw ) by formally inverting the generators of the coefficient ring is isomorphic to
the algebra of regular functions on the unipotent cell N w of the Kac–Moody group. This solves
Conjecture IV.3.1 of [13].
Note also that in the Dynkin case the unipotent cells N w are closely related to the double
Bruhat cells of type (e, w), whose coordinate ring is known to be an upper cluster algebra by a
result of [9]. However, our proof is different and shows that C[N w ] is not only an upper cluster
algebra but a genuine cluster algebra.
Finally, we explain how the results of this paper are related to those of [37], in which a cluster
algebra structure on the coordinate ring of the unipotent radical NK of a parabolic subgroup of
a complex simple algebraic group of type A, D, E was introduced. We give a proof of Conjecture 9.6 of [37].
1.2. Remark
Our preprint [36] contains special cases of the main results of this article: When w is an
adaptable Weyl group element, we constructed and studied the subcategories Cw independently
of [13], using different methods. For this case, [36] contains a proof of [13, Conjecture IV.3.1].
Since [36] is already cited in several published articles, we decided to keep it on the arXiv as a
convenient reference, but it will not be published in a journal.
1.3. Notation
Throughout let K be an algebraically closed field. For a K-algebra A let mod(A) be the
category of finite-dimensional left A-modules. By a module we always mean a finite-dimensional
left module. Often we do not distinguish between a module and its isomorphism class. Let D :=
HomK (−, K) : mod(A) → mod(Aop ) be the usual duality.
For a quiver Q let rep(Q) be the category of finite-dimensional representations of Q over K.
It is well known that we can identify rep(Q) and mod(KQ).
By a subcategory we always mean a full subcategory. For an A-module M let add(M) be the
subcategory of all A-modules which are isomorphic to finite direct sums of direct summands
of M. A subcategory U of mod(A) is an additive subcategory if any finite direct sum of modules
in U is again in U . By Fac(M) (resp. Sub(M)) we denote the subcategory of all A-modules
X such that there exists some t 1 and some epimorphism M t → X (resp. monomorphism
X → M t ).

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

333

For an A-module M let Σ(M) be the number of isomorphism classes of indecomposable
direct summands of M. An A-module is called basic if it can be written as a direct sum of
pairwise non-isomorphic indecomposable modules.
For an A-module M and a simple A-module S let [M : S] be the Jordan–Hölder multiplicity
of S in a composition series of M. Let dim(M) := dimA (M) := ([M : S])S be the dimension
vector of M, where S runs through all isomorphism classes of simple A-modules.
For a set U we denote its cardinality by |U |. If f : X → Y and g : Y → Z are maps, then the
composition is denoted by gf = g ◦ f : X → Z.
If U is a subset of a K-vector space V , then let SpanK U be the subspace of V generated
by U .
By K(X1 , . . . , Xr ) (resp. K[X1 , . . . , Xr ]) we denote the field of rational functions (resp. the
polynomial ring) in the variables X1 , . . . , Xr with coefficients in K.
Let C be the field of complex numbers, and let N = {0, 1, 2, . . .} be the natural numbers,
including 0. Set N1 := N \ {0}.
Recommended introductions to representation theory of finite-dimensional algebras and
Auslander–Reiten theory are the books [7,2,29,55].
2. Definitions and known results
2.1. Preprojective algebras and nilpotent varieties
Let Q = (Q0 , Q1 , s, t) be a finite quiver without oriented cycles. (As usual, Q0 is the set of
vertices, Q1 is the set of arrows, an arrow a ∈ Q1 starts in a vertex s(a) and terminates in t (a).)
Let
Λ = ΛQ = KQ/(c)
be the associated preprojective algebra. We assume that Q is connected and has vertices Q0 =
{1, . . . , n}. Here K is an algebraically closed field, KQ is the path algebra of the double quiver
Q of Q which is obtained from Q by adding to each arrow a : i → j in Q an arrow a ∗ : j → i
pointing in the opposite direction, and (c) is the ideal generated by the element
a ∗ a − aa ∗ .

c=
a∈Q1

Clearly, the path algebra KQ is a subalgebra of Λ. Let πQ : mod(Λ) → mod(KQ) be the corresponding restriction functor.
A Λ-module M is called nilpotent if a composition series of M contains only the simple
modules S1 , . . . , Sn associated to the vertices of Q. Let nil(Λ) be the abelian category of finitedimensional nilpotent Λ-modules.
Let d = (d1 , . . . , dn ) ∈ Nn . By
rep(Q, d) =

HomK K ds(a) , K dt (a)
a∈Q1

334

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

we denote the affine space of representations of Q with dimension vector d. Furthermore, let
mod(Λ, d) be the affine variety of elements
HomK K ds(a) , K dt (a) × HomK K dt (a) , K ds(a)

(fa , fa ∗ )a∈Q1 ∈
a∈Q1

such that the following holds:
(i) For all i ∈ Q0 we have
fa ∗ fa =
a∈Q1 :s(a)=i

fa fa ∗ .
a∈Q1 :t (a)=i

By Λd we denote the variety of all (fa , fa ∗ )a∈Q1 ∈ mod(Λ, d) such that the following condition
holds:
(ii) There exists some N such that for each path a1 a2 · · · aN of length N in the double quiver Q
of Q we have fa1 fa2 · · · faN = 0.
(It is not difficult to check that Λd is indeed an affine variety, namely for a fixed d we can choose
N = d1 + · · · + dn in condition (ii) above.) If Q is a Dynkin quiver, then (ii) follows already from
condition (i). One can regard (ii) as a nilpotency condition, which explains why the varieties Λd
are often called nilpotent varieties. Note that rep(Q, d) can be considered as a subvariety of Λd .
In fact rep(Q, d) forms an irreducible component of Λd . Lusztig [50, Section 12] proved that all
irreducible components of Λd have the same dimension, namely
dim rep(Q, d) =

ds(a) dt (a) .
a∈Q1

One can interpret Λd as the variety of nilpotent Λ-modules with dimension vector d. The group
n

GLd =

GLdi (K)
i=1

acts on mod(Λ, d), Λd and rep(Q, d) by conjugation. Namely, for g = (g1 , . . . , gn ) ∈ GLd and
x = (fa , fa ∗ )a∈Q1 ∈ mod(Λ, d) define
−1
, gs(a) fa ∗ gt−1
g.x := gt (a) fa gs(a)
(a)

a∈Q1

.

The action on Λd and rep(Q, d) is obtained via restriction. The isomorphism classes of Λmodules in mod(Λ, d) and Λd , and KQ-modules in rep(Q, d), respectively, correspond to the
orbits of these actions. For a module M in mod(Λ, d), (resp. in Λd or in rep(Q, d)), let GLd .M
denote its GLd -orbit.
There is a bilinear form −, − = −, − Q : Zn × Zn → Z associated to Q defined by
d, e := d, e

Q

:=

di ei −
i∈Q0

ds(a) et (a) .
a∈Q1

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

335

The dimension vector of a KQ-module M is denoted by dim(M) = dimQ (M). (Note that
dimQ (M) = dimΛ (M), since we can consider M also as a Λ-module.) For KQ-modules M
and N set
M, N := M, N

Q

:= dim HomKQ (M, N ) − dim Ext1KQ (M, N ).

It is known that M, N = dim(M), dim(N ) . Let (−, −) = (−, −)Q : Zn × Zn → Z be the
symmetrization of the bilinear form −, − , i.e. (d, e) := d, e + e, d . For Λ-modules X and
Y set
(X, Y )Q := πQ (X), πQ (Y ) Q + πQ (Y ), πQ (X) Q .
Lemma 2.1. (See [17, Lemma 1].) For any Λ-modules X and Y we have
dim Ext1Λ (X, Y ) = dim HomΛ (X, Y ) + dim HomΛ (Y, X) − (X, Y )Q .
In particular, dim Ext1Λ (X, X) is even, and dim Ext1Λ (X, Y ) = dim Ext1Λ (Y, X).
Corollary 2.2. For a nilpotent Λ-module X with dimension vector d the following are equivalent:
• The closure GLd .X of GLd .X is an irreducible component of Λd ;
• The orbit GLd .X is open in Λd ;
• Ext1Λ (X, X) = 0.
2.2. Semicanonical bases
We recall the definition of the dual semicanonical basis and its multiplicative properties, following [50,51,31,35]. From now on, assume that K = C.
For each dimension vector d = (d1 , . . . , dn ) we defined the affine variety Λd . A subset C
of Λd is said to be constructible if it is a finite union of locally closed subsets. For a C-vector
space V , a function
f : Λd → V
is constructible if the image f (Λd ) is finite and f −1 (m) is a constructible subset of Λd for all
m∈V.
The set of constructible functions Λd → C is denoted by M(Λd ). This is a C-vector space.
Recall that the group GLd acts on Λd by conjugation. By M(Λd )GLd we denote the subspace of
M(Λd ) consisting of the constructible functions which are constant on the GLd -orbits in Λd . Set
M :=

M(Λd )GLd .
d∈Nn

For f ∈ M(Λd )GLd , f ∈ M(Λd )GLd and d = d + d we define a constructible function
f := f

f : Λd → C

336

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

in M(Λd )GLd by
mχc U ⊆ X f (U )f (X/U ) = m

f (X) :=
m∈C

for all X ∈ Λd , where U runs over the points of the Grassmannian of all submodules of X with
dim(U ) = d . Here, for a constructible subset V of a complex variety we denote by χc (V ) its
(topological) Euler characteristic with respect to cohomology with compact support. This turns
M into an associative C-algebra.
Remark 2.3. Note that the product defined here is opposite to the convolution product we have
used in [31,32,35]. This new convention turns out to be better adapted to our choice of categorifying C[N(w)] and C[N w ] by categories closed under factor modules. It is also compatible with
our choice in [37] of categorifying coordinate rings of partial flag varieties by categories closed
under submodules.
For the canonical basis vector ei := dim(Si ) we know that Λei is just a point, which (as a
Λ-module) is isomorphic to the simple module Si . Define 1i : Λei → C by 1i (Si ) := 1. By M
we denote the subalgebra of M generated by the functions 1i where 1 i n. Set Md :=
M ∩ M(Λd )GLd . It follows that
M=

Md
d∈Nn

is an Nn -graded C-algebra. Let U (n) be the enveloping algebra of the positive part n of the
Kac–Moody Lie algebra g associated to Q, see Sections 4.1 and 4.2.
Theorem 2.4. (See Lusztig [51].) There is an isomorphism of Nn -graded C-algebras
U (n) → M
defined by Ei → 1i for 1

i

n.

Let Irr(Λd ) be the set of irreducible components of Λd .
Theorem 2.5. (See Lusztig [51].) For each Z ∈ Irr(Λd ) there is a unique fZ : Λd → C in Md
such that fZ takes value 1 on some dense open subset of Z and value 0 on some dense open
subset of any other irreducible component Z of Λd . Furthermore, the set
S := fZ Z ∈ Irr(Λd ), d ∈ Nn
is a C-basis of M.
The basis S is called the semicanonical basis of M. By Theorem 2.4 we just identify M and
U (n) and consider S also as a basis of U (n). Since U (n) is a cocommutative Hopf algebra, its
graded dual
U (n)∗gr =

Ud∗
d∈Nn

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

337

is a commutative C-algebra. Let M∗d be the dual space of Md , and set
M∗ :=

M∗d .
d∈Nn

Again we identify M∗ and U (n)∗gr .
For X ∈ Λd define an evaluation function
δX : M d → C
by δX (f ) := f (X).
It is not difficult to show that the map X → δX from Λd to M∗d is constructible in the above
sense. So on every irreducible component Z ∈ Irr(Λd ) there is a Zariski open set on which this
map is constant. Define ρZ := δX for any X in this open set. The C-vector space M∗d is spanned
by the functions δX with X ∈ Λd . Then by construction
S ∗ := ρZ Z ∈ Irr(Λd ), d ∈ Nn
is the basis of M∗ ≡ U (n)∗gr dual to Lusztig’s semicanonical basis S of U (n).
In case X is a rigid Λ-module, the orbit of X in Λd is open, its closure is an irreducible
component Z, and δX = ρZ belongs to S ∗ .
For a module X ∈ Λd and an m-tuple i = (i1 , . . . , im ) with 1 ij n for all j , let Fi,X denote
the projective variety of composition series of type i of X. Thus an element in Fi,X is a flag
(0 = X0 ⊂ X1 ⊂ · · · ⊂ Xm = X)
of submodules Xj of X such that for all 1 j m the subfactor Xj /Xj −1 is isomorphic to the
simple Λ-module Sij associated to the vertex ij of Q. Let
di : Λ d → C
be the map which sends X ∈ Λd to χc (Fi,X ). It follows from the definition of that di = 1i1
· · · 1im . The C-vector space Md is spanned by the maps di . We have δX (di ) = χc (Fi,X ).
Theorem 2.6. (See [31].) For X, Y ∈ nil(Λ) we have δX δY = δX⊕Y .
In [35] a more complicated formula than the one in Theorem 2.6 is given, expressing δX δY as
a linear combination of δZ where Z runs over all possible middle terms of non-split short exact
sequences with end terms X and Y . The formula is especially useful when dim Ext1Λ (X, Y ) = 1.
In this case, the following hold:
Theorem 2.7. (See [35, Theorem 2].) Let X, Y ∈ nil(Λ). If dim Ext1Λ (X, Y ) = 1 with
0 → X → E → Y → 0 and 0 → Y → E → X → 0
the corresponding non-split short exact sequences, then
δX δ Y = δE + δ E .

338

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

2.3. Frobenius categories
Let A be a K-algebra. Let C be a subcategory of a module category mod(A) which is closed
under extensions. Clearly, we have
Ext1C (X, Y ) = Ext1A (X, Y )
for all modules X and Y in C. An A-module C in C is called C-projective (resp. C-injective)
if Ext1A (C, X) = 0 (resp. Ext1A (X, C) = 0) for all X ∈ C. If C is C-projective and C-injective,
then C is also called C-projective–injective. We say that C has enough projectives (resp. enough
injectives) if for each X ∈ C there exists a short exact sequence 0 → Y → C → X → 0 (resp.
0 → X → C → Y → 0) where C is C-projective (resp. C-injective) and Y ∈ C. If C has enough
projectives and enough injectives, and if these coincide (i.e. an object is C-projective if and only
if it is C-injective), then C is called a Frobenius subcategory of mod(A). In particular, C is a
Frobenius category in the sense of Happel [38]. Of course, for A = Λ, an A-module C in C is
C-projective if and only if it is C-injective, see Lemma 2.1.
By definition the objects in the stable category C are the same as the objects in C, and the morphism spaces HomC (X, Y ) are the morphism spaces in C modulo morphisms factoring through
C-projective–injective objects. The category C is a triangulated category in a natural way [38],
where the shift is given by the relative inverse syzygy functor
Ω −1 : C → C.
For all X and Y in C there is a functorial isomorphism
HomC X, Ω −1 (Y ) ∼
= Ext1C (X, Y ).
The category C is a 2-Calabi–Yau category, if for all X, Y ∈ C there is a functorial isomorphism
Ext1C (X, Y ) ∼
= D Ext1C (Y, X).
2.4. Frobenius categories associated to Weyl group elements
By Iˆ1 , . . . , Iˆn we denote the indecomposable injective Λ-modules with socle S1 , . . . , Sn ,
respectively. Here S1 , . . . , Sn are the 1-dimensional simple Λ-modules corresponding to the vertices of the quiver Q. (The modules Iˆi are infinite-dimensional if Q is not a Dynkin quiver.)
For a Λ-module X and a simple module Sj let soc(j ) (X) := socSj (X) be the sum of all submodules U of X with U ∼
= Sj . (In this definition, we do not assume that X is finite-dimensional.)
For a sequence (j1 , . . . , jt ) of indices with 1 jp n for all p, there is a unique chain
0 = X0 ⊆ X1 ⊆ · · · ⊆ Xt ⊆ X
of submodules of X such that Xp /Xp−1 = soc(jp ) (X/Xp−1 ). Define soc(j1 ,...,jt ) (X) := Xt .
For the rest of this section, let i = (ir , . . . , i1 ) be a reduced expression of an element w of the
Weyl group W = WQ of Q. (By definition, this is the Weyl group of the Kac–Moody Lie algebra
g associated to Q, see Section 4.1.) For 1 k r let
Vk := Vi,k := soc(ik ,...,i1 ) (Iˆik ),

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

339

and set Vi := V1 ⊕ · · · ⊕ Vr . (The module Vi is dual to the cluster-tilting object constructed in
[13, Section III.2].) Define
Ci := Fac(Vi ) ⊆ nil(Λ).
For 1

n let kj := max{1

j

k

r | ik = j }. Define Ii,j := Vi,kj and set
Ii := Ii,1 ⊕ · · · ⊕ Ii,n .

The category Ci and the module Ii depend only on w, and not on the chosen reduced expression
i of w. Therefore, we define
Cw := Ci

and Iw := Ii .

(If Q is a Dynkin quiver, and w = w0 is the longest Weyl group element, then Cw = nil(Λ) =
mod(Λ).) Without loss of generality, we assume that for each 1 j n there is some 1 k r
with ik = j . Otherwise, we could just replace Q by a quiver with fewer vertices. Note also that
Cw = add(Iw ) if and only if ik = is for all k = s. In this case, most of our theory becomes trivial.
The following three theorems are proved in [13]. They were also obtained independently and
by different methods in [36] in the case when w is adaptable.
Theorem 2.8. For any Weyl group element w the following hold:
(i) Cw is a Frobenius category;
(ii) The stable category C w is a 2-Calabi–Yau category;
(iii) Cw has n indecomposable Cw -projective–injective modules, namely the indecomposable direct summands of Iw ;
(iv) Cw = Fac(Iw ).
We denote the relative inverse syzygy functor of C w by Ωw−1 .
Recall that a Λ-module T is rigid if Ext1Λ (T , T ) = 0. Let C be a subcategory of mod(Λ), and
let T ∈ C be rigid. Recall that for all X, Y ∈ mod(Λ) we have dim Ext1Λ (X, Y ) = dim Ext1Λ (Y, X).
We need the following definitions:
• T is C-maximal rigid if Ext1Λ (T ⊕ X, X) = 0 with X ∈ C implies X ∈ add(T );
• T is a C-cluster-tilting module if Ext1Λ (T , X) = 0 with X ∈ C implies X ∈ add(T ).
Theorem 2.9. For a rigid Λ-module T in Cw the following are equivalent:
(i) Σ(T ) = length(w);
(ii) T is Cw -maximal rigid;
(iii) T is a Cw -cluster-tilting module.
For 1

k

r let
k − := max{0, 1
k + := min{k + 1

k − 1 | is = ik },

s
s

r, r + 1 | is = ik }.

340

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

For 1 i, j n let qij be the number of edges between the vertices i and j of the underlying
graph of our quiver Q.
Following Berenstein, Fomin and Zelevinsky we define a quiver Γi as follows: The vertices
of Γi are just the numbers 1, . . . , r. For 1 s, t r there are qis ,it arrows from s to t provided
t + s + > t > s. These are called the ordinary arrows of Γi . Furthermore, for each 1 s r
there is an arrow s → s − provided s − > 0. These are the horizontal arrows of Γi .
On the other hand, let A be a K-algebra, and let X = X1n1 ⊕ · · · ⊕ Xtnt be a finite-dimensional
A-module, where the Xi are pairwise non-isomorphic indecomposable modules and ni 1. Let
Si = SXi be the simple EndA (X)op -module corresponding to Xi . Then HomA (X, Xi ) is the indecomposable projective EndA (X)op -module with top Si . The basic facts on the quiver ΓX of
the endomorphism algebra EndA (X)op are collected in [33, Section 3.2]. In particular, we have
a 1-1 correspondence between the vertices of ΓX and the modules X1 , . . . , Xt .
Theorem 2.10. The module Vi is Cw -maximal rigid, and we have ΓVi = Γi .
For example, let Q be a quiver with underlying graph 1
3. Then i := (i7 ,
2
. . . , i1 ) := (3, 1, 2, 3, 1, 2, 1) is a reduced expression of a Weyl group element w ∈ WQ . The
quiver Γi looks as follows:
6

3

1

5

2

7

4

We often try to visualize Λ-modules. For example, let Q be the quiver
1
b

2

a
c

3
and let i := (i6 , . . . , i1 ) := (3, 2, 1, 3, 2, 1). Then the Λ-module Vi = V1 ⊕ · · · ⊕ V6 looks as
follows:
V1 =

V2 =

1

V3 =

1
2

1
2

2
3

1

2
3
1

1

1

V4 =

1
1

V5 =

1
1

2
3

3
1

2

2

1

V6 =

1
2

2
3

1

3
1

2
3

2

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

341

The numbers can be interpreted as basis vectors or as composition factors. For example, the module V5 is a 9-dimensional Λ-module with dimension vector dimΛ (V5 ) = (d1 , d2 , d3 ) = (4, 3, 2).
More precisely, one could display V5 as follows:
1
b

1

2
a

b

c

1

2
c

3

b∗
a∗

a

3

1
c∗

b

2
This picture shows how the different arrows of the quiver Q of Λ act on the 9 basis vectors
of V5 . For example, one can see immediately that the socle of X is isomorphic to S2 , and the top
is isomorphic to S1 ⊕ S1 ⊕ S1 .
2.5. Relative homology for Cw
We recall some notions from relative homology theory which, for Artin algebras, was developed by Auslander and Solberg [4,5].
Let A be a K-algebra, and let X, Y, Z, T ∈ mod(A). Set
FT := HomA (T , −) : mod(A) → mod EndA (T )op .
A short exact sequence
0→Z→Y →X→0
is FT -exact if 0 → FT (Z) → FT (Y ) → FT (X) → 0 is exact. By FT (X, Z) we denote the set of
equivalence classes of FT -exact sequences with end terms X and Z as above.
Let YT be the subcategory of all X ∈ mod(A) such that there exists an exact sequence
f

f

f

f

3
2
1
0
· · · −→
T3 −→
T1 −→
T0 −→
X→0

(1)

where Ti ∈ add(T ) for all i and the short exact sequences
0 → Ker(fi ) → Ti → Im(fi ) → 0
are FT -exact for all i 0. We call sequence (1) an add(T )-resolution of X. We say that (1) has
length at most d if Tj = 0 for all j > d. Note that
add(T ) ⊆ YT .

342

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Dually, one defines add(T )-coresolutions
g

g

g

g

0
1
2
3
T0 −→
T1 −→
T2 −→
···
0 → X −→

where we require now that the sequences
0 → Im(gi ) → Ti → Coker(gi ) → 0
are F T -exact, where F T is the contravariant functor HomA (−, T ).
For X ∈ YT and Z ∈ mod(A) let ExtiFT (X, Z), i 0 be the cohomology groups of the cocomplex obtained by applying the functor HomA (−, Z) to the sequence
f

f

f

3
2
1
T2 −→
T1 −→
T0 .
· · · −→

Lemma 2.11. (See [4].) For X ∈ YT and Z ∈ mod(A) there is a functorial isomorphism
Ext1FT (X, Z) ∼
= FT (X, Z).
Proposition 2.12. (See [5, Proposition 3.7].) For X ∈ YT and Z ∈ mod(A) there is a functorial
isomorphism
ExtiFT (X, Z) → ExtiEndA (T )op HomA (T , X), HomA (T , Z)
for all i

0.

Corollary 2.13. The functor
HomA (T , −) : YT → mod EndA (T )op
is fully faithful. In particular, HomA (T , −) has the following properties:
(i) If X ∈ YT is indecomposable, then HomA (T , X) is indecomposable;
(ii) If HomA (T , X) ∼
= HomA (T , Y ) for some X, Y ∈ YT , then X ∼
= Y.
Note that Corollary 2.13 follows already from [3, Section 3], see also [6, Lemma 1.3 (b)].
Corollary 2.14. Let T ∈ mod(A), and let C be an extension closed subcategory of YT . If
Hom (T ,f )

Hom (T ,g)

ψ : 0 → HomA (T , X) −−−−A−−−→ HomA (T , Y ) −−−−A−−−→ HomA (T , Z) → 0
is a short exact sequence of EndA (T )op -modules with X, Y, Z ∈ C, then
f

g

η:0→X−
→Y −
→Z→0
is a short exact sequence in mod(A).
Now we apply the above ideas to the category Cw . The following proposition is proved in [36]
for adaptable w and in [13] for arbitrary w. In a more general framework it is proved in [47].

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

343

Proposition 2.15. Let T be a Cw -maximal rigid module, and let X ∈ Cw . Then there exists an
add(T )-resolution of the form
0 → T1 → T 0 → X → 0
and an add(T )-coresolution of the form
0 → X → T0 → T1 → 0.
Corollary 2.16. For each Cw -maximal rigid module T we have Cw ⊆ YT .
Corollary 2.17. For each X ∈ Cw the projective dimension of the EndΛ (T )op -module
HomΛ (T , X) is at most one.
Corollary 2.18. (See [40, Theorem 5.3.2].) If T and R are Cw -maximal rigid Λ-modules, then
the EndΛ (T )op -module HomΛ (T , R) is a classical tilting module, and
EndEndΛ (T )op HomΛ (T , R) ∼
= EndΛ (R).
2.6. The cluster algebra A(Cw , T )
We refer to [25] for an excellent survey on cluster algebras. Here we only recall the main
definitions and introduce a cluster algebra A(Cw , T ) associated to a Weyl group element w and
a Cw -maximal rigid Λ-module T .
If B = (bij ) is any r × (r − n)-matrix with integer entries, then the principal part B of B is
obtained from B by deleting the last n rows. Given some 1 k r − n define a new r × (r − n)matrix μk (B) = (bij ) by
bij =

−bij

|bik |bkj + bik |bkj |
bij +
2

if i = k or j = k,
otherwise,

where 1 i r and 1 j r − n. One calls μk (B) a mutation of B. If B is an integer matrix
whose principal part is skew-symmetric, then it is easy to check that μk (B) is also an integer
matrix with skew-symmetric principal part. In this case, Fomin and Zelevinsky define a cluster
algebra A(B) as follows. Let F = C(y1 , . . . , yr ) be the field of rational functions in r commuting
variables y1 , . . . , yr . Define y := (y1 , . . . , yr ). One calls (y, B) the initial seed of A(B). For
1 k r − n define
yk∗ :=

bik
bik >0 yi

+
yk

−bik
bik <0 yi

.

The pair (μk (y), μk (B)), where μk (y) is obtained from y by replacing yk by yk∗ , is the mutation
in direction k of the seed (y, B).
Now one can iterate this process of mutation and obtain inductively a set of seeds. Thus each
seed consists of an r-tuple of algebraically independent elements of F called a cluster and of
a matrix called the exchange matrix. The elements of a cluster are its cluster variables. Given

344

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

a cluster (f1 , . . . , fr ), the monomials f1m1 f2m2 · · · frmr where mk 0 for all k are called cluster
monomials. A seed has r − n neighbours obtained by mutation in direction 1 k r − n. One
does not mutate the last n elements of a cluster, they serve as “coefficients” and belong to every
cluster. The cluster algebra A(B) is by definition the subalgebra of F generated by the set of
all cluster variables appearing in all seeds obtained by iterated mutation starting with the initial
seed.
It is often convenient to define a cluster algebra using an oriented graph, as follows. Let Γ
be a quiver without loops or 2-cycles with vertices {1, . . . , r}. We can define an r × r-matrix
B(Γ ) = (bij ) by setting
bij = (number of arrows j → i in Γ ) − (number of arrows i → j in Γ ).
Let B(Γ )◦ be the r × (r − n)-matrix obtained by deleting the last n columns of B(Γ ). The
principal part of B(Γ )◦ is skew-symmetric, hence this yields a cluster algebra A(B(Γ )◦ ).
We apply this procedure to our subcategory Cw . Let T = T1 ⊕ · · · ⊕ Tr be a basic Cw maximal rigid Λ-module with Tk indecomposable for all k. Without loss of generality assume
that Tr−n+1 , . . . , Tr are Cw -projective–injective. By ΓT we denote the quiver of the endomorphism algebra EndΛ (T )op . We then define the cluster algebra
A(Cw , T ) := A B(ΓT )◦ .
In particular, we denote by A(Cw ) the cluster algebra A(Cw , Vi ) attached to the Cw -maximal rigid
module Vi of Section 2.4. Thus A(Cw ) := A(B(Γi )◦ ). (Up to isomorphism of cluster algebras,
this definition does not depend on the choice of i, see Section 3.1.)
2.7. Mutation of rigid modules
The results of this section are straightforward generalizations of results in [33], see [36, Sections 12, 13, 14] and [13].
Let A be a K-algebra, and M be an A-module. A homomorphism f : X → M in mod(A) is
a left add(M)-approximation of X if M ∈ add(M) and the induced map
HomA (f, M) : HomA M , M → HomA (X, M)
is surjective. A morphism f : V → W is called left minimal if every morphism g : W → W
with gf = f is an isomorphism. Dually, one defines right add(M)-approximations and right
minimal morphisms. Some well known basic properties of approximations can be found in [33,
Section 3.1].
Proposition 2.19. Let T be a basic Cw -maximal rigid Λ-module, and let X be an indecomposable
direct summand of T which is not Cw -projective–injective. Then there are short exact sequences
f

g

0 → X −→ T −→ Y → 0
and

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433
f

345

g

0 → Y −−→ T −→ X → 0
such that the following hold:
(i) f and f are minimal left add(T /X)-approximations, and g and g are minimal right
add(T /X)-approximations;
(ii) Y ⊕ T /X is a basic Cw -maximal rigid Λ-module (in particular Y is indecomposable), and
X Y;
(iii) dim Ext1Λ (Y, X) = dim Ext1Λ (X, Y ) = 1;
(iv) We have add(T ) ∩ add(T ) = 0;
(v) The quiver ΓT of EndΛ (T )op has no loops and no 2-cycles;
(vi) We have
gl.dim EndΛ (T )op =

3 Cw = add(Iw ),
1 Cw = add(Iw ) and n > 1,
0 Cw = add(Iw ) and n = 1.

In the situation of the above proposition, we call {X, Y } an exchange pair associated to T /X,
and we write
μX (T ) = Y ⊕ T /X.
We say that Y ⊕ T /X is the mutation of T in direction X. The short exact sequence
f

g

0 → X −→ T −→ Y → 0
is the exchange sequence starting in X and ending in Y . Thus, we have
μY μX (T ) = T .
Let T = T1 ⊕ · · · ⊕ Tr be a basic Cw -maximal rigid Λ-module with Tk indecomposable for all
k. Without loss of generality we assume that Tr−n+1 , . . . , Tr are Cw -projective–injective. As in
Section 2.6 write B(T ) := B(ΓT ) = (tij )1 i,j r , and let B(T )◦ = (tij ) be the r × (r − n)-matrix
obtained from B(T ) by deleting the last n columns.
For 1 k r − n let
0 → Tk → T → Tk∗ → 0
and
0 → Tk∗ → T → Tk → 0
be exchange sequences associated to the direct summand Tk of T . It follows that
Ti−tik

T =
tik <0

Titik .

and T =
tik >0

346

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Set
T ∗ = μTk (T ) = Tk∗ ⊕ T /Tk .
The quivers of the endomorphism algebras EndΛ (T )op and EndΛ (μTk (T ))op are related via
Fomin and Zelevinsky’s mutation rule:
Theorem 2.20. Let w be a Weyl group element. For a basic Cw -maximal rigid Λ-module T as
above and 1 k r − n we have
B μTk (T )

◦

= μk B(T )◦ .

2.8. Categorification
An (additive) categorification of a cluster algebra A(B) as in Section 2.6 is given by the
following:
(A) A C-linear, hom-finite Frobenius category E with a cluster structure in the sense of [13, II.1]
on the basic E-maximal rigid objects.
(B) A basic E-maximal rigid objects T such that B(ΓT )◦ = B.
(C) A cluster character χ? : obj(E) → C(y1 , . . . , yr ) in the sense of Palu [52, Definition 1.2],
with triangles replaced by short exact sequences.
(D) The cluster character χ? induces a bijection between basic, T -reachable E-maximal rigid
objects and clusters in A(B).
Remark 2.21. (1) Conditions (A)–(C) imply obviously that each cluster monomial in A(B) is of
the form χR for some E -rigid object R. Thus condition (D) is a kind of injectivity requirement
for χ? .
(2) By the results in Section 2.7 we have a cluster structure on Cw . We can take T = Vi , for
which we know ΓVi by Theorem 2.10. By Theorems 2.6 and 2.7 our δ? is a good candidate for a
cluster character. In fact, by Theorems 3.1 and 3.2 below, we know that δX ∈ A(B(ΓVi )◦ ) for all
X ∈ Cw . (By Theorem 3.1 the algebra A(B(ΓVi )◦ ) is (up to isomorphism) a subalgebra of M∗ .)
Property (D) holds in our situation because of the construction of the dual semicanonical basis.
For this reason we call (Cw , Vi ) a categorification of A(B(ΓVi )◦ ).
3. Main results
In this section, let K = C be the field of complex numbers.
3.1. The cluster algebra A(Cw ) as a subalgebra of M∗ ≡ U (n)∗gr
For a reduced expression i = (ir , . . . , i1 ) of a Weyl group element w let T (Cw ) be the graph
with vertices the isomorphism classes of basic Cw -maximal rigid Λ-modules and with edges
given by mutations. Let T = T1 ⊕ · · · ⊕ Tr be a vertex of T (Cw ), and let T (Cw , T ) denote the
connected component of T (Cw ) containing T . Two modules in T (Cw ) are mutation equivalent
if they belong to the same connected component. A Λ-module X is called T -reachable if X ∈
add(R) for some vertex R of T (Cw , T ). Denote by R(Cw , T ) the subalgebra of M∗ generated by

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

347

the δRi (1 i r) where R = R1 ⊕ · · · ⊕ Rr runs over all vertices of T (Cw , T ). The following
theorem is our first main result. The proof is given in Section 15.1.
Theorem 3.1. Let w be a Weyl group element. Then the following hold:
(i) There is a unique isomorphism ι : A(Cw , T ) → R(Cw , T ) such that
ι(yi ) = δTi

(1

i

r).

(ii) If we identify the two algebras A(Cw , T ) and R(Cw , T ) via ι, then the clusters of A(Cw , T )
are identified with the r-tuples δ(R) = (δR1 , . . . , δRr ), where R runs over the vertices of the
graph T (Cw , T ). In particular, {δX | X is T -reachable} is the set of cluster monomials in
R(Cw , T ), and all cluster monomials belong to the dual semicanonical basis S ∗ of M∗ ≡
U (n)∗gr .
The proof of Theorem 3.1 relies on Theorem 2.20 and the multiplication formula in Theorem 2.7.
Write R(Cw ) := R(Cw , Vi ). (The algebra R(Cw ) and its cluster algebra structure do not depend on i, since all Cw -maximal rigid modules of the form Vi are mutation equivalent, see [13,
Proposition III.4.3].) Theorem 3.1 shows that the cluster algebra A(Cw ) is canonically isomorphic to the subalgebra R(Cw ) of U (n)∗gr .
As an application, our theory provides an algorithm which computes the Euler characteristics χc (Fk,R ) for all cluster monomials δR in R(Cw ) and all composition series types
k = (k1 , . . . , ks ), see Section 18.2. This is quite remarkable, since starting from the definitions
this seems to be an impossible task in almost all cases.
3.2. Dual PBW-bases and dual semicanonical bases
Let i = (ir , . . . , i1 ) be a reduced expression of a Weyl group element w. Let Vi = V1 ⊕ · · · ⊕ Vr
be defined as before. For each 1 k r there is a canonical embedding
ιk : Vk − → Vk .
Here we set V0 := 0. Let Mk be the cokernel of ιk , and define
Mi := M1 ⊕ · · · ⊕ Mr .
These modules play an important role in our theory. (In case w is adaptable and i is Qop -adapted,
the module Mi is a terminal KQ-module in the sense of [36].)
In the spirit of Ringel’s construction of PBW-bases for quantum groups [58], we construct
dual PBW-bases for our cluster algebras A(Cw ). The following theorem is our second main
result. The proof will be given in Section 15.
Theorem 3.2. Let i = (ir , . . . , i1 ) be a reduced expression of a Weyl group element w, and let
Mi = M1 ⊕ · · · ⊕ Mr be defined as above.

348

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

(i) The cluster algebra R(Cw ) is a polynomial ring in r variables. More precisely, we have
R(Cw ) = C[δM1 , . . . , δMr ] = SpanC δX | X ∈ Cw .
(ii) The set {δM | M ∈ add(Mi )} is a C-basis of R(Cw ).
(iii) The subset Sw∗ := S ∗ ∩ R(Cw ) of the dual semicanonical basis is a C-basis of R(Cw ) containing all cluster monomials.
Let R(Cw ) be the algebra obtained from R(Cw ) by formally inverting the elements δP for all
Cw -projective–injectives P . In other words, R(Cw ) is the cluster algebra obtained from R(Cw )
by inverting the generators of its coefficient ring. Similarly, let R(Cw ) be the cluster algebra
obtained from R(Cw ) by specializing the elements δP to 1. For both cluster algebras R(Cw ) and
R(Cw ) we get a C-basis which is easily obtained from the dual semicanonical basis Sw∗ and again
contains all cluster monomials, see Sections 15.5 and 15.6.
3.3. The shift functor in C w
As mentioned before, the category C w is a triangulated category with shift functor Ωw−1 . Recall that Vi = V1 ⊕ · · · ⊕ Vr is a basic Cw -maximal rigid module. Set Ti := Iw ⊕ Ωw−1 (Vi ). In
Section 13.1 we construct a sequence of mutations which starts in Vi and ends in Ti . This mutation sequence is crucial for the proof of some of our results. (For example, it helps to show that
the coordinate rings C[N (w)] and C[N w ] are generated by the set of cluster variables.)
Now let R = R1 ⊕ · · · ⊕ Rr be any Cw -maximal rigid Λ-module, which is mutation equivalent
to Vi . Suppose that we know a sequence of mutations starting in Vi and ending in R. Then we
can use the mutation sequence from Vi to Ti to obtain a mutation sequence between R and
Iw ⊕ Ωw−1 (R), and between R and Iw ⊕ Ωw (R), see Section 13.3.
3.4. Unipotent subgroups and cells
Let w be a Weyl group element and put

+
w

:= {α ∈

n(w) =

+

| w(α) < 0}. Let

nα
α∈

+
w

be the corresponding sum of root subspaces of n, see Section 4.3. This is a finite-dimensional
nilpotent Lie algebra. Let N (w) be the corresponding finite-dimensional unipotent group, see
Section 5.2.
The maximal Kac–Moody group attached to g as in [48, Chapter 6] comes with a pair of
subgroups N and N− (denoted by U and U− in [48]). Note that later on for the definition of generalized minors in Section 7 we also have to work with the minimal Kac–Moody group (denoted
by G min in [48, 7.4]). We have
N (w) = N ∩ w −1 N− w .
We also define the unipotent cell
N w := N ∩ (B− wB− )

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

349

where B− is the standard negative Borel subgroup of the Kac–Moody group.
Every Λ-module X in Cw gives rise to a linear form δX ∈ M∗ ≡ U (n)∗gr and by means of the
identification U (n)∗gr ≡ C[N ] to a regular function ϕX on N .
The following theorem, proved in Section 8, is our third main result.
Theorem 3.3. The algebras C[N (w)] and C[N w ] of regular functions on N (w) and N w , respectively, have a cluster algebra structure. For each reduced expression i = (ir , . . . , i1 ) of w,
the tuple ((ϕVi,1 , . . . , ϕVi,r ), B(ΓVi )◦ ) provides an initial seed of these cluster algebra structures.
The functions ϕVi,k ∈ C[N ] can be interpreted as generalized minors. We obtain natural cluster
algebra isomorphisms
C N (w) ∼
= R(Cw )

and C N w ∼
= R(Cw ).

As a result, we have obtained a categorification in the sense of 2.8 of the cluster algebra
structure on C[N(w)] and C[N w ].
3.5. Example
We are going to illustrate some of the previous results on an example. Let Q be a quiver with
underlying graph 1
3
2
4 and let i := (3, 4, 2, 1, 3, 4, 2, 1). This is a reduced
expression of the Weyl group element w := s3 s4 s2 s1 s3 s4 s2 s1 . The category Cw contains 18 indecomposable modules, and 4 of these are Cw -projective–injective. The stable category C w is
triangle equivalent to the cluster category CQ .
The maximal rigid module Vi has 8 indecomposable direct summands, namely
V1 =

V2 =

1

V5 = Ii,1 =

2
1

V3 =

1
2

V6 = Ii,2 =

2
1

V4 =

4

1
2

4
3
2

1

4

V7 = Ii,4 =

3
2

V8 = Ii,3 =

2
3

1

3
2

4

.

3

4

Similarly, Ti has 4 non-Cw -projective–injective indecomposable direct summands, namely
T1 =

2

T2 =

2

4
3

T3 =

1
2
3

T4 =

2
3

.

Here we set Tk := Ωw−1 (Vk ) for 1 k 4.
The group N can be taken to be the group of upper unitriangular 5 × 5 matrices with complex
coefficients. Given two subsets I and J of {1, 2, . . . , 5} with |I | = |J |, we denote by DI J ∈ C[N ]
the regular function mapping an element x ∈ N to its minor DI J (x) with row subset I and
column subset J . We get
ϕV1 = D{1},{2}

ϕV2 = D{12},{23}

ϕV3 = D{1234},{1235}

ϕV4 = D{123},{235}

ϕV5 = D{1},{3}

ϕV6 = D{12},{35}

ϕV7 = D{1234},{2345}

ϕV8 = D{123},{345}

ϕT1 = D{12},{13}

ϕT2 = D{123},{135}

ϕT3 = D{123},{234}

ϕT4 = D{123},{134} .

350

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

The unipotent subgroup N (w) consists of all 5 × 5 matrices of the form
⎡

1 u1
⎢0 1
⎢
⎢0 0
⎣
0 0
0 0

u2
u5
1
0
0

u7
u8
0
1
0

⎤
u4
u6 ⎥
⎥
0⎥
⎦
u3
1

(u1 , . . . , u8 ∈ C).

The unipotent cell N w is a locally closed subset of N defined by the following equations and
inequalities:
N w = x ∈ N D{1},{4} (x) = D{1},{5} (x) = D{12},{45} (x) = 0, D{1},{3} (x) = 0,
D{12},{35} (x) = 0, D{123},{345} (x) = 0, D{1234},{2345} (x) = 0 .
Note that the 4 inequalities are given by the non-vanishing of the 4 regular functions ϕIi,j , 1
j 4 attached to the indecomposable Cw -projective–injective modules. We have
D{1},{4} = ϕ

3

D{1},{5} = ϕ

4

2

D{12},{45} = ϕ

1

2

2

1

1

.

3

3

4
3

2

Our results show that the polynomial algebra C[N (w)] has a cluster algebra structure, of which
(ϕV1 , ϕV2 , ϕV3 , ϕV4 , ϕIi,1 , ϕIi,2 , ϕIi,3 , ϕIi,4 ) is a distinguished cluster. Its coefficient ring is the polynomial ring in the four variables (ϕIi,1 , ϕIi,2 , ϕIi,3 , ϕIi,4 ). The cluster mutations of this algebra
come from mutations of the basic Cw -maximal rigid Λ-modules. Moreover, if we replace the
coefficient ring by the ring of Laurent polynomials in the four variables (ϕIi,1 , ϕIi,2 , ϕIi,3 , ϕIi,4 ),
we obtain the coordinate ring C[N w ].
4. Kac–Moody Lie algebras
From now on, let K = C be the field of complex numbers. In this section we recall known
results on Kac–Moody Lie algebras.
4.1. Kac–Moody Lie algebras
Let Γ = (Γ0 , Γ1 , γ ) be a finite graph (without loops). It has as set of vertices Γ0 , edges Γ1
and γ : Γ1 → P2 (Γ0 ) determining the adjacency of the edges; here P2 (Γ0 ) denotes the set of
two-element subsets of Γ0 . If Γ0 = {1, 2, . . . , n} we can assign to Γ a symmetric generalized
Cartan matrix CΓ = (cij )1 i,j n , which is an n × n-matrix with integer entries
cij :=

2
−|γ −1 ({i, j })|

if i = j ,
if i = j .

Obviously, the assignment Γ → CΓ induces a bijection between isomorphism classes of graphs
with vertex set {1, 2, . . . , n} and symmetric generalized Cartan matrices in Zn×n up to simultaneous permutation of rows and columns.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

351

For a quiver Q = (Q0 , Q1 , s, t) as defined in Section 2.1, its underlying graph |Q| :=
(Q0 , Q1 , q) is given by q(a) = {s(a), t (a)} for all a ∈ Q1 i.e. it is obtained by “forgetting”
the orientation of the edges. We write CQ := C|Q| := (cij )i,j .
Let g := gQ := g(CQ ) be the (symmetric) Kac–Moody Lie algebra (see [43]) associated to
Q, which is defined as follows: Let h be a C-vector space of dimension 2n − rank(CQ ), and
let Π := {α1 , . . . , αn } ⊂ h∗ and Π ∨ := {α1∨ , . . . , αn∨ } ⊂ h be linearly independent subsets of the
vector spaces h∗ and h, respectively, such that
αi αj∨ = cij
for all i, j .
Let h∗ = h∗1 ⊕ h∗2 be a vector space decomposition, where h∗1 is just the subspace with basis
Π , and h∗2 is any direct complement of h∗1 in h∗ . Let (−, −) : h∗ × h∗ → C be the standard
bilinear form, defined by (αj , αj ) := αi (αj∨ ), (αi , x) := (x, αi ) := x(αi∨ ), and (x, y) := 0 for
all x, y ∈ h∗2 and 1 i, j n. Note that αi (αj∨ ) = (dim(Si ), dim(Sj ))Q , where (−, −)Q is the
bilinear form defined in Section 2.1.
Now g = (g, [−, −]) is the Lie algebra over C generated by h and the symbols ei and fi (1
i n) satisfying the following defining relations:
(L1)
(L2)
(L3)
(L4)
(L5)

[h, h ] = 0 for all h, h ∈ h,
[h, ei ] = αi (h)ei , and [h, fi ] = −αi (h)fi ,
[ei , fi ] = αi∨ and [ei , fj ] = 0 for all i = j ,
(ad(ei )1−cij )(ej ) = 0 for all i = j ,
(ad(fi )1−cij )(fj ) = 0 for all i = j .

(For x, y ∈ g and m
1 we set ad(x)(y) := ad(x)1 (y) := [x, y] and ad(x)m+1 (y) :=
m
ad(x) ([x, y]).)
The Lie algebra g is finite-dimensional if and only if Q is a Dynkin quiver. In this case, this
is the usual Serre presentation of the simple Lie algebra associated to Q.
Conversely, if g = g(C) is a Kac–Moody Lie algebra defined by a symmetric generalized
Cartan matrix C, we say that g is of type Γ if C = CΓ . This is well defined for symmetric
Kac–Moody Lie algebras. We call Γ the Dynkin graph of g.
For α ∈ h∗ let
gα := x ∈ g [h, x] = α(h)x for all h ∈ h .
One can show that dim gα < ∞ for all α. By
n

R :=

Zαi
i=1

we denote the root lattice of g. Define R + := Nα1 ⊕ · · · ⊕ Nαn . The roots of g are defined as the
elements in
:= α ∈ R \ {0} gα = 0 .

352

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Set + := ∩ R + and − := ∩ (−R + ). One can show that
= + ∪ − . The elements in + and − are the positive roots and the negative roots, respectively. The elements
in {α1 , . . . , αn } are positive roots of g and are called simple roots.
One has the triangular decomposition g = n− ⊕ h ⊕ n with
n− =

and n =

g−α

gα .

+

α∈

α∈

+

The Lie algebra n is generated by e1 , . . . , en with defining relations (L4). Set nα := gα if α ∈
R + \ {0}.
For 1 i n define an element si in the automorphism group Aut(h∗ ) of h∗ by
si (α) := α − α αi∨ αi
for all α ∈ h∗ . The subgroup W ⊂ Aut(h∗ ) generated by s1 , . . . , sn is the Weyl group of g. The
elements si are called Coxeter generators of W . The identity element of W is denoted by 1. The
length l(w) of some w = 1 in W is the smallest number t 1 such that w = sit · · · si2 si1 for some
1 ij n. In this case (it , . . . , i2 , i1 ) is a reduced expression for w. Let R(w) be the set of all
reduced expressions for w. We set l(1) = 0.
A root α ∈ is a real root if α = w(αi ) for some w ∈ W and some i. It is well known that
+.
dim gα = 1 if α is a real root. By re we denote the set of real roots of g. Define +
re := re ∩
Finally, let us fix a basis { j | 1 j 2n − rank(CQ )} of h∗ such that
j

The

j

αi∨ = δij

1

i

n, 1

2n − rank(CQ ) .

j

are the fundamental weights. We denote by
P := ν ∈ h∗ ν αi∨ ∈ Z for all 1

i

n

i

n .

the integral weight lattice, and we set
P + := ν ∈ P ν αi∨

0 for all 1

The elements in P + are called integral dominant weights. We have
2n−rank(CQ )

n

P=

Z
j =1

j

⊕

C

j

j =n+1

2n−rank(CQ )

n

and P + =

N

j

⊕

j =1

C

j.

j =n+1

Define
n

P :=

Z
j =1

j

and P

+

n

:=

N

j.

j =1

The lattice P can be naturally identified with the weight lattice of the derived subalgebra g :=
[g, g] of g.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

353

4.2. The universal enveloping algebra U (n)
The universal enveloping algebra U (n) of the Lie algebra n is the associative C-algebra defined by generators E1 , . . . , En and relations
1−cij

(1−cij −k)

(k)

(−1)k Ei Ej Ei

=0

k=0

for all i = j , where the cij are the entries of the generalized Cartan matrix CQ , and let
(k)

Ei

:= Eik /k!.

We have a canonical embedding ι : n → U (n) which maps ei to Ei for all 1
n as a subspace of U (n), and we also identify ei and Ei .
Let
J=

i

n. We consider

if dim(n) = ∞,
N1
{1, 2, . . . , d} if dim(n) = d.

Let P := {pi | i ∈ J } be a C-basis of n such that P ∩ nα is a basis of nα for all positive roots α.
We assume that {e1 , . . . , en } ⊂ P. Thus ei is a basis vector of the (1-dimensional) space nαi . For
k 0 define
(k)

pi

:= pik /k!.

(J )

Let N be the set of tuples (mi )i∈J of natural numbers mi such that mi = 0 for all but finitely
(J )
many mi . For m = (mi )i 1 ∈ N define
(m1 ) (m2 )
p2 · · · ps(ms )

pm := p1

where s is chosen such that mj = 0 for all j > s.
Theorem 4.1 (Poincaré–Birkhoff–Witt). The set
P := pm m ∈ N

(J )

is a C-basis of U (n).
The basis P is called a PBW-basis of U (n). For d = (d1 , . . . , dn ) ∈ Nn let Ud be the subspace
of U (n) spanned by the elements of the form ei1 ei2 · · · eim , where for each 1 i n the set
{k | ik = i, 1 k m} contains exactly di elements. It follows that
U (n) =

Ud .
d∈Nn

This turns U (n) into an Nn -graded algebra.

354

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Furthermore, U (n) is a cocommutative Hopf algebra with comultiplication
: U (n) → U (n) ⊗ U (n)
defined by

(x) := 1 ⊗ x + x ⊗ 1 for all x ∈ n. It is easy to check that
(pm ) =

pk ⊗ pm−k ,

(2)

k

where the sum is over all tuples k = (ki )i 1 with 0 ki mi for every i.
By Ud∗ we denote the vector space dual of Ud . Define the graded dual of U (n) by
U (n)∗gr :=

Ud∗ .
d∈Nn

It follows that U (n)∗gr is a commutative associative C-algebra with multiplication defined via the
comultiplication of U (n): For f , f ∈ U (n)∗gr and x ∈ U (n), we have
f ·f

(x) =

f (x(1) )f (x(2) ),
(x)

where (using the Sweedler notation) we write
(x) =

x(1) ⊗ x(2) .
(x)

∗ |m∈N
Let P ∗ := {pm

(J )

} be the dual PBW-basis of U (n)∗gr , where
∗
pm
(pn ) :=

1 if m = n,
0 otherwise.

The element in P ∗ corresponding to pi ∈ P is denoted by pi∗ . It follows from (2) that
∗
∗
pm
· pn∗ = pm+n
,
∗ in P ∗ is equal to a monomial in the p ∗ ’s. Hence, the graded dual U (n)∗
that is, each element pm
gr
i
can be identified with the polynomial algebra C[p1∗ , p2∗ , . . .] (with countably many variables pi∗ ).

4.3. The Lie algebra n(w)
Let
n :=

nα
α∈

+

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

355

be the completion of n. A subset Θ ⊆ + is bracket closed if for all α, β ∈ Θ with α + β ∈
we have α + β ∈ Θ. In this case, we define
n(Θ) :=

+

nα .
α∈Θ

Since Θ is bracket closed, n(Θ) is a Lie subalgebra of n. One calls Θ bracket coclosed if + \ Θ
is bracket closed.
+ | w(α) < 0}. It is well known that for each reduced expression
For w ∈ W set +
w := {α ∈
(ir , . . . , i2 , i1 ) ∈ R(w) we have
+
w

For 1

k

= αi1 , si1 (αi2 ), . . . , si1 si2 · · · sir−1 (αir ) .

r set
βi (k) :=

if k = 1,
otherwise.

αi1
si1 si2 · · · sik−1 (αik )

The set +
w contains l(w) positive roots, all of these are real roots, see for example [48, 1.3.14].
The next lemma is also well known.
+
w

Lemma 4.2. For every w ∈ W , the set
Let n(w) := n(

+)
w

is bracket closed and bracket coclosed.

be the nilpotent Lie algebra associated to w. We have
n(w) =

nα
α∈

+
w

and dim n(w) = l(w).
Again, let i = (ir , . . . , i1 ) be a reduced expression. As in Section 4.2 we choose a C-basis
P = {pj | j ∈ J } such that P ∩ nα is a basis of nα for all positive roots α. The resulting PBW(J )
basis P = {pm | m ∈ N } of U (n) is called i-compatible provided the vector pk belongs to
nβi (k) for all 1 k r. In this case
(m1 ) (m2 )
p2 · · · pr(mr )

Pi := p1

0 for all 1

mk

k

r

is a PBW-basis of the universal enveloping algebra U (n(w)) of n(w), and
Pi∗ :=

p1∗

m1

p2∗

m2

· · · pr∗

mr

mk

0 for all 1

is the corresponding dual PBW-basis of the graded dual U (n(w))∗gr .
4.4. Highest weight modules
A U (g)-module M is a weight module or h-diagonalizable if
M=

Mμ
μ∈h∗

k

r

356

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

where
Mμ := m ∈ M h · m = μ(h)m for all h ∈ h .
For each vector v ∈ Mμ let wt(v) := μ be its weight. Analogously, one defines when a right
U (g)-module is a weight module.
A U (g)-module M is a highest weight module if the following hold:
• M is a weight module;
• There is a vector v ∈ M with U (g) · v = M;
• ei · v = 0 for all i.
A right U (g)-module M is a lowest weight module if the following hold:
• M is a weight module;
• There is a vector u ∈ M with u · U (g) = M;
• u · fi = 0 for all i.
When we work with right U (g)-modules, we invert the usual ordering on weights. So if M is
a lowest weight right U (g)-module, then the vector u (which is uniquely determined up to a
non-zero scalar) has actually the lowest weight of M. Indeed, if m ∈ Mμ and h ∈ h, then we have
(m · ei ) · h = μ(h)m · ei − αi (h)m · ei = (μ − αi )(h)(m · ei ).
Here we used that [h, ei ] = hei − ei h = αi (h)ei . So m · ei has weight μ − αi .
4.5. Construction of highest weight modules
In this section we present some of our results from [32] in a form convenient for our present
purpose. For ν ∈ P + we write
Iˆν :=

n

∨

ν(α )
Iˆi i .

i=1

For 1 i n and a nilpotent Λ-module X we denote by G(i, X) the variety of submodules Y of
X such that X/Y ∼
= Si . Similarly, if
n
mi

soc(X) =

Si
i=1

and ν ∈ P + is such that ν(αi∨ ) mi for 1 i n, then we have an embedding X → Iˆν . In this
case, we denote by G(i, ν, X) the variety of submodules Y of Iˆν such that X ⊂ Y and Y/X ∼
= Si .
Hence, if dim(X) = β and f ∈ Mβ−αi , we can form the following sum
mχc Y ∈ G(i, X) f (Y ) = m .

Σ :=
m∈C

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

357

For convenience we shall denote such an expression by an integral, for example,
Σ=

f (Y ).

Y ∈G (i,X)

Similarly, there exists a partition
m

G(i, X) =

Aj
j =1

into constructible subsets such that δY = δY for all Y, Y ∈ Aj . Then, choosing arbitrary Yj ∈ Aj
for j = 1, . . . , m, we can also denote by an integral the following element of M∗β−αi ,
m

δY =

χc (Aj )δYj .
j =1

Y ∈G (i,X)

Theorem 4.3. Let λ ∈ P be an integral weight, and let Mlow (λ) be the lowest weight Verma right
U (g)-module (with underlying vector space U (n)) with lowest weight λ. Under the identifications
Mlow (λ) ≡ U (n) ≡ M
the corresponding right U (g)-module structure on M is described as follows: The generators
ei ∈ n, fi ∈ n− , h ∈ h act on g ∈ Mβ by
(g · ei ) X =

g(Y ),

Y ∈G (i,X )

g(Y ) − (ν − λ) αi∨ g(X ⊕ Si ),

(g · fi )(X) =
Y ∈G (i,ν,X)

g · h = (λ − β)(h)g,
where X ∈ Λβ+αi , X ∈ Λβ−αi and ν ∈ P + are as above.
Note that g · ei = g ∗ 1i by our convention for the multiplication in M. Moreover, the formula
for g · fi ∈ Mβ−αi is in fact independent of the choice of ν.
For each h-diagonalizable right U (g)-module
M=

Mμ
μ∈h∗

one can consider the dual representation
M∗ =

Mμ∗
μ∈h∗

358

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

defined by Mμ∗ := HomC (Mμ , C). It acquires the structure of a left U (g)-module via
(x · φ)(m) := φ(m · x)

x ∈ U (g), m ∈ M .

Consider the canonical epimorphism from the Verma module Mlow (λ) to the irreducible lowest
weight right U (g)-module Llow (λ). For the corresponding dual representations we obtain an
inclusion
∗
L∗low (λ) → Mlow
(λ).

It is well known that L∗low (λ) is isomorphic to the irreducible highest weight left U (g)-module
L(λ) with highest weight λ. This yields the following realization of the integrable module L(λ)
in terms of δ-functions.
Theorem 4.4. Let λ ∈ P + be an integral dominant weight. The subspace
U (λ) := SpanC δX | X submodule of Iˆλ
of U (n)∗gr carries the above-mentioned structure of an irreducible highest weight left U (g)module L(λ). For such X with dim(X) = β the action of the Chevalley generators of U (g) is
given by
ei · δX =

δY ,

Y ∈G (i,X)

fi · δX =

δY ,

Y ∈G (i,λ,X)

h · δX = (λ − β)(h)δX .
Note that U (n)∗gr carries also a right U (n)-module structure coming from the left regular
representation of U (n). In order to describe it, we introduce the following definition. For X ∈ Λβ
we denote by G (i, X) the variety of submodules Y of X such that dim(Y ) = αi . Each element
of this space is isomorphic to Si and clearly G (i, X) is a projective space. It is easy to see that
δX · ei =

δX/S .

S∈G (i,X)
∗ (λ) ≡ U (n)∗ , the subspace of U (n)∗ carrying the U (g)Under the above identification Mlow
gr
gr
module L(λ) can be described as follows.

Corollary 4.5. For λ ∈ P + we have
λ(αi∨ )+1

U (λ) = φ ∈ U (n)∗gr φ · ei

= 0 for all 1

i

n .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

359

Proof. The nilpotent Λ-module X is isomorphic to a submodule of Iˆλ if and only if
λ(αi∨ )+1

δX · ei

=0
✷

for every i. The claim then follows from Theorem 4.4.

Note that for λ, μ ∈ P + we have U (λ) = U (μ) if and only if
2n−rank(CQ )

λ−μ∈

C

j.

j =n+1

5. Unipotent groups
5.1. The group N and its coordinate ring C[N ]
The completion n of n defined in 4.3, is a pro-nilpotent pro-Lie algebra, see [48, Section
6.1.1]. Let N be the pro-unipotent pro-group with Lie algebra n. We refer to Kumar’s book [48,
Section 4.4] for all missing definitions.
We can assume that N = n as a set and that the multiplication of N is defined via the Baker–
Campbell–Hausdorff formula. Hence the exponential map Exp : n → N is just the identity map.
Put H := U (n)∗gr . This is a commutative Hopf algebra. We can regard H as the coordinate
ring C[N ] of N , that is, we can identify N with the set
max Spec(H) ≡ Homalg (H, C)
of C-algebra homomorphisms H → C. An element f ∈ Homalg (H, C) is determined by the
images ci := f (pi∗ ) for all i 1.
It is well known (see e.g. [1, Section 3.4]) that Homalg (H, C) can also be identified with
the group G(H◦ ) of all group-like elements of the dual Hopf algebra H◦ of H, by mapping
f ∈ Homalg (H, C) to
mi

yf =

ci
m

pm ∈ G H ◦ .

i

Note that the map f → yf does not depend on the choice of the PBW-basis P = {pm | m ∈
N(J ) }. Note also that G(H◦ ) is contained in the vector space dual H∗ of H, which is the completion U (n) of U (n) with respect to its natural grading. When we use this second identification, an
element x ∈ N = n is simply represented by the group-like element
exp(x) :=

x k /k!
k 0

in U (n). To summarize, we have H = U (n)∗gr ≡ C[N ] and
N ≡ max Spec(H) ≡ Homalg (H, C) ≡ G H◦ ⊂ H◦ ⊂ H∗ ≡ U (n).

360

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

5.2. The unipotent groups N (w) and N (w)
Let Θ be a bracket closed subset of

+,

and let

N (Θ) := Exp n(Θ)
be the corresponding pro-unipotent pro-group. For example, if α ∈ +
re , then Θα := {α} is bracket
closed. In this case, N (α) is called the one-parameter subgroup of N associated to α. We have
an isomorphism of groups N (α) ∼
= (C, +).
If Θ is bracket closed and bracket coclosed, then set N (Θ) := N ( + \ Θ). In this case, the
multiplication in N yields a bijection [48, Lemma 6.1.2]
m : N (Θ) × N (Θ) → N.
For w ∈ W let N (w) := N ( +
w ). This is a unipotent algebraic group of dimension l(w),
and its Lie algebra is n(w). Again we can identify U (n(w))∗gr ≡ C[N (w)]. Similarly, define
N (w) := N ( +
w ).
6. Evaluation functions and generating functions of Euler characteristics
Recall the identifications M∗ ≡ U (n)∗gr = C[N ]. To every X ∈ nil(Λ), we have associated a
linear form δX ∈ U (n)∗gr . We shall also denote the evaluation function δX by ϕX when we regard
it as a function on N . For 1 i n define xi : C → N by
xi (t) := exp(tei ) =
k 0

(tei )k
k!

The following formula shows how to evaluate ϕX on a product of xi (t)’s.
Proposition 6.1. Let X ∈ nil(Λ), and let i = (i1 , . . . , ik ) be any sequence with 1
1 j k. We have

ij

n for all

a

ϕX xi1 (t1 ) · · · xik (tk ) =

χc (Fia ,X )
a=(a1 ,...,ak )∈Nk

t1a1 · · · tk k
.
a1 ! · · · ak !

Here ia is short for the sequence (i1 , . . . , i1 , . . . , ik , . . . , ik ) consisting of a1 letters i1 followed by
a2 letters i2 , etc.
Proof. By Section 5.1 we can regard xi1 (t1 ) · · · xik (tk ) as an element of U (n), namely,
a

xi1 (t1 ) · · · xik (tk ) =
a=(a1 ,...,ak )∈Nk

t1a1 · · · tk k a1
a
e · · · eikk .
a1 ! · · · ak ! i 1

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

361

It follows from the identification of ϕX with δX that
a

ϕX xi1 (t1 ) · · · xik (tk ) =
a=(a1 ,...,ak )∈Nk

t1a1 · · · tk k
δX eia11 · · · eiakk .
a1 ! · · · ak !

Now, in the geometric realization M of the enveloping algebra U (n) in terms of constructible
functions, eia11 · · · eiakk becomes the convolution product 1ai11 · · · 1aikk and it is easy to see that
δX 1ai11 · · · 1aikk = χc (Fia ,X ).
This finishes the proof.

✷

Remark 6.2. The formula for ϕX given in [33, Section 9] involves descending flags instead
of ascending flags of submodules of X. This is because in the present paper we have taken a
convolution product opposite to that of our previous papers, see Remark 2.3.
Proposition 6.1 says that we can think of the ϕ-functions ϕX as generating functions of Euler
characteristics.
For i = (i1 , . . . , ik ) and a = (a1 , . . . , ak ) as above and X ∈ nil(Λ) let Fi,a,X be the projective
variety of partial composition series of type (i, a) of X. Thus an element of Fi,a,X is a chain
0 = X0 ⊆ X1 ⊆ · · · ⊆ Xk = X
aj
of submodules of X such that Xj /Xj −1 ∼
= Sij for all 1 j k. There is an obvious surjective
morphism πi,a : Fia ,X → Fi,a,X whose fibers are all isomorphic to

F Ca1 × · · · × F Cak ,
where F (Cm ) is the variety of complete flags of subspaces in Cm . In particular, we have
χc (Fia ,X ) = χc (Fi,a,X )a1 ! · · · ak !.
Summarizing, we get
χc (Fi,a,X )t1a1 · · · tkak .

ϕX xi1 (t1 ) · · · xik (tk ) =
a=(a1 ,...,ak )∈Nk

7. Generalized minors
7.1. Generalized minors
We start with some generalities on Kac–Moody groups. Let Gmin be the Kac–Moody group
with Lie(Gmin ) = g defined in [48, 7.4]. It has a refined Tits system
Gmin , NormGmin (H ), N ∩ Gmin , N− , H .
Write N min := Gmin ∩ N . Moreover, Gmin is an affine ind-variety in a unique way [48, 7.4.8].

362

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

For any real root α of g, the one-parameter subgroup N (α) is contained in Gmin , and the
N(α) together with H generate Gmin as a group. We have an anti-automorphism g → g T of
Gmin which maps N (α) to N (−α) for each real root α, and fixes H . We have another antiautomorphism g → g ι which fixes N (α) for every real root α, and hι = h−1 for every h ∈ H .
For each γ ∈ h∗ there is a character H → C∗ , a → a γ defined by exp(h)γ := eγ (h) for all
h ∈ h.
For 1 i n we have a unique homomorphism ϕi : SL2 (C) → Gmin satisfying
ϕi

1 t
0 1

= exp(tei ),

ϕi

1 0
t 1

= exp(tfi )

(t ∈ C).

We define
s i := ϕi

0 −1
.
1 0

For w ∈ W , we define w := s ir · · · s i1 , where (ir , . . . , i1 ) is a reduced expression for w. Thus, we
choose for every w ∈ W a particular representative w of w in the normalizer NormGmin (H ).
Let L(λ) denote the irreducible highest weight g-module with highest weight λ ∈ P + . Let uλ
be a highest weight vector of L(λ). This is an integrable module, so it is also a representation of
Gmin . For a reduced expression i = (ir , . . . , i1 ) of a Weyl group element w, the vector
s i1 · · · s ir (uλ ) ∈ L(λ)
is an extremal weight vector of L(λ), i.e. it belongs to the extremal weight space L(λ)w(λ) . For a
U (g)-module V and a weight vector v ∈ Vμ define
(m)

fimax v := fi

v

where m 0 is maximal such that fi(m) v = 0. Similarly, define eimax . The following results can
be found in [42, Section 4.4.3]: We have
s i1 s i2 · · · s ir (uλ ) = fimax
fimax
· · · fimax
(uλ )
r
1
2
and
· · · fimax
(uλ ) = 0.
ei1 fimax
r
2
Furthermore,
wt s i1 · · · s ir (uλ ) = wt s i2 · · · s ir (uλ ) − b1 αi1
where b1 := −(si1 · · · sir (λ), αi1 ) = (si2 · · · sir (λ), αi1 ).
We have the following analogue of the Gaussian decomposition.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

363

Proposition 7.1. Let G0 be the subset N− · H · N min of Gmin .
(i) The subset G0 is dense open in Gmin and each element g ∈ G0 admits a unique factorization
g = [g]− [g]0 [g]+ with [g]− ∈ N− , [g]0 ∈ H and [g]+ ∈ N min .
(ii) The map g → [g]+ (resp. g → [g]0 ) is a morphism of ind-varieties from G0 to N min (resp.
to H ).
Part (i) follows from the fundamental properties of a refined Tits system [48, Theorem 5.2.3].
For part (ii), see [48, Proposition 7.4.11].
Following Fomin and Zelevinsky [22] we can now define for each j a generalized minor
min such that
j , j as the regular function on G
j,

For w ∈ W , we also define

j ,w(

j)

j

j,

j

(g ∈ G0 ).

by

j ,w(

The generalized minors

(g) = [g]0 j

j)

(g) :=

j,

j

(gw).

(g) have the following alternative description.

Proposition 7.2. Let g ∈ Gmin . The coefficient of u
space L( j ) j is equal to
j , j (g).

j

in the projection of gu

j

on the weight

Proof. Set uj := u j . Let g = [g]− [g]0 [g]+ ∈ G0 . We have [g]+ uj = uj , and [g]0 uj =
[g]0 j uj . The result then follows from the fact that [g]− uj is equal to uj plus elements in lower
weights. ✷
Proposition 7.3. We have
G0 = g ∈ Gmin
Proof. Set uj := u

j

j,

j

(g) = 0 for all 1

j

n .

. We use the Birkhoff decomposition [48, Theorem 5.2.3]
Gmin =

N− wH N min ,
w∈W

where G0 is the subset of the right-hand side corresponding to w = e. If g = [g]− [g]0 [g]+ ∈ G0 ,
j
then
= 0. Conversely, if g ∈
/ G0 we have g = n− whn for some n− ∈ N− ,
j , j (g) = [g]0
min
n ∈ N , h ∈ H and w = e. Then for some j we have w( j ) = j and whnuj is a multiple of
the extremal weight vector wuj . Since the projection of n− wuj on the highest weight space of
L( j ) is zero, it follows that
j , j (g) = 0. Finally, note that for any j > n the minor
j, j
does not vanish on Gmin . Indeed, the corresponding highest weight irreducible module L( j )
is one-dimensional since j (αi∨ ) = 0 for any i. Hence in the above description of G0 , we may
omit the minors
✷
j , j with j > n.

364

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

7.2. The module L(λ) as a subspace of C[N ]
For w ∈ W and 1

j

n, we denote by
D

j ,w(

j)

min . For example, D
the restriction of the generalized minor
j , j is equal to the
j ,w( j ) to N
constant function 1. In Section 9.1 we are going to show that each (restricted) generalized minor
D j ,w( j ) can be identified with a generating function ϕX for a certain Λ-module X. In order to
do this, we need to recall some results on Kac–Moody groups.
Let G := [Gmin , Gmin ] be the group constructed by Kac and Peterson [44], see [48, Section
7.4.E (1)]. The associated Lie algebra is g = [g, g].
Let C[G ]s.r. denote the algebra of strongly regular functions on G [44, Section 2C]. Define
the invariant ring

C N− \G

s.r.

:= f ∈ C G

s.r.

f (ng) = f (g) for all n ∈ N− , g ∈ G .

This ring is endowed with the usual left action of G given by
(g · f ) g := f g g

f ∈ C N− \G

s.r.

, g, g ∈ G .

It was proved by Kac and Peterson [44, Corollary 2.2] that as a left G -module, it decomposes as
follows
C N− \G

s.r.

=

L(λ).
λ∈P +

This is a multiplicity-free decomposition, in which the irreducible highest weight module L(λ)
is carried by the subspace
S(λ) = f ∈ C N− \G

s.r.

f (hg) =

λ (h)f (g)

for all h ∈ H, g ∈ G ,

where we denote
n
λ

λ(αj∨ )
j, j .

:=
j =1

Clearly, λ is contained in S(λ), and it is a highest weight vector. Moreover, for any w ∈ W , the
1-dimensional extremal weight space of S(λ) with weight w(λ) is spanned by
n
w(λ)

λ(αj∨ )
j ,w(

:=
j =1

j)

.

Now consider the restriction map
ρ : C N− \G

s.r.

→ C N min

given by restriction of functions from G to N min .

s.r.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

365

Lemma 7.4. For every λ ∈ P + , the restriction
ρλ : S(λ) → C N min

s.r.

of ρ to S(λ) is injective.
Proof. Let B− be the Borel subgroup of G with unipotent radical N− . We have
N min ⊂ G0 ∩ G = B− N min .
It follows that the natural projection from G onto B− \G restricts to an embedding of N min ,
with image the open subset of the flag variety X = B− \G defined by the non-vanishing of the
minors
j , j . Now C[N− \G ]s.r. can be regarded as the multi-homogeneous coordinate ring of
X with homogeneous components S(λ), where λ runs through P + . It follows that C[N min ] can
be identified with the subring of degree 0 homogeneous elements of the localized ring obtained
from C[N− \G ]s.r. by formally inverting the element
n

:=

j,

j

.

j =1

Therefore, the restriction ρλ of ρ to every homogeneous piece S(λ) is an embedding.

✷

It follows that we can transport the G -module structure from S(λ) to ρ(S(λ)) by setting
g · ϕ := ρ g · ρλ−1 (ϕ)

g ∈ G , ϕ ∈ ρ S(λ) .

In this way, we can identify the highest weight module L(λ) with the subspace ρ(S(λ)) of
C[N min ]s.r. . The highest weight vector is now ρ( λ ) = 1, and the extremal weight vectors are
the (restricted) generalized minors
n

Dw(λ) :=

D
j =1

λ(αj∨ )
j ,w(

j)

,

for w ∈ W .
At this point, we note that a strongly regular function on N min is just the same as an element of
U (n)∗gr . Indeed, the elements of C[N min ]s.r. are the restrictions to N min of the linear combinations
of matrix coefficients of the irreducible integrable representations L(λ) with λ ∈ P + of G , see
[44, Lemma 4.2]. Now, by Theorem 4.4, we can realize every L(λ) as a subspace of U (n)∗gr , and
every f ∈ U (n)∗gr belongs to such a subspace for λ = ni=1 li i with the li
0. It follows that
each element of U (n)∗gr can be seen as a matrix coefficient for some L(λ), and vice versa. We
can therefore identify
C N min

s.r.

≡ U (n)∗gr ≡ C[N ].

Moreover, these two ways of embedding L(λ) in C[N ] coincide.

366

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Lemma 7.5. Let λ ∈ P + . Under the identification U (n)∗gr ≡ C[N min ]s.r. , the subspace U (λ)
defined in Theorem 4.4 coincides with ρ(S(λ)).
Proof. The natural right action of U (n) on U (n)∗gr defined before Corollary 4.5 coincides with
the right action of U (n) on C[N min ]s.r. obtained by differentiating the right regular representation
of N min :
(f · n)(x) = f (nx)

x, n ∈ N min , f ∈ C N min

Consider first the case of a fundamental weight λ =

j,

j

j,

xi (t)g =

j,

j.

(g)
j (g) + t

s.r.

.

It is easy to check that

j

j,

j (s j g)

if i = j ,
if i = j .

Now, the subspace ρ(S(λ)) is spanned by the functions n →
j , j (ng), (n ∈ N− , g ∈ G ). By
differentiating the previous equation with respect to t and setting t = 0, we obtain that
ρ S(λ) ⊆ f ∈ C N min

s.r.

f · ei = 0 for i = j, f · ej2 = 0 .

Hence, using Corollary 4.5, we see that ρ(S(λ)) is contained in the embedding of L( j ) into the
∗ (
dual Verma module Mlow
j ). Since these spaces have the same graded dimensions, they must
coincide. The case of a general λ ∈ P + follows using the fact that
n
λ=

λ(αj∨ )
j, j

j =1

and that the ei ’s act as derivations on C[N min ]s.r. .

✷

8. The coordinate rings C [N(w)] and C [N w ]
8.1. The coordinate ring C[N (w)] as a ring of invariants
Again, we fix a reduced expression i = (ir , . . . , i1 ) of a Weyl group element w. Assume that
P = pm m ∈ N

(J )

is an i-compatible PBW-basis of U (n). Note that this PBW-basis of U (n) and also the corresponding dual PBW-basis of U (n)∗gr are homogeneous with respect to the (root lattice) Nn grading of U (n). We write |m| = d ∈ Nn in case pm is a homogeneous element of degree d ∈ Nn .
(J )
Let us denote by (ei )i∈J the usual coordinate vectors of Z . For example, |ek | = βi (k) for
1 k r.
The multiplication μ : U (n) ⊗ U (n) → U (n) is given by its effect on the PBW-basis, say
pm · pn =

k
cm,n
pk .
|k|=|m+n|

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

367

Next, the comultiplication μ∗ : C[N] → C[N ] ⊗ C[N ] is a ring homomorphism, so it is determined by the value on the generators pi∗ = pe∗i . By construction, we have
μ∗ pi∗ =

ei
∗
pm
cm,n
⊗ pn∗ .
|m+n|=|ei |

Lemma 8.1. Let 1

i

r and 0 = n ∈ N

(J )

such that nj = 0 for 1

ei
r. Then cm,n
= 0.

j

>
Proof. Let m = m< + m> such that m<
j = 0 for j > r and mj = 0 for 1
+
pm< · pm> . Since w is bracket closed and coclosed we have

pm> · pn =

j

r, so pm =

k
cm
> ,n pk
|k |=|m> +n|

with kj = 0 for 1

j

r. Thus
p m · pn =

k
cm
> ,n pk +m< .
|k |=|m> +n|

k
k
k
Putting k = k + m< we get cm,n
= cm
> ,n . Thus, if in our situation cm,n = 0 then kj = 0 for
some k > r. ✷

Now, let us turn to the subgroups N (w) and N (w). Consider the ideals
∗
∗
I (w) := pr+1
, pr+2
,... ,

I (w) := p1∗ , . . . , pr∗

in C[N]. Then we have
N (w) = ν ∈ Homalg C[N ], C

ν I (w) = 0 ,

N (w) = ν ∈ Homalg C[N ], C

ν I (w) = 0 .

and

In other words we have canonically C[N (w)] = C[N ]/I (w) and C[N (w)] = C[N ]/I (w).
We consider the action of N (w) on N via right multiplication. By definition, this comes from
the left action of N (w) on C[N] given by
ν · f = id ⊗ ν μ∗ (f )
for f ∈ C[N] and ν ∈ N (w). (Here we identify C[N ] ⊗ C ≡ C[N ] in the canonical way.)
We denote by C[N ]N (w) the invariant subring for this group action.
Proposition 8.2. Consider the injective ring homomorphism
π˜ w∗ : C N (w) → C[N ]

368

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

defined by pi∗ + I (w) → pi∗ for 1 i r. The corresponding morphism (of schemes) π˜ w : N →
N(w) is N (w)-invariant and is a retraction for the inclusion of N (w) into N . As a consequence,
π˜ w∗ identifies C[N (w)] with C[N ]N (w) = C[p1∗ , . . . , pr∗ ].
Proof. We have
μ∗ pi∗ = 1 ⊗ pi∗ + pi∗ ⊗ 1 +

ei
∗
pm
cm,n
⊗ pn∗
|m+n|=|ei |

where in the last sum |m| = 0 = |n|. Thus for 1

i

r and ν ∈ N (w) we get

ν · pi∗ = 1 · 0 + pi∗ · 1 +

ei
∗
cm,n
pm
· ν pn∗
|m+n|=|ei |

with the last sum vanishing by Lemma 8.1 and the definition of N (w). In other words, pi∗ ∈
C[N]N (w) for 1 i r. Thus, π˜ w : N → N (w) is N (w)-invariant, that is, π˜ w (nn ) = π˜ w (n)
for any n ∈ N (w).
Now, since the multiplication map N (w) × N (w) → N is bijective, each N (w)-orbit on N
is of the form n · N (w) for a unique n ∈ N (w). We conclude that the inclusion N (w) → N is a
section for π˜ w . Our claim follows. ✷
8.2. The coordinate ring C[N w ] as a localization of C[N ]N (w)
Let us now consider the groups N (w) and N (w) introduced in Section 5.2.
Lemma 8.3. We have
N (w) = N ∩ w −1 N− w ,
N (w) = N ∩ w −1 N w ,
N (w) ∩ N min = N min ∩ w −1 N min w .
Proof. This follows from [48, 5.2.3] and [48, 6.2.8].

✷

It follows that
is invariant under the action of N (w) ∩ N min on Gmin via right
−1
j ,w ( j )
multiplication. Indeed, for g ∈ Gmin and n ∈ N (w) ∩ N min , we have n w−1 = w−1 n for some
n ∈ N (w) ∩ N min , hence
j ,w

−1 (

j)

gn =

j,

j

gn w−1 =

=

j,

j

gw−1 =

j,
j ,w

j

−1 (

gw−1 n
j)

(g).

Define
Ow := n ∈ N min

j ,w

−1 (

j)

(n) = 0 for all 1

j

n .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

369

This is the open subset of N min consisting of elements n such that wnT ∈ G0 . Indeed,
j ,w

−1 (

j)

(n) =

j,

j

nw−1 =

j,

nw−1

j

T

=

j,

j

wnT ,

since w−1 = wT . Following [8, Section 5], we can now define the map η˜ w : Ow → N min given
by
η˜ w (z) := wzT

+

.

Recall that N w = N ∩ (B− wB− ), see Section 3.4.
Proposition 8.4. The following properties hold:
(i)
(ii)
(iii)
(iv)
(v)
(vi)

The map η˜ w is a morphism of ind-varieties.
The image of η˜ w is N w .
η˜ w (x) = η˜ w (y) if and only if x = yn for some n ∈ N (w) ∩ N min .
η˜ w restricts to a bijective morphism N (w) ∩ Ow → N w .
We have N w ⊂ Ow , and η˜ w restricts to a bijection ηw : N w → N w .
−1 (x) = η
ι ι
w
The inverse of ηw is given by ηw
w −1 (x ) for x ∈ N . It follows that ηw is an
w
automorphism of N .

Proof. Property (i) follows from Proposition 7.1(ii). Next, we have
wzT

+

=

wzT

−1
0

wzT

−1
−

wzT ∈ B− wB− .

This shows that the image of η˜ w is contained in N w . The rest of (ii) and (iii) is proved as in [8,
Proposition 5.1]. Property (iv) follows from (ii), (iii), and the decomposition N min = N (w) ×
(N (w) ∩ N min ). Finally, (v) and (vi) are proved exactly in the same way as in [8, Propositions
5.1, 5.2]. ✷
Proposition 8.5. The map π˜ w restricts to a morphism πw : N w → Ow ∩ N (w). This is an isomorphism with inverse
−1
η˜ w : Ow ∩ N (w) → N w .
ηw

In particular, N w is an affine variety with coordinate ring identified to the localized ring
C[N ]N w(w) , where
n
w

:=

j ,w

−1 (

j)

.

j =1
−1 η˜ is a bijection. On the other hand
Proof. By Proposition 8.4 (iv) and (v), we know that ηw
w
w
w
π˜ w (N ) ⊆ Ow ∩ N (w) because N ⊂ Ow . Now, by Proposition 8.4(iii), we have

η˜ w πw (x) = η˜ w (x) = ηw (x)

370

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

−1 η˜ π (x) = x for every x in N w . So we have η−1 η˜ π = id w ,
for every x ∈ N w . Hence ηw
w w
N
w w w
−1 η˜ .
and this proves that πw is the inverse of ηw
w
These maps are morphisms of varieties so they induce isomorphisms
∼
C Nw −
→
C N (w) ∩ Ow = C N (w)

∼
−
→
C[N ]

N (w)

w

w

.

✷

The following commutative diagram displays the different morphisms appearing in Propositions 8.4 and 8.5:
N

π˜ w

N (w)
ι

ι

Nw

η˜ w

Ow
∼
πw

ι

N (w) ∩ Ow

N min

ι
∼

Nw

ηw

(The arrows labeled with ι are inclusion maps.)
9. The modules Vk and Mk
For the entire section, we fix a reduced expression i = (ir , . . . , i1 ) of a Weyl group element
w, and as before let Vi = V1 ⊕ · · · ⊕ Vr and Mi = M1 ⊕ · · · ⊕ Mr . Recall that for each 1 k r
there is a short exact sequence
0 → Vk − → Vk → Mk → 0
of Λ-modules.
9.1. Generalized minors as ϕ-functions
For 1

k

r set
w −1k := si1 · · · sik .

Proposition 9.1. For 1

k

r we have
ϕVk = D

In particular, we have ϕIi,j = D

j ,w

−1 (

j)

−1
ik ,w k (

for every 1

ik )

.

j

n.

Proof. Using Lemma 7.5, we can realize the fundamental module L( ik ) as the subspace
ρ(S( ik )) of C[N]. Then using Theorem 4.4, the definition of Vk (see Section 2.4) and the
discussion in Section 7.1, we can check that the function ϕVk is an extremal weight vector

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

of weight w −1k (

ik )

in L(

ik ), hence it coincides with D i ,w −1 ( i ) up to a
k
k
k
max
eik · · · eimax
is equal to 1, so the normalizations agree
1

over, its image under
ϕVk = D i ,w−1 ( i ) . ✷
k

k

371

scalar. Moreand we have

k

Corollary 9.2. For 1

r we have dim(Vk ) =

k

− si1 si2 · · · sik (

ik

ik ).

Proof. The statement follows from the following general fact: Assume that δX ∈ U (λ) for some
weight λ ∈ P + and some Λ-module X. When we consider δX as an element of L(λ) ≡ U (λ),
Theorem 4.4 implies that wt(δX ) = λ − dim(X). ✷
Recall that for 1

r we defined

k

βi (k) =
Corollary 9.3. For 1

if k = 1,
otherwise.

αi1
si1 · · · sik−1 (αik )

r we have dim(Mk ) = βi (k).

k

Proof. By Corollary 9.2 we know that dim(Vk ) =
By the definition of Mk we have

− si1 si2 · · · sik (

ik

ik )

dim(Mk ) = dim(Vk ) − dim(Vk − )
= si1 si2 · · · sik− (

ik ) − si1 si2

= si1 si2 · · · sik−

ik

· · · sik (

ik )

− sik− +1 · · · sik (

ik )

.

But
sj (

ik ) =

− αik

if j = ik ,
if j = ik .

−

+ sik− +1 · · · sik−1 (αik )

ik
ik

It follows that
dim(Mk ) = si1 si2 · · · sik−

ik

ik

= si1 si2 · · · sik−1 (αik ).
This finishes the proof.

✷

Corollary 9.4. We have

+
w

= {dim(M1 ), . . . , dim(Mr )}.

9.2. Example
Let Q be a quiver with underlying graph
1

2
4

3

for each 1

k

r.

372

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Let w be the Weyl group element s3 s4 s2 s1 s4 . The set of reduced expressions for w is R(w) =
{(3, 4, 2, 1, 4), (3, 4, 1, 2, 4)}. We have
+
w

=

000 100 010 110 111
, 1 , 1 , 1 , 2
1

.

Let i = (3, 4, 2, 1, 4). We get
Vi = V1 ⊕ · · · ⊕ V5 =

4

⊕

⊕

4
1

⊕

4
2

4
12
4

⊕

4
12
4
3

and
M i = M1 ⊕ · · · ⊕ M5 =

4

⊕

4
1

⊕

4
2

⊕

4
12

⊕

4
12
4

.
3

Note that add(Mi ) is neither closed under factor modules nor under submodules. We have
Cw = add Vi ⊕

4
12

.

We can think of Cw as a categorification of a cluster algebra of type A1 with four coefficients.
9.3. Example
Let Q be a quiver with underlying graph 1
3. Then i := (i7 , . . . , i1 ) :=
2
(3, 1, 2, 3, 1, 2, 1) is a reduced expression of a Weyl group element w ∈ WQ . The indecomposable direct summands of Vi are
V1 =

V4 =

V6 =

1

1

1
2
3

1

V2 =

1

V5 =

1

V3 =

1
2

1
2

1

1

1

1

2
1

1
2

3
2

1

1

2
1

1
2

3
2

1
2

1

V7 =

1

3
2

1
2

1
2

1

2

1

2

1
2

1

1

1
2

1
2

1

1
2

1

1
2

1

.

2
3

1

Here, the Λ-modules are represented by their socle filtration. The indecomposable Cw projective–injective modules are V5 , V6 and V7 . The corresponding functions ϕVk are given by
ϕV1 = D

1 ,s1 (

ϕV4 = D

3 ,s1 s2 s1 s3 (

ϕV6 = D

1 ,s1 s2 s1 s3 s2 s1 (

1)
3)
1)

ϕV2 = D

2 ,s1 s2 (

ϕV3 = D

ϕV5 = D

2 ,s1 s2 s1 s3 s2 (

ϕV7 = D

3 ,s1 s2 s1 s3 s2 s1 s3 (

2)
2)
3)

.

1 ,s1 s2 s1 (

1)

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

373

9.4. Example
We continue to discuss the example from Section 3.5. Thus Q is a quiver with underlying
graph 1
3
2
4 . Note that the Weyl group WQ is the symmetric group S5 , and
the generators si are the transpositions (i, i + 1). The generalized minors become ordinary minors. More precisely, for w ∈ S5 and i ∈ {1, 2, 3, 4, 5} we have
i ,w(

i)

=

{1,2,...,i},w({1,2,...,i}) ,

since we may identify S5 with the group of permutation matrices in GL5 . Here I,J denotes the
minor in C[SL5 ] with row set I and column set J . As in Section 3.5 let w := s3 s4 s2 s1 s3 s4 s2 s1
and i := (i8 , . . . , i1 ) := (3, 4, 2, 1, 3, 4, 2, 1). We get
xi (t) := x3 (t8 )x4 (t7 )x2 (t6 )x1 (t5 )x3 (t4 )x4 (t3 )x2 (t2 )x1 (t1 )
⎛
⎞
1 t5 + t1
t5 t2
0
0
t6 t4
t6 t4 t3
1
t6 + t2
⎜0
⎟
⎜
⎟
= ⎜0
0
1
t8 + t4 t8 (t7 + t3 ) + t4 t3 ⎟ .
⎝
⎠
0
0
0
1
t7 + t3
0
0
0
0
1
A straightforward calculation shows:
D

−1
1 ,w 1 (

1)

= D{1},{2} = t5 + t1 ,

D

−1
2 ,w 2 (

2)

= D{1,2},{2,3} = t6 (t5 + t1 ) + t2 t1 ,

D

−1
4 ,w 3 (

4)

= D{1,2,3,4},{1,2,3,5} = t7 + t3 ,

D

−1
3 ,w 4 (

3)

= D{1,2,3},{2,3,5} = t8 t7 t6 (t5 + t1 ) + t2 t1 + t6 t3 (t5 + t1 ) + t3 t2 t1 + t4 t3 t2 t1 ,

D

−1
1 ,w 5 (

1)

= D{1},{3} = t5 t2 ,

D

−1
2 ,w 6 (

2)

= D{1,2},{3,5} = t6 t5 t4 t3 t2 ,

D

−1
4 ,w 7 (

4)

= D{1,2,3,4},{2,3,4,5} = t7 t4 t2 t1 ,

D

−1
3 ,w 8 (

3)

= D{1,2,3},{3,4,5} = t8 t7 t6 t5 t4 t2 .

Here the evaluation of the minors is always on xi (t). Due to the structure of the modules Vk
described in Section 3.5, we could also use Proposition 6.1 and calculate directly that
ϕVk xi (t) = D
for all 1

k

8.

−1
ik ,w k (

ik )

xi (t)

374

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

9.5. Refined socle and top series
For any Λ-module X ∈ Cw there exists a unique chain
0 = Xr ⊆ · · · ⊆ X1 ⊆ X0 = X
of submodules of X such that Xk−1 /Xk = socSik (X/Xk ). This is called the refined socle series
of type i of X. Define
si (X) := (pr , . . . , p1 )
where pk := dim(Xk−1 /Xk ) for 1

r. Similarly, there exists a unique chain

k

0 = Yr ⊆ · · · ⊆ Y1 ⊆ Y0 = X
of submodules of X such that Yk−1 /Yk = topSi (Yk−1 ) for all 1
k
top series of type i of X. Define

r. This is called the refined

k

ti (X) := (qr , . . . , q1 )
where qk := dim(Yk−1 /Yk ) for 1 k r. (For a simple module S and a module M let topS (M)
be the intersection of all submodules U of M with M/U ∼
= S.)
The existence of refined socle and top series of type i of X ∈ Cw comes from the fact that
Vi generates the category Cw . It follows directly from the definitions that each module Vk has
a refined socle and top series of type i. Now one easily checks that this property also holds for
factor modules of modules in add(Vi ).
The uniqueness of refined socle and top series of type i implies the following result:
Lemma 9.5. Let i = (ir , . . . , i1 ) be a reduced expression of w, and let X ∈ Cw . Set s := si (X) =
(pr , . . . , p1 ) and t := ti (X) = (qr , . . . , q1 ). Then the following hold:
(i) We have
Fis ,X ∼
=

r

F Cpk
k=1

and Fit ,X ∼
=

r

F Cqk .
k=1

In particular,
r

χc (Fis ,X ) =

r

pk !
k=1

and χc (Fit ,X ) =

qk !.
k=1

(ii) Fi,s,X and Fi,t,X both consist of a single point. In particular, χc (Fi,s,X ) = 1 and
χc (Fi,t,X ) = 1.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

375

Observe that (ik , . . . , it ) is a reduced expression for the Weyl group element wk,t :=
sik sik−1 · · · sit for all 1 t k r. Set j := (ir , . . . , i2 ). For 1 k r define
bk := bi,k := − sik · · · sir (

= sik+1 · · · sir (

ir ), αik

ir ), αik

,

and set bi := (br , . . . , b1 ).
Proposition 9.6. For i and j as above, the following hold:
(i) topSi (Vj,r−1 ) = 0;
1

(ii) topSi (Vi,r ) = Sib11 ;
1
(iii) si (Vi,r ) = ti (Vi,r ) = bi .
Proof. For r = 1 the statements are obvious. Thus assume r 2. Let u ir be a highest weight
vector in L( ir ). Since i = (j, i1 ) is a reduced expression, we know from Section 7.1 that
ei1 s i2 · · · s ir (u

ir

) = 0.

(3)

By Proposition 9.1 we can identify s i2 · · · s ir (u ir ) with ϕVj,r−1 . We have topSi (Vj,r−1 ) ∼
= Sic1 for
1
some c 0. Let U be the unique submodule such that Vj,r−1 /U = topSi (Vj,r−1 ). We get
1

(c)

ei1 ϕVj,r−1 = ϕU = 0.
ϕVj,r−1 = 0, a contradiction. This implies c = 0. So we
But if c 1, then Eq. (3) yields ei(c)
1
proved (i). To show (ii) we use that ϕVi,r can be identified with
s i1 s i2 · · · s ir (u

ir

) = fimax
s i2 · · · s ir (u
1

ir

) = fimax
(ϕVj,r−1 ).
1

We have wt(s i1 · · · s ir (u ir )) = wt(s i2 · · · s ir (u ir )) − b1 αi1 , see Section 7.1. This implies (ii).
Finally, it follows by induction on r that si (Vi,r ) = ti (Vi,r ) = bi . This finishes the proof. ✷
9.6. Computation of the Euler characteristics χc (Fk,Vk )
By Proposition 6.1, to evaluate ϕVk on xj1 (t1 ) · · · xjp (tp ), we need to know the Euler characteristic χc (Fk,Vk ) for arbitrary types k of composition series. These Euler characteristics can in
turn be calculated via a simple algorithm that we shall now describe.
To this end, it will be convenient to embed U (n)∗gr ≡ C[N ] in the shuffle algebra F ∗ , as
explained in [49, Section 2.8]. As a C-vector space, F ∗ has a basis consisting of all words
w[k] := w[k1 , k2 , . . . , ks ] := wk1 wk2 · · · wks

(1

k 1 , . . . , ks

n, s

0),

in the letters w1 , . . . , wn . The multiplication in F ∗ is the classical commutative shuffle product
of words with unit the empty word w[], see e.g. [53] and [49, Section 2.5]. By [49, Propositions 9 and 10], for any X ∈ nil(Λ) the image of ϕX in this embedding is just the generating
function

376

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

gX :=

χc (Fk,X )w[k]
k

of the Euler characteristics χc (Fk,X ) for all types k of composition series. (The Euler characteristic χc (Fk,X ) is equal to the coefficient of t1 · · · ts in ϕX (xk1 (t1 ) · · · xks (ts )).)
Let λ ∈ P + and 1 i n. Define endomorphisms ρλ (ei ), ρλ (fi ) of the vector space F ∗ by
ρλ (ei ) w[j1 , . . . , jk ] := δi,jk w[j1 , . . . , jk−1 ],
k

(λ − αj1 − · · · − αjl ) αi∨ w[j1 , . . . , jl , i, jl+1 , . . . , jk ].

ρλ (fi ) w[j1 , . . . , jk ] :=
l=0

Proposition 9.7. The formulas above extend to a representation ρλ : U (g) → EndC (F ∗ ) of U (g).
This turns F ∗ into a U (g)-module. The image of C[N ] in its embedding in F ∗ is a U (g)∗ (λ), see Section 4.5. In particular the
submodule isomorphic to the dual Verma module Mlow
set
ρλ (fi1 · · · fis ) w[]

1

i1 , . . . , is

n, s

0

∗ (λ).
spans the irreducible module L(λ), considered as a submodule of Mlow

The above formulas for ρλ (ei ) and ρλ (fi ) can be obtained by specializing q to 1 in the formulas of the proof of [49, Proposition 50]. We omit the details.
By Proposition 9.1, for 1 k r we have
ϕVk = D

−1
ik ,w k (

ik )

.

By Section 7.1 we know that ϕVk is obtained by acting on the highest weight vector u
k)
1)
fi(b
· · · fi(b
k
1

ik

of

L( ik ) with the product
of divided powers of the Chevalley generators, where
bk = bi,k is defined as in Section 9.5. Therefore we have
gVk = ρ

(b )

ik

(bk )

fi 1 1 · · · fi k

w[] .

(4)

Hence to calculate the generating function gVk one only needs to apply b1 + · · · + bk = dim(Vk )
times the above combinatorial formula for ρ ik (fi ). Thus we have obtained an algorithm for
calculating all Euler characteristics χc (Fk,Vk ).
9.7. Example
We continue the example of Section 9.3. Clearly, we have
gV1 = ρ

1

(f1 ) w[] =

1

α1∨ w[1] = w[1].

Similarly
gV2 = ρ

(2)

2

f1 f2 w[] .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

377

Now we calculate successively
ρ
ρ
ρ

2

(f2 ) w[] =

2

α2∨ w[2] = w[2],

(f1 ) w[2] =

2

α1∨ w[1, 2] + (

2
2

(f1 ) 2w[2, 1] = 2

2

+(

2

− α2 ) α1∨ w[2, 1] = 2w[2, 1],

α1∨ w[1, 2, 1] + (
2

2

− α2 ) α1∨ w[2, 1, 1]

− α2 − α1 ) α1∨ w[2, 1, 1]

= 4w[2, 1, 1].
(2)

Hence, taking into account that f1 = f12 /2, we get
gV2 = 2w[2, 1, 1].
Similar applications of formula (4) yield the following results
(3) (2)

gV3 = ρ

1

f1 f2 f1 w[] = 4w[1, 2, 1, 2, 1, 1] + 12w[1, 2, 2, 1, 1, 1],

gV4 = ρ

3

f1 f2 f3 w[] = 2w[3, 2, 1, 1],

gV7 = ρ

3

f1 f2 f1 f2 f3 w[]

(2)

(4) (3) (2)

= 288w[3, 2, 1, 1, 2, 2, 2, 1, 1, 1, 1] + 144w[3, 2, 1, 1, 2, 2, 1, 2, 1, 1, 1]
+ 96w[3, 2, 1, 2, 1, 2, 2, 1, 1, 1, 1] + 48w[3, 2, 1, 1, 2, 2, 1, 1, 2, 1, 1]
+ 48w[3, 2, 1, 2, 1, 1, 2, 2, 1, 1, 1] + 48w[3, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1]
+ 48w[3, 2, 1, 1, 2, 1, 2, 2, 1, 1, 1] + 16w[3, 2, 1, 2, 1, 2, 1, 1, 2, 1, 1]
+ 16w[3, 2, 1, 2, 1, 1, 2, 1, 2, 1, 1] + 16w[3, 2, 1, 1, 2, 1, 2, 1, 2, 1, 1].
The generating functions gV5 and gV6 are too large to be included here. For example gV5 is a
linear combination of 402 words.
9.8. The modules M[b, a]
For 1

k

r let
k − := max{0, 1

k − 1 | is = ik },

s

+

k := min{k + 1

r, r + 1 | is = ik },

s

kmin := min{1

s

r | is = ik },

kmax := max{1

s

r | is = ik }.

Set k (0) := k, and for an integer m define k (m−1) := (k (m) )− and k (m+1) := (k (m) )+ . For 1
n and 1 k r + 1 let
k − (j ) := max{0, 1

s

k − 1 | is = j },

j

378

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

and
k[j ] := {1

k − 1 | is = j } ,

s

and set tj := (r + 1)[j ].
For 1 a b r with ia = ib define M[b, a] := Vb /Va − . (For convenience, we define V0 =
Vr+1 = 0.) We have a short exact sequence
0 → M a − , bmin → M[b, bmin ] → M[b, a] → 0.
Note that amin = bmin , since we assume ia = ib . For 1
M[k, k] = Mk . One can visualize a module M[b, a] by

k

r we have M[k, kmin ] = Vk and

Mb
Mb −
···
Ma
We have
r

Vi =

M[k, kmin ].
k=1

For each k we have a short exact sequence
0 → M[k, kmin ] → M[kmax , kmin ] → M kmax , k + → 0.
Note that M[kmax , kmin ] = Ii,ik is Cw -projective–injective. Define
Tk := Ti,k :=

Vk
M[kmax , k + ]

if k + = r + 1,
otherwise.

Thus if k + = r + 1, then Ωw−1 (Vk ) = Tk . Define Ti := T1 ⊕ · · · ⊕ Tr . In other words, we have
r

Ti =

M[kmax , k] = Iw ⊕ Ωw−1 (Vi ).

k=1

9.9. Computation of dim HomΛ (Vk , Ms )
Lemma 9.8. Let 1
(i) If k

k, s

r.

s, then we have
0 if k < s,
dim HomΛ (Vk , Ms ) = dim HomΛ (Mk , Ms ) ∼
=
1 if k = s.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

379

(ii) If k > s, then
dim HomΛ (Vk , Ms ) =

if ik = is ,

m 0,k (−m) >s (Mk (−m) , Ms )Q

1+

m 0,k (−m) >s (Mk (−m) , Ms )Q

if ik = is .

(iii) We have
dim HomΛ (Vk , Vs ) = dim HomΛ (Vk , Ms ⊕ Ms − ⊕ · · · ⊕ Msmin ).
Proof. We have short exact sequences
ι

π

ι

π

s
s
k
k
→
Vk −→
Mk → 0 and ψ : 0 → Vs − −
→
Vs −→
Ms → 0.
η : 0 → Vk − −

First, assume that k < s. Then the module Mk is contained in C(is ,...,i1 ) and also in C(is−1 ,...,i1 )
Now Vs is C(is ,...,i1 ) -projective–injective and Vs − is C(is−1 ,...,i1 ) -projective–injective. This implies
dim HomΛ (Mk , Vs − ) = dim HomΛ (Mk , Vs )

and

dim Ext1Λ (Mk , Vs − ) = 0.

Now apply HomΛ (Mk , −) to the sequence ψ and get HomΛ (Mk , Ms ) = 0. Next, apply
HomΛ (−, Ms ) to η. We have HomΛ (Mk , Ms ) = 0 and by induction we also get
HomΛ (Vk − , Ms ) = 0. This implies HomΛ (Vk , Ms ) = 0.
Next, let k = s. We apply HomΛ (−, Mk ) to η. Since HomΛ (Vk − , Mk ) = 0, we get
dim HomΛ (Vk , Mk ) = dim HomΛ (Mk , Mk ).
Applying HomΛ (Vk , −) to η gives an exact sequence
Hom (V ,ι )

Hom (V ,π )

Λ k k
k
0 → HomΛ (Vk , Vk − ) −−−−Λ−−k−−
→ HomΛ (Vk , Vk ) −−−−
−−−−→ HomΛ (Vk , Mk ) → 0.

Here we use that Vk − is contained in C(ik ,...,i1 ) and Vk is C(ik ,...,i1 ) -projective–injective. Thus
every homomorphism h : Vk → Mk factors through πk . In other words, there exists some
g : Vk → Vk such that πk ◦ g = h. Now Vk is indecomposable, so the endomorphism ring
EndΛ (Vk ) is local. Therefore g = λidVk + g for some nilpotent endomorphism g and some
λ ∈ K. Now we easily see that the image of g is contained in ιk (Vk − ). Thus h = λπk . This
implies dim HomΛ (Vk , Mk ) = 1.
Finally, assume that k > s. Then Lemma 2.1 yields
dim Ext1Λ (Vk , Ms ) = dim HomΛ (Vk , Ms ) + dim HomΛ (Ms , Vk ) − (Vk , Ms )Q
= dim HomΛ (Vk , Ms ) + dim HomΛ (Ms , Vk ) − (Vk − , Ms )Q − (Mk , Ms )Q
= dim HomΛ (Vk , Ms ) + dim HomΛ (Ms , Vk ) + dim Ext1Λ (Vk − , Ms )
− dim HomΛ (Vk − , Ms ) − dim HomΛ (Ms , Vk − ) − (Mk , Ms )Q .
Since s < k, we have dim HomΛ (Ms , Vk − ) = dim HomΛ (Ms , Vk ) and Ext1Λ (Vk , Ms ) =
Ext1Λ (Vk − , Ms ) = 0. Thus we get
dim HomΛ (Vk , Ms ) = (Mk , Ms )Q + dim HomΛ (Vk − , Ms ).
The result follows by induction.

380

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

To prove (iii) we just apply HomΛ (Vk , −) to the short exact sequence 0 → Vs − → Vs →
Ms → 0, and then use induction. ✷
Note that in general we have dim HomΛ (Vk , Ms ) = dim HomΛ (Mk , Ms ).
Corollary 9.9. For 1

r we have Ext1Λ (Mk , Mk ) = 0.

k

Proof. Again we use the short exact sequence
η : 0 → Vk − → Vk → Mk → 0.
The three modules in this sequence are contained in C(ik ,...,i1 ) . In particular, Vk is C(ik ,...,i1 ) projective–injective. This implies Ext1Λ (Vk , Mk ) = 0. We have HomΛ (Vk − , Mk ) = 0 by
Lemma 9.8. Thus, applying the functor HomΛ (−, Mk ) to η we get Ext1Λ (Mk , Mk ) = 0. ✷
Corollary 9.10. For 1

k

r with k − = 0 we have dim Ext1Λ (Mk , Vk − ) = 1.

Proof. Apply HomΛ (Mk , −) to the sequence η appearing in the proof of Corollary 9.9.

✷

10. The add(Mi )-stratification of Cw
10.1. The stratification
Let a = (a1 , . . . , ar ) be a tuple of nonnegative integers, and let CMi ,a be the category of all
Λ-modules X such that there exists a chain
0 = X0 ⊆ X1 ⊆ · · · ⊆ Xr = X
a
of submodules of X with Xk /Xk−1 ∼
= Mk k for all 1

k

r.

Lemma 10.1. If X is a module in CMi ,a and CMi ,b , then a = b.
Proof. Let a = (a1 , . . . , ar ) and b = (b1 , . . . , br ). There is a short exact sequence
0 → Xr−1 → X → Mrar → 0.
Lemma 9.8 and induction show that HomΛ (Xr−1 , Mr ) = 0. Thus dim HomΛ (X, Mr ) = ar . Similarly, we get dim HomΛ (X, Mr ) = br . Thus ar = br , and by induction we get ak = bk for all
1 k r. ✷
Define
CMi :=

CMi ,a .
a∈Nr

Lemma 10.2. We have Cw = CMi .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

381

Proof. The category Cw contains all Mk , and Cw is closed under extensions. This implies
CMi ⊆ Cw .
Vice versa, assume X ∈ Cw . By Proposition 2.15 there exists a short exact sequence
f

g

ε:0→V −
→V −
→X→0
with V , V ∈ add(Vi ) and g is a minimal right add(Vi )-approximation. We call ε a minimal
add(Vi )-resolution of length at most one. Since Vr is Cw -projective–injective, by the minimality
of g we know that V does not contain a direct summand isomorphic to Vr . Let U be the unique
a
submodule of V such that V /U ∼
= Mr r with ar maximal. Clearly, we have
a
U∼
= Vr −r ⊕ V /Vrar .

By Lemma 9.8 and induction, the image of f is contained in U . We have V / Im(f ) ∼
= X. Let
a
Xr−1 := g(U ). We get X/Xr−1 ∼
= Mr r , and by passing to the restriction maps, we obtain a short
exact sequence
f

0 → V −→ Vra−r ⊕ V /Vrar → Xr−1 → 0.
This is an add(Vi )-resolution of Xr−1 . By possibly deleting a direct summand of f of the form
id : Vra− → Vra− , this yields again a minimal add(Vi )-resolution of length at most one of Xr−1 .
The result follows by induction. ✷
For X ∈ CMi ,a set
Mi (X) := M1a1 ⊕ · · · ⊕ Mrar .
Recall that Bi := EndΛ (Vi )op .
For a Λ-module X ∈ Cw we want to compute the dimension vector of the Bi -module
HomΛ (Vi , X). The indecomposable projective Bi -modules are the modules HomΛ (Vi , Vk ),
1 k r. Thus the entries of the dimension vector dimBi (HomΛ (Vi , X)) are
dim HomBi HomΛ (Vi , Vk ), HomΛ (Vi , X)
where 1

k

r. By Corollaries 2.13 and 2.16 we have
HomBi HomΛ (Vi , Vk ), HomΛ (Vi , X) ∼
= HomΛ (Vk , X).

For 1

k

r define
k

:= HomΛ (Vi , Mk ).

(In Section 11 we prove that Bi is a quasi-hereditary algebra and that the k are the corresponding standard modules.) The following result follows directly from Lemma 9.8.
Lemma 10.3. The dimension vectors dimBi (

k ),

1

k

r are linearly independent.

382

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Lemma 10.4. For all 1

k

r we have

dimBi HomΛ (Vi , Vk ) = dimBi (

k ) + dimBi (

k − ) + · · · + dimBi (

kmin ).

Proof. Use the short exact sequence
0 → Vk − → Vk → Mk → 0
and an induction on k.

✷

The next result shows that Lemma 10.4 is just a special case of a general fact.
Proposition 10.5. For a Λ-module X ∈ Cw and a = (a1 , . . . , ar ) the following are equivalent:
(i) X ∈ CMi ,a ;
(ii) There exists a short exact sequence
r

r

Vka−k

0→
k=1

Vkak → X → 0;

→
k=1

(iii) dimBi (HomΛ (Vi , X)) = dimBi (HomΛ (Vi , Mi (X))) =

r
k=1 ak dimBi (

k ).

Proof. (i) ⇒ (ii): Assume X ∈ CMi ,a with a = (a1 , . . . , ar ). By induction we get the following
diagram of morphisms with exact row and columns.
0

0

r−1 ak
k=1 Vk −

Vra−r

r−1 ak
k=1 Vk

Vrar
g

f

0

Xr−1

ι

X

π

0

Mrar

0

0

Since Vr is Cw -projective–injective, there exists a homomorphism g such that π ◦ g = g. Then
[f, g ] : rk=1 Vkar → X is an epimorphism. Let Z := Ker([f, g ]). The Snake Lemma yields an
exact sequence
r−1
h
h
Vka−k −
→Z−
→ Vra−r .
k=1

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

383

Clearly, h is an epimorphism, since f is an epimorphism. For dimension reasons h is a
monomorphism. Thus we get a short exact sequence
r−1
h
h
Vka−k −
→Z−
→ Vra−r → 0.

0→
k=1

Applying HomΛ (Vi , −) to this sequence yields an exact sequence of Bi -modules with a projeca
tive end term. Thus this sequence splits, and we get Z = rk=1 Vk −k . So we constructed a short
exact sequence
r

r

Vka−k →

ηX : 0 →
k=1

Vkak → X → 0.
k=1

(ii) ⇒ (iii): Apply HomΛ (Vi , −) to the short exact sequence ηX . Since Vi is rigid, this yields
a short exact sequence of Bi -modules, and we get
r

r

Vkak

dimBi HomΛ (Vi , X) = dimBi HomΛ Vi ,

Vka−k

− dimBi HomΛ Vi ,

k=1

k=1

r

=

ak dimBi HomΛ (Vi , Vk ) − dimBi HomΛ (Vi , Vk − )
k=1
r

=

ak dimBi (

k ).

k=1

This implies (iii).
(iii) ⇒ (i): Let X ∈ Cw , and assume dimBi (HomΛ (Vi , X)) = rk=1 ak dimBi ( k ). Set a =
(a1 , . . . , ar ). We know that X ∈ CMi ,b for some b = (b1 , . . . , br ). By the implication (i) ⇒ (iii)
r
we get dimBi (HomΛ (Vi , X)) =
k=1 bk dimBi ( k ). Since the vectors dimBi ( 1 ), . . . ,
dimBi ( r ) are linearly independent, we get ak = bk for all k. ✷
Corollary 10.6. For X, Y ∈ Cw we have dimBi (HomΛ (Vi , X)) = dimBi (HomΛ (Vi , Y )) if and
only if X, Y ∈ CMi ,a for some a.
Proof. By Lemma 10.3 the dimension vectors dimBi (
Proposition 10.5. ✷

k)

are linearly independent. Now use

A short exact sequence η : 0 → X → Y → Z → 0 of Λ-modules is called Mi -split if Mi (X) ⊕
Mi (Z) ∼
= Mi (Y ). Recall that FVi := HomΛ (Vi , −).
Corollary 10.7. For a short exact sequence η : 0 → X → Y → Z → 0 of Λ-modules in Cw the
following are equivalent:
(i) η is FVi -exact;
(ii) η is Mi -split.

384

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Proof. Clearly, η is FVi -exact if and only if
dimBi HomΛ (Vi , X) + dimBi HomΛ (Vi , Z) = dimBi HomΛ (Vi , Y ) .
By Proposition 10.5 this happens if and only if Mi (X) ⊕ Mi (Z) ∼
= Mi (Y ).

✷

10.2. Example
Let Q be a quiver with underlying graph
1

2

3

and let w0 be the longest Weyl group element in WQ . Thus we have Cw0 = mod(Λ). The short
exact sequences
η :0→

2

→

1
2

⊕

3
2

→

1

→ 0 and η : 0 →

3
2

1

3
2

→

2
1

3
2

→

2

→0

are exchange sequences in mod(Λ). Let i = (1, 2, 1, 3, 2, 1) and j = (2, 1, 2, 3, 2, 1) be reduced
expressions of w0 . We get
Mi =

1

⊕

1
2

⊕

1
2
3

⊕

2

⊕

2
3

⊕

3

and Mj =

1

⊕

1
2

⊕

1
2
3

⊕

3

⊕

3
2

⊕ 2.

Now one easily observes that η is Mi -split and not Mj -split, and η is Mj -split but not Mi -split.
11. Quasi-hereditary algebras associated to reduced expressions
11.1. Quasi-hereditary algebras
Let A be a finite-dimensional algebra. By P1 , . . . , Pr and Q1 , . . . , Qr and S1 , . . . , Sr we
denote the indecomposable projective, indecomposable injective and simple A-modules, respectively, where Si = top(Pi ) = soc(Qi ).
For a class U of A-modules let F (U) be the class of all A-modules X which have a filtration
0 = X0 ⊆ X1 ⊆ · · · ⊆ Xt = X
of submodules such that all factors Xj /Xj −1 belong to U for all 1 j t. Such a filtration is
called a U -filtration of X. We call these modules the U -filtered modules.
Fix a bijective map ω : {S1 , . . . , Sr } → {1, . . . , r}. Let i be the largest factor module of Pi
such that [ i : Sj ] = 0 for all j with ω(Sj ) > ω(Si ), and set
={

1, . . . ,

r }.

The modules i are called standard modules. The algebra A is called quasi-hereditary if
EndA ( i ) ∼
= K for all i, and if A A belongs to F ( ). Quasi-hereditary algebras first occured
in Cline, Parshall and Scott’s [16] study of highest weight categories.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

385

Note that the definition of a quasi-hereditary algebra depends on the chosen ordering of
the simple modules. If we reorder them, it could happen that our algebra is no longer quasihereditary.
Now assume A is a quasi-hereditary algebra, and let F ( ) be the subcategory of -filtered
A-modules. For X ∈ F ( ) let [X : i ] be the number of times that i occurs as a factor in a
-filtration of X. Then
dim (X) = [X :

1 ], . . . , [X

:

r]

∈ Nr

is the -dimension vector of X. Let ∇i be the largest submodule of Qi such that [∇i : Sj ] = 0
for all j with ω(Sj ) > ω(Si ), and let
∇ = {∇1 , . . . , ∇r }.
The modules ∇i are called costandard modules. The following results (and the missing definitions) can be found in [56,57]:
(i) There is a unique (up to isomorphism) basic tilting module T ( ∩ ∇) over A such that
add T ( ∩ ∇) = F ( ) ∩ F (∇).
F ( ) is closed under extensions and under direct summands.
[Pi : j ] = [∇j : Si ] for all 1 i, j r.
If X ∈ F ( ), then [X : i ] = dim HomA (X, ∇i ) for all i.
HomA ( i , j ) = 0 for all i, j with ω(Si ) > ω(Sj ).
Ext1A ( i , j ) = 0 for all i, j with ω(Si ) ω(Sj ).
The F ( )-projective modules are the projective A-modules. The F (∇)-injective modules
are the injective A-modules.
(viii) The F ( )-injective modules are the modules in add(T ( ∩ ∇)). The F (∇)-projective
modules are the modules in add(T ( ∩ ∇)).
(ix) If Ext1A (X, ∇i ) = 0 for all i, then X ∈ F ( ). Similarly, if Ext1A ( i , Y ) = 0 for all i, then
Y ∈ F (∇).
(ii)
(iii)
(iv)
(v)
(vi)
(vii)

The module T ( ∩ ∇) is called the characteristic tilting module of A. In general, T ( ∩ ∇) is
not a classical tilting module. (Here a tilting module is called classical provided its projective
dimension is at most one.) The endomorphism algebra EndA (T ( ∩ ∇)) is called the Ringel dual
of A. It is again a quasi-hereditary algebra in a natural way, see [56].
Following Ringel [59], the finite-dimensional algebra A is strongly quasi-hereditary if there
is a bijective map ω : {S1 , . . . , Sr } → {1, . . . , r} such that for each 1 k r there is a short exact
sequence
0 → Rk → Pk → Dk → 0
satisfying the following two properties:
(1) Rk is a direct sum of indecomposable projective A-modules Pj with ω(j ) > ω(k);
0 if ω(j ) > ω(k),
(2) [Dk : Sj ] =
1 if j = k.

386

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Each strongly quasi-hereditary algebra is quasi-hereditary with k = Dk for all k. Furthermore,
we have proj.dim( k ) 1 for all k. If each of the modules Rk is indecomposable, then one easily
checks that A is -serial, i.e. each Pk has a unique -filtration.
11.2. The algebra Bi is quasi-hereditary
As before, let Vi = V1 ⊕ · · · ⊕ Vr and Mi = M1 ⊕ · · · ⊕ Mr . Set Bi := EndΛ (Vi )op . For 1
k r let S(k) be the (simple) top of the indecomposable Bi -modules Pk := HomΛ (Vi , Vk ). As
before, define k := HomΛ (Vi , Mk ), and set
:= {

1, . . . ,

r }.

Define ω : {S(1), . . . , S(r)} → {1, . . . , n} by ω(S(k)) := r − k + 1.
The following theorem was first proved in [36, Section 16] for adaptable Weyl group elements.
Later the statement was generalized to arbitrary Weyl group elements by Iyama and Reiten [41].
Here we present a proof for the general case, which is very similar to our original proof of the
adaptable case.
Theorem 11.1. Let i be a reduced expression of a Weyl group element w. The following hold:
(i) The algebra Bi = EndΛ (Vi )op is strongly quasi-hereditary and -serial with standard modules = { 1 , . . . , r };
(ii) The functor HomΛ (Vi , −) yields an equivalence of categories Fi : Cw → F ( );
(iii) T ( ∩ ∇) = HomΛ (Vi , Ti ).
Proof. (i): We know that for each 1

k

r there is a short exact sequence
ι

k
→
Vk → Mk → 0.
η : 0 → Vk − −

We apply the functor HomΛ (Vi , −) to this sequence and obtain a short exact sequence
H
→
0 → HomΛ (Vi , Vk − ) → Pk −

k

→0

of Bi -modules. Let ω(S(j )) ω(S(k)), and let F : HomΛ (Vi , Vj ) → k be a homomorphism of Bi -modules. Since HomΛ (Vi , Vj ) is a projective Bi -module, there is a homomorphism G : HomΛ (Vi , Vj ) → Pk such that H ◦ G = F . There exists a Λ-module homomorphism g : Vj → Vk such that G = HomΛ (Vi , g). Assume ω(S(j )) > ω(S(k)). Since j < k,
we know that Im(g) ⊆ ιk (Vk − ). Thus Im(G) ⊆ Im(HomΛ (Vi , ιk )) = Ker(H ). But this implies
F = 0. Therefore we have [ k : S(j )] = 0. Next, we consider the case ω(S(j )) = ω(S(k)).
The endomorphism ring EndΛ (Vk ) is local, and we work over an algebraically closed field.
Thus g = λidVk + g with g nilpotent and λ ∈ K. We have soc(Vk ) ⊆ Ker(g ). This implies
Im(g ) ⊆ ιk (Vk − ). Thus F = H ◦ G = H ◦ HomΛ (Vi , λidVk ). In other words, HomBi (Pk , k ) is
1-dimensional. This finishes the proof of (i).
(ii): For X, Z ∈ Cw we have a functorial isomorphism
Ext1FV (X, Z) → Ext1Bi HomΛ (Vi , X), HomΛ (Vi , Z) .
i

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

387

Thus the image of the functor
HomΛ (Vi , −) : Cw → mod(Bi )
is extension closed. Clearly, for all 1 k r the standard module k is in HomΛ (Vi , Cw ). It
follows that F ( ) ⊆ HomΛ (Vi , Cw ).
Now let X ∈ Cw . By Lemma 10.2 we know that X ∈ CMi ,a for some a = (a1 , . . . , ar ). Thus
there is a short exact sequence
η : 0 → Xr−1 → X → Mrar → 0.
We claim that η is FVi -exact: Clearly, η is FVr -exact, since Vr is Cw -projective–injective and
Xr−1 ∈ Cw . Since HomΛ (Vk , Mr ) = 0 for all k < r, it follows that η is also FVk -exact for all
such k. Clearly, HomΛ (Vi , Mrar ) is contained in F ( ). By induction also HomΛ (Vi , Xr−1 ) is in
F ( ). Since F ( ) is closed under extensions, and since η is FVi -exact, we get that HomΛ (Vi , X)
is in F ( ). So we proved that F ( ) = HomΛ (Vi , Cw ). Now Corollary 2.13 and Lemma 2.16
show that the restriction functor Fi : Cw → F ( ) is an equivalence of categories.
(iii): It is enough to show that Ext1Λ ( k , Ti ) = 0 for all 1 k r, see Section 11.1. Recall
that all indecomposable direct summands of Ti are of the form M[smax , s] where 1 s r. We
fix such an s.
For each 1 k r there is a short exact sequence
η : 0 → M k − , kmin → M[k, kmin ] → Mk → 0.
Applying HomΛ (Vi , −) yields a projective resolution
0 → HomΛ Vi , M k − , kmin

→ HomΛ Vi , M[k, kmin ] → HomΛ (Vi , Mk ) → 0

of Bi -modules.
If k s, then HomΛ (M[k − , kmin ], M[smax , s]) = 0. Since Fi is an equivalence, we get
HomBi HomΛ Vi , M k − , kmin , HomΛ Vi , M[smax , s]

= 0.

This implies Ext1Bi ( k , HomΛ (Vi , M[smax , s])) = 0.
Next, assume that k > s. We have a short exact sequence
ψ : 0 → M s − , smin → M[smax , smin ] → M[smax , s] → 0.
Applying HomΛ (−, Mk ) yields Ext1Λ (M[smax , s], Mk ) = 0. Thus Ext1Λ (Mk , M[smax , s]) = 0.
This implies
Ext1FV Mk , M[smax , s] = Ext1Bi
i

k , HomΛ

Vi , M[smax , s]

= 0.

Here we used that Ext1Λ (M[smax , smin ], Mk ) = 0 (since M[smax , smin ] is Cw -projective–injective),
and HomΛ (M[s − , smin ], Mk ) = 0 by Lemma 9.8. This finishes the proof of (iii). ✷
Corollary 11.2. The modules HomΛ (Vi , Ii,j ), 1
projective–injectives modules.

j

n are the indecomposable F ( )-

388

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Proof. This follows from Theorem 11.1(iii) and Section 11.1.
Each
lows:

✷

-filtration of the indecomposable projective Bi -module HomΛ (Vi , Vk ) looks as fol-

k
k−

···
k min

(We just displayed the factors of the (unique) -filtration of HomΛ (Vi , Vk ).)
We can now reformulate parts of Proposition 10.5 as follows:
Proposition 11.3. For a Λ-module X ∈ Cw and a = (a1 , . . . , ar ) the following are equivalent:
(1) X ∈ CMi ,a ;
(2) dim (Fi (X)) = (a1 , . . . , ar ).
Proof. Since
lent. ✷

k

= HomΛ (Vi , Mk ), it is clear that (iii) in Proposition 10.5 and (2) are equiva-

We know that Bi is an algebra of finite global dimension. Thus one can define the Ringel form
X, Y

Bi

j

:= dim(X), dim(Y ) B :=

(−1)j dim ExtBi (X, Y ).

i

j

The next lemma gives the values of −, −
Lemma 11.4. For 1

k,

s Bi

Bi

0

applied to standard modules.

r we have

k, s

⎧
⎨0
= dim HomBi ( k , s ) − dim Ext1Bi ( k , s ) = 1
⎩ (M , M )
k
s Q

Proof. As before, for 1 t r we set Pt := HomΛ (Vi , Vt ) and
that proj.dim( t ) 1 for all t. Thus
k,

s Bi

= dim HomBi (

k,

t

if k < s,
if k = s,
if k > s.

:= HomΛ (Vi , Mt ). We know

1
s ) − dim ExtBi (

k,

s ).

The cases k < s and k = s are clear, see Section 11.1. Thus, assume k > s. The short exact
sequence
0 → Vk − → Vk → Mk → 0
yields a projective resolution
0 → Pk − → Pk →

k

→0

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

of

k.

389

We apply HomΛ (−, Ms ) and obtain an exact sequence

0 → HomBi (

k,

s ) → HomBi (Pk ,

s ) → HomBi (Pk − ,

1
s ) → ExtBi (

k,

s ) → 0.

This implies
k,

s Bi

= dim HomBi (Pk ,

s ) − dim HomBi (Pk − ,

s)

= dim HomΛ (Vk , Ms ) − dim HomΛ (Vk − , Ms )
= (Mk , Ms )Q .
✷

For the third equality we use Lemma 9.8.
11.3. Example

For an arbitrary Cw -maximal rigid Λ-module T , it seems to be difficult to determine when
EndΛ (T )op is quasi-hereditary and when not.
Even if Q is a quiver with underlying graph
1

3

2

there are maximal rigid modules whose endomorphism algebra is not quasi-hereditary: Let w =
w0 be the longest Weyl group element in WQ . Let T be the Cw -maximal rigid Λ-module
2
3

⊕

⊕

2
1

3

2
1

⊕

1
2
3

⊕

2
1

⊕

3
2

3
2

.

1

The quiver of EndΛ (T )op looks as follows:
2

2
3

1

1

2
3

1

2
2

1
3

3
3

2

2
1

It is not difficult to show that EndΛ (T )op is not a quasi-hereditary algebra.
12. Mutations of clusters via dimension vectors
12.1. Dimension vectors of rigid modules
Let A be a finite-dimensional K-algebra. For m 0 let Am be the free A-module of rank
m. By mod(A, m) we denote the affine variety of m-dimensional A-modules. (One can define
mod(A, m) as the variety of K-algebra homomorphisms A → Mm (K).) If U is a submodule of
Am such that Am /U is m-dimensional, then the Richmond stratum S(U, Am ) is the subset of
mod(A, m) consisting of the modules X such that there exists a short exact sequence

390

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

0 → U → Am → X → 0,
see [54]. A more general situation was studied by Bongartz [10].
Theorem 12.1. (See [54, Theorem 1].) The Richmond stratum S(U, Am ) is a smooth, irreducible,
locally closed subset of mod(A, m), and
dim S U, Am = dim HomA U, Am − dim EndA (U ).
Proposition 12.2. Assume that gl.dim(A) < ∞. Let M and N be rigid A-modules of projective
dimension at most one. If dim(M) = dim(N ), then M ∼
= N.
Proof. Let m be the K-dimension of M and N . Thus, there are projective resolutions
0 → P → Am → M → 0 and 0 → P → Am → N → 0
of M and N , respectively. Here we used that the projective dimensions of M and N are at
most one. Since dim(M) = dim(N ), we get dim(P ) = dim(P ). Since A is a finite-dimensional
algebra of finite global dimension, its Cartan matrix is invertible. In other words, the dimension vectors of the indecomposable projective A-modules are linearly independent. Thus we get
P∼
=P .
Since M and N are rigid, their GLm (K)-orbits are open in mod(A, m). In particular, these
orbits are open in the Richmond stratum S(P , Am ). But S(P , Am ) is irreducible, and therefore
it can contain at most one open orbit. It follows that M ∼
= N. ✷
Now, let Cw = Fac(Vi ) be defined as before, and let T = T1 ⊕ · · · ⊕ Tr be a fixed basic Cw maximal rigid module and set B := EndΛ (T )op .
Corollary 12.3. Let X and Y be indecomposable rigid modules in Cw . If
dimB HomΛ (T , X) = dimB HomΛ (T , Y ) ,
then X ∼
= Y.
Proof. Use Corollary 2.17 and Proposition 2.19(vi), and then apply Proposition 12.2.

✷

12.2. Mutations via dimension vectors
We now explain how to calculate mutations of clusters via dimension vectors. We start with
some notation: For d = (d1 , . . . , dr ) and f = (f1 , . . . , fr ) in Zr define
max{d, f} := (h1 , . . . , hr )
where hs = max{ds , fs } for 1 s r. Set Max{d, f} := d if ds fs for all s. In this case, we
write d f. Of course, Max{d, f} = d implies max{d, f} = d. By |d| we denote the sum of the
entries of d.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

391

Let Γ be a quiver without loops and without 2-cycles and with vertices 1, . . . , r. Some of
these vertices can be considered as frozen vertices, i.e. one cannot perform a mutation at these
vertices.
Now replace each vertex s of Γ by some ds ∈ Zr . Thus we obtain a new quiver Γ whose
vertices are elements in Zr .
For k not a frozen vertex, define the mutation μdk (Γ ) of Γ at the vertex dk in two steps:
(1) Replace the vertex dk of Γ by
d∗k := −dk + max

di ,
di →dk

dj
dk →dj

where the sums are taken over all arrows in Γ which start, respectively end in the vertex dk .
(2) Change the arrows of Γ following Fomin and Zelevinsky’s quiver mutation rule for the
vertex dk .
Thus starting with Γ we can use iterated mutation and obtain quivers whose vertices are
elements in Zr .
For example, if for each s we choose ds = −es , where es is the sth canonical basis vector
of Zr , then the resulting vertices (i.e. elements in Zr ) are the denominator vectors of the cluster variables of the cluster algebra A(B(Γ )◦ ) associated to Γ , compare with [26, Section 7,
Eq. (7.7)]. (The variables attached to the frozen vertices serve as (non-invertible) coefficients. To
obtain the denominator vectors as defined in [26] one has to ignore the entries corresponding to
these n coefficients.) It is an open problem, if these denominator vectors actually parametrize the
cluster variables of A(B(Γ )◦ ).
We will show that for an appropriate choice of Γ and of the initial vectors ds , the quivers
obtained by iterated mutation of Γ are in bijection with the seeds and clusters of A(B(Γ )◦ ).
All resulting vertices (including the ds ) will be elements in Nr , and we will show that for our
particular choice of initial vectors, we can use “Max” instead of “max” in the formula above.
(This holds for all iterated mutations.)
For the rest of this section let T = T1 ⊕ · · · ⊕ Tr be a basic Cw -maximal rigid Λ-module, and
set B := EndΛ (T )op .
Proposition 12.4. Let R = R1 ⊕ · · · ⊕ Tr be a basic Cw -maximal rigid Λ-module. Let
f

g

η : 0 → Rk −→ R −→ Rk∗ → 0

f

g

and η : 0 → Rk∗ −−→ R −→ Rk → 0

be the two exchange sequences associated to an indecomposable direct summand Rk of R which
is not Cw -projective–injective. Then dim HomΛ (T , R ) = dim HomΛ (T , R ), and we have
dimB HomΛ (T , Rk ) + dimB HomΛ T , Rk∗
= max dimB HomΛ T , R
Furthermore, the following are equivalent:

, dimB HomΛ T , R

.

392

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

(i) η is FT -exact;
(ii) dim HomΛ (T , R ) > dim HomΛ (T , R );
(iii) dimB (HomΛ (T , R )) dimB (HomΛ (T , R )).
Proof. By Corollary 2.18 we know that HomΛ (T , R) is a classical tilting module over B. Thus
we can apply [39, Lemma 2.2] and assume without loss of generality that
Ext1B HomΛ (T , Rk ), HomΛ T , Rk∗

= 0.

By Proposition 2.12,
1 = dim Ext1Λ Rk∗ , Rk

dim Ext1FT Rk∗ , Rk
= dim Ext1B HomΛ T , Rk∗ , HomΛ (T , Rk ) > 0.

This implies Ext1Λ (Rk∗ , Rk ) = Ext1FT (Rk∗ , Rk ). Thus η is FT -exact, and
HomΛ T ,f

HomΛ T ,g

η : 0 → HomΛ (T , Rk ) −−−−−−−→ HomΛ T , R −−−−−−−→ HomΛ T , Rk∗ → 0
is a (non-split) short exact sequence. If we apply HomΛ (T , −) to η , we obtain an exact sequence
HomΛ T ,f

0 → HomΛ T , Rk∗ −−−−−−−−→ HomΛ T , R

HomΛ T ,g

−−−−−−−→ HomΛ (T , Rk ).

Now HomΛ (T , g ) cannot be an epimorphism, since that would yield a non-split extension
and we know that Ext1B (HomΛ (T , Rk ), HomΛ (T , Rk∗ )) = 0. Thus for dimension reasons we
get dim HomΛ (T , R ) > dim HomΛ (T , R ). Using the functors HomB (P , −) where P runs
through the indecomposable projective B-modules, it also follows that dimB (HomΛ (T , R )) >
dimB (HomΛ (T , R )). Finally, the formula for dimension vectors follows from the exactness
of η. ✷
Proposition 12.4 yields an easy combinatorial rule for the mutation of Cw -maximal rigid
modules. Let R = R1 ⊕ · · · ⊕ Rr be a basic Cw -maximal rigid Λ-module. Without loss of
generality we assume that Rr−n+1 , . . . , Rr are Cw -projective–injective. For 1 s r let ds :=
dimB (HomΛ (T , Rs )).
As before, let ΓR be the quiver of EndΛ (R)op . The vertices of ΓR are labeled by the modules
Rs . For each s we replace the vertex labeled by Rs by the dimension vector ds . The resulting
quiver is denoted by ΓR .
For 1 k r − n let
0 → Rk → R → Rk∗ → 0 and 0 → Rk∗ → R → Rk → 0
be the two resulting exchange sequences. We can now easily compute the dimension vector of
the EndΛ (T )op -module HomΛ (T , Rk∗ ), namely Proposition 12.4 yields that
d∗k := dimB HomΛ T , Rk∗

=

−dk +

di →dk

di

if

−dk +

dk →dj

dj

otherwise,

di →dk

|di | >

dk →dj

|dj |,

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

393

where the sums are taken over all arrows in ΓR which start, respectively end in the vertex dk .
More precisely, we have
d∗k = −dk + max

di ,
di →dk

(5)

dj
dk →dj

and we know that
max

dj = Max

di ,
di →dk

di ,

dk →dj

di →dk

dj .

(6)

dk →dj

Remark 12.5. Let T = T1 ⊕ · · · ⊕ Tr be a basic Cw -maximal rigid module, and let B (T ) :=
( Si , Sj )1 i,j r be the matrix of the Ringel form of the algebra B := EndΛ (T )op . Let X be a
T -reachable Λ-module, see Section 3.1. Set d := dimB (HomΛ (T , X)) ∈ Nr . Define
g˜ T (X) := d · B (T ) ,
where d is considered as a row vector. As explained in [27, Section 4] the entries of g˜ T (X),
which correspond to the non-Cw -projective–injective direct summands Tk of T form precisely
the g-vector of ϕX with respect to the initial cluster (δT1 , . . . , δTr ).
12.3. Examples (Dimension vectors of Bi -modules)
Let Q be a quiver with underlying graph 1
Γi looks as follows:

3 and let i := (3, 1, 2, 3, 1, 2). Thus

2

5

2
4

1

6

3

The following picture shows the quiver ΓVi of EndΛ (Vi )op where the vertices corresponding to
the modules Vk .
3

2

2

1

1

2
1

3

2

2

1

2

2
3

3

394

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Here is the quiver ΓVi whose vertices are the dimension vectors dimBi (HomΛ (Vi , Vk )):

1

1
1

1

0
0

0

1

1
1

0

1

1
1

1
0

1

1

0
1

0
0

1
2

1

1
1

0
1

0
0

1

1
1

0
1

Next, let us look at an example of type A2 . Thus, let Q be a quiver with underlying graph

3
1

2

and let i := (3, 2, 1, 3, 2, 1). The quiver ΓVi of EndΛ (Vi )op looks as follows:

1
1
2

2

1

3
1

1
1
1

2
3

2

1

3

2

1
2

1
1
1
2

2
3

1

3
1

2
3

2

1
1

2
3

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

395

Here is the quiver ΓVi :
3

1
4

5

2
1

2

3

2
4

2

3

0
2

1
3

1

0
2

1
2

0
3

1

1
3

1
0

0
2

1

2

1
1

0
1

12.4. Example (Mutations via dimension vectors)
Let Q be a quiver with underlying graph 1
3 and let i := (i7 , . . . , i1 ) :=
2
(1, 3, 2, 1, 3, 2, 1) be a reduced expression. As before, let Vi = V1 ⊕ · · · ⊕ V7 . The indecomposable Cw -projective–injectives are V5 , V6 and V7 . Let us compute the dimension vectors
dimBi (HomΛ (Vi , Mk )).
dim(
dim(

1) =
5) =

9

3
6

4
2

2
0
1

1

1

2) =

dim(

2
0

6) =

dim(

0
0

6

2
4

3
0

1
0
0

1

0

dim(

1
0

dim(

0
0

3) =
7) =

2

0
1

0
1

0

1
0
0

0

dim(

0
0
0

4) =

3

1
2

2

0
0

0

.

0

Here is the quiver Γi :
4

7

1

5

2
3

6

The following picture shows the quiver ΓVi . Its vertices are the dimension vectors of the
EndΛ (Vi )op -modules HomΛ (Vi , Vk ). These dimension vectors can be constructed easily using
Lemma 9.8.
13

4
8

6

1

12

2
2

6

8

2
5

4

2

0
1

1

0

1

9

2
2

4

6

0

2
4

3

1

2

0
1

0

0
0

1

3
6

1

0
1

4
8

0
1

1

1
2

2

396

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Now let us mutate the Λ-module V4 . We have
12

dimBi HomΛ (Vi , V4 ) =

4
8

6

1

.

2
2

We have to look at all arrows starting and ending in the corresponding vertex of ΓVi , and add up
the entries of the attached dimension vectors, as explained in Section 12.2. Since
13

4
8

6

1
2

2

+2·

6

2
4

3

0
1

1

9

= 70 > 69 =

3
6

4

1

+2·

2
2

8

2
5

4

0

,

1
1

we get
dimBi HomΛ Vi , V4∗
and the quiver ΓμV

4

4
8

6

13

4
8

6

1

13
6

2
5

4

0

1

4
8

8

1

+2·

2

2
2

2

1
2

6

2
4

3

0
1

1

−

12

4
8

6

1
2

2

=

13

4
8

6

0
2

2

looks as follows:

(Vi )

13

=

0

9

2
2

4

6

0

3

1

2

0

0
1

0

1

2
4

1

0

3
6

1
2

2

0
1

1

0
0

1

Note that we cannot control how the arrows between vertices corresponding to the three indecomposable Cw -projective–injectives behave under mutation. But this does not matter, because
these arrows are not needed for the mutation of seeds and clusters. In the picture, we indicate the
missing information by lines of the form
. This process can be iterated, and our theory
says that each of the resulting dimension vectors determines uniquely a cluster variable.
12.5. Mutations via

-dimension vectors

Using Lemma 9.8 we can explicitly compute the dimension vector of the Bi -module s =
HomΛ (Vi , Ms ) for all 1 s r. Recall that the kth entry of this dimension vector is just
dim HomΛ (Vk , Ms ). Thus, the K-dimension of s is
r

dim(

s ) = dim HomΛ (Vi , Ms ) =

dim HomΛ (Vk , Ms ).
k=1

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

397

Define
d := dim(

1 ), . . . , dim(

r)

.

Now let R = R1 ⊕ · · · ⊕ Rr be a basic Cw -maximal rigid Λ-module, and suppose that Rk
is not Cw -projective–injective. Then we can mutate R in direction Rk . We obtain two exchange
sequences
0 → Rk → R → Rk∗ → 0

and 0 → Rk∗ → R → Rk → 0

with R , R ∈ add(R/Rk ).
For brevity, set
ds := dim

HomΛ (Vi , Rs )

for all 1 s r. Similarly to the definition of ΓR in Section 12.2 let ΓR be the quiver which
is obtained from the quiver of EndΛ (R)op by replacing the vertex corresponding to Rs by the
-dimension vector ds .
For d = (d1 , . . . , dr ) and f = (f1 , . . . , fr ) in Zr define
r

d · f :=

di fi .
i=1

Proposition 12.6. The

d∗k :=

-dimension vector of the Bi -module HomΛ (Vi , Rk∗ ) is

−dk +
−dk +

di
dk →dj dj
di →dk

if di →dk di · d >
otherwise.

dk →dj

dj · d ,

Here the sums are taken over all arrows of the quiver of ΓR which start, respectively end in the
vertex dk .
Proof. This follows immediately from our results in Section 12.2
12.6. Example (Mutations via

✷

-dimension vectors)

We repeat Example 12.4, but this time we work with -dimension vectors. Let Q and i be as
before. The following picture shows the quiver ΓVi . Its vertices are the -dimension vectors of
the EndΛ (Vi )op -modules HomΛ (Vi , Vk ).

398

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433
1

1
0

0

1

0

0
0

0

0

0
1

0

0

0
0

1

1
0

1

0

0
0

0

0

0

1

0
0

0

0

0

0

0
0

0
0

1

0
0

1
0

0

0
1

0

0
0

1

Again, let us mutate the Λ-module V4 . We have
HomΛ (Vi , V4 ) =

dim

0

1
0

0

1
0

.

0

We have to look at all arrows starting and ending in the corresponding vertex of ΓVi , and to
add up the entries of the attached -dimension vectors, as explained in the previous section.
In this example it is clear that the ingoing arrows yield the required larger dimension, since the
calculation with outgoing arrows would produce a -dimension vector with negative entries,
which is not possible. Thus the quiver ΓμV (Vi ) looks as follows:
4

1

1
0

0

1

1

0
0

0

0

0
1

0

0

0
0

1

0
0

0

0

2
0

0

0

0

1

0
0

0

0

0

0

0
0

0
0

1

0
0

1
0

0

0
1

0

0
0

1

13. A sequence of mutations from Vi to Ti
13.1. The algorithm
Let i := (ir , . . . , i1 ) be a reduced expression of a Weyl group element. For 1
qij :=

−cij
0

i, j

n set

if i = j ,
otherwise.

(The cij are the entries of the Cartan matrix C of our Kac–Moody Lie algebra g, see Section 4.1.
Note that this definition of qij is equivalent to the one in Section 2.4.) As before, we define a
quiver Γi as follows: The vertices of Γi are 1, 2, . . . , r. For 1 s, t r there are qis ,it arrows
from s to t provided t + s + > t > s. These are called the ordinary arrows of Γi . Furthermore,

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

399

for each 1 s r there is an arrow s → s − provided s − > 0. These are the horizontal arrows
of Γi .
As before, let Vi = V1 ⊕ · · · ⊕ Vr and Mi = M1 ⊕ · · · ⊕ Mr . We know that the quiver Γi can
be identified with the quiver ΓVi of the endomorphism algebra Bi = EndΛ (Vi )op . The vertices
of ΓVi are labeled by V1 , . . . , Vr . More precisely, the vertex s of Γi corresponds to the vertex
Vs = M[s, smin ] of ΓVi , where 1 s r.
Recall that for 1 j n and 1 k r + 1, we defined
k[j ] := {1

k − 1 | is = j } ,

s

tj := (r + 1)[j ],
kmin := min{1

s

r | is = ik }.

Now we describe an algorithm which yields a sequence of mutations starting with ΓVi and ending
with ΓTi (see Section 9.8 for the definition of Ti ). The proof is done by induction on r − n.
Before going into details let us describe the general idea of this algorithm. Assume that Q is
the linearly oriented quiver
m−1

m

···

2

1

of type Am . We would like to find a sequence of mutations which transforms Q into the quiver
Qop
m−1

m

···

2

1

with opposite linear orientation. This can be done by applying the following m − 1 sequences of
mutations:
Q1 := μm−1 · · · μ2 μ1 (Q),

Q2 := μm−2 · · · μ2 μ1 Q1 ,

...,

Qm−1 := μ1 Qm−2 .

Now one easily checks that Qm−1 = Qop . If we delete all ordinary arrows of Γi we obtain a
disjoint union of linearly oriented quivers of type Ami for various mi 1. The main idea of
the following algorithm is to apply a sequence of mutations to Γi which (in the same way as
explained above) reverses the orientation of these subquivers of type Ami without causing too
many changes for the remaining ordinary arrows.
In the following, we just ignore the symbols of the form M[a, b] in case a < b.
Step 1. We mutate the following
r1 := ti1 − 1 − 1[i1 ]
vertices of ΓV0i := ΓVi in the given order:
(1[i ])

(1[i ])

M 1min1 , 1min1

(1[i ]+1)

, M 1min1

(1[i ])

, 1min1

(1[i ]+2)

, M 1min1

(1[i ])

, 1min1

(ti −2)

1
, . . . , M 1min

(1[i ])

, 1min1

.

400

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Under the identification ΓVi ≡ Γi , this sequence of mutations corresponds to the sequence of
mutations
−→
μ1 := μ (r1 −1)
1
min

◦ · · · ◦ μ1(1) ◦ μ1min .
min

We obtain a new quiver ΓV1i with r1 new vertices
(1[i ]+1)

M 1min1

(1[i ]+1)

(1[i ]+2)

, 1min1

(ti −1)

1
M 1min

, M 1min1

(1[i ]+1)

, 1min1

(1[i ]+1)

, 1min1

(1[i ]+3)

, M 1min1

(1[i ]+1)

, 1min1

,...,

.

Step 2. We mutate the following
r2 := ti2 − 1 − 2[i2 ]
vertices of ΓV1i in the following order:
(2[i ])

(2[i ])

M 2min2 , 2min2

(2[i ]+1)

, M 2min2

(2[i ])

, 2min2

(2[i ]+2)

, M 2min2

(2[i ])

, 2min2

(ti −2)

2
, . . . , M 2min

(2[i ])

, 2min2

.

This mutation sequence corresponds to
−→
μ2 := μ (r2 −1)
2
min

◦ · · · ◦ μ2(1) ◦ μ2min .
min

We obtain a new quiver ΓV2i with r2 new vertices
(2[i ]+1)

M 2min2
M

(2[i ]+1)

(2[i ]+2)

, 2min2

, M 2min2

(ti2 −1) (2[i2 ]+1)
2min
, 2min

(2[i ]+1)

, 2min2

(2[i ]+3)

, M 2min2

(2[i ]+1)

, 2min2

,...,

.

Step k. We mutate the following
rk := tik − 1 − k[ik ]
vertices of ΓVk−1
in the following order:
i
(k[i ])

(k[i ])

M kmink , kmink

(k[i ]+1)

, M kmink

(k[i ])

, kmink

(k[i ]+2)

, M kmink

(k[i ])

, kmink

(ti −2)

, . . . , M kmink

(k[i ])

, kmink

This mutation sequence corresponds to
−→
μk := μ (rk −1)
k
min

◦ · · · ◦ μk (1) ◦ μkmin .
min

We obtain a new quiver ΓVki with rk new vertices
(k[i ]+1)

M kmink
M

(k[i ]+1)

, kmink

(ti −1) (k[i ]+1)
kmink , kmink

(k[i ]+2)

, M kmink
.

(k[i ]+1)

, kmink

(k[i ]+3)

, M kmink

(k[i ]+1)

, kmink

,...,

.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

401

The algorithm stops when all vertices are of the form M[kmax , k]. This will happen after
n

tj (tj − 1)
2

r(i) :=
j =1

mutations. Define
μ→r ◦ · · · ◦ −
μ→2 ◦ −
μ→1 .
μi := −
Thus we have
μi (Vi ) = Ti .
As an example, assume Q is a Dynkin quiver of type E8 . Thus the underlying graph of Q
looks as follows:
7
5

6

8

3

4

2

1

Let c := s8 s7 s6 s5 s4 s3 s2 s1 . Then w := c15 is the longest element in the Weyl group W of Q,
and i := (8, . . . , 2, 1, . . . , 8, . . . , 2, 1) is a reduced expression (with 120 entries) of w. We get
tj = 15 for all 8 vertices j of Q. Then our algorithm says that starting with Vi we reach Ti after
r(i) = 8 · 105 = 840 mutations.
when we apply the mutation
We now want to describe what happens to the quiver ΓVk−1
i
μ→k . First, we need some notation:
sequence −
For each 1 j n let
pj := min{1

r | is = j },

s

uj := min{0, k

s

r | is = j }.

(0)

Note that pj = pj . The sequence
(0)

(ruj −1)

(1)

pj , pj , . . . , pj

of vertices of ΓVk−1
is called the j -chain of ΓVk−1
, provided uj = 0. If uj = 0, then we have an
i
i
empty j -chain. The sequence
(0)

(t −1)

(1)

pj , pj , . . . , pj j

is the extended j -chain.
given by the vertices of a single extended j -chain looks as folEach full subgraph of ΓVk−1
i
lows:
(t −1)

pj j

···

(ruj +1)

pj

(ruj )

pj

(ruj −1)

pj

···

(2)

pj

(1)

pj

(0)

pj

402

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

The arrows of the extended j -chains (1
mutation sequence

n), are the horizontal arrows of ΓVk−1
. In the
i

j

−→
−→ −→
μr ◦ · · · ◦ −
μ−k+1
◦ μk

(ruj )

there are no mutations at the vertices pj

(ruj +1)

, pj

(t −1)

, . . . , pj j

. These are called the frozen

ΓVk−1
.
i

vertices of
To describe the quiver ΓVki , it is enough to study the effect of −
μ→k on the n − 1 full subgraphs
k
of ΓVi which consist of the ik -chain together with one extended j -chain, where 1 j n and
j = ik .
For brevity, set s = s (0) = kmin , t = t (0) = pj . Let q = qik ,j be the number of edges between
ik and j in the underlying graph of Q. The following picture shows how the arrows between the
look like (we have 1 j n with ik = j , and we use
ik -chain and an extended j -chain in ΓVk−1
i
the notation u q v if there are q arrows from u to v):

s (az )

···

s (az−1 )

q

q

t (bz )

q

q

s (a2 )
q

···

t (bz−1 )

q

s (a1 )
q

t (b2 )

q

t (b1 )

Here s (ai ) belongs to the ik -chain, and t (bi ) belongs to the extended j -chain for all 1 i z.
(The q arrows from s (az ) to t (bz ) do not exist necessarily. But the first q arrows between the
ik -chain and the j -chain (counted from the right) always start at the ik -chain. We do not display
any arrows between frozen vertices, they don’t play any role.)
μ→k consists of mutations at the vertices s (0) , s (1) , . . . , s (rk −1) . By defThe mutation sequence −
inition,
.
μ→k ΓVk−1
ΓVki := −
i
After applying −
μ→k , the horizontal arrows of the ik -chain stay the same, except the arrow
(r
)
(r
−1)
k
k
→s
changes its orientation and becomes s (rk ) ← s (rk −1) . The vertex s (rk −1) becomes
s
an additional frozen vertex of ΓVki .
The arrows between the ik -chain and the j -chain change as follows:
s (az −1)
q

t (bz )

···

s (az−1 −1)
q

q

t (bz−1 )

q

s (a2 −1)
q

···

q

t (b2 )

(In case s (a1 ) = s, the q arrows from s (a1 −1) to t (b1 ) do not exist.)

s (a1 −1)
q

q

t (b1 )

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

403

We illustrate this again in a more explicit example: Here is a possible subgraph before we
apply −
μ→k , where rk = 8 and ruj = 6:
s (tik −1)

···

s (8)

s (7)
q

t (tj −1)

···

t (8)

s (6)
q

t (7)

s (5)
q

s (4)

s (3)

q

t (6)

t (5)

s (2)
q

t (4)

t (3)

q

s (1)

s (0)

t (1)

t (0)

q

t (2)

(The numbers rk and ruj are determined by the orientation of the horizontal arrows in the above
picture.)
This is how it looks like after we applied −
μ→k to the rk vertices of the ik -chain:
s (tik −1)
t (tj −1)

···

s (8)

···

t (8)

s (7)

s (6)

s (5)

q

q

q

t (7)

t (6)

t (5)

s (4)

s (3)

s (2)

q

t (4)

q

t (3)

s (1)
q

t (2)

s (0)

q

t (1)

t (0)

Again, possible arrows between frozen vertices are not shown.
Note that if we start with our initial Cw -maximal rigid module Vi , and if we only perform the
r(i) mutations described in the algorithm, then we obtain the subset
M[b, a] 1

a

b

r, ia = ib

of the set of indecomposable rigid modules of Cw . In particular, this subset contains all modules Mk = M[k, k] where 1 k r. The next theorem describes the precise exchange relation
obtained in each of the r(i) steps of the algorithm above.
We use our description of mutations via -dimension vectors from Section 12.5 in order to
(k[i ])
(k[i ])
(k[i ]+1)
show that the mutation M[s, smin s ]∗ of M[s, smin s ] is indeed M[s + , smin s
].
In formula (7) below we just write M[b, a] instead of δM[b,a] . (Recall that for any Λ-module
X and any constructible function f ∈ M we have δX (f ) := f (X). This defines an element δX
in M∗ .)
Theorem 13.1 (Generalized determinantal identities). Let Mi = M1 ⊕ · · · ⊕ Mr . Then for 1
k, s r with is = ik we have
(k[i ])

M s, smin s

(k[i ]+1)

· M s + , smin s
(k[i ])

= M s + , smin s

(k[i ]+1)

· M s, smin s

(k[i ]) qis it

+

M t, tmin t
t + s + >t>s

(k[i ]) qis il

·

M l, lminl

.

(7)

l + s + >s>l>smin

Proof. Formula (7) is just an exchange relation corresponding to the mutation of the mod(k[i ])
(k[i ])
(k[i ]+1)
ule M[s, smin s ] with M[s, smin s ]∗ = M[s + , smin s
]. More precisely, the mutation of
(k[is ])
M[s, smin ] happens during the mutation sequence −
μ→k , which is part of the mutation sequence
μi . ✷

404

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Remark 13.2. It is not hard to see that the above theorem can be also stated as follows: For
1 t < s r with is = ij = i we have
M s, t + M s − , t = M[s, t] M s − , t + +

M s − (j ), t + (j )

qij

,

j ∈I \{i}

where in addition to the notation in 9.8 we set t + (j ) := min{r + 1, t + 1 k r | ik = j }. Fomin
and Zelevinsky [22, Theorem 1.17] prove generalized determinantal identities associated to pairs
of Weyl group elements for all Dynkin cases (including the non-simply laced cases). Using the
material of Section 7, formula (7) can be seen as a generalization of some of their identities to
the symmetric Kac–Moody case.
Corollary 13.3. The functions δM1 , . . . , δMr are algebraically independent. In particular,
C[δM1 , . . . , δMr ], the subalgebra of M∗ generated by the δMk ’s is just a polynomial ring in
r variables.
Proof. Clearly, the functions δM[1,1min ] , . . . , δM[r,rmin ] are algebraically independent, since Vk =
M[k, kmin ] and any product of the functions δV1 , . . . , δVr lies in the dual semicanonical basis.
Here we use that Vi is rigid and then we apply [31, Theorem 1.1]. We claim that each function
δM[b,a] with 1 a b r and ia = ib is a rational function in δM1 , . . . , δMb . In particular,
each δVk is a rational function in δM1 , . . . , δMr . This implies that δM1 , . . . , δMr are algebraically
independent.
We prove our claim by induction on r and on the length l([b, a]) := |{a k b | ik = ib }| of
the interval [b, a]. For r = 1 the statement is clear. Also, if l([b, a]) = 1, then M[b, a] = Mb and
we are done as well. Thus assume by induction that our claim is true for all intervals [d, c] of
length at most m for some m 1. All intervals of length m + 1 are of the form [b+ , a] for some
(k[i ])
1 a b r. We have a = bminb for some 1 k r. We also assume by induction that our
claim holds for all intervals [d, c] with b+ > d. Our formula (7) yields
M b+ , a =

1
· M[b, a] · M b+ , a +
M[b, a + ]
−

1
·
M[b, a + ]

(k[it ])
M t, tmin
t + b+ >t>b

qib it

(k[il ])
M l, lmin

·

qib il

.

l + b+ >b>l>bmin

(8)
The intervals on the right hand side of this equation all have either length at most m, or they are
of the form [d, c] with b+ > d. This finishes the proof. ✷
In fact, we will show that for any Λ-module X ∈ Cw we have δX ∈ C[δM1 , . . . , δMr ], see Theorem 15.1. In particular, for all 1 k r the rational function δVk is a polynomial in δM1 , . . . , δMr .
Another proof of the polynomiality of the functions δM[b,a] was found by Kedem and
Di Francesco [21, Lemma B.7], using ideas of Fomin and Zelevinsky (in particular [9,
Lemma 4.2]). We thank these four mathematicians for communicating their insights to us at
MSRI in March 2008.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

405

13.2. Example
Let Q be a quiver with underlying graph
3
2

1

2

2

3

Here we use the notation i a j if there are a edges between i and j . Let i :=
(i10 , . . . , i1 ) := (2, 3, 2, 1, 2, 1, 3, 1, 2, 1). This is a reduced expression for a Weyl group element
in WQ . The quiver Γi looks as follows:
5

7
3

3

3

2

8

10

3
3

3

2

6

2
2

2

2

1

2

2

9

4

For the mutation sequence μi we get
−→ −→
μi = −
μ−→
10 ◦ · · · ◦ μ2 ◦ μ1

= (id) ◦ (id) ◦ (μ2 ) ◦ (id) ◦ (μ6 μ2 ) ◦ (μ1 ) ◦ (μ4 ) ◦ (μ3 μ1 ) ◦ (μ8 μ6 μ2 ) ◦ (μ5 μ3 μ1 ).
Here are the quivers Γik :
Γi1

3

5

7
3

1

3

3
2

8

10

6

2
2

2

2

2

9

4

Γi2
3

10

3

5

7
3

3

6

8

9

2

3

2
2

2

1

2

2

4

406

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Γi3

5

7
3

10

3

3

3
2

6

8
2

1

2

3

2

2

9

4

Γi4

5

7
3

3

1

3

3

3

2

10

2

6

8
2

2

2

9

4

Γi5

5

7
3

3

1

3

3
2

10

2

6

8
2

2

2

9

4

Γi6 = Γi7

5

7
3

10

2

3

8

3
3

3
2

6

2

1

2

2

2

2

9

4

Γi8 = Γi9 = Γi10

5

7
3

10

8
2

9

2

3

3
3

3

1

2

6

2

2

2

4

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

407

(2[i ])

(k[i ])

Applying formula (7) to M[s, smin s ] := M[6, 6min6 ] = M[6, 2] we get the following:
M[6, 2] · M[8, 6] = M[8, 2] · M[6, 6] + M[7, 3]3 · M[4, 4]2

(s = 6, k = 2).

Thus, we have
M[8, 2] =

1
M[6, 2] · M[8, 6] − M[7, 3]3 · M[4, 4]2 .
M[6, 6]

Similarly, we obtain
M[2, 2] · M[6, 6] = M[6, 2] + M[5, 3]3 · M[4, 4]2

(s = 2, k = 2),

M[6, 6] · M[8, 8] = M[8, 6] + M[7, 7]3

(s = 6, k = 6),

M[5, 3] · M[7, 5] = M[7, 3] · M[5, 5] + M[6, 6] · M[4, 4]

(s = 5, k = 3),

M[3, 3] · M[5, 5] = M[5, 3] + M[4, 4]2

(s = 3, k = 3),

M[5, 5] · M[7, 7] = M[7, 5] + M[6, 6]

(s = 5, k = 5).

3

2

3

By our double induction (on r and on the length of the intervals [b, a]), in each of the above equations, we can write the functions M[6, 2], M[8, 6], M[7, 3], M[5, 3] and M[7, 5], respectively, as
a rational function of the functions appearing in the same equation. Now one can use these equations to express δM[8,2] as a rational function in δM1 , . . . , δM8 . Remarkably, this rational function
is a polynomial.
Finally, we display the dimension vectors of the modules M1 , . . . , M8 :
βi (1) =
βi (5) =

βi (2) =

0
1

0
13

40

2

βi (6) =

βi (3) =

1
3

0
63

189

8

βi (7) =

3
8

0
176

527

22

βi (4) =

24

βi (8) =

1392

8
1
465
58

.

As an exercise, the reader can compute βi (9) and βi (10).
Exchange equations are always homogeneous. For example,
M[5, 3] · M[7, 5] = M[7, 3] · M[5, 5] + M[6, 6]3 · M[4, 4]2
is an equation of degree

205
615

26

.

13.3. The shift functor in C w via mutations
Fix a reduced expression i = (ir , . . . , i1 ) of some Weyl group element w. As before, let Ti :=
Iw ⊕ Ωw−1 (Vi ). Define
Wi := Iw ⊕ Ωw (Vi ).
In Section 13.1 we defined a sequence of mutations
μ→r ◦ · · · ◦ −
μ→1 = μsr(i) ◦ · · · ◦ μs2 ◦ μs1
μi = −
where 1

sp

r for all p, such that

408

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

and μ−1
i (Ti ) = μs1 ◦ μs2 ◦ · · · ◦ μsr(i) (Ti ) = Vi .

μi (Vi ) = μsr(i) ◦ · · · ◦ μs2 ◦ μs1 (Vi ) = Ti

Clearly, if R is a basic Cw -maximal rigid module such that R = μpt ◦ · · · ◦ μp1 (Vi ), then we have
R = μpt ◦ · · · ◦ μp1 ◦ μ−1
i (Ti ).
Now define an involution
(−)∗ : {1, . . . , r} \ 1

r k + = r + 1 → {1, . . . , r} \ 1

k

r k+ = r + 1

k

by
(m) ∗

kmin

(t −2−m)

j
:= kmin

,
(m)

where j := ikmin . Observe that every 1 s r can be written as kmin for some unique k (namely
k = s) and some unique 0 m tj − 1. The following picture illustrates how (−)∗ permutes the
vertices of Γi :

(t −1)

j
kmin

(t −2)

(t −3)

j
kmin

(t −4)

j
kmin

j
kmin

···

(2)

(1)

kmin

kmin

kmin

Set
μ−1
i

∗

∗ .
:= μs1∗ ◦ μs2∗ ◦ · · · ◦ μsr(i)

Proposition 13.4. Let R be a basic Cw -maximal rigid module which is mutation equivalent to Vi .
Then Iw ⊕ Ωw−1 (R) and Iw ⊕ Ωw (R) are mutation equivalent to Vi . More precisely, let
R = μzt ◦ · · · ◦ μz1 (Vi )

and R = μqu ◦ · · · ◦ μq1 (Ti ).

Then we have
Iw ⊕ Ωw−1 (R) = μzt∗ ◦ · · · ◦ μz1∗ (Ti )

and Iw ⊕ Ωw (R) = μqu∗ ◦ · · · ◦ μq1∗ (Vi ).

Besides Ωw−1 (R), we can also compute Ωw (R) by just knowing a sequence of mutations from
Vi to R. This works because Vi and Ti are connected via a known sequence of mutations, namely
μi if we start at Vi , and μ−1
i if we start at Ti . The following picture illustrates the situation:
∗
(μ−1
i )

Wi

μz∗ ◦···◦μz∗
t

Iw ⊕ Ωw (R)

μi

Vi
μzt ◦···◦μz1

1

R

Ti
μz∗ ◦···◦μz∗
t

Iw ⊕ Ωw−1 (R)

1

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

409
(t −1)

Proof. As before, for 1 j n set pj := min{1 s r | is = j }. Note that pj j
= pj max
and pj = pj min . In the following pictures we display only the relevant horizontal arrows. The
quiver ΓVi looks as follows:
(t −1)

, p1 ]

M[p1 1

(t −1)

, pn ]

M[pn n

M[p1 1

M[pn n

(t −2)

, p1 ]

···

M[p1 , p1 ]

(1)

M[p1 , p1 ]

(t −2)

, pn ]

···

M[pn , pn ]

(1)

M[pn , pn ]

Next, we display the quiver ΓTi :
M[p1 max , p1 ]

M[p1 max , p1 ]

M[pn max , pn ]

M[pn max , pn ]

(t −1)

]

(t −1)

]

(2)

···

M[p1 max , p1 1

(2)

···

M[pn max , pn n

(1)

M[p1 max , p1 ]

(1)

M[pn max , pn ]

We know that Iw ⊕ Ωw−1 (Vi ) = Ti . In particular, we have
Ωw−1 M pj

(s−1)

for all 1

j

n and 1

s

, pj

(s)

= M pj max , pj

tj − 1. Thus ΓTi looks like this:

(t −1)

, p1 ]

Ωw−1 (M[p1 , p1 ])

Ωw−1 (M[p1 , p1 ])

···

Ωw−1 (M[p1 1

(t −1)

, pn ]

Ωw−1 (M[pn , pn ])

Ωw−1 (M[pn , pn ])

···

Ωw−1 (M[pn n

M[p1 1

M[pn n

(1)

(1)

(t −2)

, p1 ])

(t −2)

, pn ])

(t −1)

The n vertices of the form M[pj j , pj ] at the “left” of both quivers ΓVi and ΓTi are frozen
vertices, to all other vertices we can apply the mutation operation.
Now let
0 → Tk → T → Tk∗ → 0
be an exchange sequence associated to the cluster algebra R(Cw , Vi ). This yields an exchange triangle Tk → T → Tk∗ → Tk [1] in the stable category C w . Note that Tk [1] = Ωw−1 (Tk ). It follows
that Tk [1] → T [1] → Tk∗ [1] → Tk [2] is an exchange triangle as well. There is an associated
exchange sequence
0 → Ωw−1 (Tk ) → I ⊕ Ωw−1 T

→ Ωw−1 Tk∗ → 0

410

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

where I is some module in add(Iw ). Thus, if we mutate the basic Cw -maximal rigid module
Iw ⊕ Ωw−1 (T ) in direction Ωw−1 (Tk ), we obtain (Ωw−1 (Tk ))∗ = Ωw−1 (Tk∗ ). We argue similarly to
show that the mutation of Iw ⊕ Ωw (T ) in direction Ωw (Tk ) gives (Ωw (Tk ))∗ = Ωw (Tk∗ ). This
finishes the proof. ✷
Corollary 13.5. If a Λ-module R is Vi -reachable, then Ωwz (R) is Vi -reachable for all z ∈ Z.
13.4. Example
Let Q be a quiver with underlying graph 1
(1, 2, 1, 3, 2, 1, 4, 3, 2, 1). Then we get
4

3

3

ΓVi

4 and let i := (i10 , . . . , i1 ) :=

3

2

2

2

2

1

1

3
2
1

1

1

2

4

1

3

1

3

2

2

2

2
1

1

3
2

2

4

3

3

1
2
3
4

and
4

4

3

ΓTi

4

3

2
1

3
2
1

3

4

2

3

3

4

4

3

2

2
1

2

3
2

4

3

2

3

4

4

3

1
2
3
4

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

411

Again, we identify the vertices of ΓVi and ΓTi with the indecomposable direct summands of Vi
and Ti , respectively. As before, we identify ΓVi and the quiver Γi , which looks as follows:
Γi (≡ ΓVi )

8

10

5

9

1

6

2

7

3
4

We have
−→ −→
μi = −
μ−→
10 ◦ · · · ◦ μ2 ◦ μ1

= (id) ◦ (id) ◦ (μ1 ) ◦ (id) ◦ (μ2 ) ◦ (μ5 ◦ μ1 ) ◦ (id) ◦ (μ3 ) ◦ (μ6 ◦ μ2 ) ◦ (μ8 ◦ μ5 ◦ μ1 ).
Mutation of Vi at V5 yields the following quiver:
4

3

3

Γμ5 (Vi )

1

2

2
1

3
2
1

3

1

2

1

2

4

1

3

1

3

2

2

2

2
1

1

3
2

2

4

3

3

1
2
3
4

The associated exchange sequences are
0→

1

3
2

→

1

⊕

2
1

3
2

→

2
1

→ 0 and 0 →

→

2
1

1
2

⊕

3
2
1

Next, we mutate at V6 . The exchange sequences look as follows:
0→

1

2

3
2

4
3

→

1

3
2

⊕

1

3
2

4
3

→

2
1

3
2

→ 0 and

→

1

3
2

→0

412

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433
2

0→

1
2

3

1

→

3

⊕

2
3

2
1

4
3

1

→

3
2

→0

4
3

2

Set R := (μ6 ◦ μ5 )(Vi ). Thus we have R = R5 ⊕ R6 ⊕ Vi /(V5 ⊕ V6 ) with
R5 =

1

1

and R6 =

3
2

3

4.

2
3

To calculate Ωw−1 (R), we have to compute (μ6∗ ◦ μ5∗ )(Ti ). Mutation of Ti at 5∗ = 5 yields
the following quiver:
4

4

3

Γμ5∗ (Ti )

3

3

2

2

2

1

3
2
1

4

4

3

4

2

3

3

4

4

3

2

2
1

2

3
2

3

4

4

3

1
2
3
4

The associated exchange sequences are
0→

3
2

4

→

3
4

⊕

4
3
2

→

4
3

→ 0 and 0 →

4
3

→

4

⊕

3
2

4

→

2

→ 0.

3

3
2

4

→ 0.

Next, we mutate at 6∗ = 2. The exchange sequences look as follows:
0→

2

→

3
2

4

→

3
4

→ 0 and 0 →

3
4

→

2
3
4

→

We get Ωw−1 (R) := Ωw−1 (R5 ) ⊕ Ωw−1 (R6 ) ⊕ Ti /(T5 ⊕ T6 ) with
Ωw−1 (R5 ) =

3
2

4

and Ωw−1 (R6 ) = 2 .

14. Irreducible components associated to Cw
14.1. Module varieties
Let Γ := (Γ0 , Γ1 , s, t) be a finite quiver with vertex set Γ0 = {1, . . . , r}, arrow set Γ1 and maps
s, t : Γ1 → Γ0 which map an arrow a to its start vertex s(a) and its terminal vertex t (a), respec-

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

413

tively. In this section, we interpret dimension vectors f = (f1 , . . . , fr ) for Γ as maps f : Γ0 → N.
We consider the affine space
mod(CΓ, f) = rep(Γ, f) =

Cf(t (a))×f(s(a))
a∈Γ1

of representations of Γ with dimension vector f. Here Cp×q denotes the vector space of (p × q)matrices with entries in C. This coincides with our definitions in Section 2.1, except that we
now work with spaces Cp×q of matrices rather than spaces HomC (Cq , Cp ) of linear maps. So
each element in mod(CΓ, f) is of the form M = (M(a))a∈Γ1 where M(a) is a matrix of size
f(t (a)) × f(s(a)).
The group
GLf :=

GLf(i) (C)
i∈Γ0

acts from the left by conjugation on mod(CΓ, f), i.e. for M = (M(a))a∈Γ1 ∈ mod(CΓ, f) and
g = (g(i))i∈Γ0 ∈ GLf we have
(g.M)(a) = g t (a) M(a)g s(a)

−1

for all a ∈ Γ1 . The orbits of GLf on mod(CΓ, f) correspond to the set of isomorphism classes
of CΓ -modules with dimension vector f. Given a path p = al · · · a2 a1 in Γ (i.e. a1 , . . . , al are
arrows with s(ai+1 ) = t (ai ) for 1 i l − 1) we define
M(p) := M(al ) · · · M(a2 )M(a1 )
for any M ∈ mod(CΓ, f). More generally, for any element ρ ∈ ei CΓ ej we have M(ρ) ∈
Cf(i)×f(j ) , since ρ is a linear combination of paths from j to i. (For k ∈ Γ0 we denote the associated path of length 0 by ek .) Set s(ρ) := j and t (ρ) := i. If I ⊂ CΓ is a finitely generated
ideal contained in the ideal generated by all paths of length 2, we may assume that it is generated by elements ρ1 , . . . , ρq with ρk ∈ etk CΓ esk for certain sk , tk ∈ Γ0 where 1 k q. Let
A := CΓ /I . We consider the affine GLf -variety
mod(A, f) := M ∈ mod(CΓ, f) M(ρk ) = 0 for 1

k

q .

Again, the GLf -orbits correspond to the isomorphism classes of A-modules with dimension vector f.
Given M ∈ mod(A, f) and M ∈ mod(A, f ) we identify any homomorphism
ϕ ∈ HomA (M, M ) with a family of matrices
ϕ(k)

k∈Γ0

∈

Cf (k)×f(k)
k∈Γ0

such that
ϕ t (b) M(b) = M (b)ϕ s(b)

414

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

for all b ∈ Γ1 . In other words, the diagram
Cf(s(b))

ϕ(s(b))

Cf (s(b))

M(b)

Cf(t (b))

M (b)
ϕ(t (b))

Cf (t (b))

commutes for all b ∈ Γ1 .
14.2. A stratification of Λw
d
Recall that for X ∈ nil(Λ) we have X ∈ Cw if and only if there is a (unique) filtration
0 = X0 ⊆ X1 ⊆ · · · ⊆ Xr = X
a
by submodules such that Xk /Xk−1 ∼
= Mk k for some ak
tion 10.2. In this case, we have

0 for all 1

k

r, see Proposi-

r

dimBi HomΛ (Vi , X) =

ak dimBi (

k ),

k=1

i.e. a := (a1 , . . . , ar ) is the

-dimension vector of HomΛ (Vi , X). Thus, with
r

μ(a) :=

ak dimΛ (Mk )
k=1

we may consider
Λa := X ∈ Λμ(a) X has a filtration 0 = X0 ⊆ X1 ⊆ · · · ⊆ Xr = X
a
with Xk /Xk−1 ∼
= Mk k , 1

k

r .

In other words, Λa = {X ∈ Λμ(a) | X ∈ CMi ,a }. Define
Λw
d := {X ∈ Λd | X ∈ Cw }.
We get a finite decomposition
Λw
d =

Λa
a∈Nr , μ(a)=d

into disjoint subsets.
Lemma 14.1. Λa is an irreducible constructible subset of Λμ(a) .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

415

Proof. We know from Proposition 10.5 that X ∈ Λa if and only if there exists a short exact
sequence
r

r

Vka−k →

0→
k=1

Vkak → X → 0
k=1

with Vk − = 0 if k − = 0. Now the result follows from [10, Section 2.1].

✷

Remark 14.2. It is not hard to see that for X ∈ nil(Λ) the following are equivalent
(i) X ∈ Cw ;
(ii) HomΛ (D(Jw ), X) = 0 = Ext1Λ (D(Λ/Jw ), X).
Here Ji is by definition the ideal of Λ which is as a C-vector space generated by all paths p in
Q with p = ei , and we set Jw := Jir · · · Ji1 . It follows that Λw
d is an open subset in Λd and it
follows that Λa is a locally closed subset of Λμ(a) . However, we will not need this fact.
14.3. Review of Bongartz’s bundle construction
Following Bongartz [10, Section 4], we apply the above definitions and conventions in order
to relate the varieties Λa and mod(Bi , f). Assume that
r

f=

ak dimBi (

k ).

k=1

Recall that this implies dim HomΛ (Vk , X) = f(k) for all X ∈ Λa . It follows, that
(X, ϕ) X ∈ Λa and ϕ ∈ HomΛ (Vk , X)
is a (usually non-trivial) algebraic vector bundle of rank f(k) over Λa . Thus, setting
I (f) := (i, j ) ∈ N21 1

i

r and 1

j

f(i)

we consider
(i)

H a :=

X, ϕj

(k)

(i,j )∈I (f)

(k)

X ∈ Λa and ϕ1 , . . . , ϕf(k)

is a basis of HomΛ (Vk , X), 1

k

r

equipped with a left GLd -action given by
(k)

g. X, ϕj

(k)

(k,j )∈I (f)

= g.X, g ◦ ϕj

(k,j )∈I (f)

,

and with a right GLf -action given by
f(k)
(k)

X, ϕj

(k,j )∈I (f)

(k)

.h = X,

ϕt ht,j (k)
t=1

.
(k,j )∈I (f)

416

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Here ht,j (k) denotes the entry in row t and column j of the matrix hk . Clearly, the map
π1 : H a → Λa
defined by
(k)

X, ϕj

(k,j )∈I (f)

→X

is a GLd -equivariant GLf -principal bundle.
In order to define a map π2 : H a → mod(Bi , f) we write Bi = CΓ /I for an admissible ideal I,
and we identify the vertices Γ0 = {1, 2, . . . , r} with the summands V1 , . . . , Vr of Vi . Recall that
Γ ≡ Γi . Thus we may think of each arrow b : i → j in Γ1 as a certain element b ∈ HomΛ (Vj , Vi ).
With these identifications
(k)

π2 X, ϕj

(k,j )∈I (f)

= M(b)

b∈Γ1

is determined by
f(t (b))
(s(b))

ϕj

◦b=

ϕu(t (b)) Mu,j (b).
u=1

Here Mu,j (b) denotes the entry in row u and column j of the matrix M(b). It is easy to verify
that π2 is a GLd -invariant GLf -equivariant morphism, if we view mod(Bi , f) with the right GLf action induced from the usual left action via the anti-automorphism h → h−1 of GLf . Moreover,
by construction
(k)

π2 X, ϕj

(k,j )∈I (f)

∼
= HomΛ (Vi , X)

as a Bi -module. Thus, in fact Im(π2 ) = F ( , f), where F ( , f) is the subset of mod(Bi , f)
consisting of the -filtered Bi -modules with dimension vector f. It is shown in [18, Corollary 1.5] that F ( , f) is open in mod(Bi , f). Since π1 is a GLf -principal bundle it follows from
Lemma 14.1 that F ( , f) = π2 (π1−1 (Λa )) is also irreducible. In particular, F ( , f) is an irreducible component of mod(Bi , f).
(k)
Finally, for π2 (X, (ϕj )(k,j )∈I (f) ) = M we have
dim GLd .X = dim GLd − dim EndΛ (X),
dim π1−1 (GLd .X) = dim GLd − dim EndΛ (X) + dim GLf ,
dim(GLf .M) = dim GLf − dim EndΛ (X).
The last equation holds, since the functor Fi : Cw → F ( ) which maps X to HomΛ (Vi , X)
is an equivalence of additive categories. By the same token π2−1 (M.GLf ) = π1−1 (GLd .X). We
conclude dim π2−1 (M) = dim GLd . Thus we proved the following:

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

417

Lemma 14.3. For a ∈ Nr and
r

f=

ak dimBi (

k)

k=1

there exists a variety H a with a GLd –GLf -action together with two surjective morphisms
Ha
π1

π2

F ( , f)

Λa

such that π1 is a GLd -equivariant GLf -principal bundle, and π2 is a GLf -equivariant and GLd invariant morphism. Moreover, dim π2−1 (M) = dim GLd for all M ∈ F ( , f).
Since Cw = Fac(Vi ), it is easy to see that for g ∈ GLd and h ∈ H a with g.h = h we have
g = 1GLd .
Remark 14.4. It seems plausible that with a dual bundle construction, as in [10, 4.3], one can
show that π2 is a GLd -principal bundle.
14.4. Parametrization of components
r
k=1 ak dimBi (

Lemma 14.5. For a = (a1 , . . . , ar ), d = μ(a) and f =

dim F ( , f) = dim GLf − d, d

k)

we have

Q.

Proof. For any N ∈ F ( , f) we have proj.dimBi (N ) 1, thus Ext2Bi (N, N ) = 0, which implies that N is a smooth point [30, 3.7] of the scheme mod(Bi , f). Recall that μ(a) =
r
k=1 ak dim(Mk ). Now Voigt’s Lemma [28, 1.3] and our Lemma 11.4 allow the calculation
dim F ( , f) = dim GLf .N + dim Ext1Bi (N, N )
= dim GLf − f, f

Bi

r

= dim GLf −

ak2

k,

k Bi

+

k=1

ak as

k,

s Bi

1 s<k r

r

= dim GLf −

ak2 Mk , Mk
k=1

= dim GLf − d, d

Q

+

ak as (Mk , Ms )Q
1 s<k r

Q.

For the fourth equality we used Lemma 11.4 and the fact that
k,

This finishes the proof.

✷

k Bi

= 1 = Mk , M k

Q.

418

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Proposition 14.6. The (Zariski-) closure Z a of Λa is an irreducible component of Λμ(a) . In
particular, Z a is the unique irreducible component of Λμ(a) which contains a dense open subset
which belongs to Λa .
Proof. We know from Lemma 14.1 that Λa is an irreducible constructible subset of Λμ(a) . Thus,
Z a is an irreducible subvariety of Λμ(a) . Since Λμ(a) is equi-dimensional, it remains to show that
dim Λa = dim GLd − d, d

Q

= dim Λd .

Recall that d = μ(a) and
r

f=

ak dimBi (

k ).

k=1

As before, F ( , f) denotes the irreducible open subset of -good modules in the affine GLf variety mod(Bi , f) of Bi -modules with dimension vector f. By Lemma 14.5 we know that
dim F ( , f) = dim GLf − d, d

Q.

In Section 14.3 we constructed a GLd –GLf -variety H a together with surjective morphisms
Ha
π1

Λa

π2

F ( , f)

with π1 a GLd -equivariant GLf -principal bundle, and π2 a GLf -equivariant morphism with all
fibers having the same dimension as GLd . Our claim about the dimension of Λa follows. ✷
Let M = M1a1 ⊕ · · · ⊕ Mrar for some a = (a1 , . . . , ar ) ∈ Nr . We just proved that Z a is an
irreducible component of Λμ(a) . Let us denote the corresponding dual semicanonical basis vector
ρZ a by sM . Thus there is a dense open subset U a ⊆ Z a such that sM = δX for all X ∈ U a .
15. A dual PBW-basis and a dual semicanonical basis for A(Cw )
In this section we prove Theorem 3.1 and Theorem 3.2. We also deduce from these results the
existence of semicanonical bases for the cluster algebras R(Cw , T ) and R(Cw , T ) obtained by
inverting and specializing coefficients, respectively.
15.1. Proof of Theorem 3.1
By the definition of the cluster algebra A(Cw , T ), its initial seed is (y, B(T )◦ ) where y =
(y1 , . . . , yr ). In particular, A(Cw , T ) is a subalgebra of F := C(y1 , . . . , yr ). Since T is rigid, by
Theorem 2.6 and [31, Theorem 1.1] every monomial in the δTk belongs to the dual semicanonical
basis S ∗ , hence the δTk are algebraically independent, and (δT1 , . . . , δTr ) is a transcendence basis
of the subfield G it generates inside the fraction field of U (n)∗gr . Let ι : F → G be the field

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

419

isomorphism defined by ι(yk ) = δTk where 1 k r. Combining Theorems 2.7 and 2.20 we
see that the cluster variable z of A(Cw , T ) obtained from the initial seed (y, B(T )◦ ) through a
sequence of seed mutations in successive directions k1 , . . . , ks will be mapped by ι to δX , where
X ∈ Cw is the indecomposable rigid module obtained by the same sequence of mutations of
rigid modules. It follows that ι restricts to an isomorphism from A(Cw , T ) to R(Cw , T ). This
isomorphism is completely determined by the images of the elements yk , hence the unicity. The
cluster monomials are mapped to elements δR where R is a (not necessarily Cw -maximal or
basic) rigid module in Cw , hence an element of S ∗ . More precisely, the cluster monomials in
R(Cw , T ) are the elements δR , where R runs through the set of all T -reachable modules (see
Section 3.1 for the definition of T -reachable). This finishes the proof of Theorem 3.1.
15.2. Proof of Theorem 3.2
Let Mi = M1 ⊕ · · · ⊕ Mr be as before. For 1
β(k) := βi (k).
We have

k

r we proved that dim(Mk ) = βi (k). Set

C[δM1 , . . . , δMr ] ⊆ R(Cw , Vi ) ⊆ SpanC δX | X ∈ Cw ,
where the first inclusion follows from the observation that each of the Λ-modules Mk for 1
k r is the direct summand of a Cw -maximal rigid module on the mutation path from Vi to Ti ,
see Section 13. The second inclusion follows from the observation that SpanC δX | X ∈ Cw is
an algebra. This follows from the fact that Cw is an additive category together with Theorem 2.6.
For each M ∈ add(Mi ) we constructed a dual semicanonical basis vector sM , see the explanation at the end of Section 14.4. If M = Mk is an indecomposable direct summand of Mi , then
sM = δMk . (For every rigid Λ-module R ∈ nil(Λ), the function δR belongs to the dual semicanonical basis. The modules Mk are rigid by Corollary 9.9.)
The following theorem is a slightly more explicit statement of Theorem 3.2:
Theorem 15.1. Let w be a Weyl group element, and let i = (ir , . . . , i1 ) be a reduced expression
of w. Then the following hold:
(i) We have
R(Cw , Vi ) = C[δM1 , . . . , δMr ] = SpanC δX | X ∈ Cw .
(ii) The set
δM M ∈ add(Mi )
is a C-basis of R(Cw , Vi ).
(iii) The subset
Sw∗ := sM M ∈ add(Mi )
of the dual semicanonical basis is a C-basis of R(Cw , Vi ), and all cluster monomials of
R(Cw , Vi ) belong to Sw∗ .

420

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

The basis {δM | M ∈ add(Mi )} will be called dual PBW-basis of R(Cw , Vi ), and Sw∗ the dual
semicanonical basis of R(Cw , Vi ). The proof of this theorem will be given after a series of lemmas.
Let
n=

nd
+

d∈

be the root space decomposition of n. We consider n as a subspace of the universal enveloping algebra U (n). Since we identify U (n) and M, we can think of an element f in nd as a
constructible function f : Λd → C in Md .
/ {β(k) | 1
Lemma 15.2. Let f ∈ nd . If d ∈

r}, then

k

f (X) = 0 for all X ∈ Cw .
Proof. Let X ∈ Cw , and let f ∈ nd with f (X) = 0. In particular, f ∈ Md , and we have d =
dim(X) ∈ + . We know that X ∈ CMi ,a for some a = (a1 , . . . , ar ). Thus
r

dim(X) =

ak dim(Mk ).
k=1

By Lemma 4.2, +
k r} is a bracket closed subset of
w = {β(k) | 1
some 1 s r. This finishes the proof. ✷

+.

Thus d = β(s) for

As before, let i = (ir , . . . , i1 ) be a reduced expression of a Weyl group element w, and let
P = pm m ∈ N

(J )

be an i-compatible PBW-basis of U (n), see Sections 4.2 and 4.3.
Lemma 15.3. Let pm ∈ P where m = (mj )j ∈J . If mj > 0 for some j > r, then
pm (X) = 0 for all X ∈ Cw .
Equivalently, δX (pm ) = 0 for all X ∈ Cw .
Proof. We regard pm as an element of M, hence as a convolution product
pm = p1(m1 ) p2(m2 ) · · · ps(ms ) .
Let us assume that s > r and ms > 0. It follows that pm = p ps where
p :=

1
(m )
(m )
(m )
p 1 p2 2 · · · ps−1s−1 ps(ms −1) .
ms 1

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

421

Now let X ∈ Cw . Then
mχc U ⊆ X p(U )ps (X/U ) = m .

pm (X) = (p ps )(X) =
m∈C

Since Cw is closed under factor modules, we get X/U ∈ Cw for all submodules U of X. Now
Lemma 15.2 yields ps (X/U ) = 0 for all such U . Thus we proved that pm (X) = 0 for all
X ∈ Cw . ✷
Recall from Section 4.3 that
Pi∗ =

p1∗

m1

· · · pr∗

mr

mk

0 for all 1

k

r

is a subset of the dual PBW-basis P ∗ of U (n)∗gr . The following lemma is of central importance:
Lemma 15.4. For 1

k

r we have pk∗ = δMk (up to rescaling of pk ).

Proof. For each 1 k r there exists some m = (mi )i 1 such that pm (Mk ) = 0, since δMk ∈
M∗ ≡ U (n)∗gr is a linear combination of elements in P ∗ . Let s be the natural number with
ms 1, but mj = 0 for all j > s.
By Lemma 15.3, if s > r, then pm (X) = 0 for all modules X ∈ Cw , a contradiction. Thus, we
know that s r. We even know that s k, since Mk is an object of the subcategory Cu of Cw ,
where u = sik · · · si2 si1 .
If s = k, then for dimension reasons m1 = · · · = mk−1 = 0 and mk = 1. So we get pm = pk .
Finally, assume s < k. Since pm (Mk ) = 0, we know that Mk has a filtration
0 = U1,0 ⊆ U1,1 ⊆ · · · ⊆ U1,m1 = U2,0 ⊆ U2,1 ⊆ · · · ⊆ U2,m2 = U3,0 ⊆ · · · ⊆ Us,ms = Mk
such that pi (Ui,j /Ui,j −1 ) = 0 for all 1 i s and 1 j mi . But we know that pi lies in
Mβ(i) . In other words, we have dim(Ui,j /Ui,j −1 ) = β(i). This implies that β(k), the dimension
vector of Mk , is a positive integer linear combination of β(i)’s with i < k. More precisely,
β(k) = m1 β(1) + · · · + ms β(s).
But β(1), . . . , β(s) belong to the bracket closed set +
v where v := sis · · · si2 si1 . Thus β(k) is
also in +
v , which is a contradiction, since s < k.
Summarizing, we proved that pm (Mk ) = 0 if and only if pm = pk . Now we can rescale our
PBW-basis elements pk , and we obtain without loss of generality that pk (Mk ) = 1. Thus we
proved that
δMk (pm ) := pm (Mk ) =
In other words, δMk = pk∗ .

1 if pm = pk ,
0 otherwise.

✷

Corollary 15.5. Under the identification U (n)∗gr ≡ M∗ we have
Pi∗ = δM M ∈ add(Mi ) .

422

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Proof. By definition
Pi∗ =

p1∗

m1

· · · pr∗

mr

mk

0 for all 1

k

r ⊆ P ∗.

This implies the result, since pk∗ = δMk and δX · δY = δX⊕Y for all nilpotent Λ-modules X
and Y . ✷
Proof of Theorem 15.1. Let X ∈ Cw . By Lemma 15.3 and Corollary 15.5, δX is a linear combination of dual PBW-basis vectors of the form δM with M ∈ add(Mi ). Hence δX ∈
C[δM1 , . . . , δMr ], and
SpanC δX | X ∈ Cw ⊆ C[δM1 , . . . , δMr ] ⊆ R(Cw , Vi ).
Using the known reverse inclusions we get (i) and (ii) of Theorem 15.1.
Next, let M = M1a1 ⊕ · · · ⊕ Mrar be a module in add(Mi ). Set a := (a1 , . . . , ar ). Then sM = δX
for some module X in Z a . In particular, X is contained in Cw . Thus, by what we proved up to
now we get
sM = δX ∈ R(Cw , Vi ).
For dimension reasons this implies that
Sw∗ := sM M ∈ add(Mi ) = S ∗ ∩ R(Cw , Vi )
is a C-basis of R(Cw , Vi ). By what we proved before, the set of cluster monomials of R(Cw , Vi )
are a subset of Sw∗ . This finishes the proof of Theorem 15.1. ✷
By Theorem 15.1, we know that
R(Cw , Vi ) = C p1∗ , . . . , pr∗ .
Thus Proposition 8.2 yields the following result:
Proposition 15.6. Under the identification U (n)∗gr ≡ C[N ] the cluster algebra R(Cw , Vi ) gets
identified to the ring of invariants C[N]N (w) , which is isomorphic to C[N (w)].
Corollary 15.7. Let i = (ir , . . . , i1 ) be a reduced expression of w. For X ∈ Cw , the function
ϕX ∈ C[N] is determined by its values on {xi (t) | t = (tr , . . . , t1 ) ∈ (C∗ )r } where xi (t) :=
xir (tr ) · · · xi2 (t2 )xi1 (t1 ).
Proof. Let ϕ, ψ ∈ C[N ]N (w) . Then ϕ = ψ if and only if ϕ(xi (t)) = ψ(xi (t)) for all t ∈ (C∗ )r .
Recall that each x ∈ N can be written as x = yy for a unique (y, y ) ∈ N (w) × N (w). For
x ∈ N w we have πw (x) = y. Furthermore, the image of πw is dense in N (w), see Proposition 8.5.
It is well known that the set {xi (t) | t ∈ (C∗ )r } contains a dense open subset of N w . For x = xi (t)
we get
ϕ πw (x) = ϕ(y) = ϕ yy = ϕ(x).

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

423

For the second equality we used that ϕ is N (w)-invariant. Since ϕ is a regular map, its values
on the whole of N(w) are already determined by its values on πw (xi (t)), t ∈ (C∗ )r . ✷
15.3. Proof of Theorem 3.3
By Proposition 8.5, we know that C[N w ] is the localization of the ring C[N (w)] with respect to the minors D i ,w−1 ( i ) . By Proposition 15.6, C[N (w)] is equal to the cluster algebra
R(Cw , Vi ). By Proposition 9.1, the minors D i ,w−1 ( i ) coincide with the functions ϕX where X
runs through the set of indecomposable Cw -projective–injectives. In other words, the D i ,w−1 ( i )
coincide with the generators of the coefficient ring of R(Cw , Vi ). Hence C[N w ] is equal to the
cluster algebra R(Cw , Vi ).
15.4. Example
Let us discuss an example of base change between Pi∗ and Sw∗ . Let Q be a quiver with underlying graph 1
3 and let i := (i6 , . . . , i1 ) := (2, 3, 1, 2, 3, 1), which is a reduced
2
expression of the Weyl group element w := s2 s3 s1 s2 s3 s1 . As before, let Vi = V1 ⊕ · · · ⊕ V6 and
Mi = M1 ⊕ · · · ⊕ M6 , where as always Mk = M[k, k]. The Λ-modules Vk are the following:
V1 = M1 =

V2 = M2 =

1

V4 = M[4, 1] =

3

V3 = M3 =

3

V5 = M[5, 2] =

2
1

1

1

3
2

V6 = M[6, 3] =

2
3

2
1

3.

2

The initial cluster of our cluster algebra R(Cw , Vi ) looks as follows:

V6

3

V1

V4

2

1

1

2

=

V3

1

1

3
2

V5

1

V2

2

3
3

We have
M4 =

M5 =

3
2

1
2

M6 = 2 .

There are only three more indecomposable Λ-modules, namely
W1 =
Observe that Ω(Vk ) = Wk for 1

W2 =

2
3

k

3
2

3.

2
1

W3 =

2
1

3

.

424

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

The functions δMk can be computed easily. Indeed, for all j and k, the variety Fj,Mk is either
empty or a single point, so χc (Fj,Mk ) is either 0 or 1. Using Theorem 13.1 we get
δV4 = δM1 · δM4 − δM3 ,
δV5 = δM2 · δM5 − δM3 ,
δV6 = δM3 · δM6 − δM4 · δM5 .
Some further exchange relations are
δV3 δW3 = δV4 · δV5 + δV1 δV2 δV6 ,
δV2 δW2 = δW3 + δV4 ,
δV1 δW1 = δW3 + δV5 .
The cluster variables in R(Cw , Vi ) are
{δMk , δVs , δWt | 1

6, 4

s

6 and 1

(Here we consider the three coefficients δVk with 4
above formulas we get

k

6 also as cluster variables.) Using the

k

t

3}.

δW3 = δM1 δM2 δM6 − δM1 δM4 − δM2 δM5 + δM3 ,
δW2 = δM1 δM6 − δM5 ,
δW1 = δM2 δM6 − δM4 .
So we wrote all cluster variables as linear combinations of dual PBW-basis vectors.
15.5. Generalities on bases of algebras
A Λ-module M = rk=1 Mkak in add(Mi ) has gaps if for each 1 j n there is some 1
k r with ik = j and ak = 0. In other words, M has gaps if and only if M has no direct summand
of the form
Mi (Ii,j ) := Mkmax ⊕ · · · ⊕ Mk + ⊕ Mkmin
min

where ik = j .
Lemma 15.8. Let M = M ⊕ M be in add(Mi ) such that
M ∼
= Mi (Ii,j )
for some 1

j

n. Then we have sM = sM · sM .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

425

Proof. We have sM = δIi,j , and Ii,j is Cw -projective–injective. The claim follows now easily
from [31, Theorem 1.1] in combination with the explanations in [31, Section 2.6]. ✷
Let B := {bi | i 1} be a K-basis of a commutative K-algebra A. For some fixed n 1 let
C := {b1 , . . . , bn }. A basis vector b ∈ B is called C-free if b ∈
/ bi B for some bi ∈ C. Assume that
the following hold:
(i) For all bi ∈ C we have bi B ⊆ B.
z

z

(ii) If b1z1 · · · bnzn b = b11 · · · bnn b for some zi , zi
b = b and zi = zi for all i.
It follows that B = {b1z1 · · · bnzn b | b ∈ B is C-free, zi

0 and some C-free elements b, b ∈ B, then

0}. Define

A := A/(b1 − 1, . . . , bn − 1).
For a ∈ A, let a be the residue class of a in A. Furthermore, let Ab1 ,...,bn be the localization of A
at b1 , . . . , bn . The following lemma is easy to show.
Lemma 15.9. With the notation above, the following hold:
(1) The set B := {b | b is C-free} is a K-basis of A.
(2) The set Bb1 ,...,bn := {b1z1 · · · bnzn b | b ∈ B is C-free, zi ∈ Z} is a K-basis of Ab1 ,...,bn .
15.6. Inverting and specializing coefficients
One can rewrite the basis Sw∗ appearing in Theorem 3.2 as
Sw∗ = (δIi,1 )z1 · · · (δIi,n )zn sM M ∈ add(Mi ), M has gaps, zi

0 .

The next two theorems deal with the situation of invertible coefficients and specialized coefficients.
Theorem 15.10 (Invertible coefficients). The set
Sw∗ := (δIi,1 )z1 · · · (δIi,n )zn sM M ∈ add(Mi ), M has gaps, zi ∈ Z
is a C-basis of R(Cw , Vi ), and Sw∗ contains all cluster monomials of the cluster algebra
R(Cw , Vi ).
Next, we specialize all n coefficients δIi,j of the cluster algebra R(Cw , Vi ) to 1. We obtain a
new cluster algebra R(Cw , Vi ) which does not have any coefficients. The residue class of δX ∈
R(Cw , Vi ) is denoted by δ X . The residue class of a dual semicanonical basis vector sM is denoted
by s M .

426

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Theorem 15.11 (No coefficients). The set
S ∗w := s M M ∈ add(Mi ), M has gaps
is a C-basis of R(Cw , Vi ), and S ∗w contains all cluster monomials of the cluster algebra
R(Cw , Vi ).
Proof of Theorem 15.10 and Theorem 15.11. Let B := {bi | i
canonical basis of R(Cw , Vi ). We can label the bi such that

1} := Sw∗ be the dual semi-

{b1 , . . . , bn } = {δIi,1 , . . . , δIi,n }.
Using Lemma 15.8 it is easy to check that the elements bi satisfy the properties (i) and (ii)
mentioned in Section 15.5. Then apply Lemma 15.9. ✷
16. Acyclic cluster algebras
In this section we will study the case of acyclic cluster algebras, which is of special interest. As
before, let Q be an acyclic quiver with vertices 1, . . . , n. Without loss of generality we assume
that i < j whenever there is an arrow a : i → j in Q. We define two Weyl group elements
c := sn · · · s2 s1 and w := c2 . For simplicity we assume that Q is not a linearly oriented quiver
of type An . This implies that i := (n, . . . , 2, 1, n, . . . , 2, 1) is a reduced expression of w. Define
Vi = V1 ⊕ · · · ⊕ V2n and Mi = M1 ⊕ · · · ⊕ M2n as before.
It follows that for 1 j n we have Mj = Ij and Mn+j = τQ (Ij ). Here Ij denotes the
indecomposable injective KQ-module with socle Sj , and τQ is the Auslander–Reiten translation
in mod(KQ).
Observe that R(Cw , Vi ) is an acyclic cluster algebra associated to Q having n non-invertible
coefficients, whereas R(Cw , Vi ) is the acyclic cluster algebra associated to Q having no coefficients.
Theorem 16.1. With w and i as above, the following hold:
(i)
(ii)
(iii)
(iv)
(v)

R(Cw , Vi ) = C[δM1 , . . . , δM2n ] = SpanC δX | X ∈ Cw ;
{δM | M ∈ add(Mi )} and {sM | M ∈ add(Mi )} are both a C-basis of R(Cw , Vi );
{s M | M ∈ add(Mi ), M has gaps} is a C-basis of R(Cw , Vi );
{δ M | M ∈ add(Mi ), M has gaps} is a C-basis of R(Cw , Vi );
There is an isomorphism of cluster algebras R(Cw , Vi ) ∼
= AQ , where AQ is the coefficientfree acyclic cluster algebra associated to Q.

Proof. Parts (i), (ii) and (iii) were already proved before for arbitrary reduced expressions of
arbitrary Weyl group elements. Part (v) is clear from our description of the initial seed (labeled
by Vi ) for the cluster algebra R(Cw , Vi ). It remains to prove (iv): We have
R(Cw , Vi ) =

Rd
d∈Nn

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

427

where Rd is the C-vector space with basis {sM | M ∈ add(Mi ) ∩ rep(Q, d)}. We know that
{δM | M ∈ add(Mi ) ∩ rep(Q, d)} is a basis of Rd as well. After specializing the coefficients δIi,j ,
1 j n to 1, we get
R(Cw , Vi ) =

Rd
d∈Nn

where Rd is the C-vector space with basis
s M M ∈ add(Mi ) ∩ rep(Q, d), M has gaps .
Now one can use the formula
δIi,i = δMn+i · δMi −

δMn+j ·
j →i

δM k
i→k

(where the products are taken over all arrows of Q which start and end in i, respectively) and an
induction on the number of vertices of Q to show that for every M ∈ add(Mi ) which has gaps,
the vector s M is a linear combination of elements of the form δ M where M in add(Mi ) has gaps
and |dim(M )| |dim(M)|. For dimension reasons we get that the vectors δ M with M having
gaps form a linearly independent set. This implies (iv). ✷
It is interesting to compare Theorem 16.1(iv) to Berenstein, Fomin and Zelevinsky’s construction of a basis for the acyclic cluster algebra AQ . Let y := (y1 , . . . , yn ) be the initial cluster
whose exchange matrix BQ is encoded by Q, as in Section 2.6. Let y1∗ , . . . , yn∗ be the n cluster
variables obtained from y by one mutation in each of the n possible directions. Thus the n sets
{y1 , . . . , yn } \ {yk } ∪ {yk∗ } form the neighboring clusters of our initial cluster y. Using a simple
Gröbner basis argument, the following is shown in [9]:
Theorem 16.2 (Berenstein, Fomin, Zelevinsky). The monomials
y1 1 y1∗
p

q1

· · · yn n yn∗
p

qn

pi , q i

0, pi qi = 0

form a C-basis of the acyclic cluster algebra AQ .
Starting with the initial seed (y, BQ ), which corresponds to Γi ≡ ΓVi , we perform the sequence
of mutations μn · · · μ2 μ1 . In each step we obtain a new cluster variable which we denote by yk† .
Note that y1† = y1∗ , but already y2† and y2∗ may be different. Observe that μn · · · μ2 μ1 (BQ ) = BQ .
We get that
y1† , . . . , yn† , BQ
is a seed of the cluster algebra AQ where
{y1 , . . . , yn } ∩ y1† , . . . , yn† = ∅.
Our version of Theorem 16.2 looks then as follows:

428

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Theorem 16.3. The monomials
p

y1 1 y1†

q1

p

· · · yn n yn†

qn

| pi , q i

0, pi qi = 0

form a C-basis of the acyclic cluster algebra AQ .
Note that the initial cluster (y1 , . . . , yn ) comes from Vi and the cluster (y1† , . . . , yn† ) comes
from Ti .
17. Coordinate rings of unipotent radicals
In this section, we assume that Q is of finite Dynkin type A, D, E. We first recall some standard notation (we refer the reader to [37] for more details). The group G is now a simple complex
algebraic group of the same type as Q. Let J be a subset of the set I of vertices of Q, and let K
be the complementary subset. To K one can attach a standard parabolic subgroup BK containing
the Borel subgroup B = H N . We denote by NK the unipotent radical of BK . This is a subgroup
of N . Let WK be the subgroup of the Weyl group W generated by the reflections sk with k ∈ K.
This is a finite Coxeter group and we denote its longest element by w0K . The longest element of
W is denoted by w0 .
In finite type, the preprojective algebra Λ is finite-dimensional and selfinjective. In agreement
with [37], we shall denote by Pi the indecomposable projective Λ-module with top Si and by Qi
the indecomposable injective module with socle Si . We write
QJ =

Qj

and PJ =

j ∈J

Pj .
j ∈J

In [37] we have shown that C[NK ] is naturally isomorphic to the subalgebra
RK := SpanC ϕX X ∈ Sub(QJ )
of C[N]. As before, Sub(QJ ) is the full subcategory of mod(Λ) whose objects are submodules
of direct sums of finitely many copies of QJ . This allowed us to introduce a cluster algebra
AJ ⊆ RK , whose cluster monomials are of the form ϕX with X a rigid module in Sub(QJ ). We
conjectured that in fact AJ = RK , see [37, Conjecture 9.6].
We are going to prove that this conjecture follows from the results of this paper. Let w :=
w0 woK , and let i be a reduced expression for w.
Lemma 17.1. We have NK = N (w0K ) = N (w0 w0K ).
Proof. We know that N (w0K ) is the subgroup of N generated by the one-parameter subgroups
N(α) with α > 0 and w0K (α) > 0. These are exactly the one-parameter subgroups of N which
do not belong to the Levi subgroup of BK , hence the first equality follows. Now, since N =
w0 N− w0 , we have
N w0K = N ∩ w0K N w0K = N ∩ w0K w0 N− w0 w0K = N w0 w0K .

✷

As before, let Fac(PJ ) be the subcategory of mod(Λ) whose objects are factor modules of
direct sums of finitely many copies of PJ .

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

429

Lemma 17.2. We have Cw0 wK = Fac(PJ ).
0

Proof. By Proposition 9.1, we know that the indecomposable Cw -projective–injective object Ii,i
with socle Si satisfies
ϕIi,i = D

K
i ,w0 w0 (

i)

(i ∈ I ).

By [37, Section 6.2], it follows that Ii,i = EwK Qi , where EwK is the functor defined in [37, Sec0
0
tion 5.2]. It readily follows that Ii,i is the indecomposable projective–injective object of Fac(PJ )
with simple socle Si . Hence Cw0 wK and Fac(PJ ) have the same projective–injective genera0
tor. ✷
Let S denote the self-duality of mod(Λ) induced by the involution a → a ∗ mapping an arrow
a of Q to its opposite arrow a ∗ , see [34, Section 1.7]. This restricts to an anti-equivalence of
categories Fac(PJ ) → Sub(QJ ), that we shall again denote by S.
Lemma 17.3. For every X ∈ nil(Λ) and every n ∈ N we have
ϕX n−1 = (−1)dim X ϕS(X) (n).
Proof. We know that N is generated by the one-parameter subgroups xi (t) attached to the simple
positive roots. By Proposition 6.1 we have
a

ϕX xi1 (t1 ) · · · xik (tk ) =

χc (Fia ,X )
a=(a1 ,...,ak )∈Nk

t1a1 · · · tk k
.
a1 ! · · · ak !

Now, if n = xi1 (t1 ) · · · xik (tk ), we have n−1 = xik (−tk ) · · · xi1 (−t1 ) and the result follows from
the fact that Fia ,X ∼
= Fiaopop ,S(X) , where iop and aop denote the sequences obtained by reading i
and a from right to left. ✷
We can now prove the following:
Theorem 17.4. Conjecture 9.6 of [37] holds.
Proof. As before, let w := w0 w0K , and let i be a reduced expression of w. The cluster algebra
R(Cw ) = R(Fac(PJ )) is isomorphic to AJ via the map ϕX → ϕS(X) . This comes from the fact
that S : Fac(PJ ) → Sub(QJ ) is an anti-equivalence which maps the Cw -maximal rigid module
Vi used to define the initial seed of R(Cw ) to the maximal rigid module Uj of [37, Section 9.2]
used to define the initial seed of AJ . (Here we assume that j is the reduced expression of w0K w0
obtained by reading the reduced expression i of w0 w0K from right to left.) In particular the cluster
variables ϕMk which, by Theorem 15.1, generate R(Fac(PJ )) ≡ C[N (w0 w0K )] are mapped to
cluster variables ϕS(Mk ) of AJ . They also form a system of generators of the polynomial algebra
C[N(w0 w0K )] = C[NK ] by Lemma 17.3, because the map n → n−1 is a biregular automorphism
of NK . Hence AJ = C[NK ]. ✷

430

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

Remark 17.5. The previous discussion shows that we obtain two different cluster algebra structures on C[NK ], coming from the two different subcategories Fac(PJ ) and Sub(QJ ). When
using Fac(PJ ) = Cw0 wK , we regard C[NK ] as the subring of N (w0 w0K )-invariant functions
0

of C[N] for the action of N (w0 w0K ) on N by right translations, see Section 8.1. This allows
K

us to relate the first cluster structure to the cluster structure of the unipotent cell C[N w0 w0 ],
see Proposition 8.5. When using Sub(QJ ), we regard C[NK ] as the subring of N (w0 w0K )invariant functions of C[N ] for the action of N (w0 w0K ) = N (w0K ) on N by left translations.
−
−
These functions can then be “lifted” to BK
-invariant functions on G for the action of BK
on G
by left translations. This allows us to “lift” the second cluster structure to a cluster structure on
−
\G], see [37, Section 10].
C[BK
18. Remarks and open problems
18.1. Calculation of Mi (R)
Let i be a reduced expression of a Weyl group element w, and let R be a Vi -reachable
Λ-module, see Section 3.1. Based on Theorem 3.1 we can combine Corollary 10.7 and Proposition 12.4 to determine algorithmically Mi (R). (For the definition of Mi (R) see Section 10.)
Recall that the Vi -reachable modules R are in 1-1 correspondence with the cluster monomials δR
in R(Cw ).
18.2. Calculation of Euler characteristics
Let i be a reduced expression of a Weyl group element w, and let R be a Vi -reachable Λmodule, and let j = (j1 , . . . , jp ). By Proposition 6.1 the Euler characteristic χc (Fj,R ) is equal to
the coefficient of t1 · · · tp in ϕR (xj1 (t1 ) · · · xjp (tp )). Using mutations, we can express algorithmically ϕR as a Laurent polynomial in the functions ϕV1 , . . . , ϕVr . Now we can use the calculations
from Section 9.6 to compute all the Euler characteristics χc (Fj,R ).
18.3. Open orbit conjecture
It is known that the (specialized) dual canonical basis B ∗ and the dual semicanonical basis
of M∗ ≡ U (n)∗gr do not coincide, see [31, Section 1.5]. But one might at least hope that both
bases have some interesting elements in common:
S∗

Conjecture 18.1 (Open orbit conjecture). Let Z be an irreducible component of Λd , and let
bZ and ρZ be the associated dual canonical and dual semicanonical basis vectors of M∗ . If Z
contains an open GLd -orbit, then bZ = ρZ .
We know that each cluster monomial of the cluster algebra A(Cw ) is of the form ρZ , where Z
contains an open GLd -orbit. So if the conjecture is true, then all cluster monomials belong to the
dual canonical basis.
18.4. Example
Finally, we would like to ask the following question. Is it possible to realize every element
of the dual canonical basis of M∗ as a δ-function? We know several examples of elements b of

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

431

B ∗ which do not belong to S ∗ . In all these examples, b is however equal to δX for a non-generic
Λ-module X. (We say that X ∈ nil(Λ) is generic if δX ∈ S ∗ .)
Let us look at an example. Let Q be the quiver 1
2 and let Λ be the associated preprojective algebra. For λ ∈ C∗ we define representations M(λ, 1) and M(λ, 2) of Q as follows:

M(λ, 1) := C

(1)

C

(λ)

and M(λ, 2) := C2

10
01
λ1
0λ

C2

Let ι : rep(Q, (2, 2)) → Λ(2,2) be the obvious canonical embedding. Clearly, the image of ι is an
irreducible component of Λ(2,2) , which we denote by ZQ . It is not difficult to check that the set
M(λ, 1) ⊕ M(μ, 1) λ, μ ∈ C∗
is a dense subset of ZQ . It follows that
δM(λ,1)⊕M(μ,1) = ρZQ
is an element of the dual semicanonical basis S ∗ . It is easy to check that
δM(λ,2) = δM(λ,1)⊕M(μ,1) .
Indeed, the variety Fj,X of composition series of type j = (1, 2, 1, 2) has Euler characteristic 2
for X = M(λ, 1) ⊕ M(μ, 1) and Euler characteristic 1 for X = M(λ, 2). Furthermore, one can
show that
δM(λ,2) = bZQ
belongs to the dual canonical basis B ∗ of M∗ .
Note that the functions δM(λ,1)⊕M(μ,1) and δM(λ,2) do not belong to any of the subalgebras
R(Cw ), since M(λ, 1) and M(λ, 2) are regular representations of the quiver Q for all λ.
Acknowledgments
We are grateful to Øyvind Solberg for answering our questions on relative homology theory.
We thank Shrawan Kumar for his kind help concerning Kac–Moody groups. It is a pleasure to
thank the Mathematisches Forschungsinstitut Oberwolfach (MFO) for two weeks of hospitality in July/August 2006, where this work was started. Furthermore, the first and second authors
like to thank the Max-Planck Institute for Mathematics in Bonn for a research stay in September/December 2006 and October 2006, respectively. We also thank the Sonderforschungsbereich/Transregio SFB 45 for financial support. The three authors are grateful to the Mathematical
Sciences Research Institute in Berkeley (MSRI) for an invitation in Spring 2008 during which
substantial parts of this work were written. The first author was partially supported by PAPIIT
grant IN103507-2 and CONACYT grant 81948. All three authors thank the Hausdorff Center for
Mathematics in Bonn for financial support.

432

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

References
[1] E. Abe, Hopf Algebras, Cambridge Tracts in Math., vol. 74, Cambridge University Press, 1980.
[2] I. Assem, D. Simson, A. Skowro´nski, Elements of the Representation Theory of Associative Algebras. Vol. 1. Techniques of Representation Theory, London Math. Soc. Stud. Texts, vol. 65, Cambridge University Press, Cambridge,
2006, x+458 pp.
[3] M. Auslander, Representation theory of artin algebras. I, Comm. Algebra 1 (1974) 177–268.
[4] M. Auslander, Ø. Solberg, Relative homology and representation theory. I. Relative homology and homologically
finite subcategories, Comm. Algebra 21 (9) (1993) 2995–3031.
[5] M. Auslander, Ø. Solberg, Relative homology and representation theory. II. Relative cotilting theory, Comm. Algebra 21 (9) (1993) 3033–3079.
[6] M. Auslander, M. Platzeck, I. Reiten, Coxeter functors without diagrams, Trans. Amer. Math. Soc. 250 (1979) 1–46.
[7] M. Auslander, I. Reiten, S. Smalø, Representation Theory of Artin Algebras, corrected reprint of the 1995 original,
Cambridge Stud. Adv. Math., vol. 36, Cambridge University Press, Cambridge, 1997, xiv+425 pp.
[8] A. Berenstein, A. Zelevinsky, Total positivity in Schubert varieties, Comment. Math. Helv. 72 (1997) 128–166.
[9] A. Berenstein, S. Fomin, A. Zelevinsky, Cluster algebras III: Upper bounds and double Bruhat cells, Duke Math.
J. 126 (1) (2005) 1–52.
[10] K. Bongartz, Minimal singularities for representations of Dynkin quivers, Comment. Math. Helv. 69 (4) (1994)
575–611.
[11] A. Buan, R. Marsh, Cluster-tilting theory, in: Trends in Representation Theory of Algebras and Related Topics, in:
Contemp. Math., vol. 406, 2006, pp. 1–30.
[12] A. Buan, R. Marsh, M. Reineke, I. Reiten, G. Todorov, Tilting theory and cluster combinatorics, Adv. Math. 204 (2)
(2006) 572–618.
[13] A. Buan, O. Iyama, I. Reiten, J. Scott, Cluster structures for 2-Calabi–Yau categories and unipotent groups, Compos.
Math. 145 (2009) 1035–1079.
[14] P. Caldero, B. Keller, From triangulated categories to cluster algebras II, Ann. Sci. Éc. Norm. Super. (4) 39 (6)
(2006) 983–1009.
[15] P. Caldero, B. Keller, From triangulated categories to cluster algebras, Invent. Math. 172 (2008) 169–211.
[16] E. Cline, B. Parshall, L. Scott, Finite-dimensional algebras and highest weight categories, J. Reine Angew.
Math. 391 (1988) 85–99.
[17] W. Crawley-Boevey, On the exceptional fibres of Kleinian singularities, Amer. J. Math. 122 (2000) 1027–1037.
[18] W. Crawley-Boevey, J. Schröer, Irreducible components of varieties of modules, J. Reine Angew. Math. 553 (2002)
201–220.
[19] H. Derksen, J. Weyman, A. Zelevinsky, Quivers with potentials and their representations I: Mutations, Selecta Math.
(N.S.) 14 (1) (2008) 59–119.
[20] H. Derksen, J. Weyman, A. Zelevinsky, Quivers with potentials and their representations II: Applications to cluster
algebras, J. Amer. Math. Soc. 23 (3) (2010) 749–790.
[21] P. Di Francesco, R. Kedem, Q-systems as cluster algebras II: Cartan matrix of finite type and the polynomial property, Lett. Math. Phys. 89 (3) (2009) 183–216.
[22] S. Fomin, A. Zelevinsky, Double Bruhat cells and total positivity, J. Amer. Math. Soc. 12 (2) (1999) 335–380.
[23] S. Fomin, A. Zelevinsky, Cluster algebras. I. Foundations, J. Amer. Math. Soc. 15 (2) (2002) 497–529.
[24] S. Fomin, A. Zelevinsky, Cluster algebras. II. Finite type classification, Invent. Math. 154 (1) (2003) 63–121.
[25] S. Fomin, A. Zelevinsky, Cluster algebras: notes for the CDM-03 conference, in: Current Developments in Mathematics, Int. Press, Somerville, MA, 2003, pp. 1–34.
[26] S. Fomin, A. Zelevinsky, Cluster algebras. IV. Coefficients, Compos. Math. 143 (2007) 112–164.
[27] C. Fu, B. Keller, On cluster algebras with coefficients and 2-Calabi–Yau categories, Trans. Amer. Math. Soc. 362
(2010) 859–895.
[28] P. Gabriel, Finite representation type is open. Representations of algebras, in: Proc. Internat. Conf., Carleton Univ.,
Ottawa, Ont., 1974, in: Lecture Notes in Math., vol. 488, Springer-Verlag, Berlin, 1975, pp. 132–155.
[29] P. Gabriel, A.V. Roiter, Representations of Finite-Dimensional Algebras, Springer-Verlag, Berlin, 1997, iv+177 pp.,
translated from the Russian, with a chapter by B. Keller. Reprint of the 1992 English translation.
[30] C. Geiß, Geometric methods in representation theory of finite-dimensional algebras, in: Representation Theory of
Algebras and Related Topics, Mexico City, 1994, in: CMS Conf. Proc., vol. 19, Amer. Math. Soc., Providence, RI,
1996, pp. 53–63.
[31] C. Geiß, B. Leclerc, J. Schröer, Semicanonical bases and preprojective algebras, Ann. Sci. Éc. Norm. Super. (4) 38 (2) (2005) 193–253.

C. Geiß et al. / Advances in Mathematics 228 (2011) 329–433

433

[32] C. Geiß, B. Leclerc, J. Schröer, Verma modules and preprojective algebras, Nagoya Math. J. 182 (2006) 241–258.
[33] C. Geiß, B. Leclerc, J. Schröer, Rigid modules over preprojective algebras, Invent. Math. 165 (3) (2006) 589–632.
[34] C. Geiß, B. Leclerc, J. Schröer, Auslander algebras and initial seeds for cluster algebras, J. Lond. Math. Soc. (2) 75
(2007) 718–740.
[35] C. Geiß, B. Leclerc, J. Schröer, Semicanonical bases and preprojective algebras II: A multiplication formula, Compos. Math. 143 (2007) 1313–1334.
[36] C. Geiß, B. Leclerc, J. Schröer, Cluster algebra structures and semicanonical bases for unipotent groups, arXiv:
math/0703039, 2007, 121 pp.
[37] C. Geiß, B. Leclerc, J. Schröer, Partial flag varieties and preprojective algebras, Ann. Inst. Fourier (Grenoble) 58
(2008) 825–876.
[38] D. Happel, Triangulated Categories in the Representation Theory of Finite-Dimensional Algebras, London Math.
Soc. Lecture Note Ser., vol. 119, Cambridge University Press, Cambridge, 1988, x+208 pp.
[39] D. Happel, Partial tilting modules and recollement, in: Proceedings of the International Conference on Algebra,
Part 2, Novosibirsk, 1989, in: Contemp. Math., vol. 131, Amer. Math. Soc., Providence, RI, 1992, pp. 345–361.
[40] O. Iyama, Auslander correspondence, Adv. Math. 210 (1) (2007) 51–82.
[41] O. Iyama, I. Reiten, 2-Auslander algebras associated with reduced words in Coxeter groups, preprint, arXiv:
1002.3247, 2010, 14 pp.
[42] A. Joseph, Quantum Groups and Their Primitive Ideals, Ergeb. Math. Grenzgeb. (3), vol. 29, Springer-Verlag,
Berlin, 1995, x+383 pp.
[43] V. Kac, Infinite-Dimensional Lie Algebras, third edition, Cambridge University Press, Cambridge, 1990,
xxii+400 pp.
[44] V. Kac, D. Peterson, Regular functions on certain infinite-dimensional groups, in: Arithmetic and Geometry, vol. II,
in: Progr. Math., vol. 36, Birkhäuser Boston, Boston, MA, 1983, pp. 141–166.
[45] M. Kashiwara, Y. Saito, Geometric construction of crystal bases, Duke Math. J. 89 (1997) 9–36.
[46] B. Keller, On triangulated orbit categories, Doc. Math. 10 (2005) 551–581, (electronic).
[47] B. Keller, I. Reiten, Cluster tilted algebras are Gorenstein and stably Calabi–Yau, Adv. Math. 211 (2007) 123–151.
[48] S. Kumar, Kac–Moody Groups, Their Flag Varieties and Representation Theory, Progr. Math., vol. 204, Birkhäuser
Boston, Boston, MA, 2002.
[49] B. Leclerc, Dual canonical bases, quantum shuffles and q-characters, Math. Z. 246 (2004) 691–732.
[50] G. Lusztig, Quivers, perverse sheaves, and quantized enveloping algebras, J. Amer. Math. Soc. 4 (2) (1991) 365–
421.
[51] G. Lusztig, Semicanonical bases arising from enveloping algebras, Adv. Math. 151 (2) (2000) 129–139.
[52] Y. Palu, Cluster characters for 2-Calabi–Yau triangulated categories, Ann. Inst. Fourier (Grenoble) 58 (6) (2008)
2221–2248.
[53] C. Reutenauer, Free Lie Algebras, London Mathematical Society Monographs, New Series, vol. 7, Oxford Science
Publications, The Clarendon Press, Oxford University Press, New York, 1993, xviii+269 pp.
[54] N. Richmond, A stratification for varieties of modules, Bull. Lond. Math. Soc. 33 (5) (2001) 565–577.
[55] C.M. Ringel, Tame Algebras and Integral Quadratic Forms, Lecture Notes in Math., vol. 1099, Springer-Verlag,
Berlin, 1984, xiii+376 pp.
[56] C.M. Ringel, The category of modules with good filtrations over a quasi-hereditary algebra has almost split sequences, Math. Z. 208 (2) (1991) 209–223.
[57] C.M. Ringel, The category of good modules over a quasi-hereditary algebra, in: Proceedings of the Sixth International Conference on Representations of Algebras, Ottawa, ON, 1992, in: Carleton-Ottawa Math. Lecture Note Ser.,
vol. 14, Carleton Univ., Ottawa, ON, 1992, 17 pp.
[58] C.M. Ringel, PBW-bases of quantum groups, J. Reine Angew. Math. 470 (1996) 51–88.
[59] C.M. Ringel, Iyama’s finiteness theorem via strongly quasi-hereditary algebras, preprint, arXiv:0912.5001, 2009,
5 pp.

