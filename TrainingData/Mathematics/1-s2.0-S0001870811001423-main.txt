Advances in Mathematics 227 (2011) 2241–2308
www.elsevier.com/locate/aim

Positivity for cluster algebras from surfaces ✩
Gregg Musiker a,∗ , Ralf Schiffler b , Lauren Williams c
a School of Mathematics, University of Minnesota, Minneapolis, MN 55455, United States
b Department of Mathematics, University of Connecticut, Storrs, CT 06269-3009, United States
c Department of Mathematics, UC Berkeley, Berkeley, CA 94720, United States

Received 21 October 2010; accepted 11 April 2011
Available online 23 May 2011
Communicated by Andrei Zelevinsky

Abstract
We give combinatorial formulas for the Laurent expansion of any cluster variable in any cluster algebra
coming from a triangulated surface (with or without punctures), with respect to an arbitrary seed. Moreover,
we work in the generality of principal coefficients. An immediate corollary of our formulas is a proof of the
positivity conjecture of Fomin and Zelevinsky for cluster algebras from surfaces, in geometric type.
© 2011 Elsevier Inc. All rights reserved.
MSC: 16S99; 05C70; 05E15
Keywords: Cluster algebra; Positivity conjecture; Triangulated surfaces

Contents
1.
2.
3.
4.
5.

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Cluster algebras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Cluster algebras arising from surfaces . . . . . . . . . . . . . . . .
Main results: cluster expansion formulas . . . . . . . . . . . . . .
Examples of results, and identities in the coefficient-free case

✩

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

2242
2244
2248
2254
2263

The first author is supported by the NSF research grant DMS-1067183; the second author is supported by the
NSF research grants DMS-0908765 and DMS-1001637, and by the University of Connecticut; and the third author
is supported by the NSF research grant DMS-0854432 and an Alfred Sloan Research Fellowship.
* Corresponding author.
E-mail addresses: musiker@math.umn.edu (G. Musiker), schiffler@math.uconn.edu (R. Schiffler),
williams@math.berkeley.edu (L. Williams).
0001-8708/$ – see front matter © 2011 Elsevier Inc. All rights reserved.
doi:10.1016/j.aim.2011.04.018

2242

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

6. Outline of the proof of the cluster expansion formulas . . . . . . .
7. Construction of a triangulated polygon and a lifted arc . . . . . . .
8. Construction of Aγ and the map φγ . . . . . . . . . . . . . . . . . . .
9. Quadrilateral lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10. The proof of the expansion formula for ordinary arcs . . . . . . . .
11. Positivity for notched arcs in the coefficient-free case . . . . . . .
12. The proofs of the expansion formulas for notched arcs . . . . . . .
13. Applications to F -polynomials, g-vectors, Euler characteristics
Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

2267
2268
2270
2274
2279
2285
2286
2305
2306
2307

1. Introduction
Since their introduction by Fomin and Zelevinsky [22], cluster algebras have been related to
diverse areas of mathematics such as total positivity, quiver representations, Teichmüller theory,
tropical geometry, Lie theory, and Poisson geometry. A main outstanding conjecture about cluster
algebras is the positivity conjecture, which says that if one fixes a cluster algebra A and an
arbitrary seed (x, y, B), one can express each cluster variable x ∈ A as a Laurent polynomial
with positive coefficients in the variables of x.
There is a class of cluster algebras arising from surfaces with marked points, introduced by
Fomin, Shapiro, and Thurston in [20] (generalizing work of Fock and Goncharov [17,19] and
Gekhtman, Shapiro, and Vainshtein [27]), and further developed in [21]. This class is quite large:
(assuming rank at least three) it has been shown [16] that all but finitely many skew-symmetric
cluster algebras of finite mutation type come from this construction. Note that the class of cluster
algebras of finite mutation type in particular contains those of finite type.
In this paper we give a combinatorial expression for the Laurent polynomial which expresses
any cluster variable in terms of any seed, for any cluster algebra arising from a surface. As
a corollary we prove the positivity conjecture for all such cluster algebras.
A cluster algebra A of rank n is a subalgebra of an ambient field F isomorphic to a field
of rational functions in n variables. Each cluster algebra has a distinguished set of generators
called cluster variables; this set is a union of overlapping algebraically independent n-subsets
of F called clusters, which together have the structure of a simplicial complex called the cluster
complex. See Definition 2.5 for precise details. The clusters are related to each other by birational
transformations of the following kind: for every cluster x and every cluster variable x ∈ x, there
is another cluster x = x − {x} ∪ {x }, with the new cluster variable x determined by an exchange
relation of the form
xx = y + M + + y − M − .
Here y + and y − lie in a coefficient semifield P, while M + and M − are monomials in the elements
of x − {x}. There are two dynamics at play in the exchange relations: that of the monomials,
which is encoded in the exchange matrix, and that of the coefficients.
A classification of finite type cluster algebras – those with finitely many clusters – was given
by Fomin and Zelevinsky in [23]. They showed that this classification is parallel to the famous
Cartan–Killing classification of complex simple Lie algebras, i.e. finite type cluster algebras either fall into one of the infinite families An , Bn , Cn , Dn , or are of one of the exceptional types

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2243

E6 , E7 , E8 , F4 , or G2 . Furthermore, the type of a finite type cluster algebra depends only on
the dynamics of the corresponding exchange matrices, and not on the coefficients. However,
there are many cluster algebras of geometric origin which – despite having the same type – have
totally different systems of coefficients. This motivated Fomin and Zelevinsky’s work in [24],
which studied the dependence of a cluster algebra structure on the choice of coefficients. One
surprising result of [24] was that there is a special choice of coefficients, the principal coefficients, which have the property that computation of explicit expansion formulas for the cluster
variables in arbitrary cluster algebras can be reduced to computation of explicit expansion formulas in cluster algebras with principal coefficients. A corollary of this work is that to prove
the positivity conjecture in geometric type, it suffices to prove the positivity conjecture using
principal coefficients.
This takes us to the topic of the present work. Our main results are combinatorial formulas
for cluster expansions of cluster variables with respect to any seed, in any cluster algebra coming
from a surface. Our formulas are manifestly positive, so as a consequence we obtain the following
result.
Theorem 1.1. Let A be any cluster algebra arising from a surface, where the coefficient system
is of geometric type, and let Σ be any initial seed. Then the Laurent expansion of every cluster
variable with respect to the seed Σ has non-negative coefficients.
Our results generalize those in [38], where cluster algebras from the (much more restrictive) case of surfaces without punctures were considered. This work in turn generalized [39],
which treated cluster algebras from unpunctured surfaces with a very limited coefficient system
that was associated to the boundary of the surface. The very special case where the surface is
a polygon and coefficients arise from the boundary was covered in [37], and also in unpublished
work [11,25]. See also [36]. Recently [32] gave an alternative formulation of the results of [38],
using perfect matchings as opposed to T -paths.
Many others have worked on finding Laurent expansions of cluster variables, and on the positivity conjecture. However, most of the results so far obtained have strong restrictions on the
cluster algebra, the choice of initial seed or on the system of coefficients.
For rank 2 cluster algebras, the works [40,42,31] gave cluster expansion formulas in affine
types. Positivity in these cases was generalized to the coefficient-free rank 2 case in [14], using [9]. For finite type cluster algebras, the positivity conjecture with respect to a bipartite seed
follows from [24, Corollary 11.7]. Other work [30] gave cluster expansions for coefficient-free
cluster algebras of finite classical types with respect to a bipartite seed.
A recent tool in understanding Laurent expansions of cluster variables is the connection to
quiver representations and the introduction of the cluster category [4] (see also [6] in type A).
More specifically, there is a geometric interpretation (found in [5] and generalized in [7]) of coefficients in Laurent expansions as Euler–Poincaré characteristics of appropriate Grassmannians
of quiver representations. Using this approach, the works [5,7,8] gave an expansion formula in
the case where the cluster algebra is acyclic and the initial cluster lies in an acyclic seed (see
also [10] in rank 2); this was subsequently generalized to arbitrary clusters in an acyclic cluster algebra [34]. Note that these formulas do not give information about the coefficients. Later,
[26] generalized these results to cluster algebras with principal coefficients that admit a categorification by a 2-Calabi–Yau category [26]; by [1,2,29], such a categorification exists in the case
of cluster algebras associated to surfaces with non-empty boundary. Recently [13] gave expressions for the F -polynomials in any skew-symmetric cluster algebra. However, since all of the

2244

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

above formulas are in terms of Euler–Poincaré characteristics (which can be negative), they do
not immediately imply the positivity conjecture.
The work [9] used the above approach to make progress towards the positivity conjecture
for coefficient-free acyclic cluster algebras, with respect to an acyclic seed.1 Building on [28]
and [8], Nakajima recently used quiver varieties to prove the positivity conjecture for cluster
algebras that have at least one bipartite seed, with respect to any cluster [33]. This is a very
strong result, but it does not overlap very much with our Theorem 1.1. Note that a bipartite seed
is in particular acyclic, but not every acyclic type has a bipartite seed; e.g. the affine type A2
does not. Further, the only surfaces that give rise to acyclic cluster algebras are the polygon
with 0, 1, or 2 punctures, and the annulus (corresponding to the finite types A and D, and the
affine types D and A, respectively). All other surfaces yield non-acyclic cluster algebras, see [20,
Corollary 12.4].
The paper is organized as follows. We give background on cluster algebras and cluster algebras from surfaces in Sections 2 and 3. In Section 4 we present our formulas for Laurent
expansions of cluster variables, and in Section 5 we give examples, as well as identities in the
coefficient-free case. As the proofs of our main results are rather involved, we give a detailed
outline of the main argument in Section 6, before giving the proofs themselves in Sections 7
to 10 and 12. In Section 13, we give applications of our results to F -polynomials, g-vectors, and
Euler–Poincaré characteristics of quiver Grassmannians.
Recall that cluster variables in cluster algebras from surfaces correspond to ordinary arcs
as well as arcs with notches at one or two ends. We remark that working in the generality of
principal coefficients is much more difficult than working in the coefficient-free case. Indeed,
once we have proved positivity for cluster variables corresponding to ordinary arcs, the proof of
positivity for cluster variables corresponding to tagged arcs in the coefficient-free case follows
easily, see Proposition 5.3 and Section 11. Putting back principal coefficients requires much more
elaborate arguments, see Section 12. A crucial tool here is the connection to laminations [21].
2. Cluster algebras
We begin by reviewing the definition of cluster algebra, first introduced by Fomin and Zelevinsky in [22]. Our definition follows the exposition in [24].
2.1. What is a cluster algebra?
To define a cluster algebra A we must first fix its ground ring. Let (P, ⊕, ·) be a semifield,
i.e., an abelian multiplicative group endowed with a binary operation of (auxiliary) addition ⊕
which is commutative, associative, and distributive with respect to the multiplication in P. The
group ring ZP will be used as a ground ring for A. One important choice for P is the tropical
semifield; in this case we say that the corresponding cluster algebra is of geometric type.
Definition 2.1 (Tropical semifield). Let Trop(u1 , . . . , um ) be an abelian group (written multiplicatively) freely generated by the uj . We define ⊕ in Trop(u1 , . . . , um ) by
a

j

1 See, however, [33, footnote 5, p. 6].

min(aj ,bj )

b

uj j ⊕

uj j =
j

uj
j

,

(2.1)

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2245

and call (Trop(u1 , . . . , um ), ⊕, ·) a tropical semifield. Note that the group ring of Trop(u1 , . . . ,
um ) is the ring of Laurent polynomials in the variables uj .
As an ambient field for A, we take a field F isomorphic to the field of rational functions in
n independent variables (here n is the rank of A), with coefficients in QP. Note that the definition
of F does not involve the auxiliary addition in P.
Definition 2.2 (Labeled seeds). A labeled seed in F is a triple (x, y, B), where
• x = (x1 , . . . , xn ) is an n-tuple from F forming a free generating set over QP,
• y = (y1 , . . . , yn ) is an n-tuple from P, and
• B = (bij ) is an n × n integer matrix which is skew-symmetrizable.
That is, x1 , . . . , xn are algebraically independent over QP, and F = QP(x1 , . . . , xn ). We refer
to x as the (labeled) cluster of a labeled seed (x, y, B), to the tuple y as the coefficient tuple, and
to the matrix B as the exchange matrix.
We obtain (unlabeled) seeds from labeled seeds by identifying labeled seeds that differ from
each other by simultaneous permutations of the components in x and y, and of the rows and
columns of B.
We use the notation [x]+ = max(x, 0), [1, n] = {1, . . . , n}, and
sgn(x) =

−1 if x < 0;
0
if x = 0;
1
if x > 0.

Definition 2.3 (Seed mutations). Let (x, y, B) be a labeled seed in F , and let k ∈ [1, n]. The seed
mutation μk in direction k transforms (x, y, B) into the labeled seed μk (x, y, B) = (x , y , B )
defined as follows:
• The entries of B = (bij ) are given by
bij =

−bij
bij + sgn(bik )[bik bkj ]+

if i = k or j = k;
otherwise.

(2.2)

• The coefficient tuple y = (y1 , . . . , yn ) is given by
yj =

yk−1

if j = k;

[b ]
yj yk kj + (yk

⊕ 1)−bkj

if j = k.

(2.3)

• The cluster x = (x1 , . . . , xn ) is given by xj = xj for j = k, whereas xk ∈ F is determined
by the exchange relation
xk =

yk

[bik ]+

xi

[−bik ]+

+ xi
(yk ⊕ 1)xk

.

(2.4)

2246

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

We say that two exchange matrices B and B are mutation-equivalent if one can get from B
to B by a sequence of mutations.
Definition 2.4 (Patterns). Consider the n-regular tree Tn whose edges are labeled by the numbers
1, . . . , n, so that the n edges emanating from each vertex receive different labels. A cluster pattern
is an assignment of a labeled seed Σt = (xt , yt , Bt ) to every vertex t ∈ Tn , such that the seeds
k
− t are obtained from each other by the seed mutation
assigned to the endpoints of any edge t −−

in direction k. The components of Σt are written as
xt = (x1;t , . . . , xn;t ),

yt = (y1;t , . . . , yn;t ),

t
.
Bt = bij

(2.5)

Clearly, a cluster pattern is uniquely determined by an arbitrary seed.
Definition 2.5 (Cluster algebra). Given a cluster pattern, we denote
X=

xt = {xi,t : t ∈ Tn , 1

i

n},

(2.6)

t∈Tn

the union of clusters of all the seeds in the pattern. The elements xi,t ∈ X are called cluster
variables. The cluster algebra A associated with a given pattern is the ZP-subalgebra of the
ambient field F generated by all cluster variables: A = ZP[X ]. We denote A = A(x, y, B),
where (x, y, B) is any seed in the underlying cluster pattern.
The remarkable Laurent phenomenon asserts the following.
Theorem 2.6. (See [22, Theorem 3.1].) The cluster algebra A associated with a seed (x, y, B) is
contained in the Laurent polynomial ring ZP[x±1 ], i.e. every element of A is a Laurent polynomial over ZP in the cluster variables from x = (x1 , . . . , xn ).
Definition 2.7. Let A be a cluster algebra, Σ be a seed, and x be a cluster variable of A. We
denote by [x]A
Σ the Laurent polynomial given by Theorem 2.6 which expresses x in terms of the
cluster variables from Σ , and call it the cluster expansion of x in terms of Σ.
The longstanding positivity conjecture [22] says that even more is true.
Conjecture 2.8 (Positivity conjecture). For any cluster algebra A, any seed Σ , and any cluster
variable x, the Laurent polynomial [x]A
Σ has coefficients which are non-negative integer linear
combinations of elements in P.
Remark 2.9. In cluster algebras whose ground semifield is Trop(u1 , . . . , um ) (the tropical semifield), it is convenient to replace the matrix B by an (n + m) × n matrix B = (bij ) whose upper
part is the n × n matrix B and whose lower part is an m × n matrix that encodes the coefficient
tuple via
m

yk =

b

ui (n+i)k .
i=1

(2.7)

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2247

Then the mutation of the coefficient tuple in Eq. (2.3) is determined by the mutation of the
matrix B in Eq. (2.2) and the formula (2.7); and the exchange relation (2.4) becomes
xk = xk−1

n

[bik ]+

m

[b(n+i)k ]+

xi
i=1

ui
i=1

n

+

[−bik ]+

m

xi
i=1

[−b(n+i)k ]+

ui

.

(2.8)

i=1

2.2. Finite type and finite mutation type classification
We say that a cluster algebra is of finite type if it has finitely many seeds. It turns out that
the classification of finite type cluster algebras is parallel to the Cartan–Killing classification of
complex simple Lie algebras [23]. More specifically, define the diagram Γ (B) associated to an
n × n exchange matrix B to be a weighted directed graph on nodes v1 , . . . , vn , with vi directed
towards vj if and only if bij > 0. In that case, we label this edge by |bij bj i |. Then A = A(x, y, B)
is of finite type if and only if Γ (B) is mutation-equivalent to an orientation of a finite type Dynkin
diagram [23]. In this case, we say that B and Γ (B) are of finite type.
We say that a matrix B (and the corresponding cluster algebra) has finite mutation type if its
mutation equivalence class is finite, i.e. only finitely many matrices can be obtained from B
by repeated matrix mutations. A classification of all cluster algebras of finite mutation type
with skew-symmetric exchange matrices was given by Felikson, Shapiro, and Tumarkin [16].
In particular, all but 11 of them come from either cluster algebras of rank 2 or cluster algebras
associated with triangulations of surfaces (see Section 3).
2.3. Cluster algebras with principal coefficients
Fomin and Zelevinsky introduced in [24] a special type of coefficients, called principal coefficients.
Definition 2.10 (Principal coefficients). We say that a cluster pattern t → (xt , yt , Bt ) on Tn
(or the corresponding cluster algebra A) has principal coefficients at a vertex t0 if P =
Trop(y1 , . . . , yn ) and yt0 = (y1 , . . . , yn ). In this case, we denote A = A• (Bt0 ).
Remark 2.11. Definition 2.10 can be rephrased as follows: a cluster algebra A has principal
coefficients at a vertex t0 if A is of geometric type, and is associated with the matrix Bt0 of order
2n × n whose upper part is Bt0 , and whose complementary (i.e., bottom) part is the n × n identity
matrix (cf. [22, Corollary 5.9]).
Definition 2.12 (The functions X ;t and F ,t ). Let A be the cluster algebra with principal coefficients at t0 , defined by the initial seed Σt0 = (xt0 , yt0 , Bt0 ) with
xt0 = (x1 , . . . , xn ),

yt0 = (y1 , . . . , yn ),

0
.
Bt0 = B 0 = bij

By the Laurent phenomenon, we can express every cluster variable x
polynomial in x1 , . . . , xn , y1 , . . . , yn ; we denote this by
X

;t

=X

B 0 ;t0
;t .

;t

(2.9)

as a (unique) Laurent

(2.10)

2248

Let F

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

;t

=F

B 0 ;t0
;t

denote the Laurent polynomial obtained from X

;t

by

F ;t (y1 , . . . , yn ) = X ;t (1, . . . , 1; y1 , . . . , yn ).

(2.11)

F ;t (y1 , . . . , yn ) turns out to be a polynomial [24] and is called an F -polynomial.
Knowing the cluster expansions for a cluster algebra with principal coefficients allows one to
compute the cluster expansions for the “same” cluster algebra with an arbitrary coefficient system. To explain this, we need an additional notation. If F is a subtraction-free rational expression
over Q in several variables, R a semifield, and u1 , . . . , ur some elements of R, then we denote
by F |R (u1 , . . . , ur ) the evaluation of F at u1 , . . . , ur .
Theorem 2.13. (See [24, Theorem 3.7].) Let A be a cluster algebra over an arbitrary semifield P
and contained in the ambient field F , with a seed at an initial vertex t0 given by
(x1 , . . . , xn ), y1∗ , . . . , yn∗ , B 0 .
Then the cluster variables in A can be expressed as follows:

x

;t

=

X

B 0 ;t0
∗
∗
;t |F (x1 , . . . , xn ; y1 , . . . , yn )
.
B 0 ;t
F ;t 0 |P (y1∗ , . . . , yn∗ )

(2.12)

When P is a tropical semifield, the denominator of Eq. (2.12) is a monomial. Therefore if the
Laurent polynomial X ;t has positive coefficients, so does x ;t .
Corollary 2.14. Let A be the cluster algebra with principal coefficients at a vertex t0 , defined by
the initial seed Σt0 = (xt0 , yt0 , Bt0 ). Let A be any cluster algebra of geometric type defined by
the same exchange matrix Bt0 . If the positivity conjecture holds for A, then it also holds for A.
3. Cluster algebras arising from surfaces
Building on work of Fock and Goncharov [17,19], and of Gekhtman, Shapiro and Vainshtein [27], Fomin, Shapiro and Thurston [20] associated a cluster algebra to any bordered
surface with marked points. In this section we will recall that construction, as well as further
results of Fomin and Thurston [21].
Definition 3.1 (Bordered surface with marked points). Let S be a connected oriented 2-dimensional Riemann surface with (possibly empty) boundary. Fix a non-empty set M of marked points
in the closure of S with at least one marked point on each boundary component. The pair (S, M)
is called a bordered surface with marked points. Marked points in the interior of S are called
punctures.
For technical reasons, we require that (S, M) is not a sphere with one, two or three punctures;
a monogon with zero or one puncture; or a bigon or triangle without punctures.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2249

Fig. 1. Example of an ideal triangulation on the left and the corresponding tagged triangulation on the right.

3.1. Ideal triangulations and tagged triangulations
Definition 3.2 (Ordinary arcs). An arc γ in (S, M) is a curve in S, considered up to isotopy, such
that: the endpoints of γ are in M; γ does not cross itself, except that its endpoints may coincide;
except for the endpoints, γ is disjoint from M and from the boundary of S; and γ does not cut
out an unpunctured monogon or an unpunctured bigon.
An arc whose endpoints coincide is called a loop. Curves that connect two marked points and
lie entirely on the boundary of S without passing through a third marked point are boundary
segments. By (c), boundary segments are not ordinary arcs.
Definition 3.3 (Crossing numbers and compatibility of ordinary arcs). For any two arcs γ , γ
in S, let e(γ , γ ) be the minimal number of crossings of arcs α and α , where α and α range
over all arcs isotopic to γ and γ , respectively. We say that arcs γ and γ are compatible if
e(γ , γ ) = 0.
Definition 3.4 (Ideal triangulations). An ideal triangulation is a maximal collection of pairwise
compatible arcs (together with all boundary segments). The arcs of a triangulation cut the surface
into ideal triangles.
There are two types of ideal triangles: triangles that have three distinct sides and triangles that
have only two. The latter are called self-folded triangles. Note that a self-folded triangle consists
of a loop , together with an arc r to an enclosed puncture which we dub a radius, see the left
side of Fig. 1.
Definition 3.5 (Ordinary flips). Ideal triangulations are connected to each other by sequences of
flips. Each flip replaces a single arc γ in a triangulation T by a (unique) arc γ = γ that, together
with the remaining arcs in T , forms a new ideal triangulation.
Note that an arc γ that lies inside a self-folded triangle in T cannot be flipped.
In [20], the authors associated a cluster algebra to any bordered surface with marked points.
Roughly speaking, the cluster variables correspond to arcs, the clusters to triangulations, and
the mutations to flips. However, because arcs inside self-folded triangles cannot be flipped, the
authors were led to introduce the slightly more general notion of tagged arcs. They showed that
ordinary arcs can all be represented by tagged arcs and gave a notion of flip that applies to all
tagged arcs.

2250

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Definition 3.6 (Tagged arcs). A tagged arc is obtained by taking an arc that does not cut out a
once-punctured monogon and marking (“tagging”) each of its ends in one of two ways, plain or
notched, so that the following conditions are satisfied:
• an endpoint lying on the boundary of S must be tagged plain,
• both ends of a loop must be tagged in the same way.
Definition 3.7 (Representing ordinary arcs by tagged arcs). One can represent an ordinary arc β
by a tagged arc ι(β) as follows. If β does not cut out a once-punctured monogon, then ι(β) is
simply β with both ends tagged plain. Otherwise, β is a loop based at some marked point a
and cutting out a punctured monogon with the sole puncture b inside it. Let α be the unique arc
connecting a and b and compatible with β. Then ι(β) is obtained by tagging α plain at a and
notched at b.
Definition 3.8 (Compatibility of tagged arcs). Tagged arcs α and β are called compatible if and
only if the following properties hold:
• the arcs α 0 and β 0 obtained from α and β by forgetting the taggings are compatible;
• if α 0 = β 0 then at least one end of α must be tagged in the same way as the corresponding
end of β;
• if α 0 = β 0 but they share an endpoint a, then the ends of α and β connecting to a must be
tagged in the same way.
Definition 3.9 (Tagged triangulations). A maximal (by inclusion) collection of pairwise compatible tagged arcs is called a tagged triangulation.
Fig. 1 gives an example of an ideal triangulation T and the corresponding tagged triangulation ι(T ). The notching is indicated by a bow tie.
3.2. From surfaces to cluster algebras
One can associate an exchange matrix and hence a cluster algebra to any bordered surface
(S, M) [20].
Definition 3.10 (Signed adjacency matrix of an ideal triangulation). Choose any ideal triangulation T , and let τ1 , τ2 , . . . , τn be the n arcs of T . For any triangle in T which is not self-folded,
we define a matrix B = (bij )1 i n, 1 j n as follows.
• bij = 1 and bj i = −1 in the following cases:
(a) τi and τj are sides of with τj following τi in the clockwise order;
(b) τj is a radius in a self-folded triangle enclosed by a loop τ , and τi and τ are sides of
with τ following τi in the clockwise order;
(c) τi is a radius in a self-folded triangle enclosed by a loop τ , and τ and τj are sides of
with τj following τ in the clockwise order;
• bij = 0 otherwise.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Then define the matrix BT = (bij )1 i
all triangles in T that are not self-folded.

n, 1 j

n

by bij =

2251

bij , where the sum is taken over

Note that BT is skew-symmetric and each entry bij is either 0, ±1, or ±2, since every arc τ
is in at most two triangles.
Remark 3.11. As noted in [20, Definition 9.2], compatibility of tagged arcs is invariant with respect to a simultaneous change of all tags at a given puncture. So given a tagged triangulation T ,
let us perform such changes at every puncture where all ends of T are notched. The resulting
tagged triangulation T represents an ideal triangulation T 0 (possibly containing self-folded triangles): T = ι(T 0 ). This is because the only way for a puncture p to have two incident arcs with
two different taggings at p is for those two arcs to be homotopic, see Definition 3.8. But then
for this to lie in some tagged triangulation, it follows that p must be a puncture in the interior of
a bigon. See Fig. 1.
Definition 3.12 (Signed adjacency matrix of a tagged triangulation). The signed adjacency matrix BT of a tagged triangulation T is defined to be the signed adjacency matrix BT 0 , where T 0 is
obtained from T as in Remark 3.11. The index sets of the matrices (which correspond to tagged
and ideal arcs, respectively) are identified in the obvious way.
Theorem 3.13. (See [20, Theorem 7.11] and [21, Theorem 5.1].) Fix a bordered surface (S, M)
and let A be the cluster algebra associated to the signed adjacency matrix of a tagged triangulation as in Definition 3.12. Then the (unlabeled) seeds ΣT of A are in bijection with tagged
triangulations T of (S, M), and the cluster variables are in bijection with the tagged arcs of
(S, M) (so we can denote each by xγ , where γ is a tagged arc). Moreover, each seed in A is
uniquely determined by its cluster. Furthermore, if a tagged triangulation T is obtained from
another tagged triangulation T by flipping a tagged arc γ ∈ T and obtaining γ , then ΣT is
obtained from ΣT by the seed mutation replacing xγ by xγ .
Remark 3.14. By a slight abuse of notation, if γ is an ordinary arc which does not cut out a
once-punctured monogon (so that the tagged arc ι(γ ) is obtained from γ by tagging both ends
plain), we will often write xγ instead of xι(γ ) .
Given a surface (S, M) with a puncture p and a tagged arc γ , we let both γ (p) and γ p denote
the arc obtained from γ by changing its notching at p. (So if γ is not incident to p, γ (p) = γ .) If
p and q are two punctures, we let γ (pq) denote the arc obtained from γ by changing its notching
at both p and q. Given a tagged triangulation T of S, we let T p denote the tagged triangulation
obtained from T by replacing each γ ∈ T by γ (p) .
Besides labeling cluster variables of A(BT ) by xτ , where τ is a tagged arc of (S, M), we will
also make the following conventions:
• If is an unnotched loop with endpoints at q cutting out a once-punctured monogon containing puncture p and radius r, then we set x = xr xr (p) .2
• If β is a boundary segment, we set xβ = 1.
2 There is a corresponding statement on the level of lambda lengths of these three arcs, see [21, Lemma 7.2]; these
conventions are compatible with both the Ptolemy relations and the exchange relations among cluster variables [21,
Theorem 7.5].

2252

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

To prove the positivity conjecture, we must show that the Laurent expansion of each cluster
variable with respect to any cluster is positive. In the context of surfaces, the next result will
allow us to restrict our attention to clusters corresponding to ideal triangulations.
p

p

Proposition 3.15. Fix (S, M), p, γ , T = (τ1 , . . . , τn ), and T p = (τ1 , . . . , τn ) as above. Let
A = A• (BT ), and Ap = A• (BT p ) be the cluster algebras with principal coefficients at the
seeds ΣT = (x, y, BT ) and ΣT p = (xp , yp , BT p ), where x = {xτi }, y = {yτi }, xp = {xτ p }, and
i
yp = {yτ p }. Then
i

A
[xγ p ]A
ΣT p = [xγ ]ΣT |xτi ←xτ p , yτi ←yτ p .
p

i

i

That is, the cluster expansion of xγ p with respect to xp in Ap is obtained from the cluster expansion of xγ with respect to x in A by substituting xτi = xτ p and yτi = yτ p .
i

i

Proof. By Definition 3.12, the rectangular exchange matrix BT is equal to BT (p) . The columns
p
of BT are indexed by {xτi } and the columns of BT are indexed by {xτ p }; the rows of BT are
i

p

indexed by {xτi } ∪ {yτi } and the rows of BT are indexed by {xτ p } ∪ {yτ p }.
i
i
To compute the x-expansion of xγ , we write down a sequence of flips (i1 , . . . , ir ) (here
1 ij n) which transforms T into a tagged triangulation T containing γ . Applying the corresponding exchange relations then gives the x-expansion of xγ in A. By the description of tagged
flips [21, Remark 4.13], performing the same sequence of flips on T p transforms T p into the
tagged triangulation T p , which in particular contains γ p . Therefore applying the corresponding
exchange relations gives the xp -expansion of xγ p in Ap .
Since in both cases we start from the same exchange matrix and apply the same sequence
of mutations, the xp -expansion of xγ p in Ap will be equal to the x-expansion of xγ in A after
relabeling variables, i.e. after substituting xτi = xτ p and yτi = yτ p . ✷
i

i

Corollary 3.16. Fix a bordered surface (S, M) and let A be the corresponding cluster algebra.
Let T be an arbitrary tagged triangulation. To prove the positivity conjecture for A with respect
to xT , it suffices to prove positivity with respect to clusters of the form xι(T 0 ) , where T 0 is an
ideal triangulation.
Proof. As in Remark 3.11, we can perform simultaneous tag-changes at punctures to pass from
an arbitrary tagged triangulation T to a tagged triangulation T representing an ideal triangulation.
By a repeated application of Proposition 3.15 – which preserves positivity because it just involves
a substitution of variables – we can then express cluster expansions with respect to xT in terms
of cluster expansions with respect to xT . ✷
The exchange relation corresponding to a flip in an ideal triangulation is called a generalized
Ptolemy relation. It can be described as follows.
Proposition 3.17. (See [21].) Let α, β, γ , δ be arcs (including loops) or boundary segments
of (S, M) which cut out a quadrilateral; we assume that the sides of the quadrilateral, listed

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2253

Fig. 2. Illustrations for Proposition 3.17 and Definition 3.19.

in cyclic order, are α, β, γ , δ. Let η and θ be the two diagonals of this quadrilateral; see the
left-hand side of Fig. 2. Then
xη x θ = Y x α x γ + Y x β x δ
for some coefficients Y and Y .
Proof. This follows from the interpretation of cluster variables as lambda lengths and the
Ptolemy relations for lambda lengths [21, Theorem 7.5 and Proposition 6.5]. ✷
Note that some sides of the quadrilateral in Proposition 3.17 may be glued to each other,
changing the appearance of the relation. There are also generalized Ptolemy relations for tagged
triangulations, see [21, Definition 7.4].
3.3. Keeping track of coefficients using laminations
So far we have not addressed the topic of coefficients for cluster algebras arising from bordered surfaces. It turns out that W. Thurston’s theory of measured laminations gives a concrete
way to think about coefficients, as described in [21] (see also [18]).
Definition 3.18 (Laminations). A lamination on a bordered surface (S, M) is a finite collection
of non-self-intersecting and pairwise non-intersecting curves in S \ M, modulo isotopy relative
to M, subject to the following restrictions. Each curve must be one of the following:
• a closed curve;
• a curve connecting two unmarked points on the boundary of S;
• a curve starting at an unmarked point on the boundary and, at its other end, spiraling into a
puncture (either clockwise or counterclockwise);
• a curve whose ends both spiral into punctures (not necessarily distinct).
Also, we forbid curves that bound an unpunctured or once-punctured disk, and curves with two
endpoints on the boundary of S which are isotopic to a piece of boundary containing zero or one
marked point.
In [21, Definitions 12.1 and 12.3], the authors define shear coordinates and extended exchange
matrices, with respect to a tagged triangulation. For our purposes, it will be enough to make these
definitions with respect to an ideal triangulation.

2254

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 3. Examples of elementary laminations.

Definition 3.19 (Shear coordinates). Let L be a lamination, and let T be an ideal triangulation. For each arc γ ∈ T , the corresponding shear coordinate of L with respect to T , denoted by
bγ (T , L), is defined as a sum of contributions from all intersections of curves in L with γ . Specifically, such an intersection contributes +1 (respectively, −1) to bγ (T , L) if the corresponding
segment of a curve in L cuts through the quadrilateral surrounding γ as shown in Fig. 2 in the
middle (respectively, right).
Definition 3.20 (Multi-laminations and associated extended exchange matrices). A multilamination is a finite family of laminations. Fix a multi-lamination L = (Ln+1 , . . . , Ln+m ). For
an ideal triangulation T of (S, M), define the matrix B = B(T , L) = (bij ) as follows. The top
n × n part of B is the signed adjacency matrix B(T ), with rows and columns indexed by arcs
γ ∈ T (or equivalently, by the tagged arcs ι(γ ) ∈ ι(T )). The bottom m rows are formed by the
shear coordinates of the laminations Li with respect to T :
bn+i,γ = bγ (T , Ln+i ) if 1

i

m.

By [21, Theorem 11.6], the matrices B(T ) transform compatibly with mutation.
Definition 3.21 (Elementary lamination associated with a tagged arc). Let γ be a tagged arc
in (S, M). Denote by Lγ a lamination consisting of a single curve defined as follows. The
curve Lγ runs along γ within a small neighborhood of it. If γ has an endpoint a on a (circular) component C of the boundary of S, then Lγ begins at a point a ∈ C located near a in
the counterclockwise direction, and proceeds along γ as shown in Fig. 3 on the left. If γ has an
endpoint at a puncture, then Lγ spirals into a: counterclockwise if γ is tagged plain at a, and
clockwise if it is notched.
The following result comes from [21, Proposition 16.3].
Proposition 3.22. Let T be an ideal triangulation with a signed adjacency matrix B(T ). Recall
that we can view T as a tagged triangulation ι(T ). Let LT = (Lγ )γ ∈ι(T ) be the multi-lamination
consisting of elementary laminations associated with the tagged arcs in ι(T ). Then the cluster
algebra with principal coefficients A• (B(T )) is isomorphic to A(B(T , LT )).
4. Main results: cluster expansion formulas
In this section we present cluster expansion formulas for cluster variables in a cluster algebra
associated to a bordered surface, with respect to a seed corresponding to an ideal triangulation;
by Proposition 3.15 and Corollary 3.16, this enables us to compute cluster expansion formulas

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2255

Fig. 4. Possible tiles corresponding to crossing a radius of a bigon.

with respect to an arbitrary seed by an appropriate substitution of variables. Since our formulas
are given in the system of principal coefficients and are manifestly positive, this proves positivity
for any cluster algebra of geometric type associated to a bordered surface.
We present three slightly different formulas, based on whether the cluster variable corresponds
to a tagged arc with 0, 1, or 2 notched ends. More specifically, fix an ordinary arc γ and a tagged
triangulation T = ι(T ◦ ) of (S, M), where T ◦ is an ideal triangulation. We recursively construct
an edge-weighted graph GT ◦ ,γ by glueing together tiles based on the local configuration of the
intersections between γ and T ◦ . Our formula (Theorem 4.10) for xγ with respect to ΣT is given
in terms of perfect matchings of GT ◦ ,γ . This formula also holds for the cluster algebra element
x = xr xr (p) , where is a loop cutting out a once-punctured monogon enclosing the puncture p
and radius r. In the case of γ (p) , an arc between points p and q with a single notch at p, we build
the graph GT ◦ , p associated to the loop p such that ι( p ) = γ (p) . Our combinatorial formula
(Theorem 4.17) for xγ (p) is then in terms of the so-called γ -symmetric matchings of GT ◦ , p .
In the case of γ (pq) , an arc between points p and q which is notched at both p and q, we
build the two graphs GT ◦ , p and GT ◦ , q associated to p and q . Our combinatorial formula
(Theorem 4.20) for xγ (pq) is then in terms of the γ -compatible pairs of matchings of GT ◦ , p
and GT ◦ , q .
4.1. Tiles
Let T ◦ be an ideal triangulation of a bordered surface (S, M) and let γ be an ordinary arc in
(S, M) which is not in T ◦ . Choose an orientation on γ , let s ∈ M be its starting point, and let
t ∈ M be its endpoint. We denote by s = p0 , p1 , p2 , . . . , pd+1 = t the points of intersection of γ
and T ◦ in order. Let τij be the arc of T ◦ containing pj , and let j −1 and j be the two ideal
triangles in T ◦ on either side of τij .
To each pj we associate a tile Gj , an edge-labeled triangulated quadrilateral (see the rightj
j
hand side of Fig. 4), which is defined to be the union of two edge-labeled triangles 1 and 2
j
j
glued at an edge labeled τij . The triangles 1 and 2 are determined by j −1 and j as follows.
If neither j −1 nor j is self-folded, then they each have three distinct sides (though possibly
j
j
fewer than three vertices), and we define 1 and 2 to be the ordinary triangles with edges
j
j
labeled as in j −1 and j . We glue 1 and 2 at the edge labeled τij , so that the orientations
j

j

of 1 and 2 both either agree or disagree with those of j −1 and j ; this gives two possible
planar embeddings of a graph Gj which we call an ordinary tile.
If one of j −1 or j is self-folded, then in fact T ◦ must have a local configuration of a bigon
(with sides a and b) containing a radius r incident to a puncture p inscribed inside a loop , see
Fig. 5. Moreover, γ must either

2256

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 5. Possible triple tiles for crossing a self-folded triangle.

(1) start at the puncture p and intersect the loop ,
(2) intersect the loop and terminate at the puncture p, or
(3) intersect the loop , radius r and then again.
In cases (1) and (2), we associate to pj (the intersection point with ) an ordinary tile Gj
consisting of a triangle with sides {a, b, } which is glued along diagonal to a triangle with
sides { , r, r}. As before there are two possible planar embeddings of Gj .
In case (3), we have a triple pk−1 , pk , pk+1 of consecutive intersection points (the intersection
with , r, and again), one of which is pj . To this triple we associate a union of tiles Gj −1 ∪
Gj ∪ Gj +1 , which we call a triple tile, based on whether γ enters and exits through different
sides of the bigon or through the same side. These graphs are defined by Fig. 5 (each possibility
is denoted in boldface within a concatenation of five tiles). Note that in each case there are two
possible planar embeddings of the triple tile. We call the tiles Gj −1 and Gj +1 within the triple
tile ordinary tiles.
Definition 4.1 (Relative orientation). Given a planar embedding Gj of an ordinary tile Gj , we
define the relative orientation rel(Gj , T ◦ ) of Gj with respect to T ◦ to be ±1, based on whether
its triangles agree or disagree in orientation with those of T ◦ .
Note that in Fig. 5, the southwest-most tile in each of the three graphs in the middle (respectively, rightmost) column has relative orientation +1 (respectively, −1). Also note that by
construction, the planar embedding of a triple tile Gj −1 ∪ Gj ∪ Gj +1 satisfies rel(Gj −1 , T ◦ ) =
rel(Gj +1 , T ◦ ).

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2257

Fig. 6. Glueing tiles Gj and Gj +1 along the edge labeled τ[γj ] .

Definition 4.2. Using the notation above, the arcs τij and τij +1 form two edges of a triangle j
in T ◦ . Define τ[γj ] to be the third arc in this triangle if j is not self-folded, and to be the radius
in j otherwise.
4.2. The graph GT ◦ ,γ
We now build a graph by glueing together tiles G1 , . . . , Gd . We start by choosing a planar
embedding G1 of G1 (thus rel(G1 , T ◦ ) = ±1), then recursively attach tiles G2 , . . . , Gd in order
from 2 to d, subject to the following conditions.
(1) Triple tiles must stay glued together as in Fig. 5.
(2) For two adjacent ordinary tiles, each of which may be an exterior tile of a triple tile, we
glue Gj +1 to Gj along the edges labeled τ[γj ] , choosing a planar embedding Gj +1 for Gj +1
so that rel(Gj +1 , T ◦ ) = rel(Gj , T ◦ ). See Fig. 6.
After glueing together the d tiles, we obtain a graph (embedded in the plane), which we
denote GT ◦ ,γ . Let GT ◦ ,γ be the graph obtained from GT ◦ ,γ by removing the diagonal in each tile.
Fig. 5 gives examples of a dotted arc γ and the corresponding graph GT ◦ ,γ . Each γ intersects T ◦
five times, so each GT ◦ ,γ has five tiles.
Remark 4.3. Abusing notation, we will also use the word tile to refer to the graph obtained from
a tile by deleting its diagonal.
Remark 4.4. Even if γ is a curve with self-intersections, our definition of GT ◦ ,γ makes sense.
This is relevant to our formula for the doubly-notched loop, see Remark 4.22.
4.3. Cluster expansion formula for ordinary arcs
Recall that if τ is a boundary segment then xτ = 1, and if τ is a loop cutting out a oncepunctured monogon with radius r and puncture p, then xτ = xr xr (p) . Also see Remark 3.14.
Before giving the next result, we need to introduce some notation.
Definition 4.5 (Crossing monomial). If γ is an ordinary arc and τi1 , τi2 , . . . , τid is the sequence
of arcs in T ◦ which γ crosses, we define the crossing monomial of γ with respect to T ◦ to be
cross T ◦ , γ =

d
j =1

xτij .

2258

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Definition 4.6 (Perfect matchings and weights). A perfect matching of a graph G is a subset P
of the edges of G such that each vertex of G is incident to exactly one edge of P . If the edges of
a perfect matching P of GT ◦ ,γ are labeled τj1 , . . . , τjr , then we define the weight x(P ) of P to
be xτj1 · · · xτjr .
Definition 4.7 (Minimal and maximal matchings). By induction on the number of tiles it is easy
to see that GT ◦ ,γ has precisely two perfect matchings which we call the minimal matching P− =
P− (GT ◦ ,γ ) and the maximal matching P+ = P+ (GT ◦ ,γ ), which contain only boundary edges.
To distinguish them, if rel(G1 , T ◦ ) = 1 (respectively, −1), we define e1 and e2 to be the two
edges of GT ◦ ,γ which lie in the counterclockwise (respectively, clockwise) direction from the
diagonal of G1 . Then P− is defined as the unique matching which contains only boundary edges
and does not contain edges e1 or e2 . P+ is the other matching with only boundary edges.
For an arbitrary perfect matching P of GT ◦ ,γ , we let P−
defined as P− P = (P− ∪ P ) \ (P− ∩ P ).

P denote the symmetric difference,

Lemma 4.8. (See [32, Theorem 5.1].) The set P− P is the set of boundary edges of a (possibly
disconnected) subgraph GP of GT ◦ ,γ , which is a union of cycles. These cycles enclose a set of
tiles j ∈J Gij , where J is a finite index set.
We use this decomposition to define height monomials for perfect matchings. Note that the
exponents in the height monomials defined below coincide with the definition of height functions
given in [35] for perfect matchings of bipartite graphs, based on earlier work of [12,15,41] for
domino tilings.
Definition 4.9 (Height monomial and specialized height monomial). Let T ◦ = {τ1 , τ2 , . . . , τn }
be an ideal triangulation of (S, M) and γ be an ordinary arc of (S, M). By Lemma 4.8, for any
perfect matching P of GT ◦ ,γ , P P− encloses the union of tiles j ∈J Gij . We define the height
monomial h(P ) of P by
n

h(P ) =

k
hm
τk ,

k=1

where mk is the number of tiles in j ∈J Gij whose diagonal is labeled τk .
We define the specialized height monomial y(P ) of P to be the specialization Φ(h(P )), where
Φ is defined below:
⎧
if τi is not a side of a self-folded triangle;
⎪
⎨ yτi
yr
Φ(hτi ) = y (p) if τi is a radius r to puncture p in a self-folded triangle;
⎪
⎩ r
yr (p) if τi is a loop in a self-folded triangle with radius r to puncture p.
Theorem 4.10. Let (S, M) be a bordered surface with an ideal triangulation T ◦ , and let T =
{τ1 , τ2 , . . . , τn } = ι(T ◦ ) be the corresponding tagged triangulation. Let A be the corresponding
cluster algebra with principal coefficients with respect to ΣT = (xT , yT , BT ), and let γ be an
ordinary arc in S (this may include a loop cutting out a once-punctured monogon). Let GT ◦ ,γ
be the graph constructed in Section 4.2. Then the Laurent expansion of xγ with respect to ΣT is
given by

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

[xγ ]A
ΣT =

1
cross(T ◦ , γ )

2259

x(P )y(P ),
P

where the sum is over all perfect matchings P of GT ◦ ,γ .
Sections 7–9 set up the auxiliary results which are used for the proof of Theorem 4.10, which
is given in Section 10. See Section 6 for an outline of the proof.
Remark 4.11. This expansion as a Laurent polynomial does not necessarily yield a reduced
fraction, which is why our denominators are defined in terms of crossing numbers as opposed to
the intersection numbers (α|β) defined in Section 8 of [20].
4.4. Cluster expansion formulas for tagged arcs with notches
We now consider cluster variables of tagged arcs which have a notched end. The following
remark shows that if we want to compute the Laurent expansion of a cluster variable associated to
a tagged arc notched at p, with respect to a tagged triangulation T , there is no loss of generality
in assuming that all arcs in T are tagged plain at p.
Remark 4.12. Fix a tagged triangulation T of (S, M) such that T = ι(T ◦ ), where T ◦ is an ideal
triangulation. Let p and q (possibly p = q) be two marked points, and let γ denote an ordinary
arc between p and q. If p is a puncture and we are interested in computing the Laurent expansion
of xγ (p) with respect to T , we may assume that no tagged arc in T is notched at p. Otherwise,
by changing the tagging of T and γ (p) at p, and applying Proposition 3.15, we could reduce the
computation of the Laurent expansion of xγ (p) to our formula for cluster variables corresponding
to ordinary arcs. Note that if there is no tagged arc in T which is notched at p, then there is no
loop in T ◦ cutting out a once-punctured monogon around p. Similarly, if p and q are punctures
and we are interested in computing the Laurent expansion of xγ (pq) with respect to T , we may
assume that no tagged arc in T is notched at either p or q (equivalently, there are no loops
in T ◦ cutting out once-punctured monogons around p or q). We will make these assumptions
throughout this section.
Additionally, when we give our formulas for Laurent expansions for arcs γ (p) and γ (pq) with
one or two notches, we will treat separately the case that γ ∈
/ T ◦ and γ ∈ T ◦ . When γ ∈ T ◦ , so
that xγ is an initial cluster variable, the Laurent expansion for γ (p) may be obtained from the formula x p = xγ xγ (p) and our Laurent expansion for x p , noting that xγ is an initial variable. And
when γ ∈ T ◦ , the positivity of xγ (pq) will be treated separately in Proposition 4.21. Therefore the
definitions and results which follow – with the exception of Proposition 4.21 – will assume that
γ∈
/ T ◦.
Before giving our formulas, we must introduce some notation.
Definition 4.13 (Crossing monomials for tagged arcs with notches). Let γ be an ordinary arc,
incident to a puncture p, and assume that γ ∈
/ T ◦ . Let γ (p) be the tagged arc obtained from γ by
notching at p. We define the associated crossing monomial as
cross T ◦ , γ (p) =

cross(T ◦ , p )
= cross T ◦ , γ
cross(T ◦ , γ )

xτ ,
τ

2260

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 7. Possible local configurations around a puncture.

where the product is over all ends of arcs τ of T ◦ that are incident to p. If p and q are punctures
and γ (pq) is a tagged arc with a notch at p and q, we define the associated crossing monomial as
cross T ◦ , γ (pq) =

cross(T ◦ , p )cross(T ◦ ,
cross(T ◦ , γ )3

q)

= cross T ◦ , γ

xτ ,
τ

where the product is over all ends of arcs τ that are incident to p or q.
Our formula computing the Laurent expansion of a cluster variable xγ (p) with exactly one
notched end (at the puncture p) involves γ -symmetric matchings of the graph associated to the
ideal arc p corresponding to γ (p) (so ι( p ) = γ (p) ). Note that p is a loop cutting out a oncepunctured monogon around p.
Our goal now is to define γ -symmetric matchings. For an arc τ ∈ T ◦ and a puncture p, let
ep (τ ) denote the number of ends of τ incident to p (so if τ is a loop with its ends at p, ep (τ ) = 2).
We let ep = ep (T ◦ ) = τ ∈T ◦ ep (τ ). Keeping the notation of Section 4.1, orient γ from q to p,
let τi1 , τi2 , . . . , τid denote the arcs crossed by γ in order, and let 0 , . . . , d+1 be the sequence of
ideal triangles in T ◦ which γ passes through. We let ζ1 and ζep denote the sides of triangle d+1
not crossed by γ (by Remark 4.12, ζ1 = ζep ), so that τid follows ζep and ζep follows ζ1 in
clockwise order around d+1 . Let ζ2 through ζep −1 denote the labels of the other arcs incident
to puncture p in order as we follow p clockwise around p. Note that if T ◦ contains a loop τ
based at p, then τ appears twice in the multiset {ζ1 , . . . , ζep }. Fig. 7 shows some possible local
configurations around a puncture.
Definition 4.14 (Subgraphs GT ◦ ,γ ,p,1 , GT ◦ ,γ ,p,2 , HT ◦ ,γ ,p,1 , and HT ◦ ,γ ,p,2 of GT ◦ , p ). Since
p is a loop cutting out a once-punctured monogon with radius γ and puncture p, the graph
GT ◦ , p contains two disjoint connected subgraphs, one on each end, both of which are isomorphic to GT ◦ ,γ . Therefore each subgraph consists of a union of tiles Gτi1 through Gτid ; we let
GT ◦ ,γ ,p,1 and GT ◦ ,γ ,p,2 denote these two subgraphs.
Let v1 and v2 be the two vertices of tiles Gτid in GT ◦ , p incident to the edges labeled ζ1
and ζep . For i ∈ {1, 2}, we let HT ◦ ,γ ,p,i be the connected subgraph of GT ◦ ,γ ,p,i which is obtained
by deleting vi and the two edges incident to vi . See Fig. 8.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 8. GT ◦ ,

p,

2261

with subgraphs GT ◦ ,γ ,p,i and HT ◦ ,γ ,p,i shaded as indicated.

Definition 4.15 (γ -symmetric matching). Having fixed an ideal triangulation T ◦ and an ordinary
arc γ between p and q, we call a perfect matching P of GT ◦ , p γ -symmetric if the restrictions
of P to the two ends satisfy P |HT ◦ ,γ ,p,1 ∼
= P |HT ◦ ,γ ,p,2 .
Definition 4.16 (Weight and height monomials of a γ -symmetric matching). Fix a γ -symmetric
matching P of GT ◦ , p . By Lemma 12.4, P restricts to a perfect matching of (without loss of
generality) GT ◦ ,γ ,p,1 . Therefore the following definitions of weight and (specialized) height
monomials x(P ) and y(P ) are well defined:
x(P ) =

x(P )
,
x(P |GT ◦ ,γ ,1 )

y(P ) =

y(P )
.
y(P |GT ◦ ,γ ,1 )

We are now ready to state our result for tagged arcs with one notched end.
Theorem 4.17. Let (S, M) be a bordered surface with puncture p and tagged triangulation
T = {τ1 , τ2 , . . . , τn } = ι(T ◦ ) where T ◦ is an ideal triangulation. Let A be the corresponding
cluster algebra with principal coefficients with respect to ΣT . Let γ be an ordinary arc with
one end incident to p, and let p be the ordinary arc corresponding to γ (p) (so ι( p ) = γ (p) ).
Without loss of generality we can assume that T contains no arc notched at p and that γ ∈
/ T (see
Remark 4.12). Let GT ◦ , p be the graph constructed in Section 4.2. Then the Laurent expansion
of xγ (p) with respect to ΣT is given by
[xγ (p) ]A
ΣT =

1
cross(T ◦ , γ (p) )

x(P )y(P ),
P

where the sum is over all γ -symmetric matchings P of GT ◦ , p .
We prove Theorem 4.17 in Section 12.1. For the case of a tagged arc with notches at both
ends, we need two more definitions in the same spirit as the above notation.

2262

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Definition 4.18 (γ -compatible pair of matchings). Assume that the tagged triangulation T
does not contain either γ , γ (p) , or γ (q) . Let Pp and Pq be γ -symmetric matchings of GT ◦ , p
and GT ◦ , q , respectively. By Lemma 12.4, without loss of generality, Pp |GT ◦ ,γ ,p,1 and Pq |GT ◦ ,γq ,1
are perfect matchings. We say that (Pp , Pq ) is a γ -compatible pair if the restrictions satisfy
Pp |GT ◦ ,γ ,p,1 ∼
= Pq |GT ◦ ,γq ,1 .
Definition 4.19 (Weight and height monomials for γ -compatible matchings). Fix a γ -compatible
pair of matchings (Pp , Pq ) of GT ◦ , p and GT ◦ , q . We define the weight and height monomial,
respectively x(Pp , Pq ) and y(Pp , Pq ), as
x(Pp , Pq ) =

x(Pp )x(Pq )
,
x(Pp |GT ◦ ,γ ,1 )3

y(Pp , Pq ) =

y(Pp )y(Pq )
.
y(Pp |GT ◦ ,γ ,1 )3

For technical reasons, we require the (S, M) is not a closed surface with exactly 2 marked
points for Theorem 4.20 and Proposition 5.3.
Theorem 4.20. Let (S, M) be a bordered surface with punctures p and q and tagged triangulation T = {τ1 , τ2 , . . . , τn } = ι(T ◦ ) where T ◦ is an ideal triangulation. Let γ be an ordinary arc
between p and q. Assume γ ∈
/ T , and without loss of generality assume T does not contain an
arc notched at p or q. Let A be the corresponding cluster algebra with principal coefficients with
respect to ΣT . Let p and q be the two ideal arcs corresponding to γ (p) and γ (q) . Let GT ◦ , p
and GT ◦ , q be the graphs constructed in Section 4.2. Then the Laurent expansion of xγ (pq) with
respect to ΣT is given by
[xγ (pq) ]A
ΣT =

1
cross(T ◦ , γ (pq) )

x(Pp , Pq )y(Pp , Pq ),
(Pp ,Pq )

where the sum is over all γ -compatible pairs of matchings (Pp , Pq ) of (GT ◦ , p , GT ◦ , q ).
Proposition 4.21. Let (S, M), p, q, T , A, γ be as in Theorem 4.20, except that we assume that
γ ∈ T . Then [xγ (pq) ]A
ΣT , which can be expressed as
(p) (q)

xγ xγ yτ + (1 −

e (τ )

yτ p
xτ

τ ∈T

)(1 −

e (τ )

τ ∈T

yτ q

)

,

is a positive Laurent polynomial.
We prove this theorem and proposition in Section 12.3.
Remark 4.22. If in Theorem 4.20 the two endpoints p and q of γ coincide, i.e. γ is a loop, then
we let p and q denote the loops (with self-intersections) displayed in Fig. 9 for the purpose of
the formula for [xγ (pp) ]A
ΣT .
(pq)

Remark 4.23. An analogous expression for xγ , as in Proposition 4.21, holds even if γ ∈
/ T or
even if T includes arcs notched at p or q. See Theorems 12.9 and 12.10 for details.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2263

Fig. 9. Analogues of p and q for a loop notched at its basepoint.

Fig. 10. Ideal triangulation T ◦ of (S, M).

5. Examples of results, and identities in the coefficient-free case
5.1. Example of a Laurent expansion for an ordinary arc
Consider the ideal triangulation in Fig. 10. We have labeled the loop of the ideal triangulation T ◦ as and the radius as r. The corresponding tagged triangulation has two arcs, both
homotopic to r: we denote by τ1 the one which is notched at the puncture, and by τ2 the one
which is tagged plain at the puncture. The graph GT ◦ ,γ1 corresponding to the arc γ1 is shown on
the left of Fig. 11. It is drawn so that the relative orientation of the first tile rel(G , T ◦ ) is equal
to −1. GT ◦ ,γ1 has 19 perfect matchings.
Applying Theorem 4.10, we make the specialization x = x1 x2 , xr = x2 , y = y1 , yr = y2 /y1 ,
and x11 = x12 = x13 = x14 = 1. We find that xγ1 is equal to
1
x1 x2 x42 x5 x9 + y3 x4 x5 x9 + y6 x1 x2 x42 x7 + y1 y3 x3 x4 x5 x9 + y3 y6 x4 x10 x7
x1 x2 x3 x4 x5 x6
+ y5 y6 x1 x2 x4 x6 x7 + y2 y3 x3 x4 x5 x9 + y1 y3 y6 x3 x4 x10 x7 + y3 y5 y6 x6 x7 + y1 y2 y3 x32 x4 x5 x9
+ y2 y3 y6 x3 x4 x10 x7 + y1 y3 y5 y6 x3 x6 x7 + y3 y4 y5 y6 x3 x5 x6 x7 + y1 y2 y3 y6 x32 x4 x10 x7

2264

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 11. The graphs GT ◦ ,γ1 and GT ◦ ,

p.

+ y2 y3 y5 y6 x3 x6 x7 + y1 y3 y4 y5 y6 x32 x5 x6 x7 + y1 y2 y3 y5 y6 x32 x6 x7 + y2 y3 y4 y5 y6 x32 x5 x6 x7
+ y1 y2 y3 y4 y5 y6 x33 x5 x6 x7 .
5.2. Example of a Laurent expansion for a singly-notched arc
To compute the Laurent expansion of xγ2 (the notched arc in Fig. 10), we draw the graph
GT ◦ , p associated to the loop p , where p is the ideal arc associated to γ2 . Fig. 11 depicts this
graph, embedded so that the relative orientation of the tiles with diagonals labeled 5 is +1. We
need to enumerate γ -symmetric matchings of GT ◦ , p , i.e. those matchings which have isomorphic restrictions to the two bold subgraphs. Splitting up the set of γ -symmetric matchings into
three classes, corresponding to the configuration of the perfect matching on the restriction to Gγ ,
we obtain
[xγ2 ]A
ΣT =

1
x4 x5 (x9 x6 x8 + y7 x9 x9 + y7 y8 x9 x7 x10 )
x5 x6 x7 x8 x9
+ y6 y7 x4 x10 (x9 x7 + y8 x7 x10 x7 + y8 y9 x7 x8 x6 )
+ y5 y6 y7 x6 (x9 x7 + y8 x7 x10 x7 + y8 y9 x7 x8 x6 ) .

Since the initial variables appearing in this sum correspond to ordinary arcs, no specialization of
variables was necessary in this case (except for the boundaries x13 = x14 = 1).
5.3. Example of a Laurent expansion for a doubly-notched arc
We close with an example of a cluster expansion formula for a tagged arc with notches at
both endpoints. We build two graphs associated to the doubly-notched arc γ3 in Fig. 12: each
graph corresponds to a loop p or q tracing out a once-punctured monogon around an endpoint
of γ3 . Note that in the planar embeddings of Fig. 13, the relative orientations of the first tiles are

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2265

Fig. 12. Ideal triangulation T ◦ and doubly-notched arc γ3 .

Fig. 13. Graphs GT ◦ ,

p

and GT ◦ ,

q

corresponding to ideal arcs p , q .

both +1. So each minimal matching uses the lowest edge in GT ◦ , p and GT ◦ , q , respectively.
To write down the Laurent expansion for xγ3 , we need to enumerate the γ -compatible pairs of
perfect matchings of these graphs. There are 12 pairs of γ -compatible perfect matchings in all,
yielding the 12 monomials in the expansion of xγ3 :
[xγ3 ]A
ΣT =

1
x3 x4 x62 x8 + y5 x42 x6 x8 + y7 x3 x4 x6 x8 x9
x3 x4 x5 x6 x7 x8
+ y3 y5 x2 x4 x5 x6 x8 + y5 y7 x42 x8 x9 + y3 y5 y7 x2 x4 x5 x8 x9
+ y5 y6 y7 x4 x5 x7 x9 + y3 y5 y6 y7 x2 x52 x7 x9 + y5 y6 y7 y8 x4 x5 x6 x7
+ y3 y4 y5 y6 y7 x3 x5 x6 x7 x9 + y3 y5 y6 y7 y8 x2 x52 x6 x7 + y3 y4 y5 y6 y7 y8 x3 x5 x62 x7 .

2266

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

5.4. Identities for cluster variables in the coefficient-free case
Remark 5.1. Note that if we set all the yi ’s equal to 1 in Section 5.2, then xγ2 factors as
x10 x7 + x6 x8 + x9
x7 x8 x9

x6 x7 + x4 x7 x10 + x4 x5 x9
.
x5 x6

The first term depends only on the local configuration around the puncture p (at which end γ2
is notched). The second term is exactly the coefficient-free cluster variable associated to the
ordinary arc homotopic to γ2 .
Also, if we set all the yi ’s equal to 1 in Section 5.3, then xγ3 factors as
x3 x 6 + x4 + x 2 x 5
x3 x4 x5

x6 + x9
x7 x8

x4 x8 + x5 x7
.
x6

The first and second terms correspond to local configurations around the punctures q and p,
respectively, and the third term is exactly the coefficient-free cluster variable associated to the
ordinary arc homotopic to γ3 .
These examples hint at a general phenomenon in the coefficient-free case:
Definition 5.2. Fix a bordered surface (S, M) and a tagged triangulation T = ι(T ◦ ) of S. For
any puncture p we construct a Laurent polynomial with positive coefficients that only depends
on the local neighborhood of p. Let τ1 , τ2 , . . . , τh denote the ideal arcs of T ◦ incident to p in
clockwise order, assuming that h 2. (If a loop is incident to p, it appears twice in this list, once
for each end.) Let [τi , τi+1 ] denote the unique arc in an ideal triangle containing τi and τi+1 , such
that [τi , τi+1 ] is in the clockwise direction from τi ; here the indices in [τi , τi+1 ] are considered
modulo h. We set
zp =

h−1 i
i=0 σ (x[τ1 ,τ2 ] xτ3 xτ4

xτ1 xτ2 · · · xτh

· · · xτh )

,

where σ is the cyclic permutation (1, 2, 3, . . . , h) acting on subscripts.
When p has exactly one ideal arc r incident to it, the tagged triangulation contains exactly
two tagged arcs r and r (p) (technically ι(r) and ι(r)(p) ) incident to p. In this case,
zp =

xr (p)
.
xr

Proposition 5.3. Fix (S, M) and T as above, let A be the corresponding coefficient-free cluster
algebra, and let γ be an ordinary arc between distinct marked points p and q, or a loop which
does not cut out a once-punctured monogon. Then if p = q and p is a puncture,
xγ (p) = zp · xγ ,
and if both p and q are punctures,
xγ (pq) = zp zq · xγ .

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2267

Finally if γ is a loop so that p = q and γ (pp) is a doubly-notched loop, then
xγ (pp) = zp2 · xγ .
We will prove Proposition 5.3 in Section 11.
6. Outline of the proof of the cluster expansion formulas
As the proofs in this paper are rather involved, we present here a detailed outline.
Step 1. Fix a bordered surface with marked points (S, M). The seeds of A = A(S, M) are in
bijection with tagged triangulations, so to prove the positivity conjecture for A, we must
prove positivity with respect to every seed ΣT where T is a tagged triangulation. By
Corollary 3.16, it is enough to prove positivity with respect to every seed ΣT where
T = ι(T ◦ ) for some ideal triangulation.
Step 2. Fix an ideal triangulation T ◦ = (τ1 , . . . , τn ) of (S, M), with boundary segments denoted
τn+1 , . . . , τn+c . Fix also an ordinary arc γ , which crosses T d times; we would like to
understand the Laurent expansion of xγ with respect to ΣT . We build a triangulated
polygon Sγ which comes with a “lift” γ˜ of γ . The triangulation Tγ of Sγ has d internal
arcs labeled σ1 , . . . , σd , and d + 3 boundary segments labeled σd+1 , . . . , σ2d+3 . We have
a map π : {σ1 , . . . , σ2d+3 } → {τ1 , . . . , τn+c }. This step will be addressed in Section 7.
Step 3. We build a type Ad cluster algebra Aγ associated to Sγ , with a (3d + 3) × d extended
exchange matrix. This is obtained from the (2d + 3) × d extended exchange matrix
associated to (Sγ , Tγ ) (with rows indexed by interior arcs and boundary segments), and
appending a d × d identity matrix below. It is clear from the construction that the initial
cluster is acyclic.
Step 4. We construct a map φγ from Aγ to the fraction field Frac(A), such that for each σ ∈ Tγ ,
φγ (xσ ) = xπ(σ ) . We check that φγ is a well-defined homomorphism, using the fact that
Aγ is acyclic, and [3, Corollary 1.21]. Steps 3 and 4 will be addressed in Section 8.
Step 5. We identify a quadrilateral Q in S with simply-connected interior containing γ as a diagonal, whose other diagonal and sides (denoted γ , α1 , α2 , α3 , α4 ) cross T fewer times
than γ does. To do so we use (a slight generalization of) a lemma of [39], which will be
stated and proved in Section 9.
Step 6. We check that φγ (xγ˜ ) = xγ , by induction on the number of crossings of γ and T . To do
so, we use Step 5 to produce Q, which we lift to a quadrilateral Q in a larger triangulated
polygon S containing Sγ . By induction, the cluster expansions of each of xγ , xα1 , xα2 ,
xα3 , and xα4 are given by matching formulas using the combinatorics of S. By comparing
the exchange relations corresponding to the flip in Q and the flip in Q, and using the fact
that cluster expansion formulas are known in type A, we deduce that φγ (xγ˜ ) = xγ .
Step 7. In type A, the matching formula giving the Laurent expansion of xγ˜ in Aγ with respect
to ΣTγ is known. Since φγ (xγ˜ ) = xγ , and φγ is a homomorphism, we can compute the
Laurent expansion of xγ in terms of ΣT . Here we use the fact that for every arc σi ∈ Tγ ,
φγ (xσi ) = xπ(σi ) . This proves our main theorem for cluster variables corresponding to
ordinary arcs and loops cutting out once-punctured monogons. Steps 6 and 7 will be
addressed in Section 10.
Step 8. We prove our combinatorial formula for a singly-notched arc by using the identity
x = xr xr (p) (where cuts out a once-punctured monogon with radius r and puncture p),

2268

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 14. Definition of the point sj .

and our now-proved combinatorial formula for x and xr . For doubly-notched arcs we
use an analogous strategy, using a more complicated identity (Theorem 12.9). The proof
for doubly-notched loops is the same as for doubly-notched arcs, but we need to make
sense of the cluster algebra element corresponding to a singly-notched loop (see Definition 12.22). Step 8 is addressed in Section 12.
7. Construction of a triangulated polygon and a lifted arc
Let T = {τ1 , τ2 , . . . , τn+c } be an ideal triangulation of (S, M), where τ1 , . . . , τn are arcs and
τn+1 , . . . , τn+c are boundary segments. Let γ be an ordinary arc in (S, M) that crosses T exactly
d times. We now explain how to associate a triangulated polygon Sγ to γ , as well as a lift γ˜ of γ ,
which we will use later to compute the cluster expansion of xγ .
We fix an orientation for γ and we denote its starting point by s and its endpoint by t, with
s, t ∈ M. Let s = p0 , p1 , . . . , pd , pd+1 = t be the intersection points of γ and T in order of
occurrence on γ , hence p0 , pd+1 ∈ M and each pi with 1 i d lies in the interior of S. Let
i1 , i2 , . . . , id be such that pk lies on the arc τik ∈ T , for k = 1, 2, . . . , d. Note that ik may be equal
to ij even if k = j .
For k = 0, 1, . . . , d, let γk denote the segment of the path γ from the point pk to the
point pk+1 . Each γk lies in exactly one ideal triangle k in T . If 1 k d − 1, then the triangle k is formed by the arcs τik , τik+1 and a third arc that we denote by τ[γk ] . If the triangle is
self-folded then τ[γk ] is equal to either τik or τik+1 . Note however, that τik cannot be equal to τik+1 ,
since γ crosses them one after the other.
The idea now is to construct our triangulated polygon by glueing together triangles which
are modeled after 0 , 1 , . . . , d . Moreover, the triangles will be glued so that they all have
the same relative orientation (either +1 or −1). But some of 0 , 1 , . . . , d may be self-folded,
and we do not want to have self-folded triangles in the polygon. So we will unfold the self-folded
triangles in a precise way, before glueing them back together.
Let sj denote the common endpoint of τij and τij +1 such that the triangle with vertices sj , pj ,
pj +1 and with sides contained in τij , τij +1 , and γj has simply-connected interior, see Fig. 14.
Let M(γ ) = {sj | 1 j d − 1}.
We now partition the sj ’s into subsets of consecutive elements which coincide. That is, we
define integers 0 = a0 < a1 < · · · < a −1 < a = d − 1, by requiring that
s1 = s2 = · · · = sa1 = sa1 +1 ,
sa1 +1 = sa1 +2 = · · · = sa2 = sa2 +1 ,
..
..
..
..
.
.
.
.
sa −1 +1 = sa −1 +2 = · · · = sa = sd−1 .

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2269

Fig. 15. Construction of Sγ in a thrice-punctured square. The arcs of T are labeled 1 to 14, and the arcs of Tγ are labeled
according to their images under π . The triangles of Sγ all have relative orientation +1. The arc γ is dotted. There are
d = 15 crossings between γ and T , and M(γ ) = {t1 , . . . , t8 }, where t1 = t8 , t2 = t7 and t3 = t6 .

In the example in Fig. 15, we have
a0

a1

a2

a3

a4

a5

a6

a7

a8

0

3

4

7

9

10

12

13

14

We define t1 = sa1 , t2 = sa2 , . . . , t = sd−1 . Note that M(γ ) = {t1 , t2 , . . . , t }, and that ti may be
equal to tj even if i = j .
We now construct a triangulated polygon Sγ which is a union of fans F1 , . . . , F , where
each Fh consists of ah − ah−1 + 2 triangles that all share the vertex th . We will describe this
precisely below; see Fig. 15.
Step 1: Plot a rectangle with vertices (0, 0), (0, 1), (d − 1, 1), (d − 1, 0).
Step 2: Label (0, 0), (1, 0), and (0, 1) by s, t1 , and t0 , respectively. For a2h + 1 k a2h+1 ,
plot the points (k, 1) and label (a2h+1 , 1) by t2h+2 . For a2h+1 + 1 k a2h+2 , plot the
points (k, 0), and label (a2h+2 , 0) by t2h+3 .
Step 3: Connect t2h by a line segment with each plotted point (k, 0) that lies between (and
including) t2h−1 and t2h+1 , for 1 h < /2. Connect t2h+1 by a line segment with each
plotted point (k, 1) that lies between t2h and t2h+2 , for 0 h < ( − 1)/2.

2270

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Step 4: If is odd, label (d − 1, 0) by t and otherwise label (d − 1, 1) by t.
Step 5: Label the interior arcs of the polygon by σ1 , . . . , σd , in the order that a curve from s to t
(which intersects each only once) would cross them. Set π(σ1 ) = τi1 , . . . , π(σd ) = τid .
This determines whether all triangles of the polygon have relative orientation +1
or all have relative orientation −1. Label the boundary segments of the polygon by
σd+1 , . . . , σ2d+3 , starting at s and going counterclockwise around the boundary of Sγ .
Step 6: Each boundary segment σj not incident to s or t is the side of a unique triangle in the
polygon, whose other sides project via π to τik , τik+1 , for some k. If the ideal triangle k
has three distinct sides, set π(σj ) = τ[γk ] . Otherwise k is self-folded: define π(σj ) to
be the label of the radius in k .
Step 7: If σj and σj +1 are the two boundary segments incident to s in the polygon, then we
define π(σj ) and π(σj +1 ) so that {π(σj ), π(σj +1 )} is the set of labels of the two sides
of 0 which do not cross γ , and so that the relative orientation of the triangle with sides
σj and σj +1 agrees with the relative orientation of the other triangles in the polygon. If
0 is self-folded with radius r, then set π(σj ) = π(σj +1 ) = r.
Step 8: If σj and σj +1 are the two boundary segments incident to t in the polygon, then we
define π(σj ) and π(σj +1 ) so that {π(σj ), π(σj +1 )} is the set of labels of the two sides
of d which do not cross γ , and so that the relative orientation of the triangle with sides
σj and σj +1 agrees with the relative orientation of the other triangles in the polygon. If
d is self-folded with radius r, then set π(σj ) = π(σj +1 ) = r.
Step 9: Each of the triangles in this construction corresponds to an ideal triangle in T . If the
ideal triangle is not self-folded, then the constructed triangle may have the same orientation as the ideal triangle or the opposite one, but if the orientations do not match for
one such pair of triangles then it does not match for any such pair of triangles. In the
latter case, we reflect the whole polygon at the horizontal axis.
Step 10: We will use γ˜ to denote the arc in Sγ from s to t; we call this the lift of γ .
The result is a polygon Sγ with set of vertices M and triangulation Tγ . Its internal arcs are
labeled σ1 , . . . , σd , and the boundary segments are labeled σd+1 , . . . , σ2d+3 . Moreover, each triangle i in Tγ corresponds to an ideal triangle in T , and, if the ideal triangle is not self-folded,
then the orientations of the two triangles match.
8. Construction of Aγ and the map φγ
Let (S, M) be a bordered surface with marked points, fix an ideal triangulation T with internal
arcs {τ1 , . . . , τn } and boundary segments {τn+1 , . . . , τn+c }, and let A be the associated cluster
algebra with principal coefficients. The initial cluster variables of A are {xτi | 1 i n}. Using
the construction of Sγ and Tγ in Section 7, we will construct a related type A cluster algebra Aγ ,
and define a homomorphism φγ from Aγ to Frac(A).
8.1. Construction of a type A cluster algebra
To this end, let Sγ be the polygon with triangulation Tγ constructed in Section 7. Recall that
its internal arcs are labeled σ1 , . . . , σd , and its boundary segments are labeled σd+1 , . . . , σ2d+3 .
We define a (3d + 3) × d exchange matrix B as follows. The first 2d + 3 rows are the signed
adjacency matrix of the triangulation Tγ together with its boundary segments. The bottom d
rows are a copy of the d × d identity matrix. We let Aγ = A(B), and denote the initial cluster

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2271

by xTγ . We denote the coefficient variables by {xσd+1 , . . . , xσ2d+3 } ∪ {yσ1 , . . . , yσd }. We let P =
Trop(xσd+1 , . . . , xσ2d+3 , yσ1 , . . . , yσd ) be the tropical semifield.
The following lemma is obvious.
Lemma 8.1. The 2d + 3 coefficient variables of Aγ are encoded by both the boundary segments
of Sγ and elementary laminations associated to the internal arcs of Sγ .
For each k = 1, 2, . . . , d, denote by xσk the cluster variable obtained by mutation from xTγ in
direction k.
Proposition 8.2. Aγ is a cluster algebra of type Ad , and its initial seed is acyclic. It follows that
Aγ is generated over ZP by the initial d cluster variables and their first mutations, that is, the
set {xσ1 , . . . , xσd , xσ1 , . . . , xσd }. The ideal of relations among these variables is generated by the
d exchange relations expressing xσi xσi in terms of other cluster variables.
Proof. Aγ is of type Ad with acyclic initial seed, because Sγ is a polygon with d + 3 vertices,
and each triangle in Tγ has at least one side on the boundary of Sγ . The last two statements now
follow from [3, Theorem 1.20 and Corollary 1.21]. ✷
8.2. The map φγ
We now define a homomorphism φγ of Z-algebras from the cluster algebra Aγ to the field
of fractions Frac(A) of the cluster algebra A. We define φγ on a set of generators of Aγ and
then show that it is a well-defined homomorphism, by checking that the image of the d exchange
relations from Proposition 8.2 are relations in Frac(A).
8.2.1. Definition of φγ on the variables corresponding to arcs of Tγ
If σj is an internal arc or boundary segment of Tγ (so 1 j 2d + 3), define
φγ (xσj ) = xπ(σj ) .

(8.1)

We make the convention that if π(σj ) is a boundary segment of S, then xπ(σj ) = 1. Also recall
that if π(σj ) is a loop in a self-folded triangle then the notation xπ(σj ) stands for the product xr xr (p) , where r is the radius and p is the puncture in the self-folded triangle.
8.2.2. Definition of φγ on the first mutations of the initial cluster variables
Define

φγ xσj

⎧
x
⎪
⎨ π(σj )
= xe
⎪
⎩ (1 + yr )xr x (p)
r
y (p)
r

if π(σj ) is not a loop or a radius;
if π(σj ) is a loop, where e is obtained by flipping π(σj );
if π(σj ) is a radius r to a puncture p.
(8.2)

2272

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 16. One possible local configuration for γ crossing through a quadrilateral.

8.2.3. Definition of φγ on the coefficients yσj
Define
⎧
⎪
⎨ yπ(σj ) if π(σj ) is not a loop or a radius;
yr
if π(σj ) is a radius r to a puncture p;
φγ (yσj ) = y (p)
r
⎪
⎩
yr (p)
if π(σj ) is a loop enclosing the radius r and puncture p.

(8.3)

8.2.4. Definition of φγ on the whole cluster algebra
By Proposition 8.2, defining φγ on the cluster variables and their first mutations, as well as
on the generators of the coefficient group, is enough to define a homomorphism of Z-algebras
φγ from Aγ , provided that φγ is well defined. Note that φγ is a map from Aγ to Frac(A), rather
than a map to A itself.
Proposition 8.3. The map φγ is a well-defined homomorphism of Z-algebras
φγ : Aγ → Frac(A).
Proof. By Proposition 8.2, it suffices to show that φγ maps the d exchange relations involving
xσj xσj to relations in A. We prove this by checking three cases: π(σj ) is not a loop or radius;
π(σj ) is a loop enclosing a radius r; and π(σj ) is a radius r.
In all cases, the exchange relation in Aγ is determined by the quadrilateral in Tγ with diagonal σj , which projects via π to the quadrilateral in T with diagonal π(σj ). Note that in all cases,
the exchange relation in Aγ has the form
xσ j xσ j = yσ j

xb +

(8.4)

xc ,
c

b

where b ranges over all arcs in T following σj in clockwise order, and c ranges over all arcs in T
following σj in counterclockwise order.
In the first case (when π(σj ) is not a loop or radius), the local configuration of the triangulation
is either that of Fig. 16 or Fig. 17. The image of the exchange relation under φγ is
xπ(σj ) xπ(σj ) = yπ(σj )

xπ(b) +
b

xπ(c) .
c

This is exactly the corresponding exchange relation (“Ptolemy relation”) in A.
Note that in theory we also need to consider configurations such as that in Fig. 18, where one
or both of the arcs π(σj −1 ) and π(σj +1 ) are loops cutting out once-punctured monogons with

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2273

Fig. 17. A second possible local configuration for γ crossing through a quadrilateral.

Fig. 18. A possible local configuration for γ crossing a bigon containing a self-folded triangle.

Fig. 19. A possible local configuration for γ crossing the loop of a self-folded triangle.

puncture p and radius r. If say π(σj −1 ) is such a loop, then the image of the exchange relation
(p)
in A contains xπ(σj −1 ) = xr xr . However, the resulting relation will still be an exchange relation
in A (a “generalized Ptolemy relation”), by [21, Proposition 6.5, Lemma 7.2, and Definition 7.4].
Now suppose that π(σj ) is a loop enclosing the radius r and puncture p. See Fig. 19. Without
loss of generality, π(σj −1 ) = π(α1 ) = r. In this case (8.4) is equal to
xσj xσj = yσj xσj −1 xα2 + xσj +1 xα1
and its image under φγ is
xπ(σj ) xe = yr (p) xr xπ(α2 ) + xπ(σj +1 ) xr ,

2274

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 20. A possible local configuration for γ crossing the radius of a self-folded triangle.

where e is the arc obtained by flipping π(σj ). Since xπ(σj ) = xr xr (p) , dividing by xr yields
exactly the exchange relation for xr (p) xe in A, see Eq. (7.1) of [21].
Finally suppose that π(σj ) is a radius r to a puncture p; let denote the corresponding loop
around the puncture, see Fig. 20. Note that the two boundary segments on the left-hand side of
the figure project to π(σj ). In this case the image of (8.4) under φγ is
xπ(σj ) 1 +

yr
yr
xr xr (p) =
x xπ(σj ) + x xπ(σj ) .
yr (p)
yr (p)

Since x = xr xr (p) , this is an identity. This completes the proof.

✷

9. Quadrilateral lemma
Lemma 9.1. Let T = {τ1 , . . . , τn+c } be an ideal triangulation of (S, M), and let γ be an arc in
(S, M) which is not in T . Let e(γ , T ) be the number of crossings between γ and T . Then there
exist five, not necessarily distinct, arcs or boundary segments α1 , α2 , α3 , α4 and γ in (S, M)
such that
(a) each of α1 , α2 , α3 , α4 and γ crosses T fewer than e(γ , T ) times,
(b) α1 , α2 , α3 , α4 are the sides of an ideal quadrilateral with simply-connected interior in which
γ and γ are the diagonals.
Proof. Let k = e(γ , T ). If k = 1, let γ ∈ T be the unique arc crossing γ . Then γ is a side of
exactly two triangles in T . We distinguish three cases according to how many of these triangles
are self-folded, see Fig. 21.
(1) If neither triangle is self-folded, let α1 , α2 and γ , and also α3 , α4 and γ denote the three
sides of the two triangles, such that α1 and α3 (and hence also α2 and α4 ) are opposite sides
in the quadrilateral formed by the union of the two triangles. Then these arcs satisfy (a)
and (b), see the left of Fig. 21.
(2) If one of the two triangles is self-folded, then let α4 and γ denote the two sides of the selffolded triangle, and let α1 , α2 and γ denote the three sides of the other triangle. Since γ
crosses γ but not α4 , it follows that γ is the loop of the self-folded triangle and α4 is its
radius. Setting α3 = α4 , we obtain five arcs that satisfy conditions (a) and (b), see the middle
of Fig. 21.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2275

Fig. 21. Configurations of the ideal triangles incident to γ .

Fig. 22. Labeling of the crossing points of γ and τ . Here k = 12 and j = j2 = h = 6.

(3) The case where both triangles are self-folded is actually impossible, because two self-folded
triangles that share a side can only occur on the sphere with three punctures, but this surface
is not allowed, see the right of Fig. 21.
Suppose k 2. Choose an orientation of γ and denote its starting and ending points by a
and b (note that a and b may coincide). Label the k crossing points of γ and T by 1, 2, . . . , k
according to their order on γ , such that point 1 is closest to a. Let h be the middle crossing point,
more precisely, let h = k/2 . Denote by τ the unique arc of the triangulation T that crosses γ at
the point with label h, and let r = e(τ, γ ) be the number of crossings between τ and γ . Choose
an orientation of τ and denote its starting point by c and its endpoint by d (note again that c
and d may coincide). As before with γ , label the r crossing points of τ and γ by j1 , j2 , . . . , jr
according to their order on τ (see Fig. 22). Thus r k, {j1 , j2 , . . . , jr } ⊂ {1, 2, . . . , k}. Note that
s < t does not imply js < jt . Choose so that j = h is the middle crossing point.
We will use τ and γ to construct the five arcs of the lemma. Let γ − (respectively τ − ) denote
the curve γ (respectively τ ) with the opposite orientation. We will distinguish four cases:
(1) ( = 1 or j −1 < j ) and ( = r or j +1 > j ). We define the arcs below, and we illustrate
them as the dashed arcs in Fig. 23, continuing the example of Fig. 22. Suppose first that
1 < < r. Let
γ = (a, j

−1 , j +1 , b

| γ , τ, γ )

be the arc that starts at a and is homotopic to γ up to the crossing point j −1 , then, from j −1
to j +1 , γ is homotopic to τ , and from j +1 to b, γ is homotopic to γ . Note that γ and γ
cross exactly once, namely at j .

2276

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 23. Construction of γ , α1 , α2 , α3 and α4 in case (1).

In a similar way, we define
α1 = a, j

−1 , j

α2 = (a, j , j

, a | γ , τ, γ − ,

α3 = b, j

| γ , τ, γ ),

α4 = b, j , j

+1 , b

+1 , j

, b | γ −, τ −, γ ,

−1 , a

| γ −, τ −, γ − .

In the special case where = 1 (respectively = r), we define
γ = (c, j

+1 , b

| τ, γ )

α1 = c, j , a | τ, γ

−

α4 = b, j , c | γ − , τ −

respectively γ = (a, j

−1 , d

| γ, τ) ,
−

respectively α3 = d, j , b | τ , γ ,
respectively α2 = (a, j , d | γ , τ ) ,

where c and d are the starting and ending points of τ . In particular, if = r = 1 then γ = τ .
Then α1 , α2 , α3 , α4 form a quadrilateral with simply-connected interior such that α1 and α3
are opposite sides, α2 and α4 are opposite sides, and γ and γ are the diagonals. The topological type of this quadrilateral is as in the left-hand side of Fig. 24. This shows (b).

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2277

Fig. 24. Different topological types of quadrilaterals.

It remains to show (a). By hypothesis, we have j −1 < j = h and j +1 > j = h. Moreover,
since the crossing points j −1 , and j both lie on the same arc τ of the ideal triangulation, the
arc γ must cross some other arc between the two crossings at j −1 and j ; in other words,
j −1 < j − 1 = h − 1. Similarly j +1 > j + 1 = h + 1. Also recall that k 2h k + 1.
Then
e γ , T = (j

−1

− 1) + (k − j

e(α1 , T ) = (j

−1

− 1) + j < h − 2 + h

e(α3 , T ) = (k − j

+1 ) + (k

+ 1) < h − 2 + h + 1

k,

k,

− j + 1) < k − h − 1 + k − h + 1

e(α2 , T ) = (j − 1) + (k − j
e(α4 , T ) = (k − j ) + (j

+1

−1

+1 ) < h − 1 + k

−h−1

− 1) < k − h + h − 2

k,

k,

k.

In the case where = 1, we have
e γ ,T = k − j

+1

< k,

e(α1 , T ) = j − 1 < k,
e(α4 , T ) = k − j < k,
and in the case where = r, we have
e γ ,T = j

−1

− 1 < k,

e(α3 , T ) = k − j < k,
e(α2 , T ) = j − 1 < k.
This shows (a).
(2) ( = 1 or j −1 < j ) and ( = r or j +1 < j ). This case is illustrated in Fig. 25. Suppose
first that 1 < < r.
Let γ = (a, j −1 , j +1 , a | γ , τ, γ − ) be the arc that starts at a and is homotopic to γ up to
the crossing point j −1 , then, from j −1 to j +1 , γ is homotopic to τ , and from j +1 to a,
γ is homotopic to γ − . Note that γ and γ cross exactly once, namely at the point j . In
a similar way, let

2278

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 25. Construction of γ , α1 , α2 , α3 and α4 in case (2).

α1 = a, j , j
α2 = (a, j

−1 , a

−1 , j

| γ , τ −, γ − ,

, b | γ , τ, γ ),

α3 = b, j , j
α4 = a, j

+1 , j

+1 , a

| γ − , τ, γ − ,

, a | γ , τ −, γ − .

In the special case where = 1 (respectively = r), we define
γ = c, j

+1 , a

| τ, γ −

respectively γ = (a, j

−1 , d

| γ, τ) ,

α1 = a, j , c | γ , τ −

respectively α3 = b, j , d | γ − , τ ,

α2 = (c, j , b | τ, γ )

respectively α4 = d, j , a | τ − , γ − ,

where c is the starting point of τ and d is its endpoint. Note again that γ = τ if = r = 1.
Then α1 , α2 , α3 , α4 form a quadrilateral with simply-connected interior such that α1 and α3
are opposite sides, α2 and α4 are opposite sides, and γ and γ are the diagonals. The topological type of this quadrilateral is as in the right-hand side of Fig. 24. This shows (b). It remains

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2279

to show (a). By hypothesis, we have j −1 < j = h and j +1 < j = h. As in case (1), the
crossing points j −1 , and j both lie on the same arc τ of the ideal triangulation, and thus the
arc γ must cross some other arc between the two crossings at j −1 and j ; in other words,
j −1 < j − 1 = h − 1. Similarly j +1 < j − 1 = h − 1. Also recall that k 2h k + 1.
Then
e γ , T = (j

−1

− 1) + (j

e(α1 , T ) = (j − 1) + j

−1

e(α3 , T ) = (k − j ) + (j

+1

− 1) < h − 2 + h − 2

<h−1+h−1

+1

k,

k,

− 1) < k − h + h − 2

k,
k,

e(α2 , T ) = (j

−1

− 1) + (k − j ) < h − 2 + k − h

e(α4 , T ) = (j

+1

− 1) + j < h − 2 + h

k.

In the case where = 1, we have
e γ ,T = j

+1

− 1 < k,

e(α1 , T ) = j − 1 < k,
e(α2 , T ) = k − j < k,
and in the case where = r, we have
e γ ,T = j

−1

− 1 < k,

e(α3 , T ) = k − j < k,
e(α4 , T ) = j − 1 < k.
This shows (a).
(3) j −1 > j and j
(4) j −1 > j and j

+1
+1

< j . This case follows from the case (1) by symmetry.
> j . This case follows from the case (2) by symmetry.

✷

10. The proof of the expansion formula for ordinary arcs
The main technical lemma we need in order to complete the proof of our expansion formula
for ordinary arcs is that φγ (xγ˜ ) = xγ . Once we have this, the proof of our expansion formula for
ordinary arcs will follow easily.
10.1. The proof that φγ (xγ˜ ) = xγ
In this section we show that the constructions of Sγ and Tγ in Section 7 are compatible with
the map φγ defined in Section 8 in a sense which we make precise in Theorem 10.1.
Fix a bordered surface (S, M), an ideal triangulation T = (τ1 , . . . , τn ), and let A be the corresponding cluster algebra with principal coefficients with respect to T . Also fix an arc γ in S. This

2280

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 26. The picture at the left shows a surface, along with diagonals γ (bold) and γ (dashed) of a quadrilateral
α1 , . . . , α4 . The pictures at the right show the triangulated polygons Sγ and Sγ .
γ

γ

gives rise to a polygon Sγ with a triangulation Tγ = (σ1 , . . . , σd ), a lift γ˜ of γ in Sγ , a cluster
algebra Aγ , a map π : Tγ → T , and a homomorphism
φγ : Aγ → Frac(A),
such that φγ (xσ γ ) = xπ(σ γ ) .
j

j

Theorem 10.1. Using the notation of the previous paragraph, we have that
φγ (xγ˜ ) = xγ .
Proof. We prove Theorem 10.1 by induction on the number of crossings of γ and T . When this
number is zero, there is nothing to prove. Otherwise, by Lemma 9.1, there exists a quadrilateral Q
in S with simply-connected interior, which has diagonals γ and γ , and sides α1 , α2 , α3 , α4 .
Moreover, each of γ and the four sides crosses T fewer times than γ does. See Fig. 26 for an
example.
By the constructions of Sections 7 and 8, we have six triangulated polygons Sγ , Sγ ,
Sα1 , . . . , Sα4 , six lifts γ˜ , γ˜ , α˜ 1 , . . . , α˜ 4 , in the respective polygons, six associated cluster algebras, and six different homomorphisms φγ , φγ , φα1 , . . . , φα4 .
Because γ and γ intersect (exactly once) in S, the local neighborhoods around the corresponding points in Sγ and Sγ coincide (there are at least two triangles in common and perhaps
more). Therefore we can glue (Sγ , Tγ ) and (Sγ , Tγ ) together along the common triangles, getting a larger polygon S with triangulation T = {σj }j , and a map T → T , which, abusing notation,
we denote by π . See Figs. 26 and 27. Clearly we can view the triangulated polygons Sγ , Sγ ,
and Sαi and the arcs γ˜ and α˜ i as sitting inside S. We can also view the six corresponding cluster
algebras as sitting inside the cluster algebra A• (S) of the larger polygon S. Then we can glue
the homomorphisms φγ and φγ to obtain a homomorphism φ : A• (S) → Frac(A) that extends
all the homomorphisms φγ , φγ , φα1 , . . . , φα4 .

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2281

Fig. 27. The polygon S obtained by glueing Sγ and Sγ together.

Because γ , γ and the αi form a quadrilateral in S, we have a generalized Ptolemy relation
in A of the form
xγ xγ = Y+ xα1 xα3 + Y− xα2 xα4 ,

(10.1)

where Y+ and Y− can be computed using the elementary laminations associated to the arcs of
the triangulation T . Note that (10.1) holds even if γ cuts out a once-punctured monogon.
On the other hand, since γ˜ , γ˜ , α˜ i form a quadrilateral in S, we have a generalized Ptolemy
relation in A• (S) of the form
xγ˜ xγ˜ = Y+ xα˜ 1 xα˜ 3 + Y− xα˜ 2 xα˜ 4 ,

(10.2)

where again Y+ and Y− can be computed using the elementary laminations associated to the arcs
of the triangulation T .
Applying φ to (10.2) and using the inductive hypothesis, we get
φ(xγ˜ )xγ = φ(Y+ )xα1 xα3 + φ(Y− )xα2 xα4 .

(10.3)

From (10.1) and (10.3), we see that the proof of Theorem 10.1 is a consequence of
Lemma 10.2 below. ✷
Lemma 10.2. φ(Y+ ) = Y+ and φ(Y− ) = Y− .
Proof. The monomials Y± and Y± are defined by Eqs. (10.1) and (10.2) and are computed by
analyzing how the laminations associated to the arcs of T and T cut across the quadrilaterals
Q ⊂ S and Q ⊂ S.
By the definition of shear coordinate, the only laminations which can make a contribution to
the Y ’s (respectively, Y ’s) are those intersecting γ and two opposite sides of Q (respectively,
γ˜ and two opposite sides of Q). In particular, these laminations must be a subset of the laminations Lτi1 , . . . , Lτid (respectively, Lσ1 , . . . , Lσd , where σ1 , . . . , σd are arcs of the triangulation of
Sγ ⊂ S).

2282

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 28. Comparing the shear coordinates from a self-folded triangle to that from spiraling laminations.

We claim that for every such arc τik in T which is not a loop or radius, the lamination Lτik has
the same local configuration in Q as Lσk does in Q. (Recall that π(σk ) = τik .) To see why this is
true, recall that Sγ is constructed by following γ in S, keeping track of which arcs it is crossing,
and glueing together a sequence of triangles accordingly. In S, we can imagine applying an
isotopy to γ , so that it follows γ as long as possible without introducing unnecessary crossings
with arcs of the triangulation, before leaving γ to travel along a different side of the quadrilateral.
Recall that each elementary laminate Lτik is obtained by taking the corresponding arc τik and
simply rotating its endpoints a tiny amount counterclockwise. So a laminate Lτik will make a
nonzero contribution to the shear coordinates if and only if it crosses a side of Q (say α2 ), then γ
and γ , then the opposite side α4 of Q, without crossing α1 or α3 in between. (The corresponding
arc τik will either have exactly the same crossings with Q, or it may have an endpoint coinciding
with an endpoint of α2 .) In this case the lift σk of τik will be an arc of S which is an internal
arc common to both Sγ and Sγ ; it is clear by inspection that it will cut across the two opposite
sides α˜ 2 and α˜ 4 of Q, see Fig. 27.
Therefore the corresponding contributions to the shear coordinates will be the same from both
the arc τik and its lift σk . Since φ(yσj ) = yπ(σj ) if π(σj ) is not a loop or radius, we can henceforth
ignore the contributions to the Y monomials which come from such arcs τik and their lifts σk .
It remains to analyze the contribution to the shear coordinates from a self-folded triangle
in T , and the contributions to the shear coordinates from its lift in T . We will carefully analyze
a representative example, and then explain what happens in the remaining cases.
The leftmost figure in Fig. 28 shows the quadrilateral Q in S; γ is the arc bisecting it. We’ve
also displayed a self-folded triangle in T with a loop τi1 and radius τi2 to a puncture p. Just to
the right of this is the same quadrilateral, and the elementary laminations Lτi1 and Lτi2 . To the
right of that is the quadrilateral Q, bisected by the arc γ˜ . Here, σ1 , σ2 , and σ3 are the lifts of
τi1 and τi2 in Q; π(σ1 ) = π(σ3 ) = τi1 and π(σ2 ) = τi2 . The rightmost figure in Fig. 28 shows Q
together with the elementary laminations Lσ1 , Lσ2 , and Lσ3 .
Computing shear coordinates, we get bγ (T , Lτi1 ) = bγ (T , Lτi2 ) = −1, and also bγ˜ (T , Lσ1 ) =
bγ˜ (T , Lσ2 ) = bγ˜ (T , Lσ3 ) = −1. Therefore the Y− monomial in R gets a contribution of
yτi1 yτi2 = yτ (p) yτi2 , and the Y− monomial in R gets a contribution of yσ1 yσ2 yσ3 . Applying φ
i2

yτi

to this gives φ(yσ1 yσ2 yσ3 ) = y 2(p) y
τi

2

2
(p)
τi
2

= yτi2 yτ (p) , as desired.
i2

Fig. 29 shows two more ways that a self-folded triangle from T might interact with
the quadrilateral Q. Each row of the figure displays the self-folded triangle and the corresponding elementary laminations, and the lift of the self-folded triangle in T and the corresponding elementary laminations. In the example of the top row, we have bγ (T , Lτi1 ) = 0,

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2283

Fig. 29. Other possible configurations involving laminations associated to a self-folded triangle.

bγ (T , Lτi2 ) = −1, bγ˜ (T , Lσ1 ) = 0, bγ˜ (T , Lσ2 ) = −1, and bγ˜ (T , Lσ3 ) = −1. In the example of
the second row, we have bγ (T , Lτi1 ) = −1, bγ (T , Lτi2 ) = 0, bγ˜ (T , Lσ1 ) = −1, bγ˜ (T , Lσ2 ) = 0,
and bγ˜ (T , Lσ3 ) = 0.
All other configurations of a self-folded triangle from T either make no contribution to the
shear coordinates indexed by γ (in which case the same is true for the lift of that self-folded
triangle), or come from either rotating or reflecting one of the configurations from Fig. 29. We
leave it as an exercise for the reader to check that just as in the example of Fig. 28, the monomials
corresponding to the shear coordinate bγ˜ (T , Lσ1 ∪ Lσ2 ∪ Lσ3 ) map via φ to the monomials
corresponding to the shear coordinate bγ (T , Lτi1 ∪ Lτi2 ).
It may seem that our arguments and figures rely on the assumption that the quadrilateral Q
has four distinct edges and four distinct vertices. However, one can always slightly deform a
quadrilateral with some identified vertices or edges to get a quadrilateral with four distinct edges
and vertices; see Fig. 30. It is not hard to see that the shear coordinates of a lamination with
respect to a given arc are unchanged if we work instead with this deformation, so our arguments
extend to this situation.
This completes the proof of the claim, and hence the lemma. ✷
We are now ready to prove Theorem 4.10.
Proof of Theorem 4.10. We have fixed (S, M), an ordinary arc γ , and an ideal triangulation T with internal arcs τ1 , . . . , τn and boundary segments τn+1 , . . . , τn+c . This determines a
cluster algebra A with principal coefficients with respect to ΣT . From (S, M), T , and γ we
have built a polygon Sγ with a “lift” γ˜ of γ , together with a triangulation Tγ with internal
arcs σ1 , . . . , σd and boundary segments σd+1 , . . . , σ2d+3 . We have a map π : {σ1 , . . . , σ2d+3 } →
{τ1 , . . . , τn+c }. Furthermore, we have associated a type Ad cluster algebra Aγ to Sγ , and a homo-

2284

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 30. Opening up a radius does not change contributions from shear coordinates.

morphism φγ from Aγ to Frac(A). This map has the property that for each σi ∈ {σ1 , . . . , σ2d+3 },
φγ (xσi ) = xπ(σi ) . Additionally, by Theorem 10.1, φγ (xγ˜ ) = xγ .
Since Aγ is a type A cluster algebra, we can compute the Laurent expansion of xγ˜ with
respect to ΣTγ . More specifically, [32] proved Theorem 4.10 for unpunctured surfaces, which
in particular includes polygons. At this point the reader may worry that Theorem 4.10 cannot
be applied to Aγ , as Aγ is not simply a cluster algebra with principal coefficients associated to
a triangulation – it has extra coefficient variables corresponding to the boundary segments of Tγ .
However, consider the triangulated polygon (Sγ , Tγ ) that we obtain from (Sγ , Tγ ) by adding
c triangles around the boundary, each one with an edge at a boundary segment, and consider
the corresponding cluster algebra Aγ with principal coefficients. This is still a type A cluster
algebra so we can use the result of [32] to apply Theorem 4.10 to expand the cluster variable
corresponding to γ˜ with respect to ΣTγ in Aγ . Clearly the formula giving the Laurent expansion
of xγ˜ with respect to ΣTγ in Aγ is identical to the formula giving the Laurent expansion of the
cluster variable corresponding to γ˜ with respect to ΣTγ in Aγ .
Therefore we can apply Theorem 4.10 to get the cluster expansion of xγ˜ with respect to ΣTγ
in Aγ : in other words, we build a graph GTγ ,γ˜ , and the cluster expansion is given as a generating
function for perfect matchings of this graph. The variables in the expansion are xσ1 , . . . , xσ2d+3
and yσ1 , . . . , yσd . Therefore, since φγ is a homomorphism such that φγ (xσi ) = xπ(σi ) for 1
i 2d + 3, and φγ (xσ ) = xπ(σ ) , computing the Laurent expansion for xγ with respect to T
in A amounts to applying a specialization of variables to the generating function for matchings
in GTγ .
It follows from the construction in Section 7 that the unlabeled graph GTγ ,γ˜ is equal to the
unlabeled graph GT ,γ : this is because the triangulated polygon (Sγ , Tγ ) is built so that the local
configuration of triangles that γ˜ passes through is the same as the local configuration of triangles
that γ passes through in T . Additionally, an edge of GTγ ,γ˜ labeled σi corresponds to an edge
of GT ,γ labeled π(σi ).
Comparing the definition of φγ on the coefficients yσj (Eq. (8.3)) to the definition of the
specialized height monomial (Definition 4.9), we see now that applying φγ to the generating

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2285

Fig. 31. Illustrations for proof of Proposition 5.3.

function for matchings in GTγ ,γ˜ yields exactly the formula of Theorem 4.10 applied to S, T ,
and γ . This completes the proof of the theorem. ✷
11. Positivity for notched arcs in the coefficient-free case
In this section we will use Proposition 5.3 together with our positivity result for ordinary arcs
to prove the positivity result for notched arcs (in the coefficient-free case).
Proof of Proposition 5.3. Fix a bordered surface (S, M) and an ideal triangulation T ◦ of S. Let
A be the associated coefficient-free cluster algebra. Consider a puncture p, a different marked
point q, and an ordinary arc γ between p and q. Consider a third marked point s and an ordinary
arc ρ between p and s. Let α and β be the two ordinary arcs between q and s which are sides of
a bigon so that the triangles with sides α, γ , ρ and β, γ , ρ have simply-connected interior. See
the left-hand side of Fig. 31.
x (p)
x (p)
Then in A, xγ xρ (p) = xα + xβ = xγ (p) xρ , which implies that γxγ = ρxρ . In other words, the
x

(p)

ratio γxγ is an invariant which we will call zp , which depends only on p, and not the choice of
ordinary arc γ incident to p. If we take the same bigon with sides α and β and notch all three
arcs emanating from q, we get xγ (pq) xρ = xα (q) + xβ (q) = zq xα + zq xβ = zq (xγ (p) xρ ). Therefore
xγ (pq) = zq xγ (p) = zp zq xγ .
So far we have treated the case where γ has two distinct endpoints. Now suppose that γ
is an ordinary loop based at p which does not cut out a once-punctured monogon. Then we
can find two marked points q and s, two ordinary arcs α1 and α2 between p and s, and two
ordinary arcs α3 and α4 between p and q, such that the four arcs form a quadrilateral with
diagonal γ . See the right-hand side of Fig. 31. Then xγ xρ = xα1 xα3 + xα2 xα4 and xγ (pp) xρ =
xα (p) xα (p) + xα (p) xα (p) , where xα (p) = zp xαi . It follows that xγ (pp) = zp2 xγ .
i
1
3
2
4
What remains is to give an explicit expression for the quantity zp . For γ an ordinary arc with
x

(p)

distinct endpoints, we know that zp = γxγ does not depend on the choice of γ , so we make
the simplest possible choice. Choose τ1 to be any arc of T ◦ which is incident to p, so that xτ1
is in the initial cluster associated to T ◦ . Let q denote the other endpoint of τ1 , and let p be
the loop based at q cutting out a once-punctured monogon around p. Then x p = xτ1 xτ (p) , so
zp =

x

(p)
τ1

xτ1

1

=

xp
xτ2
1

. The variable xτ1 is an initial cluster variable and we can compute the Laurent

expansion of x p using Theorem 4.10.
It is easy to see that the graph GT ◦ , p consists of h − 1 tiles with diagonals τ2 , . . . , τh , where
τ1 , τ2 , . . . , τh are the arcs of T ◦ emanating from p (say in clockwise order around p). The tiles
are glued in an alternating fashion so as to form a “zig-zag” shape, see Fig. 32. Also, τ1 is the

2286

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 32. Graph GT ◦ ,

p

corresponding to arc p enclosing radius τ1 .

label of the two outer edges of GT ◦ , p . Now a straightforward induction on h shows that applying
Theorem 4.10 to p gives

x

p

=

xτ1

h−1 i
i=0 σ (x[τ1 ,τ2 ] xτ3 xτ4

· · · xτh )

xτ2 · · · xτh

,

where σ is the cyclic permutation (1, 2, 3, . . . , h) acting on subscripts. Dividing this expression
by xτ21 gives the desired expression for zp . This completes the proof. ✷
Corollary 11.1. Fix a bordered surface (S, M), a tagged triangulation T of the form ι(T ◦ ) where
T ◦ is an ideal triangulation, and let A be the corresponding coefficient-free cluster algebra. Then
the Laurent expansion of a cluster variable corresponding to a notched arc with respect to ΣT
is positive.
Proof. This follows immediately from our positivity result for cluster variables corresponding
to ordinary arcs, together with Proposition 5.3. ✷
12. The proofs of the expansion formulas for notched arcs
In this section, we prove the results of Section 4.4, giving cluster expansion formulas for cluster variables corresponding to tagged arcs. We use algebraic identities for cluster variables to
reduce the proofs of Theorems 4.17 and 4.20 to combinatorial statements about perfect matchings, γ -symmetric matchings, and γ -compatible pairs of matchings.
In particular, for the case of a tagged arc γ (p) with a single notch at puncture p (Theorem 4.17), we use the equation x p = xγ xγ (p) and the fact that Theorem 4.10 gives us matching
formulas for two out of three of these terms. For the case of a tagged arc γ (pq) with a notch at
both ends, punctures p and q (Theorem 4.20), we use an identity (described in Section 12.2) involving xγ (pq) and three other cluster variables, where all other terms except xγ (pq) have matching
formulas from Theorems 4.10 and 4.17. In both of these cases, the fact that the desired matching
formulas for xγ (p) and xγ (pq) satisfy combinatorial identities analogous to the algebraic identities
coming from the cluster algebra completes the proofs of Theorems 4.17 and 4.20. Before giving these proofs, we introduce some notation and auxiliary lemmas. We begin by describing the
shape of the graph GT ◦ , p in more detail.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 33. The graph GT ◦ ,
even.

p.

There exists no perfect matching of GT ◦ ,

p

2287

containing the highlighted edges. Here ep is

Definition 12.1. Let Hζ be the connected subgraph of GT ◦ , p consisting of the union of the
tiles Gζ1 through Gζep (see the notation of Section 4.4 and Fig. 8).
Remark 12.2. It follows from the construction of GT ◦ , p in Section 4.2 and the fact that ζ1
through ζep all share a single endpoint, that Hζ contains no consecutive triple of tiles all of
which lie in the same row or column.
Remark 12.3. Since the arcs τid , ζ1 , ζep are the sides of a triangle in T ◦ , and τid−1 and τid share a
vertex, it follows that in the graph GT ◦ , p either the three tiles Gτid−1 , Gτid , and Gζ1 or the three
tiles Gτid−1 , Gτid and Gζep lie in a single row or column. Thus, we may assume without loss of
generality that tiles Gτid−1 , Gτid , and Gζ1 lie in a single row and tiles Gτid−1 , Gτid , and Gζep do
not. See Fig. 33.
Lemma 12.4. If P is a perfect matching of GT ◦ , p then P restricts to a perfect matching on at
least one of its two ends. More precisely, P |GT ◦ ,γ ,p,1 is a perfect matching of GT ◦ ,γ ,p,1 , or the
analogous condition must hold for P |GT ◦ ,γ ,p,2 .
Proof. See Fig. 33. We let w1 (respectively w2 ) denote the other vertex of the edge labeled ζep
(respectively ζ1 ) incident to v1 (respectively v2 ). Suppose that P is a perfect matching of GT ◦ , p
whose restriction to each of the subgraphs GT ◦ ,γ ,p,i is not a perfect matching. The restriction
of P to GT ◦ ,γ ,p,1 is not a perfect matching if and only if P contains the edge labeled ζ2 incident
to vertex v1 . Then P must also contain the edge labeled τid on the same tile because otherwise
the vertex w1 could only be covered by the edge labeled τid−1 and this would leave a connected
component with an odd number of vertices to match together.
Similarly, the restriction of P to GT ◦ ,γ ,p,2 is not a perfect matching if and only if P contains
the edge labeled ζep −1 incident to vertex v2 . Then P must also contain the edge labeled τid
incident to w2 on this same tile. However, no perfect matching P can contain all four of these

2288

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 34. One of the matchings P− and P+ of GT ◦ ,
Here ep is odd.

p

must contain the highlighted edges and is therefore γ -symmetric.

edges since by Remark 12.2, Hζ contains no consecutive triple of tiles lying in a single row or
column. Thus we have a contradiction. ✷
12.1. Proof of the expansion formula for arcs with a single notch
For the proof of Theorem 4.17, we also need the following fact.
Lemma 12.5. The minimal matching P− of GT ◦ ,

p

is a γ -symmetric matching.

Proof. Since P− and P+ are the unique perfect matchings of GT ◦ , p using only boundary edges,
it follows that exactly one out of {P− , P+ }, say P , contains the edge labeled τid−1 on the tile Gτid
containing v1 . The perfect matching P cannot contain the edge labeled τid on the adjacent tiles.
As shown in Fig. 34, the perfect matching P contains other edges on the boundary in an alternating fashion. Since the two ends of GT ◦ , p are isomorphic, continuing along the boundary in an
alternating pattern, we obtain that P is γ -symmetric. Its complement must also be γ -symmetric,
so both P− and P+ are γ -symmetric. ✷
We need to introduce a few more definitions before proving Theorem 4.17.
(i)

Definition 12.6. Let Hζ denote the induced subgraph obtained after deleting the vertices vi , wi
(1)

(2)

of Hζ and all edges incident to those vertices. Let Gζ (respectively Gζ ) denote the subgraph
(1)

(2)

of GT ◦ , p which is the union Hζ ∪ GT ◦ ,γ ,p,2 (respectively GT ◦ ,γ ,p,1 ∪ Hζ ). That is, we use a
superscript (i) to denote the removal of the ith side of a graph.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2289

Definition 12.7 (Symmetric completion). Fix a perfect matching P of GT ◦ , p , and by Lemma 12.4, assume without loss of generality that P restricts to a perfect matching on GT ◦ ,γ ,p,1 .
(1)
Therefore P also restricts to a perfect matching on the complement, graph Gζ . We define the
symmetric completion P = P |G(1) of P |G(1) to be the unique extension of P |G(1) to GT ◦ , p such
ζ

ζ

ζ

that P |HT ◦ ,γ ,p,1 ∼
= P |HT ◦ ,γ ,p,2 . (Note that after adding edges to HT ◦ ,γ ,p,1 , only vertex v1 is not
covered. We add an edge incident to v1 based on whether the edge incident to w1 labeled τid−1
is included so far.) It follows from this construction that the restriction P |GT ◦ ,γ ,p,1 is a perfect
matching.

Definition 12.8 (Sets P(γ ) and SP(γ (p) )). For an ordinary arc γ (including loops cutting out
once-punctured monogons) we let P(γ ) denote the set of perfect matchings of GT ◦ ,γ , and let
SP(γ (p) ) denote the set of γ -symmetric matchings of GT ◦ , p .
We now prove Theorem 4.17 by constructing a bijection ψ between pairs (P1 , P2 ) in
P(γ ) × SP(γ (p) ) and perfect matchings P3 in P( p ). This bijection will be weight-preserving
and height-preserving, in the sense that if ψ(P1 , P2 ) = P3 , then x(P1 )x(P2 ) = x(P3 ) and
h(P1 )h(P2 ) = h(P3 ). This gives
x(P3 )h(P3 ) =
P3 ∈P (

x(P1 )h(P1 )
P1 ∈P (γ )

p)

x(P2 )h(P2 ) .

(12.1)

P2 ∈SP (γ (p) )

After applying Φ, the left-hand side and first term on the right are the numerators for
x
x p and xγ given by Theorem 4.10, which allows us to express xγ (p) = xγp in terms of
P2 ∈SP (γ (p) ) x(P2 )h(P2 ).

Proof of Theorem 4.17. As indicated above, we define a map
ψ : P(γ ) × SP γ (p) → P(
ψ(P1 , P2 ) =

p)

by

P1 ∪ P2 |G(1)

if P2 |GT ◦ ,γ ,p,1 is a perfect matching,

P2 |G(2) ∪ P1

otherwise

ζ

ζ

where the edges of P1 are placed on the subgraph GT ◦ ,γ ,p,1 or GT ◦ ,γ ,p,2 , respectively. In words,
ψ removes all of the edges from one of the two ends of the γ -symmetric matching P2 , and
replaces those edges with edges from the perfect matching P1 , thereby constructing a perfect
matching P3 of P( p ) that it is not necessarily γ -symmetric. By Lemma 12.4, either P2 |GT ◦ ,γ ,p,1
or P2 |GT ◦ ,γ ,p,2 is a perfect matching and so ψ is well defined. Thus ψ(P1 , P2 ) is a perfect matching of P( p ).
We show that ψ is a bijection by exhibiting its inverse. For P3 ∈ P( p ), define
ϕ(P3 ) =

⎧
⎨ (P3 |GT ◦ ,γ ,p,1 , P3 |G(1) )

if P3 |GT ◦ ,γ ,p,1 is a perfect matching,

⎩ (P3 |GT ◦ ,γ ,p,2 , P3 |

otherwise.

ζ

(2)

Gζ

)

A little thought shows that these two maps are inverses.

2290

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

We now show that the bijection ψ is weight-preserving. Without loss of generality, P2 |GT ◦ ,γ ,p,1
is a perfect matching. If ψ(P1 , P2 ) = P3 , then P3 = P1 ∪ P2 |G(1) . We obtain
ζ

x(P3 ) = x(P1 )x(P2 |G(1) ) = x(P1 )
ζ

Since x(P2 ) is defined to be

x(P2 )
x(P2 |GT ◦ ,γ ,p,1 ) ,

x(P2 )
.
x(P2 |GT ◦ ,γ ,p,1 )

we conclude that ψ is weight-preserving.

To see that ψ is height-preserving, we use Lemma 12.5, which states that P− (GT ◦ , p ) is
a γ -symmetric matching. Consequently, using the same partitioning that showed that ψ was
weight-preserving, we can consider the following equation describing the symmetric difference
of P3 and P− (GT ◦ , p ):
P3

P− (GT ◦ , p ) = P1

P− (GT ◦ ,γ ) ∪ P2

P− (GT ◦ , p )|G(1) .
ζ

Since the cycles appearing in the symmetric difference determine the height monomials, this
decomposition implies that
h(P3 ) = h(P1 )h(P2 |G(1) ) = h(P1 )
ζ

h(P2 )
= h(P1 )h(P2 ),
h(P2 |GT ◦ ,γ ,p,1 )

hence ψ is height-preserving.
Because φ is weight- and height-preserving, we have (12.1). Applying Φ gives
x(P )y(P ) =
P ∈P (

x(P1 )y(P1 )
P1 ∈P (γ )

p)

We now use the identity x

p

P2

x(P2 )y(P2 ) .

(12.2)

.

(12.3)

∈SP (γ (p) )

= xγ xγ (p) and obtain

xγ (p) =

cross(T ◦ , γ )
cross(T ◦ ,

p)

P ∈P (

p)

x(P )y(P )

P ∈P (γ ) x(P )y(P )

Comparing (12.3) and (12.2) yields the desired formula.

✷

12.2. An algebraic identity for arcs with two notches
We now give the algebraic portion of the proof of Theorem 4.20. For the purpose of computing
the Laurent expansion of xρ (pq) with respect to T , we can assume that no tagged arc in T is
notched at either p or q, see Remark 4.12. In the statement below, the notation χ indicates 1
or 0, based on whether it’s argument is true or false.
Theorem 12.9. Fix a tagged triangulation T of (S, M) which comes from an ideal triangulation,
and let A be the cluster algebra associated to (S, M) with principal coefficients with respect

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2291

Fig. 35. The lamination Lρ corresponding to diagonal ρ of a quadrilateral.

to T . Let p and q be punctures in S, and let ρ be an ordinary arc between p and q. Assume that
no tagged arc in T is notched at either p or q. Then
e (τ )

xρ xρ (pq) − xρ (p) xρ (q) yρχ(ρ∈T ) = 1 −

yτ p

e (τ )

1−

τ ∈T

yτe(τ,ρ) .

yτ q
τ ∈T

τ ∈T

Proof. For simplicity, we assume that ρ ∈
/ T . (Later we will lift the assumption.) Choose a
quadrilateral in S with simply-connected interior such that one of its diagonals is ρ. (This involves the choice of two more marked points, say v and w.) Label the arcs of the quadrilateral
by α, β, γ , δ and the other diagonal by ρ , see Fig. 35. Note that there are four ways of changing
the taggings around p and q, and for each we get a Ptolemy relation:
xρ xρ = Y + Yq+ Yp+ xβ xδ + Y − xα xγ ,
xρ (p) xρ = Y + Yq+ xβ xδ (p) + Y − Yp− xα (p) xγ ,
xρ (q) xρ = Y + Yp+ xβ (q) xδ + Y − Yq− xα xγ (q) ,
xρ (pq) xρ = Y + xβ (q) xδ (p) + Y − Yq− Yp− xα (p) xγ (q) .

(12.4)
(12.5)
(12.6)
(12.7)

Here, Y + (respectively Y − ) is the monomial (in coefficient variables) coming from all laminations which do not spiral into p or q and which give a shear coordinate of 1 (respectively −1)
with ρ, as in Fig. 39. We use Definition 12.1 of [21] to compute shear coordinates with respect
to tagged arcs ρ (p) , ρ (q) , and ρ (pq) .
Yp± and Yq± are monomials coming from laminations which spiral into either the puncture
p or q, respectively. Since we assumed that T does not contain arcs with a notch at p or q,
all laminates which spiral into p or q spiral counterclockwise. Yp+ is the monomial coming
from laminations that spiral into p giving a shear coordinate of 1 to ρ (equivalently, a shear
coordinate of 1 to ρ (q) ). Yq+ is the monomial coming from laminations that spiral into q giving
a shear coordinate of 1 to ρ (equivalently, a shear coordinate of 1 to ρ (p) ). Yp− is the monomial
coming from laminations that spiral into p giving a shear coordinate of −1 to ρ (p) (equivalently,
to ρ (pq) ). Finally, Yq− is the monomial coming from laminations that spiral into q giving a shear
coordinate of −1 to ρ (q) (equivalently, to ρ (pq) ). See Fig. 36.
When we multiply Eqs. (12.4) and (12.7) and subtract the product of (12.5) and (12.6), some
terms cancel. Factoring the remaining terms, we find that
(xρ )2 (xρ xρ (pq) − xρ (p) xρ (q) ) = Y + Y − Yp+ Yp− xα (p) xδ − xα xδ (p) Yq+ Yq− xγ (q) xβ − xβ (q) xγ .
We now want to interpret each of the terms xα (p) xδ , xα xδ (p) , xγ (q) xβ , and xβ (q) xγ as the lefthand side of a Ptolemy relation. To this end, let be the arc between v and w which is homotopic

2292

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 36. Laminations incident to punctures p and q.

Fig. 37. The local configurations used in the proof of Theorem 12.9.

Fig. 38. Shear coordinates associated to the bigon around puncture p.

to the concatenation of α and δ, so that and ρ are opposite sides of a bigon with vertices v
and w and internal vertex p. See Fig. 37.
The Ptolemy relations concerning this bigon are
xα xδ (p) = Y2 Y4 x + Y1 xρ

and xδ xα (p) = Y1 Y3 xρ + Y2 x .

Here Y1 , Y2 , Y3 , and Y4 are monomials coming from laminations that intersect α and δ as in
Fig. 38. (See also [21, Fig. 32].) Note that by our assumptions on T , we do not have to worry
about laminations that spiral clockwise into p.
A laminate crossing ρ and spiraling to p must cross ρ, so Yp+ Yp− = Y4 . Therefore
Yp+ Yp− xα (p) xδ − xα xδ (p) = Y4 (Y1 Y3 xρ + Y2 x ) − (Y2 Y4 x + Y1 xρ )
e (τ )

= Y1 xρ (Y3 Y4 − 1) = Y1 xρ

yτ p
τ ∈T

since laminates spiraling to p correspond to tagged arcs incident to p.

−1 ,

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2293

Fig. 39. Shear coordinates associated to the quadrilateral containing punctures p and q as vertices.

Similarly, letting η be the arc between v and w homotopic to the concatenation of β and γ , so
that ρ and η are opposite sides of a bigon with the interior point q, we get the following Ptolemy
relations:
xβ xγ (q) = Y2 Y4 xρ + Y1 xη

and xγ xβ (q) = Y1 Y3 xη + Y2 xρ .

Here, Y1 , Y2 , Y3 , Y4 are defined just as Y1 , Y2 , Y3 , Y4 were, with q replacing p.
Similar to above, Yq+ Yq− = Y3 , and
Yq+ Yq− xγ (q) xβ − xβ (q) xγ = Y2 xρ

e (τ )

yτ q

−1 .

τ ∈T

We now have that
(xρ )2 (xρ xρ (pq) − xρ (p) xρ (q) ) = Y + Y − Y1 xρ

e (τ )

yτ p
τ ∈T

xρ xρ (pq) − xρ (p) xρ (q) = Y + Y − Y1 Y2

e (τ )

− 1 Y2 xρ

yτ q

−1 ,

so

τ ∈T
e (τ )

yτ p

e (τ )

−1

τ ∈T

yτ q

−1 .

τ ∈T

Since the monomials Y ± , Y1 and Y2 are defined by laminates crossing the quadrilateral as in
Fig. 39 (which in turn come from tagged arcs of T that have the same local configuration), it
follows that
Y + Y − Y1 Y2 =

yτe(τ,ρ) .
τ ∈T

This completes the proof when ρ ∈
/ T.
If ρ ∈ T , the proof is nearly the same. In this case, one gets a contribution to the shear coordinates from the laminate Lρ associated to ρ, see Fig. 35. Eqs. (12.5) and (12.6) remain the same,
and Eqs. (12.4) and (12.7) become
xρ xρ = Y + Yq+ Yp+ yρ xβ xδ + Y − xα xγ ,
xρ (pq) xρ = Y + xβ (q) xδ (p) + Y − Yq− Yp− yρ xα (p) xγ (q) .

(12.8)
(12.9)

2294

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 40. Illustration for Remark 12.11.

Using the four Ptolemy relations, i.e. (12.8)(12.9) − yρ (12.5)(12.6), we get
xρ2 (xρ xρ (pq) − yρ xρ (p) xρ (q) ) = Y + Y − yρ Yp+ Yp− xα (p) xδ − xα xδ (p) yρ Yq+ Yq− xγ (q) xβ − xβ (q) xγ .
In this case yρ Yp+ Yp− = Y4 and yρ Yq+ Yq− = Y3 , and the proof continues as before.

✷

There is a version of Theorem 12.9 which makes no assumptions on the notching of arcs in T
at p or q. Although we won’t use it later, we record the statement.
Theorem 12.10. Fix a tagged triangulation T of (S, M) which comes from an ideal triangulation,
and let A be the cluster algebra associated to (S, M) with principal coefficients with respect to T .
Let p and q be punctures in S, and let ρ be an ordinary arc between p and q. Then
χ(ρ (p) ∈T ) χ(ρ (q) ∈T )
yρ (q)

xρ xρ (pq) yρ (p)

χ(ρ (pq) ∈T )

− xρ (p) xρ (q) yρχ(ρ∈T ) yρ (pq)

is equal to
e (τ )

yτe(τ,ρ)
τ ∈T

yτ p
τ ∈T

e (τ )

e (τ )

−

yτ p
τ ∈T

yτ q
τ ∈T

e (τ )

−

yτ q

,

τ ∈T

where ep (τ ) (respectively, ep (τ )) is the number of ends of τ that are incident to the puncture p
with an ordinary (respectively, notched) tagging.
Remark 12.11. In the degenerate case of a bordered surface with two punctures p and q and
only one other marked point v, Theorem 12.9 still holds and the proof is analogous. Here we let
ρ be a loop based at v crossing ρ exactly once, and define α, β = γ , and δ as in Fig. 40. Note
that we can view α, β, γ , and δ as the four sides of a degenerate quadrilateral with diagonals ρ
and ρ . We then obtain the analogues of Eqs. (12.4)–(12.9), replacing all instances of vertex w
e (τ )
with v, γ with β, xβ xβ (p) with xρ , Y2 with 1, and Yq+ Yq− with τ ∈T yτ q .
Remark 12.12. In the degenerate case when p = q, Theorem 12.9 also holds, but we need to
make sense of notation such as xρ (p) when ρ is a loop. See Section 12.4.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2295

Fig. 41. The local configuration around arc γ between p and q.

12.3. Combinatorial identities satisfied by γ -compatible pairs of matchings
We now use Theorem 12.9 to prove Proposition 4.21, where γ ∈ T ◦ , and then Theorem 4.20,
where γ ∈
/ T ◦ . In both proofs, we will use Theorems 4.10 and 4.17 to replace appearances of
cluster variables xγ , xγ (p) , and xγ (q) with generating functions of perfect (and γ -symmetric)
matchings of graphs GT ◦ ,γ , GT ◦ , p and GT ◦ , q . We are then reduced to proving combinatorial
identities concerning these sets of matchings.
Lemma 12.13. Assume that the ideal triangulation T ◦ contains the arc γ between the punctures q and p (p = q). Let p denote the loop based at puncture q enclosing the arc γ and
puncture p, but no other marked points. Let P− ( p ) and P+ ( p ) denote the minimal and maximal matchings of GT ◦ , p , respectively. Define q , P− ( q ), and P+ ( q ) analogously. Assume the
local configuration around arc γ and punctures p and q is as in Fig. 41. Let ζ1 = γ and ζ2
through ζep label the arcs that p crosses as we follow it clockwise around puncture p. Analogously, let η1 = γ and η2 through ηeq label the arcs that q crosses as we follow it clockwise
around puncture q. Then we have the following:
ep −1

x P− (

p ) h P− (

p ) = xγ

(12.10)

x ζj x η 2 ,
j =2
ep

x P+ (

p ) h P+ (

p ) = xηeq
j =3

Analogous identities for

q

ep

x ζj x γ

hζj .

(12.11)

j =2

are obtained by replacing p with q and switching the η’s and ζ ’s.

Proof. The minimal and maximal matchings are precisely those that contain only boundary
edges. We distinguish between the two based on the fact that arcs ζep , γ , and ζ2 are assumed
to be given in clockwise order, as are ηeq , γ , and η2 . The edges of the minimal and maximal
matchings both have a regular alternating pattern on the interior of Hζ (respectively Hη ). See
Fig. 42 for the verification of (12.10). The weights in the other equation are analogous.
The height monomial of a minimal matching is 1, and the height monomial of a maximal
matching of a graph is the product of hτi ’s, one for each label of a tile in the graph. Looking at
the diagonals (i.e. labels) of the tiles in GT ◦ , p and GT ◦ , q completes the proof. ✷
Proof of Proposition 4.21. We define ζ1 through ζep and η1 through ηeq as in Lemma 12.13.
Based on Lemma 12.13, it follows that

2296

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 42. The graph GT ◦ ,

p

with the minimal matching P− ( p ) highlighted.
eq

ep

x P− ( q ) h P− ( q ) x P+ (

p ) h P+ (

2
p ) hγ = xγ hγ

(xζj hζj )
j =2

p)

h P− (

p)

x P+ ( q ) h P+ ( q ) hγ = xγ2 hγ

and

j =2
eq

ep

x P− (

xηj

x ζj
j =2

(xηj hηj ).
j =2

Therefore
Pp ∈P (

p)

x(Pp )h(Pp )

xγ xζ2 xζ3 · · · xζep

Pq ∈P ( q ) x(Pq )h(Pq )

·

xγ xη2 xη3 · · · xηeq

ep

− hγ

eq

− hγ

hζj
j =2

· hγ

ep

hηj

+ 1 + h2γ

j =2

eq

hζj
j =2

hηj

(12.12)

j =2

is positive, since P± ( p ) ∈ P( p ), P± ( q ) ∈ P( q ), and thus the two negative terms cancel with
terms coming from the product of Laurent polynomials.
Since we assumed that T does not contain any arcs with notches at p or q, it fole
e (τ )
e
lows that Φ(hγ ) = yγ , Φ(h(Pp )) = y(Pp ), jp=2 Φ(hζj ) = τ ∈T yτ p , and jq=2 Φ(hηj ) =
e (τ )

τ ∈T

yτ q

. Applying Φ to (12.12), we obtain that
Pp ∈P (

p)

x(Pp )y(Pp )

xγ xζ2 xζ3 · · · xζep
e (τ )

+ 1−

yτ p

·

Pq ∈P ( q ) x(Pq )y(Pq )

xγ xη2 xη3 · · · xηeq
e (τ )

1−

τ ∈T

· yγ

yτ q

(12.13)

τ ∈T

is positive. Since γ ∈ T , xγ is an initial cluster variable and the left-hand side of (12.13) can be
rewritten using Remark 4.12. Theorem 12.9 then gives
xγ (pq) =

xγ (p) xγ (q) yγ + (1 −

e (τ )

τ ∈T

yτ p

)(1 −

xγ

It follows that the cluster expansion of xγ (pq) is positive.

✷

e (τ )

τ ∈T

yτ q

)

.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2297

For the remainder of this section, we assume that γ (as well as γ (p) , γ (q) and γ (pq) ) is not
in the tagged triangulation T . We use the notation of Definition 12.8, and additionally we let
CP(γ (pq) ) denote the set of pairs of γ -compatible matchings (Pp , Pq ) of GT ◦ , p GT ◦ , q , and
let P(ζ ) (respectively P(ζ (i) ), P(η), and P(η(i) )) denote the set of perfect matchings of Hζ
(i)
(i)
(respectively Hζ , Hη , and Hη ). Following Section 4.4, we label the tiles of GT ◦ , p so that
they match the labels of the arcs crossed as we travel along p in clockwise order:
Gτi1 , Gτi2 , . . . , Gτid , Gζ1 , Gζ2 , . . . , Gζep −1 , Gζep , Gτid , Gτid−1 , . . . , Gτi2 , Gτi1 .
See Fig. 8. Analogously, the tiles of GT ◦ ,
travel along q in clockwise order:

q

are labeled so that they match the arcs crossed as we

Gτid , Gτid−1 , . . . , Gτi1 , Gη1 , Gη2 , . . . , Gηeq −1 , Gηeq , Gτi1 , Gτi2 , . . . , Gτid−1 , Gτid .
It follows that the tiles Gτid in both GT ◦ , p and GT ◦ , q have two adjacent sides labeled ζ1 and ζep ,
and the tiles Gτi1 contain two adjacent sides labeled η1 and ηeq .
We let JT ◦ ,γ ,p,i denote the induced subgraph obtained from GT ◦ ,γ ,p,i by deleting vertices vi
and wi , and all edges incident to either of these two vertices.
Lemma 12.14. If P is a γ -symmetric matching of GT ◦ , p then P can be partitioned into three
perfect matchings of subgraphs in exactly one of the two following ways:
(1) P = P |GT ◦ ,γ ,p,1

P |H (1)

P |JT ◦ ,γ ,p,2 , or

(2) P = P |JT ◦ ,γ ,p,1

P |H (2)

P |GT ◦ ,γ ,p,2 .

ζ

ζ

Proof. See Figs. 33 and 34. We will divide the set of γ -symmetric matchings of GT ◦ , p into
two classes, depending on whether or not they contain one of the edges labeled τid−1 on the tiles
containing vertex v1 and v2 . By definition, a γ -symmetric matching must contain both of these
edges or neither.
(1) If P contains the specified edges, then P must also contain the edge labeled ζ1 that is
incident to vertex v1 . (Otherwise, v1 could only be covered by the edge labeled ζ2 and this would
leave a connected component with an odd number of vertices to match together.) Filling in the
rest of the edges on tiles Gτi1 through Gτid−1 , we see that P |GT ◦ ,γ ,p,1 is a perfect matching.
Such a P does not contain the edge labeled τid on the tile Gτid−1 since that would also leave a
connected component with an odd number of vertices. Consequently, vertices v2 and w2 must be
covered by edges from Gζep . We conclude that the remainder of the set P can be decomposed
disjointly as the perfect matchings P |H (1) and P |JT ◦ ,γ ,p,2 .
ζ

(2) If P does not contain the specified edges, then P must contain the edge labeled ζep that is
incident to v2 . (Otherwise the vertex where edges labeled ζep and τid−1 meet on that tile would not
be covered by an edge of P .) Filling in the rest of P , we see that it restricts to a perfect matching
on GT ◦ ,γ ,p,2 . Since the edge labeled τid−1 incident to w1 is not in P , the edge ζ1 incident to v1
cannot be contained in P . (Otherwise vertex w1 could only be covered by the edge labeled τid
and this also leaves an odd number of vertices to match together.) We conclude that the rest of
the set P can be decomposed disjointly as the perfect matchings P |JT ◦ ,γ ,p,1 and P |H (2) .
ζ

As P either contains or does not contain the specified edges, the proof is complete.

✷

2298

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Remark 12.15. By Lemma 12.14, it is impossible for both the edge labeled ζ1 incident to v1 (respectively v2 ) and the edge labeled ζep incident to v2 (respectively v1 ) to appear in a γ -symmetric
matching of GT ◦ , p . Furthermore case (1) of Lemma 12.14 corresponds to the case where P contains one edge labeled ζ1 incident to v1 or v2 , but does not contain either edge labeled ζep incident
to v1 or v2 . Case (2) is the reverse, and analogous statements hold for edges labeled η1 and ηeq
in GT ◦ , q .
We use this observation to partition various sets of matchings into disjoint sets.
Definition 12.16 (Pa,b (γ ), SP a,b (γ (p) ), and CP a,b (γ (pq) )). For a ∈ {1, ep } and b ∈ {1, eq },
let Pa,b (γ ) (respectively SP a,b (γ (p) ) and CP a,b (γ (pq) )) denote the set of matchings in P(γ )
(respectively SP(γ (p) ) and CP(γ (pq) )) that contains at least one edge labeled ζa and at least
one edge labeled ηb .
By Remark 12.15, we have the following:
P(γ ) = P1,1 (γ )

P1,eq (γ )

SP γ (p) = SP 1,1 γ (p)
CP γ (pq) = CP 1,1 γ (pq)

Pep ,1 (γ )

SP 1,eq γ (p)

Pep ,eq (γ ),

(12.14)

SP ep ,1 γ (p)

CP 1,eq γ (pq)

CP ep ,1 γ (pq)

SP ep ,eq γ (p) ,
CP ep ,eq γ (pq) .

(12.15)
(12.16)

We let P1 (ζ ) (respectively Pep (ζ )) denote the subset of perfect matchings of Hζ that contains the
edge labeled ζ1 (respectively ζep ) on the tile Gζep (respectively Gζ1 ). We define Pb (η), Pa (ζ (i) ),
(i)

(i)

and Pb (η(i) ) analogously for graphs Hη , Hζ , and Hη . We also define the following:
Ma,b (γ ) =

(12.17)

x(P )h(P ),
P ∈Pa,b (γ )

M(γ ) =

(12.18)

x(P )h(P ),
P ∈P (γ )

SM γ (p) =

(12.19)

x(Pp )h(Pp ),
Pp ∈SP (γ (p) )

CM γ (pq) =

x(Pp , Pq )h(Pp , Pq ),
(Pp ,Pq

(12.20)

)∈CP (γ (pq) )

Ma (ζ ) =

(12.21)

x(P )h(P ),
P ∈Pa (ζ )

M ζ (1) =
M ζ (2) =

P ∈P (ζ ) x(P )h(P )

x ζ1
hζep

,

and

P ∈P (ζ ) x(P )h(P )

xζep

.

(12.22)
(12.23)

We define Mb (η), M(η(1) ), and M(η(2) ) analogously. In Eqs. (12.21)–(12.23), h(P ) is the
height monomial with respect to the relevant subgraph.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2299

Lemma 12.17. By Remark 12.3, we can assume without loss of generality that the tiles Gτid−1 ,
Gτid , and Gζ1 (respectively Gτi2 , Gτi1 , and Gη1 ) all lie in a single row or column, while the tiles
Gζep , Gτid , and Gτid−1 (respectively Gηeq , Gτi1 , and Gτi2 ) do not. Then
M(γ ) = M1,1 (γ ) + M1,eq (γ ) + Mep ,1 (γ ) + Mep ,eq (γ );
SM γ (p) = M1,1 (γ ) + M1,eq (γ ) M ζ (1) + Mep ,1 (γ ) + Mep ,eq (γ ) M ζ (2) ;
SM γ (q) = M1,1 (γ ) + Mep ,1 (γ ) M η(1) + M1,eq (γ ) + Mep ,eq (γ ) M η(2) ;
CM γ (pq) = M1,1 (γ )M ζ (1) M η(1) + M1,eq (γ )M ζ (1) M η(2)
+ Mep ,1 (γ )M ζ (2) M η(1) + Mep ,eq (γ )M ζ (2) M η(2) .
Proof. The identity for M(γ ) follows directly from (12.14). We use (12.15) to get
SM γ (p) =

x(Pp )h(Pp ) +
Pp ∈SP 1,1

x(Pp )h(Pp )
Pp ∈SP ep ,1

(γ (p) )

(γ (p) )

x(Pp )h(Pp ) +

+
Pp ∈SP 1,eq (γ (p) )

x(Pp )h(Pp ).

By Lemma 12.14, a γ -symmetric matching Pp of GT ◦ ,
matchings of
GT ◦ ,γ ,p,1

(1)

Hζ

JT ◦ ,γ ,p,2

(12.24)

Pp ∈SP ep ,eq (γ (p) )
p

restricts to the disjoint union of perfect

or JT ◦ ,γ ,p,1

(2)

Hζ

GT ◦ ,γ ,p,2 ,

based on whether Pp contains an edge labeled ζ1 or ζep , respectively. Thus we obtain
x(Pp ) =
=

x(Pp |GT ◦ ,γ ,p,2 )
x(Pp )
= x(Pp |H (1) )x(Pp |JT ◦ ,γ ,p,2 ) = x(Pp |H (1) )
ζ
ζ
x(Pp |GT ◦ ,γ ,p,1 )
x ζ1

or

x(Pp |GT ◦ ,γ ,p,2 )
x(Pp )
= x(Pp |H (2) )x(Pp |JT ◦ ,γ ,p,1 ) = x(Pp |H (2) )
,
ζ
ζ
x(Pp |GT ◦ ,γ ,p,2 )
xζep

respectively. To calculate the height, note that the minimal matching P− (
SP 1,1 ( p ) SP 1,eq ( p ), so
h(Pp ) =

p ) appears in the subset

h(Pp )
= h(Pp |H (1) )h(Pp |JT ◦ ,γ ,p,2 ) = h(Pp |H (1) )h(Pp |GT ◦ ,γ ,p,2 )
ζ
ζ
h(Pp |GT ◦ ,γ ,p,1 )

in the case that Pp ∈ SP 1,1 ( p ) SP 1,eq ( p ). On the other hand, any γ -symmetric matching in
SP ep ,1 (γ (p) ) SP ep ,eq (γ (p) ) has a height monomial scaled by a factor of hζep . Thus
h(Pp ) =

h(Pp )
= h(Pp |H (2) )h(Pp |JT ◦ ,γ ,p,1 ) = hζep h(Pp |H (2) )h(Pp |GT ◦ ,γ ,p,1 )
ζ
ζ
h(Pp |GT ◦ ,γ ,p,2 )

in the case that Pp ∈ SP ep ,1 (

p)

SP ep ,eq (

p ).

We thus can rewrite (12.24) as

2300

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

SM γ (p) =
P1 ∈P1,1 (γ ) P1,eq (γ ) P2 ∈P1 (ζ (1) )

x(P1 )
h(P1 )x(P2 )h(P2 )
x ζ1

+
P1 ∈Pep ,1 (γ ) Pep ,eq (γ ) P2 ∈Pep (ζ (2) )

x(P1 )
h(P1 )x(P2 )h(P2 )hζep ,
xζep

(12.25)

thus showing the identity for SM(γ (p) ) (and SM(γ (q) )).
The formula for CM(γ (pq) ) follows by similar logic since specifying the four ends of a
γ -compatible pair of matchings of GT ◦ , p and GT ◦ , q also specifies which of the two cases of
Lemma 12.14 we are in for both GT ◦ , p and GT ◦ , q . ✷
Lemma 12.17 immediately implies the following.
Lemma 12.18. The expression CM(γ (pq) )M(γ ) − SM(γ (p) )SM(γ (q) ) equals
M1,1 (γ )Mep ,eq (γ ) − M1,eq (γ )Mep ,1 (γ ) M ζ (1) − M ζ (2)

M η(1) − M η(2) .

The next two results describe how to simplify the three factors in (12.18).
Lemma 12.19. We have
Φ M1,1 (γ )Mep ,eq (γ ) − M1,eq (γ )Mep ,1 (γ )
d−1

= xτi1 xτid xζ1 xζep xη1 xηeq

xτ2i
j =2

j

yτe(τ,γ ) .

(12.26)

τ ∈T

Proof. The idea is that a superposition of two matchings corresponding to the first term on the
left-hand side of (12.26) can be decomposed into a superposition of two matchings corresponding
to the second term on the left-hand side of (12.26) in all cases except one. This case corresponds
to the right-hand side of (12.26). Let P1 + P2 be the multigraph given by the superposition of P1
and P2 , let P1 be an element of P1,1 (γ ), and let P2 be an element of Pep ,eq (γ ). Since GT ◦ ,γ is
bipartite, P1 + P2 consists of a disjoint union of cycles of even length (including doubled edges
which we treat as cycles of length two).
By definition, P1 contains the edge labeled ζ1 on the tile Gτid while P2 contains the edge
labeled ζep on Gτid . Similarly, P1 contains the edge labeled η1 on Gτi1 while P2 contains the
edge labeled ηeq on Gτi1 . Consequently, the superposition P1 + P2 contains at least one cycle
of length greater than two, and one such cycle must contain the edges labeled ζ1 and ζep on the
tile Gτid , and one must contain the edges labeled η1 and ηeq on the tile Gτi1 .
Let k be the number of cycles in P1 + P2 of length greater than 2 which do not involve edges
on tiles Gτid or Gτi1 . Then there are 2k ways of decomposing P1 + P2 into the superposition of
two matchings, one from P1,1 (γ ) and one from Pep ,eq (γ ). When P1 + P2 has at least two cycles
of length greater than 2, there are also 2k ways to decompose P1 + P2 into the superposition of
two matchings with one from each of Pep ,1 (γ ) and P1,eq (γ ). Thus we have a weight-preserving
and height-preserving bijection between such superpositions.
The superposition of the minimal matching P− (γ ) ∈ P1,1 (γ ) and the maximal matching
P+ (γ ) ∈ Pep ,eq (γ ) is of the form P1 + P2 , but consists of a single cycle including all edges on the

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2301

boundary of GT ◦ ,γ . Recall that the sets P1,1 (γ ), Pep ,1 (γ ), P1,eq (γ ), and Pep ,eq (γ ) are disjoint.
Accordingly, a single cycle cannot decompose into a superposition of an element of Pep ,1 (γ )
and an element of P1,eq (γ ) because P− (γ ) and P+ (γ ) are the unique two perfect matchings of
a single cycle including all edges on the boundary of GT ◦ ,γ . It follows that any superposition of
an element in Pep ,1 (γ ) and an element in P1,eq (γ ) must contain at least two cycles, and is also
of the form P1 + P2 , with P1 ∈ P1,1 (γ ) and P2 ∈ Pep ,eq (γ ).
In conclusion, the only monomial not canceled on the left-hand side of (12.26) corresponds to
the superposition of P− (γ ) and P+ (γ ), which includes all edges on the boundary. To calculate
the weight, note that on each tile Gτij for 2 j d − 1, there are exactly two adjacent tiles that
include edges on the boundary with weight xτij , see Fig. 6. On the other hand, Gτi1 and Gτid only
have one adjacent tile each with an edge on the boundary with weight xτi1 (respectively xτid ).
The remaining two boundary edges of Gτi1 have weights xη1 and xηeq , while those of Gτid
have weights xζ1 and xζep . The product of heights is dj =1 hτij , the height monomial for the
minimal matching multiplied by the height monomial for the maximal matching. This specializes
e(τ,γ )
to τ ∈T yτ
under the map Φ. ✷
Lemma 12.20. We have the following two identities:
ep −1

Φ M ζ (1) − M ζ (2)

= xτid

e (τ )

1−

x ζj

yτ p

and

τ ∈T

j =2
eq −1

Φ M η

(1)

−M η

(2)

= xτi1

e (τ )

1−

xηj

yτ q

.

τ ∈T

j =2

Proof. It suffices to prove the first identity. The idea is to show that almost all terms on the lefthand side cancel except for two, which correspond to the two monomials on the right. Recall the
notation preceding Lemma 12.17.
(1)
(2)
The union of a perfect matching of Hζ (respectively Hζ ) and the edge labeled ζep (respectively ζ1 ) on Gζ1 (respectively Gζep ) is an element of the set P1 (ζ ) (respectively Pep (ζ )). The
minimal height of a matching in P1 (ζ ) is hζep while subset Pep (ζ ) contains the perfect matching
of Hζ with a height monomial of 1. We accordingly obtain the identities
and Mep (ζ ) = xζep xζ1 M ζ (1) ,

M1 (ζ ) = xζ1 xζep M ζ (2)
Φ M ζ (1) − M ζ (2)

=

Φ(Mep (ζ ) − M1 (ζ ))
xζ1 xζep

=

Φ(

and so

x(P )h(P ))
,
xζ1 xζep

P

(12.27)

where the sum is over P ∈ (P1 (ζ ) ∪ Pep (ζ )) \ (P1 (ζ ) ∩ Pep (ζ )). There are exactly two perfect
matchings of Hζ not in this intersection, therefore (12.27) equals
x(P− (Hζ ))y(P− (Hζ )) − x(P+ (Hζ ))y(P+ (Hζ ))
.
xζ1 xζep
By inspection (see the central subgraphs of Figs. 33 and 34), x(P− (Hζ )) = x(P+ (Hζ )) =
xτid (

ep
j =1 xζj ),

y(P− (Hζ )) = 1, and y(P+ (Hζ )) =

e (τ )

τ ∈T

yτ p

.

✷

2302

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

We can now prove Theorem 4.20.
Proof of Theorem 4.20. We conclude from Lemmas 12.18, 12.19, and 12.20 that
Φ CM γ (pq) M(γ ) − SM γ (p) SM γ (q)
ep

d

=

eq

xτ2i
j =1

×

x ζj

j

xηj

j =1

j =1
e (τ )

1−

yτe(τ,γ )
τ ∈T

τ ∈T

Using Theorem 4.17, we have that xγ =

e (τ )

1−

yτ p

yτ q

(12.28)

.

τ ∈T

Φ(M(γ ))
d
j =1 xτi

and xγ (p) xγ (q) is equal to

j

Φ(SM(γ (p) ))
e(γ ,τ )+ep (τ )
τ ∈T xτ

·

Φ(SM(γ (q) ))
e(γ ,τ )+eq (τ )
τ ∈T xτ

=

Φ(SM(γ (p) ))
ep
j =1 xζj

d
j =1 xτij

Φ(SM(γ (q) ))

·

d
j =1 xτij

eq
j =1 xηj

.

Using (12.28), we obtain
Φ(CM(γ (pq) ))Φ(M(γ ))
d
2
j =1 xτij

ep
j =1 xζj

eq
j =1 xηj

e (τ )

− xγ (p) xγ (q) = 1 −
τ ∈T

Comparing this to Theorem 12.9 and using xγ =

e (τ )

1−

yτ p

τ ∈T

Φ(M(γ ))
d
j =1 xτi

yτe(τ,γ ) .

yτ q

τ ∈T

yields

j

xγ (pq) =

Φ(CM(γ (pq) ))
d
j =1 xτij

ep
j =1 xζj

eq
j =1 xηj

.

✷

12.4. The case of a doubly-notched loop
Section 12.3 proved our formula for cluster variables corresponding to doubly-notched arcs
between two distinct punctures p and q. It remains to understand the cluster variables corresponding to doubly-notched loops.
We will use the same strategy for doubly-notched loops as we used for doubly-notched arcs
between two punctures, namely, we will show that our combinatorial formula for doubly-notched
loops satisfies the identity of Theorem 12.9. However, we need to explain how to interpret Theorem 12.9 when ρ is a loop, namely an arc between points p and q where p and q happen to
coincide. In this case it is not immediately clear how to interpret the symbols xρ (p) and xρ (q) ;
a “singly-notched loop” does not represent a cluster variable.
Before defining the symbol xρ (p) , we need to introduce an operation we call augmentation.
Definition 12.21 (Augmentation). Fix a bordered surface (S, M), an ideal triangulation T ◦ of S,
a puncture p, and a loop ρ based at p with a choice of orientation. Let be the first triangle
of T ◦ which ρ crosses. We assume that is not self-folded, so we can denote the arcs of by

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2303

Fig. 43. Augmenting a bordered surface and triangulation.

a, b and c (in clockwise order), with a and c incident to p, a and b incident to a marked point u,
and b and c incident to a marked point v. We then define the augmented bordered surface (S, M)
by adding a single puncture q to (S, M), placing it inside . And we construct the augmented
triangulation T ◦ from T ◦ by adding three new arcs inside : an arc aˆ from q to u, an arc cˆ
from q to v, and an arc bˆ from u to v (so that bˆ and b form a bigon with the puncture q inside).
See Fig. 43.
Definition 12.22 (The Laurent polynomial corresponding to a singly-notched loop). Fix a bordered surface (S, M) and a tagged triangulation T = ι(T ◦ ) corresponding to an ideal triangulation T ◦ , and let A be the corresponding cluster algebra with principal coefficients with respect
to T . Let ρ be an ordinary loop based at p, with a choice of orientation, and let ρ (p) denote the
“tagged arc” obtained from ρ by notching at the final end of ρ. We represent this “tagged arc”
by the curve (with a self-intersection) p obtained by following the loop ρ along its orientation,
but then looping around the puncture p and doubling back, again following ρ. See Fig. 9. Let
GT ◦ , p be the graph associated to p in Section 4.2. Then we define xρ (p) to be
1
cross(T ◦ , ρ (p) )

x(P )y(P ),
P

where the sum is over all ρ-symmetric matchings P of GT ◦ , p .
Proposition 12.23. Using the notation of Definition 12.22, let T ◦ denote the augmented triangulation corresponding to T ◦ and ρ, and let ρˆ denote the arc in T ◦ from q to p which is equal to ρ
after identification of p and q. We set xaˆ = xa , xbˆ = xb , xcˆ = xc , yaˆ = ya , ybˆ = yb , and ycˆ = yc .
Let ˆp denote the loop which is the ideal arc representing ρˆ (p) . Then xρ (p) is equal to
1
cross(T ◦ , ρˆ (p) )

x(P )y(P ),
P

where the sum is over all ρ-symmetric
ˆ
matchings P of GT ◦ , ˆp .
Remark 12.24. In other words, xρ (p) can be obtained by taking the formula for xρˆ (p) given by
Theorem 4.17, and making a simple substitution of variables.

2304

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

Fig. 44. Laminations for a quadrilateral in a bigon.

Proof. By Remark 4.12, we can assume that the first triangle which p crosses is not self-folded;
therefore we can augment T ◦ . We defined T ◦ so that the sequence of diagonals crossed by the
loop ˆp in S is identical to the sequence of diagonals crossed by the curve p in S. Moreover,
the local configurations of all triangles crossed is the same for both ˆp and p , and after the
substitution aˆ = a, bˆ = b, and cˆ = c, even their labels coincide. (Note that it was essential for
us to define T ◦ so that in the neighborhoods around p in both S and S, the two triangulations
coincide.) Therefore, after this substitution, the labeled graphs GT ◦ , ˆp and GT ◦ , p are equal. Additionally, the notions of ρ-symmetric
ˆ
and ρ-symmetric matchings coincide, as do the crossing
monomials. This proves the proposition. ✷
Proposition 12.25. Fix a bordered surface (S, M) and a tagged triangulation T = ι(T ◦ ), and
let A be the corresponding cluster algebra. Let ρ be a loop based at a puncture p in S. Choose
two market points w and v, arcs α and β between p and v, and arcs γ and δ between p and w,
so that α, β, γ , and δ are the four sides (in clockwise order) of a quadrilateral with simplyconnected interior. Let ρ denote the arc between v and w so that ρ and ρ are the two diagonals
of this quadrilateral. Choose the orientation for ρ which starts at the corner of the quadrilateral
between β and γ , and ends at the corner between α and δ, and define xρ (p) as in Definition 12.22.
Define xρ (q) in the same way, but using the opposite orientation for ρ. Let Yq± , Yp± , and Y ±
be the monomials of shear coordinates coming from laminations as in Fig. 44 (which shows a
degeneration of Figs. 36 and 39). Then we have (12.5) and (12.6).
ˆ γˆ , δ,
ˆ ρ,
Proof. It suffices to prove (12.5). We augment S and T ◦ , and define arcs α,
ˆ β,
ˆ and ρˆ
ˆ γˆ
in S, so that they are the same as the corresponding arcs in S except that the endpoints of β,
and ρˆ are moved from p to q. See Fig. 45. The underlying triangulations are indicated by thin
lines, and the sides of the quadrilateral are bold.
ˆ
By Proposition 12.23, after a simple specialization of variables (obtained by equating a,
ˆ b,
cˆ with a, b, c), xρ (p) is equal to xρˆ . Similarly, xρ = xρˆ , xβ = xβˆ , xδ (p) = xδˆ(p) , xα (p) = xαˆ (p) ,
and xγ = xγˆ . Note that we are using the fact that the augmentation T ◦ of T ◦ preserves the
neighborhood around the puncture p. Finally, we know that in S Eq. (12.5) holds, so after the
simple specialization above, the proposition holds. ✷
The proof of Theorem 4.20 for doubly-notched arcs can now be extended to loops.
Proof of Theorem 4.20. We’ve now defined xρ (p) and xρ (q) , so the statement of Theorem 12.9
makes sense. (Here ep (τ ) = eq (τ ) is the number of ends of arcs of T ◦ which are incident to p.)
Moreover by Proposition 12.25, (12.5) and (12.6) hold, and the proof of Theorem 12.9 works

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2305

Fig. 45. Opening the quadrilateral in the bigon.

with minimal modifications. We now have an algebraic counterpart for a singly-notched loop
given by Proposition 12.23, which is analogous to our formula for singly-notched loops. Using
this, the proofs of Section 12.3 now hold for doubly-notched loops, with no changes necessary.
This proves our combinatorial formula for cluster variables of doubly-notched loops as sums
over γ -compatible pairs of matchings. ✷
Question 12.26. When ρ is a loop, is xρ (p) an element of A, or just Frac(A)?
13. Applications to F -polynomials, g-vectors, Euler characteristics
13.1. F -polynomials and g-vectors
Fomin and Zelevinsky showed [24] that the Laurent expansions of cluster variables can be
computed from the somewhat simpler F -polynomials and g-vectors. In this section we invert
this line of thought and compute the F -polynomials and g-vectors from our Laurent expansion
formulas. F -polynomials are obtained from Laurent expansions of cluster variables with principal coefficients by setting all cluster variables equal to 1. Thus the F -polynomial Fγ of a tagged
arc γ is obtained from Theorems 4.10, 4.17 and 4.20 by deleting the weight and crossing monomials, and summing up only the specialized height monomials. E.g. if γ is an ordinary arc then
Fγ =

y(P ),
P

where the sum is over all perfect matchings of GT ◦ ,γ .
Note that this shows that F -polynomials have constant term 1, since the minimal matching P−
is the only matching with y(P− ) = 1.
It has been shown [24] that the Laurent expansion of any cluster variable with respect to a seed
(x, y, B) is homogeneous with respect to the grading given by deg(xi ) = ei and deg(yi ) = Bei ,
where ei = (0, . . . , 0, 1, 0, . . . , 0) ∈ Zn with 1 at position i. The g-vector gγ of a cluster variable xγ is the degree of its Laurent expansion with respect to this grading. Since y(P− ) = 1,
Theorem 4.10 implies that the g-vector is given by
gγ = deg

x(P− )
,
cross(T ◦ , γ )

2306

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

if γ is an ordinary arc. The same formula works for arcs with one or two notches, replacing
x(P− ) by x(P− ) or x(P− ), respectively.
13.2. Euler–Poincaré characteristics
In this section we combine our cluster expansion formula with results of [13]. Let A =
A(x, y, B) be a rank n cluster algebra with principal coefficients associated to a surface. Associate to B = (bij ) a quiver Q(B) without loops or oriented 2-cycles, with vertices {1, 2, . . . , n}
and with bij arrows from i to j if and only if bij > 0. Let S be a potential on Q(B), and consider
the corresponding Jacobian algebra: it is the quotient of the complete path algebra of Q(B) by the
Jacobian ideal, which is the closure of the ideal generated by the partial cyclic derivatives of the
potential. In [13], the authors associate to any cluster variable xγ in A a finite-dimensional module Mγ over the Jacobian algebra (thus Mγ is a representation of the quiver Q(B) whose maps
satisfy the relations given by the Jacobian ideal). Furthermore, they prove that the F -polynomial
of xγ is given by the formula
n

Fγ =

yiei ,

χ Gre (Mγ )
e

i=1

where the sum is over all dimension vectors e = (e1 , e2 , . . . , en ), χ is the Euler–Poincaré characteristic, and Gre (Mγ ) is the e-Grassmannian of Mγ , i.e. the variety of subrepresentations of
dimension vector e. Comparing this to our formulas for Fγ , we get the following.
Theorem 13.1.
(1) For an ordinary arc γ , χ(Gre (Mγ )) is the number of perfect matchings P of GT ◦ ,γ such
that y(P ) is equal to ni=1 yiei .
(2) For an arc γ = γ (p) with one notched end, χ(Gre (Mγ )) is the number of γ -symmetric
matchings P of GT ◦ , p such that y(P ) = ni=1 yiei .
(3) For an arc γ = γ (pq) with two notched ends, χ(Gre (Mγ )) is the number of γ -compatible
pairs (P1 , P2 ) of GT ◦ , p GT ◦ , q such that y(P1 , P2 ) = ni=1 yiei .
Corollary 13.2. For any cluster variable xγ in a cluster algebra associated to a surface, the
Euler–Poincaré characteristic χ(Gre (Mγ )) is a non-negative integer.
Remark 13.3. In the case where Q(B) has no oriented cycles, Corollary 13.2 was already proved
in [9], and for unpunctured surfaces in [38].
Acknowledgments
We are grateful to the organizers of the workshop on cluster algebras in Morelia, Mexico,
where we benefited from Dylan Thurston’s lectures. We would also like to thank Sergey Fomin
and Bernard Leclerc for useful discussions. Finally, we are grateful to the anonymous referees for
their insightful comments and simplified exposition for the proof of Theorem 10.1. Most of this
work was completed while Gregg Musiker was an NSF postdoc and Instructor in Applied Math
at MIT, and Lauren Williams was an NSF postdoc and Benjamin Peirce Instructor at Harvard.

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

2307

References
[1] C. Amiot, Cluster categories for algebras of global dimension 2 and quivers with potential, Ann. Inst. Fourier 59 (6)
(2009) 2525–2590.
[2] I. Assem, T. Brüstle, G. Charbonneau-Jodoin, P.G. Plamondon, Gentle algebras arising from surface triangulations,
Algebra Number Theory 4 (2) (2010) 201–229.
[3] A. Berenstein, S. Fomin, A. Zelevinsky, Cluster algebras III: Upper bounds and double Bruhat cells, Duke Math. J.
126 (1) (2005) 1–52.
[4] A. Buan, R. Marsh, M. Reineke, I. Reiten, G. Todorov, Tilting theory and cluster combinatorics, Adv. Math. 204
(2006) 572–612.
[5] P. Caldero, F. Chapoton, Cluster algebras as Hall algebras of quiver representations, Comment. Math. Helv. 81
(2006) 595–616.
[6] P. Caldero, F. Chapoton, R. Schiffler, Quivers with relations arising from clusters (An case), Trans. Amer. Math.
Soc. 358 (3) (2006) 1347–1364.
[7] P. Caldero, B. Keller, From triangulated categories to cluster algebras, Invent. Math. 172 (2008) 169–211.
[8] P. Caldero, B. Keller, From triangulated categories to cluster algebras II, Ann. Sci. École Norm. Sup. (4) 39 (6)
(2006) 983–1009.
[9] P. Caldero, M. Reineke, On the quiver Grassmannian in the acyclic case, J. Pure Appl. Algebra 212 (11) (2008)
2369–2380.
[10] P. Caldero, A. Zelevinsky, Laurent expansions in cluster algebras via quiver representations, Mosc. Math. J. 6 (3)
(2006) 411–429.
[11] G. Carroll, G. Price, Two new combinatorial models for the Ptolemy recurrence, unpublished memo, 2003.
[12] J. Conway, J. Lagarias, Tiling with polyominoes and combinatorial group theory, J. Combin. Theory Ser. A 53 (2)
(1990) 183–208.
[13] H. Derksen, J. Weyman, A. Zelevinsky, Quivers with potentials and their representations II: Applications to cluster
algebras, J. Amer. Math. Soc. 23 (3) (2010) 749–790.
[14] G. Dupont, Positivity in coefficient-free rank two cluster algebras, Electron. J. Combin. 16 (1) (2009), Research
Paper 98, 11 pp.
[15] N. Elkies, G. Kuperberg, M. Larsen, J. Propp, Alternating-sign matrices and domino tilings I, J. Algebraic Combin. 1 (2) (1992) 111–132.
[16] A. Felikson, M. Shapiro, P. Tumarkin, Skew-symmetric cluster algebras of finite mutation type, preprint, arXiv:
0811.1703.
[17] V. Fock, A. Goncharov, Moduli spaces of local systems and higher Teichmüller theory, Publ. Math. Inst. Hautes
Études Sci. 103 (2006) 1–211.
[18] V. Fock, A. Goncharov, Dual Teichmüller and lamination spaces, in: Handbook of Teichmüller Theory, vol. I, in:
IRMA Lect. Math. Theor. Phys., vol. 11, Eur. Math. Soc., Zürich, 2007, pp. 647–684.
[19] V. Fock, A. Goncharov, Cluster ensembles, quantization and the dilogarithm, Ann. Sci. École Norm. Sup. (4) 42 (6)
(2009) 865–930.
[20] S. Fomin, M. Shapiro, D. Thurston, Cluster algebras and triangulated surfaces. Part I: Cluster complexes, Acta
Math. 201 (2008) 83–146.
[21] S. Fomin, D. Thurston, Cluster algebras and triangulated surfaces. Part II: Lambda lengths, preprint, 2008.
[22] S. Fomin, A. Zelevinsky, Cluster algebras I: Foundations, J. Amer. Math. Soc. 15 (2002) 497–529.
[23] S. Fomin, A. Zelevinsky, Cluster algebras II: Finite type classification, Invent. Math. 154 (2003) 63–121.
[24] S. Fomin, A. Zelevinsky, Cluster algebras IV: Coefficients, Compos. Math. 143 (2007) 112–164.
[25] S. Fomin, A. Zelevinsky, unpublished result.
[26] C. Fu, B. Keller, On cluster algebras with coefficients and 2-Calabi–Yau categories, Trans. Amer. Math. Soc. 362 (2)
(2010) 859–895.
[27] M. Gekhtman, M. Shapiro, A. Vainshtein, Cluster algebras and Weil–Petersson forms, Duke Math. J. 127 (2005)
291–311.
[28] D. Hernandez, B. Leclerc, Cluster algebras and quantum affine algebras, Duke Math. J. 154 (2) (2010) 265–341.
[29] D. Labardini-Fragoso, Quivers with potentials associated to triangulated surfaces, Proc. Lond. Math. Soc. (3) 98 (3)
(2009) 797–839.
[30] G. Musiker, A graph theoretic expansion formula for cluster algebras of classical type, Ann. Comb. 15 (1) (2011)
147–184.
[31] G. Musiker, J. Propp, Combinatorial interpretations for rank-two cluster algebras of affine type, Electron. J. Combin. 14 (1) (2007), Research Paper 15, 23 pp. (electronic).

2308

G. Musiker et al. / Advances in Mathematics 227 (2011) 2241–2308

[32] G. Musiker, R. Schiffler, Cluster expansion formulas and perfect matchings, J. Algebraic Combin. 32 (2) (2010)
187–209.
[33] H. Nakajima, Quiver varieties and cluster algebras, preprint, arXiv:0905.0002.
[34] Y. Palu, Cluster characters for triangulated 2-Calabi–Yau categories, Ann. Inst. Fourier 58 (6) (2008) 2221–2248.
[35] J. Propp, Lattice structure for orientations of graphs, preprint, arXiv:math/0209005, 1993.
[36] J. Propp, The combinatorics of frieze patterns and Markoff numbers, preprint, arXiv:math.CO/0511633.
[37] R. Schiffler, A cluster expansion formula (An case), Electron. J. Combin. 15 (2008), #R64 1.
[38] R. Schiffler, On cluster algebras arising from unpunctured surfaces II, Adv. Math. 223 (6) (2010) 1885–1923.
[39] R. Schiffler, H. Thomas, On cluster algebras arising from unpunctured surfaces, Int. Math. Res. Not. IMRN 17
(2009) 3160–3189.
[40] P. Sherman, A. Zelevinsky, Positivity and canonical bases in rank 2 cluster algebras of finite and affine types, Mosc.
Math. J. 4 (4) (2004) 947–974, 982.
[41] W. Thurston, Conway’s tiling groups, Amer. Math. Monthly 97 (1990) 757–773.
(1)
[42] A. Zelevinsky, Semicanonical basis generators of the cluster algebra of type A1 , Electron. J. Combin. 14 (1)
(2007), Note 4, 5 pp. (electronic).

